var Xu=Object.defineProperty;var Yl=s=>{throw TypeError(s)};var Yu=(s,e,i)=>e in s?Xu(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;var zr=(s,e,i)=>Yu(s,typeof e!="symbol"?e+"":e,i),Eo=(s,e,i)=>e.has(s)||Yl("Cannot "+i);var Kt=(s,e,i)=>(Eo(s,e,"read from private field"),i?i.call(s):e.get(s)),Yn=(s,e,i)=>e.has(s)?Yl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,i),Jn=(s,e,i,o)=>(Eo(s,e,"write to private field"),o?o.call(s,i):e.set(s,i),i),Wn=(s,e,i)=>(Eo(s,e,"access private method"),i);var Cs=(s,e,i,o)=>({set _(a){Jn(s,e,a,i)},get _(){return Kt(s,e,o)}});function _mergeNamespaces(s,e){for(var i=0;i<e.length;i++){const o=e[i];if(typeof o!="string"&&!Array.isArray(o)){for(const a in o)if(a!=="default"&&!(a in s)){const j=Object.getOwnPropertyDescriptor(o,a);j&&Object.defineProperty(s,a,j.get?j:{enumerable:!0,get:()=>o[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const j of a)if(j.type==="childList")for(const _e of j.addedNodes)_e.tagName==="LINK"&&_e.rel==="modulepreload"&&o(_e)}).observe(document,{childList:!0,subtree:!0});function i(a){const j={};return a.integrity&&(j.integrity=a.integrity),a.referrerPolicy&&(j.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?j.credentials="include":a.crossOrigin==="anonymous"?j.credentials="omit":j.credentials="same-origin",j}function o(a){if(a.ep)return;a.ep=!0;const j=i(a);fetch(a.href,j)}})();function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var i=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(s).forEach(function(o){var a=Object.getOwnPropertyDescriptor(s,o);Object.defineProperty(i,o,a.get?a:{enumerable:!0,get:function(){return s[o]}})}),i}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$2(s){return s===null||typeof s!="object"?null:(s=z$3&&s[z$3]||s["@@iterator"],typeof s=="function"?s:null)}var B$3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(s,e,i){this.props=s,this.context=e,this.refs=D$2,this.updater=i||B$3}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};E$2.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2(s,e,i){this.props=s,this.context=e,this.refs=D$2,this.updater=i||B$3}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$3(s,e,i){var o,a={},j=null,_e=null;if(e!=null)for(o in e.ref!==void 0&&(_e=e.ref),e.key!==void 0&&(j=""+e.key),e)J.call(e,o)&&!L$3.hasOwnProperty(o)&&(a[o]=e[o]);var tt=arguments.length-2;if(tt===1)a.children=i;else if(1<tt){for(var et=Array(tt),rt=0;rt<tt;rt++)et[rt]=arguments[rt+2];a.children=et}if(s&&s.defaultProps)for(o in tt=s.defaultProps,tt)a[o]===void 0&&(a[o]=tt[o]);return{$$typeof:l$1,type:s,key:j,ref:_e,props:a,_owner:K$1.current}}function N$3(s,e){return{$$typeof:l$1,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function O$3(s){return typeof s=="object"&&s!==null&&s.$$typeof===l$1}function escape$1(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(i){return e[i]})}var P$2=/\/+/g;function Q$3(s,e){return typeof s=="object"&&s!==null&&s.key!=null?escape$1(""+s.key):e.toString(36)}function R$2(s,e,i,o,a){var j=typeof s;(j==="undefined"||j==="boolean")&&(s=null);var _e=!1;if(s===null)_e=!0;else switch(j){case"string":case"number":_e=!0;break;case"object":switch(s.$$typeof){case l$1:case n$1:_e=!0}}if(_e)return _e=s,a=a(_e),s=o===""?"."+Q$3(_e,0):o,I$2(a)?(i="",s!=null&&(i=s.replace(P$2,"$&/")+"/"),R$2(a,e,i,"",function(rt){return rt})):a!=null&&(O$3(a)&&(a=N$3(a,i+(!a.key||_e&&_e.key===a.key?"":(""+a.key).replace(P$2,"$&/")+"/")+s)),e.push(a)),1;if(_e=0,o=o===""?".":o+":",I$2(s))for(var tt=0;tt<s.length;tt++){j=s[tt];var et=o+Q$3(j,tt);_e+=R$2(j,e,i,et,a)}else if(et=A$2(s),typeof et=="function")for(s=et.call(s),tt=0;!(j=s.next()).done;)j=j.value,et=o+Q$3(j,tt++),_e+=R$2(j,e,i,et,a);else if(j==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return _e}function S$2(s,e,i){if(s==null)return s;var o=[],a=0;return R$2(s,o,"","",function(j){return e.call(i,j,a++)}),o}function T$2(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(i){(s._status===0||s._status===-1)&&(s._status=1,s._result=i)},function(i){(s._status===0||s._status===-1)&&(s._status=2,s._result=i)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(s,e,i){S$2(s,function(){e.apply(this,arguments)},i)},count:function(s){var e=0;return S$2(s,function(){e++}),e},toArray:function(s){return S$2(s,function(e){return e})||[]},only:function(s){if(!O$3(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(s,e,i){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var o=C$2({},s.props),a=s.key,j=s.ref,_e=s._owner;if(e!=null){if(e.ref!==void 0&&(j=e.ref,_e=K$1.current),e.key!==void 0&&(a=""+e.key),s.type&&s.type.defaultProps)var tt=s.type.defaultProps;for(et in e)J.call(e,et)&&!L$3.hasOwnProperty(et)&&(o[et]=e[et]===void 0&&tt!==void 0?tt[et]:e[et])}var et=arguments.length-2;if(et===1)o.children=i;else if(1<et){tt=Array(et);for(var rt=0;rt<et;rt++)tt[rt]=arguments[rt+2];o.children=tt}return{$$typeof:l$1,type:s.type,key:a,ref:j,props:o,_owner:_e}};react_production_min.createContext=function(s){return s={$$typeof:u$1,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:t,_context:s},s.Consumer=s};react_production_min.createElement=M$3;react_production_min.createFactory=function(s){var e=M$3.bind(null,s);return e.type=s,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(s){return{$$typeof:v$2,render:s}};react_production_min.isValidElement=O$3;react_production_min.lazy=function(s){return{$$typeof:y$1,_payload:{_status:-1,_result:s},_init:T$2}};react_production_min.memo=function(s,e){return{$$typeof:x$2,type:s,compare:e===void 0?null:e}};react_production_min.startTransition=function(s){var e=V$1.transition;V$1.transition={};try{s()}finally{V$1.transition=e}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(s,e){return U$1.current.useCallback(s,e)};react_production_min.useContext=function(s){return U$1.current.useContext(s)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(s){return U$1.current.useDeferredValue(s)};react_production_min.useEffect=function(s,e){return U$1.current.useEffect(s,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(s,e,i){return U$1.current.useImperativeHandle(s,e,i)};react_production_min.useInsertionEffect=function(s,e){return U$1.current.useInsertionEffect(s,e)};react_production_min.useLayoutEffect=function(s,e){return U$1.current.useLayoutEffect(s,e)};react_production_min.useMemo=function(s,e){return U$1.current.useMemo(s,e)};react_production_min.useReducer=function(s,e,i){return U$1.current.useReducer(s,e,i)};react_production_min.useRef=function(s){return U$1.current.useRef(s)};react_production_min.useState=function(s){return U$1.current.useState(s)};react_production_min.useSyncExternalStore=function(s,e,i){return U$1.current.useSyncExternalStore(s,e,i)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$2=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$2(s,e,i){var o,a={},j=null,_e=null;i!==void 0&&(j=""+i),e.key!==void 0&&(j=""+e.key),e.ref!==void 0&&(_e=e.ref);for(o in e)m$2.call(e,o)&&!p$2.hasOwnProperty(o)&&(a[o]=e[o]);if(s&&s.defaultProps)for(o in e=s.defaultProps,e)a[o]===void 0&&(a[o]=e[o]);return{$$typeof:k$2,type:s,key:j,ref:_e,props:a,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(Vn,Rn){var Dn=Vn.length;Vn.push(Rn);e:for(;0<Dn;){var Fn=Dn-1>>>1,Tn=Vn[Fn];if(0<a(Tn,Rn))Vn[Fn]=Rn,Vn[Dn]=Tn,Dn=Fn;else break e}}function i(Vn){return Vn.length===0?null:Vn[0]}function o(Vn){if(Vn.length===0)return null;var Rn=Vn[0],Dn=Vn.pop();if(Dn!==Rn){Vn[0]=Dn;e:for(var Fn=0,Tn=Vn.length,pn=Tn>>>1;Fn<pn;){var En=2*(Fn+1)-1,An=Vn[En],bn=En+1,wn=Vn[bn];if(0>a(An,Dn))bn<Tn&&0>a(wn,An)?(Vn[Fn]=wn,Vn[bn]=Dn,Fn=bn):(Vn[Fn]=An,Vn[En]=Dn,Fn=En);else if(bn<Tn&&0>a(wn,Dn))Vn[Fn]=wn,Vn[bn]=Dn,Fn=bn;else break e}}return Rn}function a(Vn,Rn){var Dn=Vn.sortIndex-Rn.sortIndex;return Dn!==0?Dn:Vn.id-Rn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var j=performance;s.unstable_now=function(){return j.now()}}else{var _e=Date,tt=_e.now();s.unstable_now=function(){return _e.now()-tt}}var et=[],rt=[],dt=1,vt=null,Ct=3,Wt=!1,Bt=!1,qt=!1,Ut=typeof setTimeout=="function"?setTimeout:null,kt=typeof clearTimeout=="function"?clearTimeout:null,Nt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function un(Vn){for(var Rn=i(rt);Rn!==null;){if(Rn.callback===null)o(rt);else if(Rn.startTime<=Vn)o(rt),Rn.sortIndex=Rn.expirationTime,e(et,Rn);else break;Rn=i(rt)}}function dn(Vn){if(qt=!1,un(Vn),!Bt)if(i(et)!==null)Bt=!0,jn(hn);else{var Rn=i(rt);Rn!==null&&On(dn,Rn.startTime-Vn)}}function hn(Vn,Rn){Bt=!1,qt&&(qt=!1,kt(pt),pt=-1),Wt=!0;var Dn=Ct;try{for(un(Rn),vt=i(et);vt!==null&&(!(vt.expirationTime>Rn)||Vn&&!Lt());){var Fn=vt.callback;if(typeof Fn=="function"){vt.callback=null,Ct=vt.priorityLevel;var Tn=Fn(vt.expirationTime<=Rn);Rn=s.unstable_now(),typeof Tn=="function"?vt.callback=Tn:vt===i(et)&&o(et),un(Rn)}else o(et);vt=i(et)}if(vt!==null)var pn=!0;else{var En=i(rt);En!==null&&On(dn,En.startTime-Rn),pn=!1}return pn}finally{vt=null,Ct=Dn,Wt=!1}}var gn=!1,It=null,pt=-1,Dt=5,mn=-1;function Lt(){return!(s.unstable_now()-mn<Dt)}function yn(){if(It!==null){var Vn=s.unstable_now();mn=Vn;var Rn=!0;try{Rn=It(!0,Vn)}finally{Rn?fn():(gn=!1,It=null)}}else gn=!1}var fn;if(typeof Nt=="function")fn=function(){Nt(yn)};else if(typeof MessageChannel<"u"){var $n=new MessageChannel,Ln=$n.port2;$n.port1.onmessage=yn,fn=function(){Ln.postMessage(null)}}else fn=function(){Ut(yn,0)};function jn(Vn){It=Vn,gn||(gn=!0,fn())}function On(Vn,Rn){pt=Ut(function(){Vn(s.unstable_now())},Rn)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Vn){Vn.callback=null},s.unstable_continueExecution=function(){Bt||Wt||(Bt=!0,jn(hn))},s.unstable_forceFrameRate=function(Vn){0>Vn||125<Vn?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Dt=0<Vn?Math.floor(1e3/Vn):5},s.unstable_getCurrentPriorityLevel=function(){return Ct},s.unstable_getFirstCallbackNode=function(){return i(et)},s.unstable_next=function(Vn){switch(Ct){case 1:case 2:case 3:var Rn=3;break;default:Rn=Ct}var Dn=Ct;Ct=Rn;try{return Vn()}finally{Ct=Dn}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Vn,Rn){switch(Vn){case 1:case 2:case 3:case 4:case 5:break;default:Vn=3}var Dn=Ct;Ct=Vn;try{return Rn()}finally{Ct=Dn}},s.unstable_scheduleCallback=function(Vn,Rn,Dn){var Fn=s.unstable_now();switch(typeof Dn=="object"&&Dn!==null?(Dn=Dn.delay,Dn=typeof Dn=="number"&&0<Dn?Fn+Dn:Fn):Dn=Fn,Vn){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Dn+Tn,Vn={id:dt++,callback:Rn,priorityLevel:Vn,startTime:Dn,expirationTime:Tn,sortIndex:-1},Dn>Fn?(Vn.sortIndex=Dn,e(rt,Vn),i(et)===null&&Vn===i(rt)&&(qt?(kt(pt),pt=-1):qt=!0,On(dn,Dn-Fn))):(Vn.sortIndex=Tn,e(et,Vn),Bt||Wt||(Bt=!0,jn(hn))),Vn},s.unstable_shouldYield=Lt,s.unstable_wrapCallback=function(Vn){var Rn=Ct;return function(){var Dn=Ct;Ct=Rn;try{return Vn.apply(this,arguments)}finally{Ct=Dn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(s,e){ha(s,e),ha(s+"Capture",e)}function ha(s,e){for(ea[s]=e,s=0;s<e.length;s++)da.add(e[s])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(s){return ja.call(ma,s)?!0:ja.call(la,s)?!1:ka.test(s)?ma[s]=!0:(la[s]=!0,!1)}function pa(s,e,i,o){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:i!==null?!i.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function qa(s,e,i,o){if(e===null||typeof e>"u"||pa(s,e,i,o))return!0;if(o)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v$1(s,e,i,o,a,j,_e){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=i,this.propertyName=s,this.type=e,this.sanitizeURL=j,this.removeEmptyString=_e}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){z$2[s]=new v$1(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];z$2[e]=new v$1(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){z$2[s]=new v$1(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){z$2[s]=new v$1(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){z$2[s]=new v$1(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){z$2[s]=new v$1(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){z$2[s]=new v$1(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){z$2[s]=new v$1(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){z$2[s]=new v$1(s,5,!1,s.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(ra,sa);z$2[e]=new v$1(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(ra,sa);z$2[e]=new v$1(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(ra,sa);z$2[e]=new v$1(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){z$2[s]=new v$1(s,1,!1,s.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){z$2[s]=new v$1(s,1,!1,s.toLowerCase(),null,!0,!0)});function ta(s,e,i,o){var a=z$2.hasOwnProperty(e)?z$2[e]:null;(a!==null?a.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,i,a,o)&&(i=null),o||a===null?oa(e)&&(i===null?s.removeAttribute(e):s.setAttribute(e,""+i)):a.mustUseProperty?s[a.propertyName]=i===null?a.type===3?!1:"":i:(e=a.attributeName,o=a.attributeNamespace,i===null?s.removeAttribute(e):(a=a.type,i=a===3||a===4&&i===!0?"":""+i,o?s.setAttributeNS(o,e,i):s.setAttribute(e,i))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(s){return s===null||typeof s!="object"?null:(s=Ja&&s[Ja]||s["@@iterator"],typeof s=="function"?s:null)}var A$1=Object.assign,La;function Ma(s){if(La===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+s}var Na=!1;function Oa(s,e){if(!s||Na)return"";Na=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(rt){var o=rt}Reflect.construct(s,[],e)}else{try{e.call()}catch(rt){o=rt}s.call(e.prototype)}else{try{throw Error()}catch(rt){o=rt}s()}}catch(rt){if(rt&&o&&typeof rt.stack=="string"){for(var a=rt.stack.split(`
`),j=o.stack.split(`
`),_e=a.length-1,tt=j.length-1;1<=_e&&0<=tt&&a[_e]!==j[tt];)tt--;for(;1<=_e&&0<=tt;_e--,tt--)if(a[_e]!==j[tt]){if(_e!==1||tt!==1)do if(_e--,tt--,0>tt||a[_e]!==j[tt]){var et=`
`+a[_e].replace(" at new "," at ");return s.displayName&&et.includes("<anonymous>")&&(et=et.replace("<anonymous>",s.displayName)),et}while(1<=_e&&0<=tt);break}}}finally{Na=!1,Error.prepareStackTrace=i}return(s=s?s.displayName||s.name:"")?Ma(s):""}function Pa(s){switch(s.tag){case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return s=Oa(s.type,!1),s;case 11:return s=Oa(s.type.render,!1),s;case 1:return s=Oa(s.type,!0),s;default:return""}}function Qa(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ca:return(s.displayName||"Context")+".Consumer";case Ba:return(s._context.displayName||"Context")+".Provider";case Da:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ga:return e=s.displayName||null,e!==null?e:Qa(s.type)||"Memo";case Ha:e=s._payload,s=s._init;try{return Qa(s(e))}catch{}}return null}function Ra(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ta(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(s){var e=Ta(s)?"checked":"value",i=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),o=""+s[e];if(!s.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var a=i.get,j=i.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return a.call(this)},set:function(_e){o=""+_e,j.call(this,_e)}}),Object.defineProperty(s,e,{enumerable:i.enumerable}),{getValue:function(){return o},setValue:function(_e){o=""+_e},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function Va(s){s._valueTracker||(s._valueTracker=Ua(s))}function Wa(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var i=e.getValue(),o="";return s&&(o=Ta(s)?s.checked?"true":"false":s.value),s=o,s!==i?(e.setValue(s),!0):!1}function Xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ya(s,e){var i=e.checked;return A$1({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??s._wrapperState.initialChecked})}function Za(s,e){var i=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;i=Sa(e.value!=null?e.value:i),s._wrapperState={initialChecked:o,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(s,e){e=e.checked,e!=null&&ta(s,"checked",e,!1)}function bb(s,e){ab(s,e);var i=Sa(e.value),o=e.type;if(i!=null)o==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+i):s.value!==""+i&&(s.value=""+i);else if(o==="submit"||o==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?cb(s,e.type,i):e.hasOwnProperty("defaultValue")&&cb(s,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function db$1(s,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,i||e===s.value||(s.value=e),s.defaultValue=e}i=s.name,i!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,i!==""&&(s.name=i)}function cb(s,e,i){(e!=="number"||Xa(s.ownerDocument)!==s)&&(i==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+i&&(s.defaultValue=""+i))}var eb=Array.isArray;function fb(s,e,i,o){if(s=s.options,e){e={};for(var a=0;a<i.length;a++)e["$"+i[a]]=!0;for(i=0;i<s.length;i++)a=e.hasOwnProperty("$"+s[i].value),s[i].selected!==a&&(s[i].selected=a),a&&o&&(s[i].defaultSelected=!0)}else{for(i=""+Sa(i),e=null,a=0;a<s.length;a++){if(s[a].value===i){s[a].selected=!0,o&&(s[a].defaultSelected=!0);return}e!==null||s[a].disabled||(e=s[a])}e!==null&&(e.selected=!0)}}function gb(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function hb(s,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(p$1(92));if(eb(i)){if(1<i.length)throw Error(p$1(93));i=i[0]}e=i}e==null&&(e=""),i=e}s._wrapperState={initialValue:Sa(i)}}function ib(s,e){var i=Sa(e.value),o=Sa(e.defaultValue);i!=null&&(i=""+i,i!==s.value&&(s.value=i),e.defaultValue==null&&s.defaultValue!==i&&(s.defaultValue=i)),o!=null&&(s.defaultValue=""+o)}function jb(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function kb(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?kb(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mb,nb=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,o,a){MSApp.execUnsafeLocalFunction(function(){return s(e,i,o,a)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function ob(s,e){if(e){var i=s.firstChild;if(i&&i===s.lastChild&&i.nodeType===3){i.nodeValue=e;return}}s.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(s){qb.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),pb[e]=pb[s]})});function rb(s,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||pb.hasOwnProperty(s)&&pb[s]?(""+e).trim():e+"px"}function sb(s,e){s=s.style;for(var i in e)if(e.hasOwnProperty(i)){var o=i.indexOf("--")===0,a=rb(i,e[i],o);i==="float"&&(i="cssFloat"),o?s.setProperty(i,a):s[i]=a}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(s,e){if(e){if(tb[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p$1(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p$1(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p$1(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p$1(62))}}function vb(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yb=null,zb=null,Ab=null;function Bb(s){if(s=Cb(s)){if(typeof yb!="function")throw Error(p$1(280));var e=s.stateNode;e&&(e=Db(e),yb(s.stateNode,s.type,e))}}function Eb(s){zb?Ab?Ab.push(s):Ab=[s]:zb=s}function Fb(){if(zb){var s=zb,e=Ab;if(Ab=zb=null,Bb(s),e)for(s=0;s<e.length;s++)Bb(e[s])}}function Gb(s,e){return s(e)}function Hb(){}var Ib=!1;function Jb(s,e,i){if(Ib)return s(e,i);Ib=!0;try{return Gb(s,e,i)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(s,e){var i=s.stateNode;if(i===null)return null;var o=Db(i);if(o===null)return null;i=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(s=s.type,o=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!o;break e;default:s=!1}if(s)return null;if(i&&typeof i!="function")throw Error(p$1(231,e,typeof i));return i}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(s,e,i,o,a,j,_e,tt,et){var rt=Array.prototype.slice.call(arguments,3);try{e.apply(i,rt)}catch(dt){this.onError(dt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(s){Ob=!0,Pb=s}};function Tb(s,e,i,o,a,j,_e,tt,et){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(s,e,i,o,a,j,_e,tt,et){if(Tb.apply(this,arguments),Ob){if(Ob){var rt=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=rt)}}function Vb(s){var e=s,i=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(i=e.return),s=e.return;while(s)}return e.tag===3?i:null}function Wb(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(s){if(Vb(s)!==s)throw Error(p$1(188))}function Yb(s){var e=s.alternate;if(!e){if(e=Vb(s),e===null)throw Error(p$1(188));return e!==s?null:s}for(var i=s,o=e;;){var a=i.return;if(a===null)break;var j=a.alternate;if(j===null){if(o=a.return,o!==null){i=o;continue}break}if(a.child===j.child){for(j=a.child;j;){if(j===i)return Xb(a),s;if(j===o)return Xb(a),e;j=j.sibling}throw Error(p$1(188))}if(i.return!==o.return)i=a,o=j;else{for(var _e=!1,tt=a.child;tt;){if(tt===i){_e=!0,i=a,o=j;break}if(tt===o){_e=!0,o=a,i=j;break}tt=tt.sibling}if(!_e){for(tt=j.child;tt;){if(tt===i){_e=!0,i=j,o=a;break}if(tt===o){_e=!0,o=j,i=a;break}tt=tt.sibling}if(!_e)throw Error(p$1(189))}}if(i.alternate!==o)throw Error(p$1(190))}if(i.tag!==3)throw Error(p$1(188));return i.stateNode.current===i?s:e}function Zb(s){return s=Yb(s),s!==null?$b(s):null}function $b(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=$b(s);if(e!==null)return e;s=s.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$2=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(s){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,s,void 0,(s.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(s){return s>>>=0,s===0?32:31-(pc(s)/qc|0)|0}var rc=64,sc=4194304;function tc(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uc(s,e){var i=s.pendingLanes;if(i===0)return 0;var o=0,a=s.suspendedLanes,j=s.pingedLanes,_e=i&268435455;if(_e!==0){var tt=_e&~a;tt!==0?o=tc(tt):(j&=_e,j!==0&&(o=tc(j)))}else _e=i&~a,_e!==0?o=tc(_e):j!==0&&(o=tc(j));if(o===0)return 0;if(e!==0&&e!==o&&!(e&a)&&(a=o&-o,j=e&-e,a>=j||a===16&&(j&4194240)!==0))return e;if(o&4&&(o|=i&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=o;0<e;)i=31-oc(e),a=1<<i,o|=s[i],e&=~a;return o}function vc(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(s,e){for(var i=s.suspendedLanes,o=s.pingedLanes,a=s.expirationTimes,j=s.pendingLanes;0<j;){var _e=31-oc(j),tt=1<<_e,et=a[_e];et===-1?(!(tt&i)||tt&o)&&(a[_e]=vc(tt,e)):et<=e&&(s.expiredLanes|=tt),j&=~tt}}function xc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yc(){var s=rc;return rc<<=1,!(rc&4194240)&&(rc=64),s}function zc(s){for(var e=[],i=0;31>i;i++)e.push(s);return e}function Ac(s,e,i){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-oc(e),s[e]=i}function Bc(s,e){var i=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var o=s.eventTimes;for(s=s.expirationTimes;0<i;){var a=31-oc(i),j=1<<a;e[a]=0,o[a]=-1,s[a]=-1,i&=~j}}function Cc(s,e){var i=s.entangledLanes|=e;for(s=s.entanglements;i;){var o=31-oc(i),a=1<<o;a&e|s[o]&e&&(s[o]|=e),i&=~a}}var C$1=0;function Dc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(s,e){switch(s){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(s,e,i,o,a,j){return s===null||s.nativeEvent!==j?(s={blockedOn:e,domEventName:i,eventSystemFlags:o,nativeEvent:j,targetContainers:[a]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),s):(s.eventSystemFlags|=o,e=s.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),s)}function Uc(s,e,i,o,a){switch(e){case"focusin":return Lc=Tc(Lc,s,e,i,o,a),!0;case"dragenter":return Mc=Tc(Mc,s,e,i,o,a),!0;case"mouseover":return Nc=Tc(Nc,s,e,i,o,a),!0;case"pointerover":var j=a.pointerId;return Oc.set(j,Tc(Oc.get(j)||null,s,e,i,o,a)),!0;case"gotpointercapture":return j=a.pointerId,Pc.set(j,Tc(Pc.get(j)||null,s,e,i,o,a)),!0}return!1}function Vc(s){var e=Wc(s.target);if(e!==null){var i=Vb(e);if(i!==null){if(e=i.tag,e===13){if(e=Wb(i),e!==null){s.blockedOn=e,Ic(s.priority,function(){Gc(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){s.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xc(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var i=Yc(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(i===null){i=s.nativeEvent;var o=new i.constructor(i.type,i);wb=o,i.target.dispatchEvent(o),wb=null}else return e=Cb(i),e!==null&&Fc(e),s.blockedOn=i,!1;e.shift()}return!0}function Zc(s,e,i){Xc(s)&&i.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(s,e){s.blockedOn===e&&(s.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(s){function e(a){return ad(a,s)}if(0<Kc.length){ad(Kc[0],s);for(var i=1;i<Kc.length;i++){var o=Kc[i];o.blockedOn===s&&(o.blockedOn=null)}}for(Lc!==null&&ad(Lc,s),Mc!==null&&ad(Mc,s),Nc!==null&&ad(Nc,s),Oc.forEach(e),Pc.forEach(e),i=0;i<Qc.length;i++)o=Qc[i],o.blockedOn===s&&(o.blockedOn=null);for(;0<Qc.length&&(i=Qc[0],i.blockedOn===null);)Vc(i),i.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(s,e,i,o){var a=C$1,j=cd.transition;cd.transition=null;try{C$1=1,fd(s,e,i,o)}finally{C$1=a,cd.transition=j}}function gd(s,e,i,o){var a=C$1,j=cd.transition;cd.transition=null;try{C$1=4,fd(s,e,i,o)}finally{C$1=a,cd.transition=j}}function fd(s,e,i,o){if(dd){var a=Yc(s,e,i,o);if(a===null)hd(s,e,o,id,i),Sc(s,o);else if(Uc(a,s,e,i,o))o.stopPropagation();else if(Sc(s,o),e&4&&-1<Rc.indexOf(s)){for(;a!==null;){var j=Cb(a);if(j!==null&&Ec(j),j=Yc(s,e,i,o),j===null&&hd(s,e,o,id,i),j===a)break;a=j}a!==null&&o.stopPropagation()}else hd(s,e,o,null,i)}}var id=null;function Yc(s,e,i,o){if(id=null,s=xb(o),s=Wc(s),s!==null)if(e=Vb(s),e===null)s=null;else if(i=e.tag,i===13){if(s=Wb(e),s!==null)return s;s=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return id=s,null}function jd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var s,e=ld,i=e.length,o,a="value"in kd?kd.value:kd.textContent,j=a.length;for(s=0;s<i&&e[s]===a[s];s++);var _e=i-s;for(o=1;o<=_e&&e[i-o]===a[j-o];o++);return md=a.slice(s,1<o?1-o:void 0)}function od(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function qd(){return!1}function rd(s){function e(i,o,a,j,_e){this._reactName=i,this._targetInst=a,this.type=o,this.nativeEvent=j,this.target=_e,this.currentTarget=null;for(var tt in s)s.hasOwnProperty(tt)&&(i=s[tt],this[tt]=i?i(j):j[tt]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yd&&(yd&&s.type==="mousemove"?(wd=s.screenX-yd.screenX,xd=s.screenY-yd.screenY):xd=wd=0,yd=s),wd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=Od[s])?!!e[s]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(s){if(s.key){var e=Md[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=od(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(s){return s.type==="keypress"?od(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?od(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(s,e){switch(s){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ie=!1;function je(s,e){switch(s){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return s=e.data,s===ee&&fe?null:s;default:return null}}function ke(s,e){if(ie)return s==="compositionend"||!ae&&ge(s,e)?(s=nd(),md=ld=kd=null,ie=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!le[s.type]:e==="textarea"}function ne(s,e,i,o){Eb(o),e=oe(e,"onChange"),0<e.length&&(i=new td("onChange","change",null,i,o),s.push({event:i,listeners:e}))}var pe=null,qe=null;function re(s){se(s,0)}function te(s){var e=ue(s);if(Wa(e))return s}function ve(s,e){if(s==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(s){if(s.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,s,xb(s)),Jb(re,e)}}function Ce(s,e,i){s==="focusin"?(Ae(),pe=e,qe=i,pe.attachEvent("onpropertychange",Be)):s==="focusout"&&Ae()}function De(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return te(qe)}function Ee(s,e){if(s==="click")return te(e)}function Fe(s,e){if(s==="input"||s==="change")return te(e)}function Ge(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(s,e){if(He(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var i=Object.keys(s),o=Object.keys(e);if(i.length!==o.length)return!1;for(o=0;o<i.length;o++){var a=i[o];if(!ja.call(e,a)||!He(s[a],e[a]))return!1}return!0}function Je(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ke(s,e){var i=Je(s);s=0;for(var o;i;){if(i.nodeType===3){if(o=s+i.textContent.length,s<=e&&o>=e)return{node:i,offset:e-s};s=o}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Je(i)}}function Le(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?Le(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var s=window,e=Xa();e instanceof s.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)s=e.contentWindow;else break;e=Xa(s.document)}return e}function Ne(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function Oe(s){var e=Me(),i=s.focusedElem,o=s.selectionRange;if(e!==i&&i&&i.ownerDocument&&Le(i.ownerDocument.documentElement,i)){if(o!==null&&Ne(i)){if(e=o.start,s=o.end,s===void 0&&(s=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(s,i.value.length);else if(s=(e=i.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var a=i.textContent.length,j=Math.min(o.start,a);o=o.end===void 0?j:Math.min(o.end,a),!s.extend&&j>o&&(a=o,o=j,j=a),a=Ke(i,j);var _e=Ke(i,o);a&&_e&&(s.rangeCount!==1||s.anchorNode!==a.node||s.anchorOffset!==a.offset||s.focusNode!==_e.node||s.focusOffset!==_e.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),s.removeAllRanges(),j>o?(s.addRange(e),s.extend(_e.node,_e.offset)):(e.setEnd(_e.node,_e.offset),s.addRange(e)))}}for(e=[],s=i;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)s=e[i],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(s,e,i){var o=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Te||Qe==null||Qe!==Xa(o)||(o=Qe,"selectionStart"in o&&Ne(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Se&&Ie(Se,o)||(Se=o,o=oe(Re,"onSelect"),0<o.length&&(e=new td("onSelect","select",null,e,i),s.push({event:e,listeners:o}),e.target=Qe)))}function Ve(s,e){var i={};return i[s.toLowerCase()]=e.toLowerCase(),i["Webkit"+s]="webkit"+e,i["Moz"+s]="moz"+e,i}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(s){if(Xe[s])return Xe[s];if(!We[s])return s;var e=We[s],i;for(i in e)if(e.hasOwnProperty(i)&&i in Ye)return Xe[s]=e[i];return s}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(s,e){df.set(s,e),fa(e,[s])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(s,e,i){var o=s.type||"unknown-event";s.currentTarget=i,Ub(o,e,void 0,s),s.currentTarget=null}function se(s,e){e=(e&4)!==0;for(var i=0;i<s.length;i++){var o=s[i],a=o.event;o=o.listeners;e:{var j=void 0;if(e)for(var _e=o.length-1;0<=_e;_e--){var tt=o[_e],et=tt.instance,rt=tt.currentTarget;if(tt=tt.listener,et!==j&&a.isPropagationStopped())break e;nf(a,tt,rt),j=et}else for(_e=0;_e<o.length;_e++){if(tt=o[_e],et=tt.instance,rt=tt.currentTarget,tt=tt.listener,et!==j&&a.isPropagationStopped())break e;nf(a,tt,rt),j=et}}}if(Qb)throw s=Rb,Qb=!1,Rb=null,s}function D$1(s,e){var i=e[of];i===void 0&&(i=e[of]=new Set);var o=s+"__bubble";i.has(o)||(pf(e,s,2,!1),i.add(o))}function qf(s,e,i){var o=0;e&&(o|=4),pf(i,s,o,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(s){if(!s[rf]){s[rf]=!0,da.forEach(function(i){i!=="selectionchange"&&(mf.has(i)||qf(i,!1,s),qf(i,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(s,e,i,o){switch(jd(e)){case 1:var a=ed;break;case 4:a=gd;break;default:a=fd}i=a.bind(null,e,i,s),a=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),o?a!==void 0?s.addEventListener(e,i,{capture:!0,passive:a}):s.addEventListener(e,i,!0):a!==void 0?s.addEventListener(e,i,{passive:a}):s.addEventListener(e,i,!1)}function hd(s,e,i,o,a){var j=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var _e=o.tag;if(_e===3||_e===4){var tt=o.stateNode.containerInfo;if(tt===a||tt.nodeType===8&&tt.parentNode===a)break;if(_e===4)for(_e=o.return;_e!==null;){var et=_e.tag;if((et===3||et===4)&&(et=_e.stateNode.containerInfo,et===a||et.nodeType===8&&et.parentNode===a))return;_e=_e.return}for(;tt!==null;){if(_e=Wc(tt),_e===null)return;if(et=_e.tag,et===5||et===6){o=j=_e;continue e}tt=tt.parentNode}}o=o.return}Jb(function(){var rt=j,dt=xb(i),vt=[];e:{var Ct=df.get(s);if(Ct!==void 0){var Wt=td,Bt=s;switch(s){case"keypress":if(od(i)===0)break e;case"keydown":case"keyup":Wt=Rd;break;case"focusin":Bt="focus",Wt=Fd;break;case"focusout":Bt="blur",Wt=Fd;break;case"beforeblur":case"afterblur":Wt=Fd;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Wt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Wt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Wt=Vd;break;case $e:case af:case bf:Wt=Hd;break;case cf:Wt=Xd;break;case"scroll":Wt=vd;break;case"wheel":Wt=Zd;break;case"copy":case"cut":case"paste":Wt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Wt=Td}var qt=(e&4)!==0,Ut=!qt&&s==="scroll",kt=qt?Ct!==null?Ct+"Capture":null:Ct;qt=[];for(var Nt=rt,un;Nt!==null;){un=Nt;var dn=un.stateNode;if(un.tag===5&&dn!==null&&(un=dn,kt!==null&&(dn=Kb(Nt,kt),dn!=null&&qt.push(tf(Nt,dn,un)))),Ut)break;Nt=Nt.return}0<qt.length&&(Ct=new Wt(Ct,Bt,null,i,dt),vt.push({event:Ct,listeners:qt}))}}if(!(e&7)){e:{if(Ct=s==="mouseover"||s==="pointerover",Wt=s==="mouseout"||s==="pointerout",Ct&&i!==wb&&(Bt=i.relatedTarget||i.fromElement)&&(Wc(Bt)||Bt[uf]))break e;if((Wt||Ct)&&(Ct=dt.window===dt?dt:(Ct=dt.ownerDocument)?Ct.defaultView||Ct.parentWindow:window,Wt?(Bt=i.relatedTarget||i.toElement,Wt=rt,Bt=Bt?Wc(Bt):null,Bt!==null&&(Ut=Vb(Bt),Bt!==Ut||Bt.tag!==5&&Bt.tag!==6)&&(Bt=null)):(Wt=null,Bt=rt),Wt!==Bt)){if(qt=Bd,dn="onMouseLeave",kt="onMouseEnter",Nt="mouse",(s==="pointerout"||s==="pointerover")&&(qt=Td,dn="onPointerLeave",kt="onPointerEnter",Nt="pointer"),Ut=Wt==null?Ct:ue(Wt),un=Bt==null?Ct:ue(Bt),Ct=new qt(dn,Nt+"leave",Wt,i,dt),Ct.target=Ut,Ct.relatedTarget=un,dn=null,Wc(dt)===rt&&(qt=new qt(kt,Nt+"enter",Bt,i,dt),qt.target=un,qt.relatedTarget=Ut,dn=qt),Ut=dn,Wt&&Bt)t:{for(qt=Wt,kt=Bt,Nt=0,un=qt;un;un=vf(un))Nt++;for(un=0,dn=kt;dn;dn=vf(dn))un++;for(;0<Nt-un;)qt=vf(qt),Nt--;for(;0<un-Nt;)kt=vf(kt),un--;for(;Nt--;){if(qt===kt||kt!==null&&qt===kt.alternate)break t;qt=vf(qt),kt=vf(kt)}qt=null}else qt=null;Wt!==null&&wf(vt,Ct,Wt,qt,!1),Bt!==null&&Ut!==null&&wf(vt,Ut,Bt,qt,!0)}}e:{if(Ct=rt?ue(rt):window,Wt=Ct.nodeName&&Ct.nodeName.toLowerCase(),Wt==="select"||Wt==="input"&&Ct.type==="file")var hn=ve;else if(me(Ct))if(we)hn=Fe;else{hn=De;var gn=Ce}else(Wt=Ct.nodeName)&&Wt.toLowerCase()==="input"&&(Ct.type==="checkbox"||Ct.type==="radio")&&(hn=Ee);if(hn&&(hn=hn(s,rt))){ne(vt,hn,i,dt);break e}gn&&gn(s,Ct,rt),s==="focusout"&&(gn=Ct._wrapperState)&&gn.controlled&&Ct.type==="number"&&cb(Ct,"number",Ct.value)}switch(gn=rt?ue(rt):window,s){case"focusin":(me(gn)||gn.contentEditable==="true")&&(Qe=gn,Re=rt,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(vt,i,dt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(vt,i,dt)}var It;if(ae)e:{switch(s){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else ie?ge(s,i)&&(pt="onCompositionEnd"):s==="keydown"&&i.keyCode===229&&(pt="onCompositionStart");pt&&(de&&i.locale!=="ko"&&(ie||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&ie&&(It=nd()):(kd=dt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),gn=oe(rt,pt),0<gn.length&&(pt=new Ld(pt,s,null,i,dt),vt.push({event:pt,listeners:gn}),It?pt.data=It:(It=he(i),It!==null&&(pt.data=It)))),(It=ce?je(s,i):ke(s,i))&&(rt=oe(rt,"onBeforeInput"),0<rt.length&&(dt=new Ld("onBeforeInput","beforeinput",null,i,dt),vt.push({event:dt,listeners:rt}),dt.data=It))}se(vt,e)})}function tf(s,e,i){return{instance:s,listener:e,currentTarget:i}}function oe(s,e){for(var i=e+"Capture",o=[];s!==null;){var a=s,j=a.stateNode;a.tag===5&&j!==null&&(a=j,j=Kb(s,i),j!=null&&o.unshift(tf(s,j,a)),j=Kb(s,e),j!=null&&o.push(tf(s,j,a))),s=s.return}return o}function vf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wf(s,e,i,o,a){for(var j=e._reactName,_e=[];i!==null&&i!==o;){var tt=i,et=tt.alternate,rt=tt.stateNode;if(et!==null&&et===o)break;tt.tag===5&&rt!==null&&(tt=rt,a?(et=Kb(i,j),et!=null&&_e.unshift(tf(i,et,tt))):a||(et=Kb(i,j),et!=null&&_e.push(tf(i,et,tt)))),i=i.return}_e.length!==0&&s.push({event:e,listeners:_e})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(s){return(typeof s=="string"?s:""+s).replace(xf,`
`).replace(yf,"")}function Af(s,e,i){if(e=zf(e),zf(s)!==e&&i)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(s){return Hf.resolve(null).then(s).catch(If)}:Ff;function If(s){setTimeout(function(){throw s})}function Kf(s,e){var i=e,o=0;do{var a=i.nextSibling;if(s.removeChild(i),a&&a.nodeType===8)if(i=a.data,i==="/$"){if(o===0){s.removeChild(a),bd(e);return}o--}else i!=="$"&&i!=="$?"&&i!=="$!"||o++;i=a}while(i);bd(e)}function Lf(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function Mf(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var i=s.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return s;e--}else i==="/$"&&e++}s=s.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(s){var e=s[Of];if(e)return e;for(var i=s.parentNode;i;){if(e=i[uf]||i[Of]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(s=Mf(s);s!==null;){if(i=s[Of])return i;s=Mf(s)}return e}s=i,i=s.parentNode}return null}function Cb(s){return s=s[Of]||s[uf],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ue(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(p$1(33))}function Db(s){return s[Pf]||null}var Sf=[],Tf=-1;function Uf(s){return{current:s}}function E$1(s){0>Tf||(s.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(s,e){Tf++,Sf[Tf]=s.current,s.current=e}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(s,e){var i=s.type.contextTypes;if(!i)return Vf;var o=s.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var a={},j;for(j in i)a[j]=e[j];return o&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=a),a}function Zf(s){return s=s.childContextTypes,s!=null}function $f(){E$1(Wf),E$1(H$1)}function ag(s,e,i){if(H$1.current!==Vf)throw Error(p$1(168));G$1(H$1,e),G$1(Wf,i)}function bg(s,e,i){var o=s.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return i;o=o.getChildContext();for(var a in o)if(!(a in e))throw Error(p$1(108,Ra(s)||"Unknown",a));return A$1({},i,o)}function cg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G$1(H$1,s),G$1(Wf,Wf.current),!0}function dg(s,e,i){var o=s.stateNode;if(!o)throw Error(p$1(169));i?(s=bg(s,e,Xf),o.__reactInternalMemoizedMergedChildContext=s,E$1(Wf),E$1(H$1),G$1(H$1,s)):E$1(Wf),G$1(Wf,i)}var eg=null,fg=!1,gg=!1;function hg(s){eg===null?eg=[s]:eg.push(s)}function ig(s){fg=!0,hg(s)}function jg(){if(!gg&&eg!==null){gg=!0;var s=0,e=C$1;try{var i=eg;for(C$1=1;s<i.length;s++){var o=i[s];do o=o(!0);while(o!==null)}eg=null,fg=!1}catch(a){throw eg!==null&&(eg=eg.slice(s+1)),ac(fc,jg),a}finally{C$1=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(s,e){kg[lg++]=ng,kg[lg++]=mg,mg=s,ng=e}function ug(s,e,i){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=s;var o=rg;s=sg;var a=32-oc(o)-1;o&=~(1<<a),i+=1;var j=32-oc(e)+a;if(30<j){var _e=a-a%5;j=(o&(1<<_e)-1).toString(32),o>>=_e,a-=_e,rg=1<<32-oc(e)+a|i<<a|o,sg=j+s}else rg=1<<j|i<<a|o,sg=s}function vg(s){s.return!==null&&(tg(s,1),ug(s,1,0))}function wg(s){for(;s===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;s===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(s,e){var i=Bg(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=s,e=s.deletions,e===null?(s.deletions=[i],s.flags|=16):e.push(i)}function Cg(s,e){switch(s.tag){case 5:var i=s.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,xg=s,yg=Lf(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,xg=s,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=qg!==null?{id:rg,overflow:sg}:null,s.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Bg(18,null,null,0),i.stateNode=e,i.return=s,s.child=i,xg=s,yg=null,!0):!1;default:return!1}}function Dg(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Eg(s){if(I$1){var e=yg;if(e){var i=e;if(!Cg(s,e)){if(Dg(s))throw Error(p$1(418));e=Lf(i.nextSibling);var o=xg;e&&Cg(s,e)?Ag(o,i):(s.flags=s.flags&-4097|2,I$1=!1,xg=s)}}else{if(Dg(s))throw Error(p$1(418));s.flags=s.flags&-4097|2,I$1=!1,xg=s}}}function Fg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xg=s}function Gg(s){if(s!==xg)return!1;if(!I$1)return Fg(s),I$1=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!Ef(s.type,s.memoizedProps)),e&&(e=yg)){if(Dg(s))throw Hg(),Error(p$1(418));for(;e;)Ag(s,e),e=Lf(e.nextSibling)}if(Fg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p$1(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var i=s.data;if(i==="/$"){if(e===0){yg=Lf(s.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}s=s.nextSibling}yg=null}}else yg=xg?Lf(s.stateNode.nextSibling):null;return!0}function Hg(){for(var s=yg;s;)s=Lf(s.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(s){zg===null?zg=[s]:zg.push(s)}var Kg=ua.ReactCurrentBatchConfig;function Lg(s,e,i){if(s=i.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(p$1(309));var o=i.stateNode}if(!o)throw Error(p$1(147,s));var a=o,j=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===j?e.ref:(e=function(_e){var tt=a.refs;_e===null?delete tt[j]:tt[j]=_e},e._stringRef=j,e)}if(typeof s!="string")throw Error(p$1(284));if(!i._owner)throw Error(p$1(290,s))}return s}function Mg(s,e){throw s=Object.prototype.toString.call(e),Error(p$1(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function Ng(s){var e=s._init;return e(s._payload)}function Og(s){function e(kt,Nt){if(s){var un=kt.deletions;un===null?(kt.deletions=[Nt],kt.flags|=16):un.push(Nt)}}function i(kt,Nt){if(!s)return null;for(;Nt!==null;)e(kt,Nt),Nt=Nt.sibling;return null}function o(kt,Nt){for(kt=new Map;Nt!==null;)Nt.key!==null?kt.set(Nt.key,Nt):kt.set(Nt.index,Nt),Nt=Nt.sibling;return kt}function a(kt,Nt){return kt=Pg(kt,Nt),kt.index=0,kt.sibling=null,kt}function j(kt,Nt,un){return kt.index=un,s?(un=kt.alternate,un!==null?(un=un.index,un<Nt?(kt.flags|=2,Nt):un):(kt.flags|=2,Nt)):(kt.flags|=1048576,Nt)}function _e(kt){return s&&kt.alternate===null&&(kt.flags|=2),kt}function tt(kt,Nt,un,dn){return Nt===null||Nt.tag!==6?(Nt=Qg(un,kt.mode,dn),Nt.return=kt,Nt):(Nt=a(Nt,un),Nt.return=kt,Nt)}function et(kt,Nt,un,dn){var hn=un.type;return hn===ya?dt(kt,Nt,un.props.children,dn,un.key):Nt!==null&&(Nt.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===Ha&&Ng(hn)===Nt.type)?(dn=a(Nt,un.props),dn.ref=Lg(kt,Nt,un),dn.return=kt,dn):(dn=Rg(un.type,un.key,un.props,null,kt.mode,dn),dn.ref=Lg(kt,Nt,un),dn.return=kt,dn)}function rt(kt,Nt,un,dn){return Nt===null||Nt.tag!==4||Nt.stateNode.containerInfo!==un.containerInfo||Nt.stateNode.implementation!==un.implementation?(Nt=Sg(un,kt.mode,dn),Nt.return=kt,Nt):(Nt=a(Nt,un.children||[]),Nt.return=kt,Nt)}function dt(kt,Nt,un,dn,hn){return Nt===null||Nt.tag!==7?(Nt=Tg(un,kt.mode,dn,hn),Nt.return=kt,Nt):(Nt=a(Nt,un),Nt.return=kt,Nt)}function vt(kt,Nt,un){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number")return Nt=Qg(""+Nt,kt.mode,un),Nt.return=kt,Nt;if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case va:return un=Rg(Nt.type,Nt.key,Nt.props,null,kt.mode,un),un.ref=Lg(kt,null,Nt),un.return=kt,un;case wa:return Nt=Sg(Nt,kt.mode,un),Nt.return=kt,Nt;case Ha:var dn=Nt._init;return vt(kt,dn(Nt._payload),un)}if(eb(Nt)||Ka(Nt))return Nt=Tg(Nt,kt.mode,un,null),Nt.return=kt,Nt;Mg(kt,Nt)}return null}function Ct(kt,Nt,un,dn){var hn=Nt!==null?Nt.key:null;if(typeof un=="string"&&un!==""||typeof un=="number")return hn!==null?null:tt(kt,Nt,""+un,dn);if(typeof un=="object"&&un!==null){switch(un.$$typeof){case va:return un.key===hn?et(kt,Nt,un,dn):null;case wa:return un.key===hn?rt(kt,Nt,un,dn):null;case Ha:return hn=un._init,Ct(kt,Nt,hn(un._payload),dn)}if(eb(un)||Ka(un))return hn!==null?null:dt(kt,Nt,un,dn,null);Mg(kt,un)}return null}function Wt(kt,Nt,un,dn,hn){if(typeof dn=="string"&&dn!==""||typeof dn=="number")return kt=kt.get(un)||null,tt(Nt,kt,""+dn,hn);if(typeof dn=="object"&&dn!==null){switch(dn.$$typeof){case va:return kt=kt.get(dn.key===null?un:dn.key)||null,et(Nt,kt,dn,hn);case wa:return kt=kt.get(dn.key===null?un:dn.key)||null,rt(Nt,kt,dn,hn);case Ha:var gn=dn._init;return Wt(kt,Nt,un,gn(dn._payload),hn)}if(eb(dn)||Ka(dn))return kt=kt.get(un)||null,dt(Nt,kt,dn,hn,null);Mg(Nt,dn)}return null}function Bt(kt,Nt,un,dn){for(var hn=null,gn=null,It=Nt,pt=Nt=0,Dt=null;It!==null&&pt<un.length;pt++){It.index>pt?(Dt=It,It=null):Dt=It.sibling;var mn=Ct(kt,It,un[pt],dn);if(mn===null){It===null&&(It=Dt);break}s&&It&&mn.alternate===null&&e(kt,It),Nt=j(mn,Nt,pt),gn===null?hn=mn:gn.sibling=mn,gn=mn,It=Dt}if(pt===un.length)return i(kt,It),I$1&&tg(kt,pt),hn;if(It===null){for(;pt<un.length;pt++)It=vt(kt,un[pt],dn),It!==null&&(Nt=j(It,Nt,pt),gn===null?hn=It:gn.sibling=It,gn=It);return I$1&&tg(kt,pt),hn}for(It=o(kt,It);pt<un.length;pt++)Dt=Wt(It,kt,pt,un[pt],dn),Dt!==null&&(s&&Dt.alternate!==null&&It.delete(Dt.key===null?pt:Dt.key),Nt=j(Dt,Nt,pt),gn===null?hn=Dt:gn.sibling=Dt,gn=Dt);return s&&It.forEach(function(Lt){return e(kt,Lt)}),I$1&&tg(kt,pt),hn}function qt(kt,Nt,un,dn){var hn=Ka(un);if(typeof hn!="function")throw Error(p$1(150));if(un=hn.call(un),un==null)throw Error(p$1(151));for(var gn=hn=null,It=Nt,pt=Nt=0,Dt=null,mn=un.next();It!==null&&!mn.done;pt++,mn=un.next()){It.index>pt?(Dt=It,It=null):Dt=It.sibling;var Lt=Ct(kt,It,mn.value,dn);if(Lt===null){It===null&&(It=Dt);break}s&&It&&Lt.alternate===null&&e(kt,It),Nt=j(Lt,Nt,pt),gn===null?hn=Lt:gn.sibling=Lt,gn=Lt,It=Dt}if(mn.done)return i(kt,It),I$1&&tg(kt,pt),hn;if(It===null){for(;!mn.done;pt++,mn=un.next())mn=vt(kt,mn.value,dn),mn!==null&&(Nt=j(mn,Nt,pt),gn===null?hn=mn:gn.sibling=mn,gn=mn);return I$1&&tg(kt,pt),hn}for(It=o(kt,It);!mn.done;pt++,mn=un.next())mn=Wt(It,kt,pt,mn.value,dn),mn!==null&&(s&&mn.alternate!==null&&It.delete(mn.key===null?pt:mn.key),Nt=j(mn,Nt,pt),gn===null?hn=mn:gn.sibling=mn,gn=mn);return s&&It.forEach(function(yn){return e(kt,yn)}),I$1&&tg(kt,pt),hn}function Ut(kt,Nt,un,dn){if(typeof un=="object"&&un!==null&&un.type===ya&&un.key===null&&(un=un.props.children),typeof un=="object"&&un!==null){switch(un.$$typeof){case va:e:{for(var hn=un.key,gn=Nt;gn!==null;){if(gn.key===hn){if(hn=un.type,hn===ya){if(gn.tag===7){i(kt,gn.sibling),Nt=a(gn,un.props.children),Nt.return=kt,kt=Nt;break e}}else if(gn.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===Ha&&Ng(hn)===gn.type){i(kt,gn.sibling),Nt=a(gn,un.props),Nt.ref=Lg(kt,gn,un),Nt.return=kt,kt=Nt;break e}i(kt,gn);break}else e(kt,gn);gn=gn.sibling}un.type===ya?(Nt=Tg(un.props.children,kt.mode,dn,un.key),Nt.return=kt,kt=Nt):(dn=Rg(un.type,un.key,un.props,null,kt.mode,dn),dn.ref=Lg(kt,Nt,un),dn.return=kt,kt=dn)}return _e(kt);case wa:e:{for(gn=un.key;Nt!==null;){if(Nt.key===gn)if(Nt.tag===4&&Nt.stateNode.containerInfo===un.containerInfo&&Nt.stateNode.implementation===un.implementation){i(kt,Nt.sibling),Nt=a(Nt,un.children||[]),Nt.return=kt,kt=Nt;break e}else{i(kt,Nt);break}else e(kt,Nt);Nt=Nt.sibling}Nt=Sg(un,kt.mode,dn),Nt.return=kt,kt=Nt}return _e(kt);case Ha:return gn=un._init,Ut(kt,Nt,gn(un._payload),dn)}if(eb(un))return Bt(kt,Nt,un,dn);if(Ka(un))return qt(kt,Nt,un,dn);Mg(kt,un)}return typeof un=="string"&&un!==""||typeof un=="number"?(un=""+un,Nt!==null&&Nt.tag===6?(i(kt,Nt.sibling),Nt=a(Nt,un),Nt.return=kt,kt=Nt):(i(kt,Nt),Nt=Qg(un,kt.mode,dn),Nt.return=kt,kt=Nt),_e(kt)):i(kt,Nt)}return Ut}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(s){var e=Wg.current;E$1(Wg),s._currentValue=e}function bh(s,e,i){for(;s!==null;){var o=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),s===i)break;s=s.return}}function ch(s,e){Xg=s,Zg=Yg=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(dh=!0),s.firstContext=null)}function eh(s){var e=s._currentValue;if(Zg!==s)if(s={context:s,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=s,Xg.dependencies={lanes:0,firstContext:s}}else Yg=Yg.next=s;return e}var fh=null;function gh(s){fh===null?fh=[s]:fh.push(s)}function hh(s,e,i,o){var a=e.interleaved;return a===null?(i.next=i,gh(e)):(i.next=a.next,a.next=i),e.interleaved=i,ih(s,o)}function ih(s,e){s.lanes|=e;var i=s.alternate;for(i!==null&&(i.lanes|=e),i=s,s=s.return;s!==null;)s.childLanes|=e,i=s.alternate,i!==null&&(i.childLanes|=e),i=s,s=s.return;return i.tag===3?i.stateNode:null}var jh=!1;function kh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function mh(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(s,e,i){var o=s.updateQueue;if(o===null)return null;if(o=o.shared,K&2){var a=o.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),o.pending=e,ih(s,i)}return a=o.interleaved,a===null?(e.next=e,gh(o)):(e.next=a.next,a.next=e),o.interleaved=e,ih(s,i)}function oh(s,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var o=e.lanes;o&=s.pendingLanes,i|=o,e.lanes=i,Cc(s,i)}}function ph(s,e){var i=s.updateQueue,o=s.alternate;if(o!==null&&(o=o.updateQueue,i===o)){var a=null,j=null;if(i=i.firstBaseUpdate,i!==null){do{var _e={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};j===null?a=j=_e:j=j.next=_e,i=i.next}while(i!==null);j===null?a=j=e:j=j.next=e}else a=j=e;i={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:j,shared:o.shared,effects:o.effects},s.updateQueue=i;return}s=i.lastBaseUpdate,s===null?i.firstBaseUpdate=e:s.next=e,i.lastBaseUpdate=e}function qh(s,e,i,o){var a=s.updateQueue;jh=!1;var j=a.firstBaseUpdate,_e=a.lastBaseUpdate,tt=a.shared.pending;if(tt!==null){a.shared.pending=null;var et=tt,rt=et.next;et.next=null,_e===null?j=rt:_e.next=rt,_e=et;var dt=s.alternate;dt!==null&&(dt=dt.updateQueue,tt=dt.lastBaseUpdate,tt!==_e&&(tt===null?dt.firstBaseUpdate=rt:tt.next=rt,dt.lastBaseUpdate=et))}if(j!==null){var vt=a.baseState;_e=0,dt=rt=et=null,tt=j;do{var Ct=tt.lane,Wt=tt.eventTime;if((o&Ct)===Ct){dt!==null&&(dt=dt.next={eventTime:Wt,lane:0,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null});e:{var Bt=s,qt=tt;switch(Ct=e,Wt=i,qt.tag){case 1:if(Bt=qt.payload,typeof Bt=="function"){vt=Bt.call(Wt,vt,Ct);break e}vt=Bt;break e;case 3:Bt.flags=Bt.flags&-65537|128;case 0:if(Bt=qt.payload,Ct=typeof Bt=="function"?Bt.call(Wt,vt,Ct):Bt,Ct==null)break e;vt=A$1({},vt,Ct);break e;case 2:jh=!0}}tt.callback!==null&&tt.lane!==0&&(s.flags|=64,Ct=a.effects,Ct===null?a.effects=[tt]:Ct.push(tt))}else Wt={eventTime:Wt,lane:Ct,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null},dt===null?(rt=dt=Wt,et=vt):dt=dt.next=Wt,_e|=Ct;if(tt=tt.next,tt===null){if(tt=a.shared.pending,tt===null)break;Ct=tt,tt=Ct.next,Ct.next=null,a.lastBaseUpdate=Ct,a.shared.pending=null}}while(!0);if(dt===null&&(et=vt),a.baseState=et,a.firstBaseUpdate=rt,a.lastBaseUpdate=dt,e=a.shared.interleaved,e!==null){a=e;do _e|=a.lane,a=a.next;while(a!==e)}else j===null&&(a.shared.lanes=0);rh|=_e,s.lanes=_e,s.memoizedState=vt}}function sh(s,e,i){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var o=s[e],a=o.callback;if(a!==null){if(o.callback=null,o=i,typeof a!="function")throw Error(p$1(191,a));a.call(o)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(s){if(s===th)throw Error(p$1(174));return s}function yh(s,e){switch(G$1(wh,e),G$1(vh,s),G$1(uh,th),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=lb(e,s)}E$1(uh),G$1(uh,e)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(s){xh(wh.current);var e=xh(uh.current),i=lb(e,s.type);e!==i&&(G$1(vh,s),G$1(uh,i))}function Bh(s){vh.current===s&&(E$1(uh),E$1(vh))}var L$2=Uf(0);function Ch(s){for(var e=s;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var s=0;s<Dh.length;s++)Dh[s]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$2=null,N$2=null,O$2=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$1(321))}function Mh(s,e){if(e===null)return!1;for(var i=0;i<e.length&&i<s.length;i++)if(!He(s[i],e[i]))return!1;return!0}function Nh(s,e,i,o,a,j){if(Hh=j,M$2=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=s===null||s.memoizedState===null?Oh:Ph,s=i(o,a),Jh){j=0;do{if(Jh=!1,Kh=0,25<=j)throw Error(p$1(301));j+=1,O$2=N$2=null,e.updateQueue=null,Fh.current=Qh,s=i(o,a)}while(Jh)}if(Fh.current=Rh,e=N$2!==null&&N$2.next!==null,Hh=0,O$2=N$2=M$2=null,Ih=!1,e)throw Error(p$1(300));return s}function Sh(){var s=Kh!==0;return Kh=0,s}function Th(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$2===null?M$2.memoizedState=O$2=s:O$2=O$2.next=s,O$2}function Uh(){if(N$2===null){var s=M$2.alternate;s=s!==null?s.memoizedState:null}else s=N$2.next;var e=O$2===null?M$2.memoizedState:O$2.next;if(e!==null)O$2=e,N$2=s;else{if(s===null)throw Error(p$1(310));N$2=s,s={memoizedState:N$2.memoizedState,baseState:N$2.baseState,baseQueue:N$2.baseQueue,queue:N$2.queue,next:null},O$2===null?M$2.memoizedState=O$2=s:O$2=O$2.next=s}return O$2}function Vh(s,e){return typeof e=="function"?e(s):e}function Wh(s){var e=Uh(),i=e.queue;if(i===null)throw Error(p$1(311));i.lastRenderedReducer=s;var o=N$2,a=o.baseQueue,j=i.pending;if(j!==null){if(a!==null){var _e=a.next;a.next=j.next,j.next=_e}o.baseQueue=a=j,i.pending=null}if(a!==null){j=a.next,o=o.baseState;var tt=_e=null,et=null,rt=j;do{var dt=rt.lane;if((Hh&dt)===dt)et!==null&&(et=et.next={lane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),o=rt.hasEagerState?rt.eagerState:s(o,rt.action);else{var vt={lane:dt,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null};et===null?(tt=et=vt,_e=o):et=et.next=vt,M$2.lanes|=dt,rh|=dt}rt=rt.next}while(rt!==null&&rt!==j);et===null?_e=o:et.next=tt,He(o,e.memoizedState)||(dh=!0),e.memoizedState=o,e.baseState=_e,e.baseQueue=et,i.lastRenderedState=o}if(s=i.interleaved,s!==null){a=s;do j=a.lane,M$2.lanes|=j,rh|=j,a=a.next;while(a!==s)}else a===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function Xh(s){var e=Uh(),i=e.queue;if(i===null)throw Error(p$1(311));i.lastRenderedReducer=s;var o=i.dispatch,a=i.pending,j=e.memoizedState;if(a!==null){i.pending=null;var _e=a=a.next;do j=s(j,_e.action),_e=_e.next;while(_e!==a);He(j,e.memoizedState)||(dh=!0),e.memoizedState=j,e.baseQueue===null&&(e.baseState=j),i.lastRenderedState=j}return[j,o]}function Yh(){}function Zh(s,e){var i=M$2,o=Uh(),a=e(),j=!He(o.memoizedState,a);if(j&&(o.memoizedState=a,dh=!0),o=o.queue,$h(ai.bind(null,i,o,s),[s]),o.getSnapshot!==e||j||O$2!==null&&O$2.memoizedState.tag&1){if(i.flags|=2048,bi(9,ci.bind(null,i,o,a,e),void 0,null),Q$2===null)throw Error(p$1(349));Hh&30||di(i,e,a)}return a}function di(s,e,i){s.flags|=16384,s={getSnapshot:e,value:i},e=M$2.updateQueue,e===null?(e={lastEffect:null,stores:null},M$2.updateQueue=e,e.stores=[s]):(i=e.stores,i===null?e.stores=[s]:i.push(s))}function ci(s,e,i,o){e.value=i,e.getSnapshot=o,ei(e)&&fi(s)}function ai(s,e,i){return i(function(){ei(e)&&fi(s)})}function ei(s){var e=s.getSnapshot;s=s.value;try{var i=e();return!He(s,i)}catch{return!0}}function fi(s){var e=ih(s,1);e!==null&&gi(e,s,1,-1)}function hi(s){var e=Th();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:s},e.queue=s,s=s.dispatch=ii.bind(null,M$2,s),[e.memoizedState,s]}function bi(s,e,i,o){return s={tag:s,create:e,destroy:i,deps:o,next:null},e=M$2.updateQueue,e===null?(e={lastEffect:null,stores:null},M$2.updateQueue=e,e.lastEffect=s.next=s):(i=e.lastEffect,i===null?e.lastEffect=s.next=s:(o=i.next,i.next=s,s.next=o,e.lastEffect=s)),s}function ji(){return Uh().memoizedState}function ki(s,e,i,o){var a=Th();M$2.flags|=s,a.memoizedState=bi(1|e,i,void 0,o===void 0?null:o)}function li(s,e,i,o){var a=Uh();o=o===void 0?null:o;var j=void 0;if(N$2!==null){var _e=N$2.memoizedState;if(j=_e.destroy,o!==null&&Mh(o,_e.deps)){a.memoizedState=bi(e,i,j,o);return}}M$2.flags|=s,a.memoizedState=bi(1|e,i,j,o)}function mi(s,e){return ki(8390656,8,s,e)}function $h(s,e){return li(2048,8,s,e)}function ni(s,e){return li(4,2,s,e)}function oi(s,e){return li(4,4,s,e)}function pi(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function qi(s,e,i){return i=i!=null?i.concat([s]):null,li(4,4,pi.bind(null,e,s),i)}function ri(){}function si(s,e){var i=Uh();e=e===void 0?null:e;var o=i.memoizedState;return o!==null&&e!==null&&Mh(e,o[1])?o[0]:(i.memoizedState=[s,e],s)}function ti(s,e){var i=Uh();e=e===void 0?null:e;var o=i.memoizedState;return o!==null&&e!==null&&Mh(e,o[1])?o[0]:(s=s(),i.memoizedState=[s,e],s)}function ui(s,e,i){return Hh&21?(He(i,e)||(i=yc(),M$2.lanes|=i,rh|=i,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,dh=!0),s.memoizedState=i)}function vi(s,e){var i=C$1;C$1=i!==0&&4>i?i:4,s(!0);var o=Gh.transition;Gh.transition={};try{s(!1),e()}finally{C$1=i,Gh.transition=o}}function wi(){return Uh().memoizedState}function xi(s,e,i){var o=yi(s);if(i={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null},zi(s))Ai(e,i);else if(i=hh(s,e,i,o),i!==null){var a=R$1();gi(i,s,o,a),Bi(i,e,o)}}function ii(s,e,i){var o=yi(s),a={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null};if(zi(s))Ai(e,a);else{var j=s.alternate;if(s.lanes===0&&(j===null||j.lanes===0)&&(j=e.lastRenderedReducer,j!==null))try{var _e=e.lastRenderedState,tt=j(_e,i);if(a.hasEagerState=!0,a.eagerState=tt,He(tt,_e)){var et=e.interleaved;et===null?(a.next=a,gh(e)):(a.next=et.next,et.next=a),e.interleaved=a;return}}catch{}finally{}i=hh(s,e,a,o),i!==null&&(a=R$1(),gi(i,s,o,a),Bi(i,e,o))}}function zi(s){var e=s.alternate;return s===M$2||e!==null&&e===M$2}function Ai(s,e){Jh=Ih=!0;var i=s.pending;i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e}function Bi(s,e,i){if(i&4194240){var o=e.lanes;o&=s.pendingLanes,i|=o,e.lanes=i,Cc(s,i)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(s,e){return Th().memoizedState=[s,e===void 0?null:e],s},useContext:eh,useEffect:mi,useImperativeHandle:function(s,e,i){return i=i!=null?i.concat([s]):null,ki(4194308,4,pi.bind(null,e,s),i)},useLayoutEffect:function(s,e){return ki(4194308,4,s,e)},useInsertionEffect:function(s,e){return ki(4,2,s,e)},useMemo:function(s,e){var i=Th();return e=e===void 0?null:e,s=s(),i.memoizedState=[s,e],s},useReducer:function(s,e,i){var o=Th();return e=i!==void 0?i(e):e,o.memoizedState=o.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},o.queue=s,s=s.dispatch=xi.bind(null,M$2,s),[o.memoizedState,s]},useRef:function(s){var e=Th();return s={current:s},e.memoizedState=s},useState:hi,useDebugValue:ri,useDeferredValue:function(s){return Th().memoizedState=s},useTransition:function(){var s=hi(!1),e=s[0];return s=vi.bind(null,s[1]),Th().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,i){var o=M$2,a=Th();if(I$1){if(i===void 0)throw Error(p$1(407));i=i()}else{if(i=e(),Q$2===null)throw Error(p$1(349));Hh&30||di(o,e,i)}a.memoizedState=i;var j={value:i,getSnapshot:e};return a.queue=j,mi(ai.bind(null,o,j,s),[s]),o.flags|=2048,bi(9,ci.bind(null,o,j,i,e),void 0,null),i},useId:function(){var s=Th(),e=Q$2.identifierPrefix;if(I$1){var i=sg,o=rg;i=(o&~(1<<32-oc(o)-1)).toString(32)+i,e=":"+e+"R"+i,i=Kh++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=Lh++,e=":"+e+"r"+i.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return ui(e,N$2.memoizedState,s)},useTransition:function(){var s=Wh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return N$2===null?e.memoizedState=s:ui(e,N$2.memoizedState,s)},useTransition:function(){var s=Xh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(s,e){if(s&&s.defaultProps){e=A$1({},e),s=s.defaultProps;for(var i in s)e[i]===void 0&&(e[i]=s[i]);return e}return e}function Di(s,e,i,o){e=s.memoizedState,i=i(o,e),i=i==null?e:A$1({},e,i),s.memoizedState=i,s.lanes===0&&(s.updateQueue.baseState=i)}var Ei={isMounted:function(s){return(s=s._reactInternals)?Vb(s)===s:!1},enqueueSetState:function(s,e,i){s=s._reactInternals;var o=R$1(),a=yi(s),j=mh(o,a);j.payload=e,i!=null&&(j.callback=i),e=nh(s,j,a),e!==null&&(gi(e,s,a,o),oh(e,s,a))},enqueueReplaceState:function(s,e,i){s=s._reactInternals;var o=R$1(),a=yi(s),j=mh(o,a);j.tag=1,j.payload=e,i!=null&&(j.callback=i),e=nh(s,j,a),e!==null&&(gi(e,s,a,o),oh(e,s,a))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var i=R$1(),o=yi(s),a=mh(i,o);a.tag=2,e!=null&&(a.callback=e),e=nh(s,a,o),e!==null&&(gi(e,s,o,i),oh(e,s,o))}};function Fi(s,e,i,o,a,j,_e){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(o,j,_e):e.prototype&&e.prototype.isPureReactComponent?!Ie(i,o)||!Ie(a,j):!0}function Gi(s,e,i){var o=!1,a=Vf,j=e.contextType;return typeof j=="object"&&j!==null?j=eh(j):(a=Zf(e)?Xf:H$1.current,o=e.contextTypes,j=(o=o!=null)?Yf(s,a):Vf),e=new e(i,j),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,s.stateNode=e,e._reactInternals=s,o&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=j),e}function Hi(s,e,i,o){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,o),e.state!==s&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(s,e,i,o){var a=s.stateNode;a.props=i,a.state=s.memoizedState,a.refs={},kh(s);var j=e.contextType;typeof j=="object"&&j!==null?a.context=eh(j):(j=Zf(e)?Xf:H$1.current,a.context=Yf(s,j)),a.state=s.memoizedState,j=e.getDerivedStateFromProps,typeof j=="function"&&(Di(s,e,j,i),a.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Ei.enqueueReplaceState(a,a.state,null),qh(s,i,a,o),a.state=s.memoizedState),typeof a.componentDidMount=="function"&&(s.flags|=4194308)}function Ji(s,e){try{var i="",o=e;do i+=Pa(o),o=o.return;while(o);var a=i}catch(j){a=`
Error generating stack: `+j.message+`
`+j.stack}return{value:s,source:e,stack:a,digest:null}}function Ki(s,e,i){return{value:s,source:null,stack:i??null,digest:e??null}}function Li(s,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(s,e,i){i=mh(-1,i),i.tag=3,i.payload={element:null};var o=e.value;return i.callback=function(){Oi||(Oi=!0,Pi=o),Li(s,e)},i}function Qi(s,e,i){i=mh(-1,i),i.tag=3;var o=s.type.getDerivedStateFromError;if(typeof o=="function"){var a=e.value;i.payload=function(){return o(a)},i.callback=function(){Li(s,e)}}var j=s.stateNode;return j!==null&&typeof j.componentDidCatch=="function"&&(i.callback=function(){Li(s,e),typeof o!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var _e=e.stack;this.componentDidCatch(e.value,{componentStack:_e!==null?_e:""})}),i}function Si(s,e,i){var o=s.pingCache;if(o===null){o=s.pingCache=new Mi;var a=new Set;o.set(e,a)}else a=o.get(e),a===void 0&&(a=new Set,o.set(e,a));a.has(i)||(a.add(i),s=Ti.bind(null,s,e,i),e.then(s,s))}function Ui(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function Vi(s,e,i,o,a){return s.mode&1?(s.flags|=65536,s.lanes=a,s):(s===e?s.flags|=65536:(s.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=mh(-1,1),e.tag=2,nh(i,e,1))),i.lanes|=1),s)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(s,e,i,o){e.child=s===null?Vg(e,null,i,o):Ug(e,s.child,i,o)}function Yi(s,e,i,o,a){i=i.render;var j=e.ref;return ch(e,a),o=Nh(s,e,i,o,j,a),i=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~a,Zi(s,e,a)):(I$1&&i&&vg(e),e.flags|=1,Xi(s,e,o,a),e.child)}function $i(s,e,i,o,a){if(s===null){var j=i.type;return typeof j=="function"&&!aj(j)&&j.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=j,bj(s,e,j,o,a)):(s=Rg(i.type,null,o,e,e.mode,a),s.ref=e.ref,s.return=e,e.child=s)}if(j=s.child,!(s.lanes&a)){var _e=j.memoizedProps;if(i=i.compare,i=i!==null?i:Ie,i(_e,o)&&s.ref===e.ref)return Zi(s,e,a)}return e.flags|=1,s=Pg(j,o),s.ref=e.ref,s.return=e,e.child=s}function bj(s,e,i,o,a){if(s!==null){var j=s.memoizedProps;if(Ie(j,o)&&s.ref===e.ref)if(dh=!1,e.pendingProps=o=j,(s.lanes&a)!==0)s.flags&131072&&(dh=!0);else return e.lanes=s.lanes,Zi(s,e,a)}return cj(s,e,i,o,a)}function dj(s,e,i){var o=e.pendingProps,a=o.children,j=s!==null?s.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej,fj),fj|=i;else{if(!(i&1073741824))return s=j!==null?j.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,G$1(ej,fj),fj|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=j!==null?j.baseLanes:i,G$1(ej,fj),fj|=o}else j!==null?(o=j.baseLanes|i,e.memoizedState=null):o=i,G$1(ej,fj),fj|=o;return Xi(s,e,a,i),e.child}function gj(s,e){var i=e.ref;(s===null&&i!==null||s!==null&&s.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function cj(s,e,i,o,a){var j=Zf(i)?Xf:H$1.current;return j=Yf(e,j),ch(e,a),i=Nh(s,e,i,o,j,a),o=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~a,Zi(s,e,a)):(I$1&&o&&vg(e),e.flags|=1,Xi(s,e,i,a),e.child)}function hj(s,e,i,o,a){if(Zf(i)){var j=!0;cg(e)}else j=!1;if(ch(e,a),e.stateNode===null)ij(s,e),Gi(e,i,o),Ii(e,i,o,a),o=!0;else if(s===null){var _e=e.stateNode,tt=e.memoizedProps;_e.props=tt;var et=_e.context,rt=i.contextType;typeof rt=="object"&&rt!==null?rt=eh(rt):(rt=Zf(i)?Xf:H$1.current,rt=Yf(e,rt));var dt=i.getDerivedStateFromProps,vt=typeof dt=="function"||typeof _e.getSnapshotBeforeUpdate=="function";vt||typeof _e.UNSAFE_componentWillReceiveProps!="function"&&typeof _e.componentWillReceiveProps!="function"||(tt!==o||et!==rt)&&Hi(e,_e,o,rt),jh=!1;var Ct=e.memoizedState;_e.state=Ct,qh(e,o,_e,a),et=e.memoizedState,tt!==o||Ct!==et||Wf.current||jh?(typeof dt=="function"&&(Di(e,i,dt,o),et=e.memoizedState),(tt=jh||Fi(e,i,tt,o,Ct,et,rt))?(vt||typeof _e.UNSAFE_componentWillMount!="function"&&typeof _e.componentWillMount!="function"||(typeof _e.componentWillMount=="function"&&_e.componentWillMount(),typeof _e.UNSAFE_componentWillMount=="function"&&_e.UNSAFE_componentWillMount()),typeof _e.componentDidMount=="function"&&(e.flags|=4194308)):(typeof _e.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=et),_e.props=o,_e.state=et,_e.context=rt,o=tt):(typeof _e.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{_e=e.stateNode,lh(s,e),tt=e.memoizedProps,rt=e.type===e.elementType?tt:Ci(e.type,tt),_e.props=rt,vt=e.pendingProps,Ct=_e.context,et=i.contextType,typeof et=="object"&&et!==null?et=eh(et):(et=Zf(i)?Xf:H$1.current,et=Yf(e,et));var Wt=i.getDerivedStateFromProps;(dt=typeof Wt=="function"||typeof _e.getSnapshotBeforeUpdate=="function")||typeof _e.UNSAFE_componentWillReceiveProps!="function"&&typeof _e.componentWillReceiveProps!="function"||(tt!==vt||Ct!==et)&&Hi(e,_e,o,et),jh=!1,Ct=e.memoizedState,_e.state=Ct,qh(e,o,_e,a);var Bt=e.memoizedState;tt!==vt||Ct!==Bt||Wf.current||jh?(typeof Wt=="function"&&(Di(e,i,Wt,o),Bt=e.memoizedState),(rt=jh||Fi(e,i,rt,o,Ct,Bt,et)||!1)?(dt||typeof _e.UNSAFE_componentWillUpdate!="function"&&typeof _e.componentWillUpdate!="function"||(typeof _e.componentWillUpdate=="function"&&_e.componentWillUpdate(o,Bt,et),typeof _e.UNSAFE_componentWillUpdate=="function"&&_e.UNSAFE_componentWillUpdate(o,Bt,et)),typeof _e.componentDidUpdate=="function"&&(e.flags|=4),typeof _e.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof _e.componentDidUpdate!="function"||tt===s.memoizedProps&&Ct===s.memoizedState||(e.flags|=4),typeof _e.getSnapshotBeforeUpdate!="function"||tt===s.memoizedProps&&Ct===s.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=Bt),_e.props=o,_e.state=Bt,_e.context=et,o=rt):(typeof _e.componentDidUpdate!="function"||tt===s.memoizedProps&&Ct===s.memoizedState||(e.flags|=4),typeof _e.getSnapshotBeforeUpdate!="function"||tt===s.memoizedProps&&Ct===s.memoizedState||(e.flags|=1024),o=!1)}return jj(s,e,i,o,j,a)}function jj(s,e,i,o,a,j){gj(s,e);var _e=(e.flags&128)!==0;if(!o&&!_e)return a&&dg(e,i,!1),Zi(s,e,j);o=e.stateNode,Wi.current=e;var tt=_e&&typeof i.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,s!==null&&_e?(e.child=Ug(e,s.child,null,j),e.child=Ug(e,null,tt,j)):Xi(s,e,tt,j),e.memoizedState=o.state,a&&dg(e,i,!0),e.child}function kj(s){var e=s.stateNode;e.pendingContext?ag(s,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(s,e.context,!1),yh(s,e.containerInfo)}function lj(s,e,i,o,a){return Ig(),Jg(a),e.flags|=256,Xi(s,e,i,o),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(s){return{baseLanes:s,cachePool:null,transitions:null}}function oj(s,e,i){var o=e.pendingProps,a=L$2.current,j=!1,_e=(e.flags&128)!==0,tt;if((tt=_e)||(tt=s!==null&&s.memoizedState===null?!1:(a&2)!==0),tt?(j=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(a|=1),G$1(L$2,a&1),s===null)return Eg(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(_e=o.children,s=o.fallback,j?(o=e.mode,j=e.child,_e={mode:"hidden",children:_e},!(o&1)&&j!==null?(j.childLanes=0,j.pendingProps=_e):j=pj(_e,o,0,null),s=Tg(s,o,i,null),j.return=e,s.return=e,j.sibling=s,e.child=j,e.child.memoizedState=nj(i),e.memoizedState=mj,s):qj(e,_e));if(a=s.memoizedState,a!==null&&(tt=a.dehydrated,tt!==null))return rj(s,e,_e,o,tt,a,i);if(j){j=o.fallback,_e=e.mode,a=s.child,tt=a.sibling;var et={mode:"hidden",children:o.children};return!(_e&1)&&e.child!==a?(o=e.child,o.childLanes=0,o.pendingProps=et,e.deletions=null):(o=Pg(a,et),o.subtreeFlags=a.subtreeFlags&14680064),tt!==null?j=Pg(tt,j):(j=Tg(j,_e,i,null),j.flags|=2),j.return=e,o.return=e,o.sibling=j,e.child=o,o=j,j=e.child,_e=s.child.memoizedState,_e=_e===null?nj(i):{baseLanes:_e.baseLanes|i,cachePool:null,transitions:_e.transitions},j.memoizedState=_e,j.childLanes=s.childLanes&~i,e.memoizedState=mj,o}return j=s.child,s=j.sibling,o=Pg(j,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=i),o.return=e,o.sibling=null,s!==null&&(i=e.deletions,i===null?(e.deletions=[s],e.flags|=16):i.push(s)),e.child=o,e.memoizedState=null,o}function qj(s,e){return e=pj({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function sj(s,e,i,o){return o!==null&&Jg(o),Ug(e,s.child,null,i),s=qj(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function rj(s,e,i,o,a,j,_e){if(i)return e.flags&256?(e.flags&=-257,o=Ki(Error(p$1(422))),sj(s,e,_e,o)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(j=o.fallback,a=e.mode,o=pj({mode:"visible",children:o.children},a,0,null),j=Tg(j,a,_e,null),j.flags|=2,o.return=e,j.return=e,o.sibling=j,e.child=o,e.mode&1&&Ug(e,s.child,null,_e),e.child.memoizedState=nj(_e),e.memoizedState=mj,j);if(!(e.mode&1))return sj(s,e,_e,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var tt=o.dgst;return o=tt,j=Error(p$1(419)),o=Ki(j,o,void 0),sj(s,e,_e,o)}if(tt=(_e&s.childLanes)!==0,dh||tt){if(o=Q$2,o!==null){switch(_e&-_e){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(o.suspendedLanes|_e)?0:a,a!==0&&a!==j.retryLane&&(j.retryLane=a,ih(s,a),gi(o,s,a,-1))}return tj(),o=Ki(Error(p$1(421))),sj(s,e,_e,o)}return a.data==="$?"?(e.flags|=128,e.child=s.child,e=uj.bind(null,s),a._reactRetry=e,null):(s=j.treeContext,yg=Lf(a.nextSibling),xg=e,I$1=!0,zg=null,s!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=s.id,sg=s.overflow,qg=e),e=qj(e,o.children),e.flags|=4096,e)}function vj(s,e,i){s.lanes|=e;var o=s.alternate;o!==null&&(o.lanes|=e),bh(s.return,e,i)}function wj(s,e,i,o,a){var j=s.memoizedState;j===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:i,tailMode:a}:(j.isBackwards=e,j.rendering=null,j.renderingStartTime=0,j.last=o,j.tail=i,j.tailMode=a)}function xj(s,e,i){var o=e.pendingProps,a=o.revealOrder,j=o.tail;if(Xi(s,e,o.children,i),o=L$2.current,o&2)o=o&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vj(s,i,e);else if(s.tag===19)vj(s,i,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}o&=1}if(G$1(L$2,o),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(i=e.child,a=null;i!==null;)s=i.alternate,s!==null&&Ch(s)===null&&(a=i),i=i.sibling;i=a,i===null?(a=e.child,e.child=null):(a=i.sibling,i.sibling=null),wj(e,!1,a,i,j);break;case"backwards":for(i=null,a=e.child,e.child=null;a!==null;){if(s=a.alternate,s!==null&&Ch(s)===null){e.child=a;break}s=a.sibling,a.sibling=i,i=a,a=s}wj(e,!0,i,null,j);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function Zi(s,e,i){if(s!==null&&(e.dependencies=s.dependencies),rh|=e.lanes,!(i&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(p$1(153));if(e.child!==null){for(s=e.child,i=Pg(s,s.pendingProps),e.child=i,i.return=e;s.sibling!==null;)s=s.sibling,i=i.sibling=Pg(s,s.pendingProps),i.return=e;i.sibling=null}return e.child}function yj(s,e,i){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,a=e.memoizedProps.value;G$1(Wg,o._currentValue),o._currentValue=a;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(G$1(L$2,L$2.current&1),e.flags|=128,null):i&e.child.childLanes?oj(s,e,i):(G$1(L$2,L$2.current&1),s=Zi(s,e,i),s!==null?s.sibling:null);G$1(L$2,L$2.current&1);break;case 19:if(o=(i&e.childLanes)!==0,s.flags&128){if(o)return xj(s,e,i);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),G$1(L$2,L$2.current),o)break;return null;case 22:case 23:return e.lanes=0,dj(s,e,i)}return Zi(s,e,i)}var zj,Aj,Bj,Cj;zj=function(s,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)s.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Aj=function(){};Bj=function(s,e,i,o){var a=s.memoizedProps;if(a!==o){s=e.stateNode,xh(uh.current);var j=null;switch(i){case"input":a=Ya(s,a),o=Ya(s,o),j=[];break;case"select":a=A$1({},a,{value:void 0}),o=A$1({},o,{value:void 0}),j=[];break;case"textarea":a=gb(s,a),o=gb(s,o),j=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(s.onclick=Bf)}ub(i,o);var _e;i=null;for(rt in a)if(!o.hasOwnProperty(rt)&&a.hasOwnProperty(rt)&&a[rt]!=null)if(rt==="style"){var tt=a[rt];for(_e in tt)tt.hasOwnProperty(_e)&&(i||(i={}),i[_e]="")}else rt!=="dangerouslySetInnerHTML"&&rt!=="children"&&rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&rt!=="autoFocus"&&(ea.hasOwnProperty(rt)?j||(j=[]):(j=j||[]).push(rt,null));for(rt in o){var et=o[rt];if(tt=a!=null?a[rt]:void 0,o.hasOwnProperty(rt)&&et!==tt&&(et!=null||tt!=null))if(rt==="style")if(tt){for(_e in tt)!tt.hasOwnProperty(_e)||et&&et.hasOwnProperty(_e)||(i||(i={}),i[_e]="");for(_e in et)et.hasOwnProperty(_e)&&tt[_e]!==et[_e]&&(i||(i={}),i[_e]=et[_e])}else i||(j||(j=[]),j.push(rt,i)),i=et;else rt==="dangerouslySetInnerHTML"?(et=et?et.__html:void 0,tt=tt?tt.__html:void 0,et!=null&&tt!==et&&(j=j||[]).push(rt,et)):rt==="children"?typeof et!="string"&&typeof et!="number"||(j=j||[]).push(rt,""+et):rt!=="suppressContentEditableWarning"&&rt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(rt)?(et!=null&&rt==="onScroll"&&D$1("scroll",s),j||tt===et||(j=[])):(j=j||[]).push(rt,et))}i&&(j=j||[]).push("style",i);var rt=j;(e.updateQueue=rt)&&(e.flags|=4)}};Cj=function(s,e,i,o){i!==o&&(e.flags|=4)};function Dj(s,e){if(!I$1)switch(s.tailMode){case"hidden":e=s.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?s.tail=null:i.sibling=null;break;case"collapsed":i=s.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:o.sibling=null}}function S$1(s){var e=s.alternate!==null&&s.alternate.child===s.child,i=0,o=0;if(e)for(var a=s.child;a!==null;)i|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=s,a=a.sibling;else for(a=s.child;a!==null;)i|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=s,a=a.sibling;return s.subtreeFlags|=o,s.childLanes=i,e}function Ej(s,e,i){var o=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(e),null;case 1:return Zf(e.type)&&$f(),S$1(e),null;case 3:return o=e.stateNode,zh(),E$1(Wf),E$1(H$1),Eh(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Gg(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(s,e),S$1(e),null;case 5:Bh(e);var a=xh(wh.current);if(i=e.type,s!==null&&e.stateNode!=null)Bj(s,e,i,o,a),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(p$1(166));return S$1(e),null}if(s=xh(uh.current),Gg(e)){o=e.stateNode,i=e.type;var j=e.memoizedProps;switch(o[Of]=e,o[Pf]=j,s=(e.mode&1)!==0,i){case"dialog":D$1("cancel",o),D$1("close",o);break;case"iframe":case"object":case"embed":D$1("load",o);break;case"video":case"audio":for(a=0;a<lf.length;a++)D$1(lf[a],o);break;case"source":D$1("error",o);break;case"img":case"image":case"link":D$1("error",o),D$1("load",o);break;case"details":D$1("toggle",o);break;case"input":Za(o,j),D$1("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!j.multiple},D$1("invalid",o);break;case"textarea":hb(o,j),D$1("invalid",o)}ub(i,j),a=null;for(var _e in j)if(j.hasOwnProperty(_e)){var tt=j[_e];_e==="children"?typeof tt=="string"?o.textContent!==tt&&(j.suppressHydrationWarning!==!0&&Af(o.textContent,tt,s),a=["children",tt]):typeof tt=="number"&&o.textContent!==""+tt&&(j.suppressHydrationWarning!==!0&&Af(o.textContent,tt,s),a=["children",""+tt]):ea.hasOwnProperty(_e)&&tt!=null&&_e==="onScroll"&&D$1("scroll",o)}switch(i){case"input":Va(o),db$1(o,j,!0);break;case"textarea":Va(o),jb(o);break;case"select":case"option":break;default:typeof j.onClick=="function"&&(o.onclick=Bf)}o=a,e.updateQueue=o,o!==null&&(e.flags|=4)}else{_e=a.nodeType===9?a:a.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kb(i)),s==="http://www.w3.org/1999/xhtml"?i==="script"?(s=_e.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof o.is=="string"?s=_e.createElement(i,{is:o.is}):(s=_e.createElement(i),i==="select"&&(_e=s,o.multiple?_e.multiple=!0:o.size&&(_e.size=o.size))):s=_e.createElementNS(s,i),s[Of]=e,s[Pf]=o,zj(s,e,!1,!1),e.stateNode=s;e:{switch(_e=vb(i,o),i){case"dialog":D$1("cancel",s),D$1("close",s),a=o;break;case"iframe":case"object":case"embed":D$1("load",s),a=o;break;case"video":case"audio":for(a=0;a<lf.length;a++)D$1(lf[a],s);a=o;break;case"source":D$1("error",s),a=o;break;case"img":case"image":case"link":D$1("error",s),D$1("load",s),a=o;break;case"details":D$1("toggle",s),a=o;break;case"input":Za(s,o),a=Ya(s,o),D$1("invalid",s);break;case"option":a=o;break;case"select":s._wrapperState={wasMultiple:!!o.multiple},a=A$1({},o,{value:void 0}),D$1("invalid",s);break;case"textarea":hb(s,o),a=gb(s,o),D$1("invalid",s);break;default:a=o}ub(i,a),tt=a;for(j in tt)if(tt.hasOwnProperty(j)){var et=tt[j];j==="style"?sb(s,et):j==="dangerouslySetInnerHTML"?(et=et?et.__html:void 0,et!=null&&nb(s,et)):j==="children"?typeof et=="string"?(i!=="textarea"||et!=="")&&ob(s,et):typeof et=="number"&&ob(s,""+et):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(ea.hasOwnProperty(j)?et!=null&&j==="onScroll"&&D$1("scroll",s):et!=null&&ta(s,j,et,_e))}switch(i){case"input":Va(s),db$1(s,o,!1);break;case"textarea":Va(s),jb(s);break;case"option":o.value!=null&&s.setAttribute("value",""+Sa(o.value));break;case"select":s.multiple=!!o.multiple,j=o.value,j!=null?fb(s,!!o.multiple,j,!1):o.defaultValue!=null&&fb(s,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(s.onclick=Bf)}switch(i){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S$1(e),null;case 6:if(s&&e.stateNode!=null)Cj(s,e,s.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(p$1(166));if(i=xh(wh.current),xh(uh.current),Gg(e)){if(o=e.stateNode,i=e.memoizedProps,o[Of]=e,(j=o.nodeValue!==i)&&(s=xg,s!==null))switch(s.tag){case 3:Af(o.nodeValue,i,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Af(o.nodeValue,i,(s.mode&1)!==0)}j&&(e.flags|=4)}else o=(i.nodeType===9?i:i.ownerDocument).createTextNode(o),o[Of]=e,e.stateNode=o}return S$1(e),null;case 13:if(E$1(L$2),o=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,j=!1;else if(j=Gg(e),o!==null&&o.dehydrated!==null){if(s===null){if(!j)throw Error(p$1(318));if(j=e.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(p$1(317));j[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S$1(e),j=!1}else zg!==null&&(Fj(zg),zg=null),j=!0;if(!j)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(o=o!==null,o!==(s!==null&&s.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(s===null||L$2.current&1?T$1===0&&(T$1=3):tj())),e.updateQueue!==null&&(e.flags|=4),S$1(e),null);case 4:return zh(),Aj(s,e),s===null&&sf(e.stateNode.containerInfo),S$1(e),null;case 10:return ah(e.type._context),S$1(e),null;case 17:return Zf(e.type)&&$f(),S$1(e),null;case 19:if(E$1(L$2),j=e.memoizedState,j===null)return S$1(e),null;if(o=(e.flags&128)!==0,_e=j.rendering,_e===null)if(o)Dj(j,!1);else{if(T$1!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(_e=Ch(s),_e!==null){for(e.flags|=128,Dj(j,!1),o=_e.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=i,i=e.child;i!==null;)j=i,s=o,j.flags&=14680066,_e=j.alternate,_e===null?(j.childLanes=0,j.lanes=s,j.child=null,j.subtreeFlags=0,j.memoizedProps=null,j.memoizedState=null,j.updateQueue=null,j.dependencies=null,j.stateNode=null):(j.childLanes=_e.childLanes,j.lanes=_e.lanes,j.child=_e.child,j.subtreeFlags=0,j.deletions=null,j.memoizedProps=_e.memoizedProps,j.memoizedState=_e.memoizedState,j.updateQueue=_e.updateQueue,j.type=_e.type,s=_e.dependencies,j.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i=i.sibling;return G$1(L$2,L$2.current&1|2),e.child}s=s.sibling}j.tail!==null&&B$2()>Gj&&(e.flags|=128,o=!0,Dj(j,!1),e.lanes=4194304)}else{if(!o)if(s=Ch(_e),s!==null){if(e.flags|=128,o=!0,i=s.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),Dj(j,!0),j.tail===null&&j.tailMode==="hidden"&&!_e.alternate&&!I$1)return S$1(e),null}else 2*B$2()-j.renderingStartTime>Gj&&i!==1073741824&&(e.flags|=128,o=!0,Dj(j,!1),e.lanes=4194304);j.isBackwards?(_e.sibling=e.child,e.child=_e):(i=j.last,i!==null?i.sibling=_e:e.child=_e,j.last=_e)}return j.tail!==null?(e=j.tail,j.rendering=e,j.tail=e.sibling,j.renderingStartTime=B$2(),e.sibling=null,i=L$2.current,G$1(L$2,o?i&1|2:i&1),e):(S$1(e),null);case 22:case 23:return Hj(),o=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?fj&1073741824&&(S$1(e),e.subtreeFlags&6&&(e.flags|=8192)):S$1(e),null;case 24:return null;case 25:return null}throw Error(p$1(156,e.tag))}function Ij(s,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return zh(),E$1(Wf),E$1(H$1),Eh(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E$1(L$2),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(p$1(340));Ig()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return E$1(L$2),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(s,e){var i=s.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(o){W(s,e,o)}else i.current=null}function Mj(s,e,i){try{i()}catch(o){W(s,e,o)}}var Nj=!1;function Oj(s,e){if(Cf=dd,s=Me(),Ne(s)){if("selectionStart"in s)var i={start:s.selectionStart,end:s.selectionEnd};else e:{i=(i=s.ownerDocument)&&i.defaultView||window;var o=i.getSelection&&i.getSelection();if(o&&o.rangeCount!==0){i=o.anchorNode;var a=o.anchorOffset,j=o.focusNode;o=o.focusOffset;try{i.nodeType,j.nodeType}catch{i=null;break e}var _e=0,tt=-1,et=-1,rt=0,dt=0,vt=s,Ct=null;t:for(;;){for(var Wt;vt!==i||a!==0&&vt.nodeType!==3||(tt=_e+a),vt!==j||o!==0&&vt.nodeType!==3||(et=_e+o),vt.nodeType===3&&(_e+=vt.nodeValue.length),(Wt=vt.firstChild)!==null;)Ct=vt,vt=Wt;for(;;){if(vt===s)break t;if(Ct===i&&++rt===a&&(tt=_e),Ct===j&&++dt===o&&(et=_e),(Wt=vt.nextSibling)!==null)break;vt=Ct,Ct=vt.parentNode}vt=Wt}i=tt===-1||et===-1?null:{start:tt,end:et}}else i=null}i=i||{start:0,end:0}}else i=null;for(Df={focusedElem:s,selectionRange:i},dd=!1,V=e;V!==null;)if(e=V,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,V=s;else for(;V!==null;){e=V;try{var Bt=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(Bt!==null){var qt=Bt.memoizedProps,Ut=Bt.memoizedState,kt=e.stateNode,Nt=kt.getSnapshotBeforeUpdate(e.elementType===e.type?qt:Ci(e.type,qt),Ut);kt.__reactInternalSnapshotBeforeUpdate=Nt}break;case 3:var un=e.stateNode.containerInfo;un.nodeType===1?un.textContent="":un.nodeType===9&&un.documentElement&&un.removeChild(un.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(dn){W(e,e.return,dn)}if(s=e.sibling,s!==null){s.return=e.return,V=s;break}V=e.return}return Bt=Nj,Nj=!1,Bt}function Pj(s,e,i){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&s)===s){var j=a.destroy;a.destroy=void 0,j!==void 0&&Mj(e,i,j)}a=a.next}while(a!==o)}}function Qj(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&s)===s){var o=i.create;i.destroy=o()}i=i.next}while(i!==e)}}function Rj(s){var e=s.ref;if(e!==null){var i=s.stateNode;switch(s.tag){case 5:s=i;break;default:s=i}typeof e=="function"?e(s):e.current=s}}function Sj(s){var e=s.alternate;e!==null&&(s.alternate=null,Sj(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Tj(s){return s.tag===5||s.tag===3||s.tag===4}function Uj(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Tj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vj(s,e,i){var o=s.tag;if(o===5||o===6)s=s.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(s,e):i.insertBefore(s,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(s,i)):(e=i,e.appendChild(s)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=Bf));else if(o!==4&&(s=s.child,s!==null))for(Vj(s,e,i),s=s.sibling;s!==null;)Vj(s,e,i),s=s.sibling}function Wj(s,e,i){var o=s.tag;if(o===5||o===6)s=s.stateNode,e?i.insertBefore(s,e):i.appendChild(s);else if(o!==4&&(s=s.child,s!==null))for(Wj(s,e,i),s=s.sibling;s!==null;)Wj(s,e,i),s=s.sibling}var X=null,Xj=!1;function Yj(s,e,i){for(i=i.child;i!==null;)Zj(s,e,i),i=i.sibling}function Zj(s,e,i){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,i)}catch{}switch(i.tag){case 5:U||Lj(i,e);case 6:var o=X,a=Xj;X=null,Yj(s,e,i),X=o,Xj=a,X!==null&&(Xj?(s=X,i=i.stateNode,s.nodeType===8?s.parentNode.removeChild(i):s.removeChild(i)):X.removeChild(i.stateNode));break;case 18:X!==null&&(Xj?(s=X,i=i.stateNode,s.nodeType===8?Kf(s.parentNode,i):s.nodeType===1&&Kf(s,i),bd(s)):Kf(X,i.stateNode));break;case 4:o=X,a=Xj,X=i.stateNode.containerInfo,Xj=!0,Yj(s,e,i),X=o,Xj=a;break;case 0:case 11:case 14:case 15:if(!U&&(o=i.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var j=a,_e=j.destroy;j=j.tag,_e!==void 0&&(j&2||j&4)&&Mj(i,e,_e),a=a.next}while(a!==o)}Yj(s,e,i);break;case 1:if(!U&&(Lj(i,e),o=i.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=i.memoizedProps,o.state=i.memoizedState,o.componentWillUnmount()}catch(tt){W(i,e,tt)}Yj(s,e,i);break;case 21:Yj(s,e,i);break;case 22:i.mode&1?(U=(o=U)||i.memoizedState!==null,Yj(s,e,i),U=o):Yj(s,e,i);break;default:Yj(s,e,i)}}function ak(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var i=s.stateNode;i===null&&(i=s.stateNode=new Kj),e.forEach(function(o){var a=bk.bind(null,s,o);i.has(o)||(i.add(o),o.then(a,a))})}}function ck(s,e){var i=e.deletions;if(i!==null)for(var o=0;o<i.length;o++){var a=i[o];try{var j=s,_e=e,tt=_e;e:for(;tt!==null;){switch(tt.tag){case 5:X=tt.stateNode,Xj=!1;break e;case 3:X=tt.stateNode.containerInfo,Xj=!0;break e;case 4:X=tt.stateNode.containerInfo,Xj=!0;break e}tt=tt.return}if(X===null)throw Error(p$1(160));Zj(j,_e,a),X=null,Xj=!1;var et=a.alternate;et!==null&&(et.return=null),a.return=null}catch(rt){W(a,e,rt)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,s),e=e.sibling}function dk(s,e){var i=s.alternate,o=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ck(e,s),ek(s),o&4){try{Pj(3,s,s.return),Qj(3,s)}catch(qt){W(s,s.return,qt)}try{Pj(5,s,s.return)}catch(qt){W(s,s.return,qt)}}break;case 1:ck(e,s),ek(s),o&512&&i!==null&&Lj(i,i.return);break;case 5:if(ck(e,s),ek(s),o&512&&i!==null&&Lj(i,i.return),s.flags&32){var a=s.stateNode;try{ob(a,"")}catch(qt){W(s,s.return,qt)}}if(o&4&&(a=s.stateNode,a!=null)){var j=s.memoizedProps,_e=i!==null?i.memoizedProps:j,tt=s.type,et=s.updateQueue;if(s.updateQueue=null,et!==null)try{tt==="input"&&j.type==="radio"&&j.name!=null&&ab(a,j),vb(tt,_e);var rt=vb(tt,j);for(_e=0;_e<et.length;_e+=2){var dt=et[_e],vt=et[_e+1];dt==="style"?sb(a,vt):dt==="dangerouslySetInnerHTML"?nb(a,vt):dt==="children"?ob(a,vt):ta(a,dt,vt,rt)}switch(tt){case"input":bb(a,j);break;case"textarea":ib(a,j);break;case"select":var Ct=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!j.multiple;var Wt=j.value;Wt!=null?fb(a,!!j.multiple,Wt,!1):Ct!==!!j.multiple&&(j.defaultValue!=null?fb(a,!!j.multiple,j.defaultValue,!0):fb(a,!!j.multiple,j.multiple?[]:"",!1))}a[Pf]=j}catch(qt){W(s,s.return,qt)}}break;case 6:if(ck(e,s),ek(s),o&4){if(s.stateNode===null)throw Error(p$1(162));a=s.stateNode,j=s.memoizedProps;try{a.nodeValue=j}catch(qt){W(s,s.return,qt)}}break;case 3:if(ck(e,s),ek(s),o&4&&i!==null&&i.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(qt){W(s,s.return,qt)}break;case 4:ck(e,s),ek(s);break;case 13:ck(e,s),ek(s),a=s.child,a.flags&8192&&(j=a.memoizedState!==null,a.stateNode.isHidden=j,!j||a.alternate!==null&&a.alternate.memoizedState!==null||(fk=B$2())),o&4&&ak(s);break;case 22:if(dt=i!==null&&i.memoizedState!==null,s.mode&1?(U=(rt=U)||dt,ck(e,s),U=rt):ck(e,s),ek(s),o&8192){if(rt=s.memoizedState!==null,(s.stateNode.isHidden=rt)&&!dt&&s.mode&1)for(V=s,dt=s.child;dt!==null;){for(vt=V=dt;V!==null;){switch(Ct=V,Wt=Ct.child,Ct.tag){case 0:case 11:case 14:case 15:Pj(4,Ct,Ct.return);break;case 1:Lj(Ct,Ct.return);var Bt=Ct.stateNode;if(typeof Bt.componentWillUnmount=="function"){o=Ct,i=Ct.return;try{e=o,Bt.props=e.memoizedProps,Bt.state=e.memoizedState,Bt.componentWillUnmount()}catch(qt){W(o,i,qt)}}break;case 5:Lj(Ct,Ct.return);break;case 22:if(Ct.memoizedState!==null){gk(vt);continue}}Wt!==null?(Wt.return=Ct,V=Wt):gk(vt)}dt=dt.sibling}e:for(dt=null,vt=s;;){if(vt.tag===5){if(dt===null){dt=vt;try{a=vt.stateNode,rt?(j=a.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none"):(tt=vt.stateNode,et=vt.memoizedProps.style,_e=et!=null&&et.hasOwnProperty("display")?et.display:null,tt.style.display=rb("display",_e))}catch(qt){W(s,s.return,qt)}}}else if(vt.tag===6){if(dt===null)try{vt.stateNode.nodeValue=rt?"":vt.memoizedProps}catch(qt){W(s,s.return,qt)}}else if((vt.tag!==22&&vt.tag!==23||vt.memoizedState===null||vt===s)&&vt.child!==null){vt.child.return=vt,vt=vt.child;continue}if(vt===s)break e;for(;vt.sibling===null;){if(vt.return===null||vt.return===s)break e;dt===vt&&(dt=null),vt=vt.return}dt===vt&&(dt=null),vt.sibling.return=vt.return,vt=vt.sibling}}break;case 19:ck(e,s),ek(s),o&4&&ak(s);break;case 21:break;default:ck(e,s),ek(s)}}function ek(s){var e=s.flags;if(e&2){try{e:{for(var i=s.return;i!==null;){if(Tj(i)){var o=i;break e}i=i.return}throw Error(p$1(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(ob(a,""),o.flags&=-33);var j=Uj(s);Wj(s,j,a);break;case 3:case 4:var _e=o.stateNode.containerInfo,tt=Uj(s);Vj(s,tt,_e);break;default:throw Error(p$1(161))}}catch(et){W(s,s.return,et)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function hk(s,e,i){V=s,ik(s)}function ik(s,e,i){for(var o=(s.mode&1)!==0;V!==null;){var a=V,j=a.child;if(a.tag===22&&o){var _e=a.memoizedState!==null||Jj;if(!_e){var tt=a.alternate,et=tt!==null&&tt.memoizedState!==null||U;tt=Jj;var rt=U;if(Jj=_e,(U=et)&&!rt)for(V=a;V!==null;)_e=V,et=_e.child,_e.tag===22&&_e.memoizedState!==null?jk(a):et!==null?(et.return=_e,V=et):jk(a);for(;j!==null;)V=j,ik(j),j=j.sibling;V=a,Jj=tt,U=rt}kk(s)}else a.subtreeFlags&8772&&j!==null?(j.return=a,V=j):kk(s)}}function kk(s){for(;V!==null;){var e=V;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!U)if(i===null)o.componentDidMount();else{var a=e.elementType===e.type?i.memoizedProps:Ci(e.type,i.memoizedProps);o.componentDidUpdate(a,i.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var j=e.updateQueue;j!==null&&sh(e,j,o);break;case 3:var _e=e.updateQueue;if(_e!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}sh(e,_e,i)}break;case 5:var tt=e.stateNode;if(i===null&&e.flags&4){i=tt;var et=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":et.autoFocus&&i.focus();break;case"img":et.src&&(i.src=et.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var rt=e.alternate;if(rt!==null){var dt=rt.memoizedState;if(dt!==null){var vt=dt.dehydrated;vt!==null&&bd(vt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||e.flags&512&&Rj(e)}catch(Ct){W(e,e.return,Ct)}}if(e===s){V=null;break}if(i=e.sibling,i!==null){i.return=e.return,V=i;break}V=e.return}}function gk(s){for(;V!==null;){var e=V;if(e===s){V=null;break}var i=e.sibling;if(i!==null){i.return=e.return,V=i;break}V=e.return}}function jk(s){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{Qj(4,e)}catch(et){W(e,i,et)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var a=e.return;try{o.componentDidMount()}catch(et){W(e,a,et)}}var j=e.return;try{Rj(e)}catch(et){W(e,j,et)}break;case 5:var _e=e.return;try{Rj(e)}catch(et){W(e,_e,et)}}}catch(et){W(e,e.return,et)}if(e===s){V=null;break}var tt=e.sibling;if(tt!==null){tt.return=e.return,V=tt;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q$2=null,Y=null,Z=0,fj=0,ej=Uf(0),T$1=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K&6?B$2():Ak!==-1?Ak:Ak=B$2()}function yi(s){return s.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(s=C$1,s!==0||(s=window.event,s=s===void 0?16:jd(s.type)),s):1}function gi(s,e,i,o){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(s,i,o),(!(K&2)||s!==Q$2)&&(s===Q$2&&(!(K&2)&&(qk|=i),T$1===4&&Ck(s,Z)),Dk(s,o),i===1&&K===0&&!(e.mode&1)&&(Gj=B$2()+500,fg&&jg()))}function Dk(s,e){var i=s.callbackNode;wc(s,e);var o=uc(s,s===Q$2?Z:0);if(o===0)i!==null&&bc(i),s.callbackNode=null,s.callbackPriority=0;else if(e=o&-o,s.callbackPriority!==e){if(i!=null&&bc(i),e===1)s.tag===0?ig(Ek.bind(null,s)):hg(Ek.bind(null,s)),Jf(function(){!(K&6)&&jg()}),i=null;else{switch(Dc(o)){case 1:i=fc;break;case 4:i=gc;break;case 16:i=hc;break;case 536870912:i=jc;break;default:i=hc}i=Fk(i,Gk.bind(null,s))}s.callbackPriority=e,s.callbackNode=i}}function Gk(s,e){if(Ak=-1,Bk=0,K&6)throw Error(p$1(327));var i=s.callbackNode;if(Hk()&&s.callbackNode!==i)return null;var o=uc(s,s===Q$2?Z:0);if(o===0)return null;if(o&30||o&s.expiredLanes||e)e=Ik(s,o);else{e=o;var a=K;K|=2;var j=Jk();(Q$2!==s||Z!==e)&&(uk=null,Gj=B$2()+500,Kk(s,e));do try{Lk();break}catch(tt){Mk(s,tt)}while(!0);$g(),mk.current=j,K=a,Y!==null?e=0:(Q$2=null,Z=0,e=T$1)}if(e!==0){if(e===2&&(a=xc(s),a!==0&&(o=a,e=Nk(s,a))),e===1)throw i=pk,Kk(s,0),Ck(s,o),Dk(s,B$2()),i;if(e===6)Ck(s,o);else{if(a=s.current.alternate,!(o&30)&&!Ok(a)&&(e=Ik(s,o),e===2&&(j=xc(s),j!==0&&(o=j,e=Nk(s,j))),e===1))throw i=pk,Kk(s,0),Ck(s,o),Dk(s,B$2()),i;switch(s.finishedWork=a,s.finishedLanes=o,e){case 0:case 1:throw Error(p$1(345));case 2:Pk(s,tk,uk);break;case 3:if(Ck(s,o),(o&130023424)===o&&(e=fk+500-B$2(),10<e)){if(uc(s,0)!==0)break;if(a=s.suspendedLanes,(a&o)!==o){R$1(),s.pingedLanes|=s.suspendedLanes&a;break}s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),e);break}Pk(s,tk,uk);break;case 4:if(Ck(s,o),(o&4194240)===o)break;for(e=s.eventTimes,a=-1;0<o;){var _e=31-oc(o);j=1<<_e,_e=e[_e],_e>a&&(a=_e),o&=~j}if(o=a,o=B$2()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*lk(o/1960))-o,10<o){s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),o);break}Pk(s,tk,uk);break;case 5:Pk(s,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(s,B$2()),s.callbackNode===i?Gk.bind(null,s):null}function Nk(s,e){var i=sk;return s.current.memoizedState.isDehydrated&&(Kk(s,e).flags|=256),s=Ik(s,e),s!==2&&(e=tk,tk=i,e!==null&&Fj(e)),s}function Fj(s){tk===null?tk=s:tk.push.apply(tk,s)}function Ok(s){for(var e=s;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var o=0;o<i.length;o++){var a=i[o],j=a.getSnapshot;a=a.value;try{if(!He(j(),a))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(s,e){for(e&=~rk,e&=~qk,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var i=31-oc(e),o=1<<i;s[i]=-1,e&=~o}}function Ek(s){if(K&6)throw Error(p$1(327));Hk();var e=uc(s,0);if(!(e&1))return Dk(s,B$2()),null;var i=Ik(s,e);if(s.tag!==0&&i===2){var o=xc(s);o!==0&&(e=o,i=Nk(s,o))}if(i===1)throw i=pk,Kk(s,0),Ck(s,e),Dk(s,B$2()),i;if(i===6)throw Error(p$1(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,Pk(s,tk,uk),Dk(s,B$2()),null}function Qk(s,e){var i=K;K|=1;try{return s(e)}finally{K=i,K===0&&(Gj=B$2()+500,fg&&jg())}}function Rk(s){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var i=ok.transition,o=C$1;try{if(ok.transition=null,C$1=1,s)return s()}finally{C$1=o,ok.transition=i,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(s,e){s.finishedWork=null,s.finishedLanes=0;var i=s.timeoutHandle;if(i!==-1&&(s.timeoutHandle=-1,Gf(i)),Y!==null)for(i=Y.return;i!==null;){var o=i;switch(wg(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H$1),Eh();break;case 5:Bh(o);break;case 4:zh();break;case 13:E$1(L$2);break;case 19:E$1(L$2);break;case 10:ah(o.type._context);break;case 22:case 23:Hj()}i=i.return}if(Q$2=s,Y=s=Pg(s.current,null),Z=fj=e,T$1=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(i=fh[e],o=i.interleaved,o!==null){i.interleaved=null;var a=o.next,j=i.pending;if(j!==null){var _e=j.next;j.next=a,o.next=_e}i.pending=o}fh=null}return s}function Mk(s,e){do{var i=Y;try{if($g(),Fh.current=Rh,Ih){for(var o=M$2.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}Ih=!1}if(Hh=0,O$2=N$2=M$2=null,Jh=!1,Kh=0,nk.current=null,i===null||i.return===null){T$1=1,pk=e,Y=null;break}e:{var j=s,_e=i.return,tt=i,et=e;if(e=Z,tt.flags|=32768,et!==null&&typeof et=="object"&&typeof et.then=="function"){var rt=et,dt=tt,vt=dt.tag;if(!(dt.mode&1)&&(vt===0||vt===11||vt===15)){var Ct=dt.alternate;Ct?(dt.updateQueue=Ct.updateQueue,dt.memoizedState=Ct.memoizedState,dt.lanes=Ct.lanes):(dt.updateQueue=null,dt.memoizedState=null)}var Wt=Ui(_e);if(Wt!==null){Wt.flags&=-257,Vi(Wt,_e,tt,j,e),Wt.mode&1&&Si(j,rt,e),e=Wt,et=rt;var Bt=e.updateQueue;if(Bt===null){var qt=new Set;qt.add(et),e.updateQueue=qt}else Bt.add(et);break e}else{if(!(e&1)){Si(j,rt,e),tj();break e}et=Error(p$1(426))}}else if(I$1&&tt.mode&1){var Ut=Ui(_e);if(Ut!==null){!(Ut.flags&65536)&&(Ut.flags|=256),Vi(Ut,_e,tt,j,e),Jg(Ji(et,tt));break e}}j=et=Ji(et,tt),T$1!==4&&(T$1=2),sk===null?sk=[j]:sk.push(j),j=_e;do{switch(j.tag){case 3:j.flags|=65536,e&=-e,j.lanes|=e;var kt=Ni(j,et,e);ph(j,kt);break e;case 1:tt=et;var Nt=j.type,un=j.stateNode;if(!(j.flags&128)&&(typeof Nt.getDerivedStateFromError=="function"||un!==null&&typeof un.componentDidCatch=="function"&&(Ri===null||!Ri.has(un)))){j.flags|=65536,e&=-e,j.lanes|=e;var dn=Qi(j,tt,e);ph(j,dn);break e}}j=j.return}while(j!==null)}Sk(i)}catch(hn){e=hn,Y===i&&i!==null&&(Y=i=i.return);continue}break}while(!0)}function Jk(){var s=mk.current;return mk.current=Rh,s===null?Rh:s}function tj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),Q$2===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q$2,Z)}function Ik(s,e){var i=K;K|=2;var o=Jk();(Q$2!==s||Z!==e)&&(uk=null,Kk(s,e));do try{Tk();break}catch(a){Mk(s,a)}while(!0);if($g(),K=i,mk.current=o,Y!==null)throw Error(p$1(261));return Q$2=null,Z=0,T$1}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(s){var e=Vk(s.alternate,s,fj);s.memoizedProps=s.pendingProps,e===null?Sk(s):Y=e,nk.current=null}function Sk(s){var e=s;do{var i=e.alternate;if(s=e.return,e.flags&32768){if(i=Ij(i,e),i!==null){i.flags&=32767,Y=i;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{T$1=6,Y=null;return}}else if(i=Ej(i,e,fj),i!==null){Y=i;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=s}while(e!==null);T$1===0&&(T$1=5)}function Pk(s,e,i){var o=C$1,a=ok.transition;try{ok.transition=null,C$1=1,Wk(s,e,i,o)}finally{ok.transition=a,C$1=o}return null}function Wk(s,e,i,o){do Hk();while(wk!==null);if(K&6)throw Error(p$1(327));i=s.finishedWork;var a=s.finishedLanes;if(i===null)return null;if(s.finishedWork=null,s.finishedLanes=0,i===s.current)throw Error(p$1(177));s.callbackNode=null,s.callbackPriority=0;var j=i.lanes|i.childLanes;if(Bc(s,j),s===Q$2&&(Y=Q$2=null,Z=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),j=(i.flags&15990)!==0,i.subtreeFlags&15990||j){j=ok.transition,ok.transition=null;var _e=C$1;C$1=1;var tt=K;K|=4,nk.current=null,Oj(s,i),dk(i,s),Oe(Df),dd=!!Cf,Df=Cf=null,s.current=i,hk(i),dc(),K=tt,C$1=_e,ok.transition=j}else s.current=i;if(vk&&(vk=!1,wk=s,xk=a),j=s.pendingLanes,j===0&&(Ri=null),mc(i.stateNode),Dk(s,B$2()),e!==null)for(o=s.onRecoverableError,i=0;i<e.length;i++)a=e[i],o(a.value,{componentStack:a.stack,digest:a.digest});if(Oi)throw Oi=!1,s=Pi,Pi=null,s;return xk&1&&s.tag!==0&&Hk(),j=s.pendingLanes,j&1?s===zk?yk++:(yk=0,zk=s):yk=0,jg(),null}function Hk(){if(wk!==null){var s=Dc(xk),e=ok.transition,i=C$1;try{if(ok.transition=null,C$1=16>s?16:s,wk===null)var o=!1;else{if(s=wk,wk=null,xk=0,K&6)throw Error(p$1(331));var a=K;for(K|=4,V=s.current;V!==null;){var j=V,_e=j.child;if(V.flags&16){var tt=j.deletions;if(tt!==null){for(var et=0;et<tt.length;et++){var rt=tt[et];for(V=rt;V!==null;){var dt=V;switch(dt.tag){case 0:case 11:case 15:Pj(8,dt,j)}var vt=dt.child;if(vt!==null)vt.return=dt,V=vt;else for(;V!==null;){dt=V;var Ct=dt.sibling,Wt=dt.return;if(Sj(dt),dt===rt){V=null;break}if(Ct!==null){Ct.return=Wt,V=Ct;break}V=Wt}}}var Bt=j.alternate;if(Bt!==null){var qt=Bt.child;if(qt!==null){Bt.child=null;do{var Ut=qt.sibling;qt.sibling=null,qt=Ut}while(qt!==null)}}V=j}}if(j.subtreeFlags&2064&&_e!==null)_e.return=j,V=_e;else e:for(;V!==null;){if(j=V,j.flags&2048)switch(j.tag){case 0:case 11:case 15:Pj(9,j,j.return)}var kt=j.sibling;if(kt!==null){kt.return=j.return,V=kt;break e}V=j.return}}var Nt=s.current;for(V=Nt;V!==null;){_e=V;var un=_e.child;if(_e.subtreeFlags&2064&&un!==null)un.return=_e,V=un;else e:for(_e=Nt;V!==null;){if(tt=V,tt.flags&2048)try{switch(tt.tag){case 0:case 11:case 15:Qj(9,tt)}}catch(hn){W(tt,tt.return,hn)}if(tt===_e){V=null;break e}var dn=tt.sibling;if(dn!==null){dn.return=tt.return,V=dn;break e}V=tt.return}}if(K=a,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,s)}catch{}o=!0}return o}finally{C$1=i,ok.transition=e}}return!1}function Xk(s,e,i){e=Ji(i,e),e=Ni(s,e,1),s=nh(s,e,1),e=R$1(),s!==null&&(Ac(s,1,e),Dk(s,e))}function W(s,e,i){if(s.tag===3)Xk(s,s,i);else for(;e!==null;){if(e.tag===3){Xk(e,s,i);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ri===null||!Ri.has(o))){s=Ji(i,s),s=Qi(e,s,1),e=nh(e,s,1),s=R$1(),e!==null&&(Ac(e,1,s),Dk(e,s));break}}e=e.return}}function Ti(s,e,i){var o=s.pingCache;o!==null&&o.delete(e),e=R$1(),s.pingedLanes|=s.suspendedLanes&i,Q$2===s&&(Z&i)===i&&(T$1===4||T$1===3&&(Z&130023424)===Z&&500>B$2()-fk?Kk(s,0):rk|=i),Dk(s,e)}function Yk(s,e){e===0&&(s.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var i=R$1();s=ih(s,e),s!==null&&(Ac(s,e,i),Dk(s,i))}function uj(s){var e=s.memoizedState,i=0;e!==null&&(i=e.retryLane),Yk(s,i)}function bk(s,e){var i=0;switch(s.tag){case 13:var o=s.stateNode,a=s.memoizedState;a!==null&&(i=a.retryLane);break;case 19:o=s.stateNode;break;default:throw Error(p$1(314))}o!==null&&o.delete(e),Yk(s,i)}var Vk;Vk=function(s,e,i){if(s!==null)if(s.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(s.lanes&i)&&!(e.flags&128))return dh=!1,yj(s,e,i);dh=!!(s.flags&131072)}else dh=!1,I$1&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;ij(s,e),s=e.pendingProps;var a=Yf(e,H$1.current);ch(e,i),a=Nh(null,e,o,s,a,i);var j=Sh();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(o)?(j=!0,cg(e)):j=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,kh(e),a.updater=Ei,e.stateNode=a,a._reactInternals=e,Ii(e,o,s,i),e=jj(null,e,o,!0,j,i)):(e.tag=0,I$1&&j&&vg(e),Xi(null,e,a,i),e=e.child),e;case 16:o=e.elementType;e:{switch(ij(s,e),s=e.pendingProps,a=o._init,o=a(o._payload),e.type=o,a=e.tag=Zk(o),s=Ci(o,s),a){case 0:e=cj(null,e,o,s,i);break e;case 1:e=hj(null,e,o,s,i);break e;case 11:e=Yi(null,e,o,s,i);break e;case 14:e=$i(null,e,o,Ci(o.type,s),i);break e}throw Error(p$1(306,o,""))}return e;case 0:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),cj(s,e,o,a,i);case 1:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),hj(s,e,o,a,i);case 3:e:{if(kj(e),s===null)throw Error(p$1(387));o=e.pendingProps,j=e.memoizedState,a=j.element,lh(s,e),qh(e,o,null,i);var _e=e.memoizedState;if(o=_e.element,j.isDehydrated)if(j={element:o,isDehydrated:!1,cache:_e.cache,pendingSuspenseBoundaries:_e.pendingSuspenseBoundaries,transitions:_e.transitions},e.updateQueue.baseState=j,e.memoizedState=j,e.flags&256){a=Ji(Error(p$1(423)),e),e=lj(s,e,o,i,a);break e}else if(o!==a){a=Ji(Error(p$1(424)),e),e=lj(s,e,o,i,a);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I$1=!0,zg=null,i=Vg(e,null,o,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ig(),o===a){e=Zi(s,e,i);break e}Xi(s,e,o,i)}e=e.child}return e;case 5:return Ah(e),s===null&&Eg(e),o=e.type,a=e.pendingProps,j=s!==null?s.memoizedProps:null,_e=a.children,Ef(o,a)?_e=null:j!==null&&Ef(o,j)&&(e.flags|=32),gj(s,e),Xi(s,e,_e,i),e.child;case 6:return s===null&&Eg(e),null;case 13:return oj(s,e,i);case 4:return yh(e,e.stateNode.containerInfo),o=e.pendingProps,s===null?e.child=Ug(e,null,o,i):Xi(s,e,o,i),e.child;case 11:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),Yi(s,e,o,a,i);case 7:return Xi(s,e,e.pendingProps,i),e.child;case 8:return Xi(s,e,e.pendingProps.children,i),e.child;case 12:return Xi(s,e,e.pendingProps.children,i),e.child;case 10:e:{if(o=e.type._context,a=e.pendingProps,j=e.memoizedProps,_e=a.value,G$1(Wg,o._currentValue),o._currentValue=_e,j!==null)if(He(j.value,_e)){if(j.children===a.children&&!Wf.current){e=Zi(s,e,i);break e}}else for(j=e.child,j!==null&&(j.return=e);j!==null;){var tt=j.dependencies;if(tt!==null){_e=j.child;for(var et=tt.firstContext;et!==null;){if(et.context===o){if(j.tag===1){et=mh(-1,i&-i),et.tag=2;var rt=j.updateQueue;if(rt!==null){rt=rt.shared;var dt=rt.pending;dt===null?et.next=et:(et.next=dt.next,dt.next=et),rt.pending=et}}j.lanes|=i,et=j.alternate,et!==null&&(et.lanes|=i),bh(j.return,i,e),tt.lanes|=i;break}et=et.next}}else if(j.tag===10)_e=j.type===e.type?null:j.child;else if(j.tag===18){if(_e=j.return,_e===null)throw Error(p$1(341));_e.lanes|=i,tt=_e.alternate,tt!==null&&(tt.lanes|=i),bh(_e,i,e),_e=j.sibling}else _e=j.child;if(_e!==null)_e.return=j;else for(_e=j;_e!==null;){if(_e===e){_e=null;break}if(j=_e.sibling,j!==null){j.return=_e.return,_e=j;break}_e=_e.return}j=_e}Xi(s,e,a.children,i),e=e.child}return e;case 9:return a=e.type,o=e.pendingProps.children,ch(e,i),a=eh(a),o=o(a),e.flags|=1,Xi(s,e,o,i),e.child;case 14:return o=e.type,a=Ci(o,e.pendingProps),a=Ci(o.type,a),$i(s,e,o,a,i);case 15:return bj(s,e,e.type,e.pendingProps,i);case 17:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),ij(s,e),e.tag=1,Zf(o)?(s=!0,cg(e)):s=!1,ch(e,i),Gi(e,o,a),Ii(e,o,a,i),jj(null,e,o,!0,s,i);case 19:return xj(s,e,i);case 22:return dj(s,e,i)}throw Error(p$1(156,e.tag))};function Fk(s,e){return ac(s,e)}function $k(s,e,i,o){this.tag=s,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(s,e,i,o){return new $k(s,e,i,o)}function aj(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return aj(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Da)return 11;if(s===Ga)return 14}return 2}function Pg(s,e){var i=s.alternate;return i===null?(i=Bg(s.tag,e,s.key,s.mode),i.elementType=s.elementType,i.type=s.type,i.stateNode=s.stateNode,i.alternate=s,s.alternate=i):(i.pendingProps=e,i.type=s.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=s.flags&14680064,i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=s.sibling,i.index=s.index,i.ref=s.ref,i}function Rg(s,e,i,o,a,j){var _e=2;if(o=s,typeof s=="function")aj(s)&&(_e=1);else if(typeof s=="string")_e=5;else e:switch(s){case ya:return Tg(i.children,a,j,e);case za:_e=8,a|=8;break;case Aa:return s=Bg(12,i,e,a|2),s.elementType=Aa,s.lanes=j,s;case Ea:return s=Bg(13,i,e,a),s.elementType=Ea,s.lanes=j,s;case Fa:return s=Bg(19,i,e,a),s.elementType=Fa,s.lanes=j,s;case Ia:return pj(i,a,j,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Ba:_e=10;break e;case Ca:_e=9;break e;case Da:_e=11;break e;case Ga:_e=14;break e;case Ha:_e=16,o=null;break e}throw Error(p$1(130,s==null?s:typeof s,""))}return e=Bg(_e,i,e,a),e.elementType=s,e.type=o,e.lanes=j,e}function Tg(s,e,i,o){return s=Bg(7,s,o,e),s.lanes=i,s}function pj(s,e,i,o){return s=Bg(22,s,o,e),s.elementType=Ia,s.lanes=i,s.stateNode={isHidden:!1},s}function Qg(s,e,i){return s=Bg(6,s,null,e),s.lanes=i,s}function Sg(s,e,i){return e=Bg(4,s.children!==null?s.children:[],s.key,e),e.lanes=i,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function al(s,e,i,o,a){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function bl(s,e,i,o,a,j,_e,tt,et){return s=new al(s,e,i,tt,et),e===1?(e=1,j===!0&&(e|=8)):e=0,j=Bg(3,null,null,e),s.current=j,j.stateNode=s,j.memoizedState={element:o,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(j),s}function cl(s,e,i){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:o==null?null:""+o,children:s,containerInfo:e,implementation:i}}function dl(s){if(!s)return Vf;s=s._reactInternals;e:{if(Vb(s)!==s||s.tag!==1)throw Error(p$1(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p$1(171))}if(s.tag===1){var i=s.type;if(Zf(i))return bg(s,i,e)}return e}function el(s,e,i,o,a,j,_e,tt,et){return s=bl(i,o,!0,s,a,j,_e,tt,et),s.context=dl(null),i=s.current,o=R$1(),a=yi(i),j=mh(o,a),j.callback=e??null,nh(i,j,a),s.current.lanes=a,Ac(s,a,o),Dk(s,o),s}function fl(s,e,i,o){var a=e.current,j=R$1(),_e=yi(a);return i=dl(i),e.context===null?e.context=i:e.pendingContext=i,e=mh(j,_e),e.payload={element:s},o=o===void 0?null:o,o!==null&&(e.callback=o),s=nh(a,e,_e),s!==null&&(gi(s,a,_e,j),oh(s,a,_e)),_e}function gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hl(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var i=s.retryLane;s.retryLane=i!==0&&i<e?i:e}}function il(s,e){hl(s,e),(s=s.alternate)&&hl(s,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(s){console.error(s)};function ll(s){this._internalRoot=s}ml.prototype.render=ll.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(p$1(409));fl(s,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;Rk(function(){fl(null,s,null,null)}),e[uf]=null}};function ml(s){this._internalRoot=s}ml.prototype.unstable_scheduleHydration=function(s){if(s){var e=Hc();s={blockedOn:null,target:s,priority:e};for(var i=0;i<Qc.length&&e!==0&&e<Qc[i].priority;i++);Qc.splice(i,0,s),i===0&&Vc(s)}};function nl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ol(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(s,e,i,o,a){if(a){if(typeof o=="function"){var j=o;o=function(){var rt=gl(_e);j.call(rt)}}var _e=el(e,o,s,0,null,!1,!1,"",pl);return s._reactRootContainer=_e,s[uf]=_e.current,sf(s.nodeType===8?s.parentNode:s),Rk(),_e}for(;a=s.lastChild;)s.removeChild(a);if(typeof o=="function"){var tt=o;o=function(){var rt=gl(et);tt.call(rt)}}var et=bl(s,0,!1,null,null,!1,!1,"",pl);return s._reactRootContainer=et,s[uf]=et.current,sf(s.nodeType===8?s.parentNode:s),Rk(function(){fl(e,et,i,o)}),et}function rl(s,e,i,o,a){var j=i._reactRootContainer;if(j){var _e=j;if(typeof a=="function"){var tt=a;a=function(){var et=gl(_e);tt.call(et)}}fl(e,_e,s,a)}else _e=ql(i,e,s,a,o);return gl(_e)}Ec=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var i=tc(e.pendingLanes);i!==0&&(Cc(e,i|1),Dk(e,B$2()),!(K&6)&&(Gj=B$2()+500,jg()))}break;case 13:Rk(function(){var o=ih(s,1);if(o!==null){var a=R$1();gi(o,s,1,a)}}),il(s,1)}};Fc=function(s){if(s.tag===13){var e=ih(s,134217728);if(e!==null){var i=R$1();gi(e,s,134217728,i)}il(s,134217728)}};Gc=function(s){if(s.tag===13){var e=yi(s),i=ih(s,e);if(i!==null){var o=R$1();gi(i,s,e,o)}il(s,e)}};Hc=function(){return C$1};Ic=function(s,e){var i=C$1;try{return C$1=s,e()}finally{C$1=i}};yb=function(s,e,i){switch(e){case"input":if(bb(s,i),e=i.name,i.type==="radio"&&e!=null){for(i=s;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var o=i[e];if(o!==s&&o.form===s.form){var a=Db(o);if(!a)throw Error(p$1(90));Wa(o),bb(o,a)}}}break;case"textarea":ib(s,i);break;case"select":e=i.value,e!=null&&fb(s,!!i.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Zb(s),s===null?null:s.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(s,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p$1(200));return cl(s,e,null,i)};reactDom_production_min.createRoot=function(s,e){if(!nl(s))throw Error(p$1(299));var i=!1,o="",a=kl;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=bl(s,1,!1,null,null,i,!1,o,a),s[uf]=e.current,sf(s.nodeType===8?s.parentNode:s),new ll(e)};reactDom_production_min.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(p$1(188)):(s=Object.keys(s).join(","),Error(p$1(268,s)));return s=Zb(e),s=s===null?null:s.stateNode,s};reactDom_production_min.flushSync=function(s){return Rk(s)};reactDom_production_min.hydrate=function(s,e,i){if(!ol(e))throw Error(p$1(200));return rl(null,s,e,!0,i)};reactDom_production_min.hydrateRoot=function(s,e,i){if(!nl(s))throw Error(p$1(405));var o=i!=null&&i.hydratedSources||null,a=!1,j="",_e=kl;if(i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(j=i.identifierPrefix),i.onRecoverableError!==void 0&&(_e=i.onRecoverableError)),e=el(e,null,s,1,i??null,a,!1,j,_e),s[uf]=e.current,sf(s),o)for(s=0;s<o.length;s++)i=o[s],a=i._getVersion,a=a(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,a]:e.mutableSourceEagerHydrationData.push(i,a);return new ml(e)};reactDom_production_min.render=function(s,e,i){if(!ol(e))throw Error(p$1(200));return rl(null,s,e,!1,i)};reactDom_production_min.unmountComponentAtNode=function(s){if(!ol(s))throw Error(p$1(40));return s._reactRootContainer?(Rk(function(){rl(null,null,s,!1,function(){s._reactRootContainer=null,s[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(s,e,i,o){if(!ol(i))throw Error(p$1(200));if(s==null||s._reactInternals===void 0)throw Error(p$1(38));return rl(s,e,i,!1,o)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(s){console.error(s)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(s[o]=i[o])}return s},_extends$2.apply(this,arguments)}var Action;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(s){s===void 0&&(s={});function e(o,a){let{pathname:j,search:_e,hash:tt}=o.location;return createLocation("",{pathname:j,search:_e,hash:tt},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function i(o,a){return typeof a=="string"?a:createPath(a)}return getUrlBasedHistory(e,i,null,s)}function invariant$1(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function warning$2(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(s,e){return{usr:s.state,key:s.key,idx:e}}function createLocation(s,e,i,o){return i===void 0&&(i=null),_extends$2({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:i,key:e&&e.key||o||createKey()})}function createPath(s){let{pathname:e="/",search:i="",hash:o=""}=s;return i&&i!=="?"&&(e+=i.charAt(0)==="?"?i:"?"+i),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function parsePath(s){let e={};if(s){let i=s.indexOf("#");i>=0&&(e.hash=s.substr(i),s=s.substr(0,i));let o=s.indexOf("?");o>=0&&(e.search=s.substr(o),s=s.substr(0,o)),s&&(e.pathname=s)}return e}function getUrlBasedHistory(s,e,i,o){o===void 0&&(o={});let{window:a=document.defaultView,v5Compat:j=!1}=o,_e=a.history,tt=Action.Pop,et=null,rt=dt();rt==null&&(rt=0,_e.replaceState(_extends$2({},_e.state,{idx:rt}),""));function dt(){return(_e.state||{idx:null}).idx}function vt(){tt=Action.Pop;let Ut=dt(),kt=Ut==null?null:Ut-rt;rt=Ut,et&&et({action:tt,location:qt.location,delta:kt})}function Ct(Ut,kt){tt=Action.Push;let Nt=createLocation(qt.location,Ut,kt);rt=dt()+1;let un=getHistoryState(Nt,rt),dn=qt.createHref(Nt);try{_e.pushState(un,"",dn)}catch(hn){if(hn instanceof DOMException&&hn.name==="DataCloneError")throw hn;a.location.assign(dn)}j&&et&&et({action:tt,location:qt.location,delta:1})}function Wt(Ut,kt){tt=Action.Replace;let Nt=createLocation(qt.location,Ut,kt);rt=dt();let un=getHistoryState(Nt,rt),dn=qt.createHref(Nt);_e.replaceState(un,"",dn),j&&et&&et({action:tt,location:qt.location,delta:0})}function Bt(Ut){let kt=a.location.origin!=="null"?a.location.origin:a.location.href,Nt=typeof Ut=="string"?Ut:createPath(Ut);return Nt=Nt.replace(/ $/,"%20"),invariant$1(kt,"No window.location.(origin|href) available to create URL for href: "+Nt),new URL(Nt,kt)}let qt={get action(){return tt},get location(){return s(a,_e)},listen(Ut){if(et)throw new Error("A history only accepts one active listener");return a.addEventListener(PopStateEventType,vt),et=Ut,()=>{a.removeEventListener(PopStateEventType,vt),et=null}},createHref(Ut){return e(a,Ut)},createURL:Bt,encodeLocation(Ut){let kt=Bt(Ut);return{pathname:kt.pathname,search:kt.search,hash:kt.hash}},push:Ct,replace:Wt,go(Ut){return _e.go(Ut)}};return qt}var ResultType;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(ResultType||(ResultType={}));function matchRoutes(s,e,i){return i===void 0&&(i="/"),matchRoutesImpl(s,e,i)}function matchRoutesImpl(s,e,i,o){let a=typeof e=="string"?parsePath(e):e,j=stripBasename(a.pathname||"/",i);if(j==null)return null;let _e=flattenRoutes(s);rankRouteBranches(_e);let tt=null;for(let et=0;tt==null&&et<_e.length;++et){let rt=decodePath(j);tt=matchRouteBranch(_e[et],rt)}return tt}function flattenRoutes(s,e,i,o){e===void 0&&(e=[]),i===void 0&&(i=[]),o===void 0&&(o="");let a=(j,_e,tt)=>{let et={relativePath:tt===void 0?j.path||"":tt,caseSensitive:j.caseSensitive===!0,childrenIndex:_e,route:j};et.relativePath.startsWith("/")&&(invariant$1(et.relativePath.startsWith(o),'Absolute route path "'+et.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),et.relativePath=et.relativePath.slice(o.length));let rt=joinPaths([o,et.relativePath]),dt=i.concat(et);j.children&&j.children.length>0&&(invariant$1(j.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+rt+'".')),flattenRoutes(j.children,e,dt,rt)),!(j.path==null&&!j.index)&&e.push({path:rt,score:computeScore(rt,j.index),routesMeta:dt})};return s.forEach((j,_e)=>{var tt;if(j.path===""||!((tt=j.path)!=null&&tt.includes("?")))a(j,_e);else for(let et of explodeOptionalSegments(j.path))a(j,_e,et)}),e}function explodeOptionalSegments(s){let e=s.split("/");if(e.length===0)return[];let[i,...o]=e,a=i.endsWith("?"),j=i.replace(/\?$/,"");if(o.length===0)return a?[j,""]:[j];let _e=explodeOptionalSegments(o.join("/")),tt=[];return tt.push(..._e.map(et=>et===""?j:[j,et].join("/"))),a&&tt.push(..._e),tt.map(et=>s.startsWith("/")&&et===""?"/":et)}function rankRouteBranches(s){s.sort((e,i)=>e.score!==i.score?i.score-e.score:compareIndexes(e.routesMeta.map(o=>o.childrenIndex),i.routesMeta.map(o=>o.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,e){let i=s.split("/"),o=i.length;return i.some(isSplat)&&(o+=splatPenalty),e&&(o+=indexRouteValue),i.filter(a=>!isSplat(a)).reduce((a,j)=>a+(paramRe.test(j)?dynamicSegmentValue:j===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(s,e){return s.length===e.length&&s.slice(0,-1).every((o,a)=>o===e[a])?s[s.length-1]-e[e.length-1]:0}function matchRouteBranch(s,e,i){let{routesMeta:o}=s,a={},j="/",_e=[];for(let tt=0;tt<o.length;++tt){let et=o[tt],rt=tt===o.length-1,dt=j==="/"?e:e.slice(j.length)||"/",vt=matchPath({path:et.relativePath,caseSensitive:et.caseSensitive,end:rt},dt),Ct=et.route;if(!vt)return null;Object.assign(a,vt.params),_e.push({params:a,pathname:joinPaths([j,vt.pathname]),pathnameBase:normalizePathname(joinPaths([j,vt.pathnameBase])),route:Ct}),vt.pathnameBase!=="/"&&(j=joinPaths([j,vt.pathnameBase]))}return _e}function matchPath(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[i,o]=compilePath(s.path,s.caseSensitive,s.end),a=e.match(i);if(!a)return null;let j=a[0],_e=j.replace(/(.)\/+$/,"$1"),tt=a.slice(1);return{params:o.reduce((rt,dt,vt)=>{let{paramName:Ct,isOptional:Wt}=dt;if(Ct==="*"){let qt=tt[vt]||"";_e=j.slice(0,j.length-qt.length).replace(/(.)\/+$/,"$1")}const Bt=tt[vt];return Wt&&!Bt?rt[Ct]=void 0:rt[Ct]=(Bt||"").replace(/%2F/g,"/"),rt},{}),pathname:j,pathnameBase:_e,pattern:s}}function compilePath(s,e,i){e===void 0&&(e=!1),i===void 0&&(i=!0),warning$2(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let o=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_e,tt,et)=>(o.push({paramName:tt,isOptional:et!=null}),et?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(o.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),o]}function decodePath(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning$2(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function stripBasename(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,o=s.charAt(i);return o&&o!=="/"?null:s.slice(i)||"/"}function resolvePath(s,e){e===void 0&&(e="/");let{pathname:i,search:o="",hash:a=""}=typeof s=="string"?parsePath(s):s;return{pathname:i?i.startsWith("/")?i:resolvePathname(i,e):e,search:normalizeSearch(o),hash:normalizeHash(a)}}function resolvePathname(s,e){let i=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?i.length>1&&i.pop():a!=="."&&i.push(a)}),i.length>1?i.join("/"):"/"}function getInvalidPathError(s,e,i,o){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(s){return s.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(s,e){let i=getPathContributingMatches(s);return e?i.map((o,a)=>a===i.length-1?o.pathname:o.pathnameBase):i.map(o=>o.pathnameBase)}function resolveTo(s,e,i,o){o===void 0&&(o=!1);let a;typeof s=="string"?a=parsePath(s):(a=_extends$2({},s),invariant$1(!a.pathname||!a.pathname.includes("?"),getInvalidPathError("?","pathname","search",a)),invariant$1(!a.pathname||!a.pathname.includes("#"),getInvalidPathError("#","pathname","hash",a)),invariant$1(!a.search||!a.search.includes("#"),getInvalidPathError("#","search","hash",a)));let j=s===""||a.pathname==="",_e=j?"/":a.pathname,tt;if(_e==null)tt=i;else{let vt=e.length-1;if(!o&&_e.startsWith("..")){let Ct=_e.split("/");for(;Ct[0]==="..";)Ct.shift(),vt-=1;a.pathname=Ct.join("/")}tt=vt>=0?e[vt]:"/"}let et=resolvePath(a,tt),rt=_e&&_e!=="/"&&_e.endsWith("/"),dt=(j||_e===".")&&i.endsWith("/");return!et.pathname.endsWith("/")&&(rt||dt)&&(et.pathname+="/"),et}const joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(s[o]=i[o])}return s},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(s,e){let{relative:i}=e===void 0?{}:e;useInRouterContext()||invariant$1(!1);let{basename:o,navigator:a}=reactExports.useContext(NavigationContext),{hash:j,pathname:_e,search:tt}=useResolvedPath(s,{relative:i}),et=_e;return o!=="/"&&(et=_e==="/"?o:joinPaths([o,_e])),a.createHref({pathname:et,search:tt,hash:j})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$1(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant$1(!1);let s=reactExports.useContext(DataRouterContext),{basename:e,future:i,navigator:o}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:j}=useLocation(),_e=JSON.stringify(getResolveToMatches(a,i.v7_relativeSplatPath)),tt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{tt.current=!0}),reactExports.useCallback(function(rt,dt){if(dt===void 0&&(dt={}),!tt.current)return;if(typeof rt=="number"){o.go(rt);return}let vt=resolveTo(rt,JSON.parse(_e),j,dt.relative==="path");s==null&&e!=="/"&&(vt.pathname=vt.pathname==="/"?e:joinPaths([e,vt.pathname])),(dt.replace?o.replace:o.push)(vt,dt.state,dt)},[e,o,_e,j,s])}function useResolvedPath(s,e){let{relative:i}=e===void 0?{}:e,{future:o}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:j}=useLocation(),_e=JSON.stringify(getResolveToMatches(a,o.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(_e),j,i==="path"),[s,_e,j,i])}function useRoutes(s,e){return useRoutesImpl(s,e)}function useRoutesImpl(s,e,i,o){useInRouterContext()||invariant$1(!1);let{navigator:a}=reactExports.useContext(NavigationContext),{matches:j}=reactExports.useContext(RouteContext),_e=j[j.length-1],tt=_e?_e.params:{};_e&&_e.pathname;let et=_e?_e.pathnameBase:"/";_e&&_e.route;let rt=useLocation(),dt;if(e){var vt;let Ut=typeof e=="string"?parsePath(e):e;et==="/"||(vt=Ut.pathname)!=null&&vt.startsWith(et)||invariant$1(!1),dt=Ut}else dt=rt;let Ct=dt.pathname||"/",Wt=Ct;if(et!=="/"){let Ut=et.replace(/^\//,"").split("/");Wt="/"+Ct.replace(/^\//,"").split("/").slice(Ut.length).join("/")}let Bt=matchRoutes(s,{pathname:Wt}),qt=_renderMatches(Bt&&Bt.map(Ut=>Object.assign({},Ut,{params:Object.assign({},tt,Ut.params),pathname:joinPaths([et,a.encodeLocation?a.encodeLocation(Ut.pathname).pathname:Ut.pathname]),pathnameBase:Ut.pathnameBase==="/"?et:joinPaths([et,a.encodeLocation?a.encodeLocation(Ut.pathnameBase).pathname:Ut.pathnameBase])})),j,i,o);return e&&qt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},dt),navigationType:Action.Pop}},qt):qt}function DefaultErrorComponent(){let s=useRouteError(),e=isRouteErrorResponse(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),i=s instanceof Error?s.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),i?reactExports.createElement("pre",{style:a},i):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,i){return i.location!==e.location||i.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:i.error,location:i.location,revalidation:e.revalidation||i.revalidation}}componentDidCatch(e,i){console.error("React Router caught the following error during render",e,i)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(s){let{routeContext:e,match:i,children:o}=s,a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=i.route.id),reactExports.createElement(RouteContext.Provider,{value:e},o)}function _renderMatches(s,e,i,o){var a;if(e===void 0&&(e=[]),i===void 0&&(i=null),o===void 0&&(o=null),s==null){var j;if(!i)return null;if(i.errors)s=i.matches;else if((j=o)!=null&&j.v7_partialHydration&&e.length===0&&!i.initialized&&i.matches.length>0)s=i.matches;else return null}let _e=s,tt=(a=i)==null?void 0:a.errors;if(tt!=null){let dt=_e.findIndex(vt=>vt.route.id&&(tt==null?void 0:tt[vt.route.id])!==void 0);dt>=0||invariant$1(!1),_e=_e.slice(0,Math.min(_e.length,dt+1))}let et=!1,rt=-1;if(i&&o&&o.v7_partialHydration)for(let dt=0;dt<_e.length;dt++){let vt=_e[dt];if((vt.route.HydrateFallback||vt.route.hydrateFallbackElement)&&(rt=dt),vt.route.id){let{loaderData:Ct,errors:Wt}=i,Bt=vt.route.loader&&Ct[vt.route.id]===void 0&&(!Wt||Wt[vt.route.id]===void 0);if(vt.route.lazy||Bt){et=!0,rt>=0?_e=_e.slice(0,rt+1):_e=[_e[0]];break}}}return _e.reduceRight((dt,vt,Ct)=>{let Wt,Bt=!1,qt=null,Ut=null;i&&(Wt=tt&&vt.route.id?tt[vt.route.id]:void 0,qt=vt.route.errorElement||defaultErrorElement,et&&(rt<0&&Ct===0?(warningOnce("route-fallback"),Bt=!0,Ut=null):rt===Ct&&(Bt=!0,Ut=vt.route.hydrateFallbackElement||null)));let kt=e.concat(_e.slice(0,Ct+1)),Nt=()=>{let un;return Wt?un=qt:Bt?un=Ut:vt.route.Component?un=reactExports.createElement(vt.route.Component,null):vt.route.element?un=vt.route.element:un=dt,reactExports.createElement(RenderedRoute,{match:vt,routeContext:{outlet:dt,matches:kt,isDataRoute:i!=null},children:un})};return i&&(vt.route.ErrorBoundary||vt.route.errorElement||Ct===0)?reactExports.createElement(RenderErrorBoundary,{location:i.location,revalidation:i.revalidation,component:qt,error:Wt,children:Nt(),routeContext:{outlet:null,matches:kt,isDataRoute:!0}}):Nt()},null)}var DataRouterHook$1=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(DataRouterHook$1||{}),DataRouterStateHook$1=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(DataRouterStateHook$1||{});function useDataRouterContext(s){let e=reactExports.useContext(DataRouterContext);return e||invariant$1(!1),e}function useDataRouterState(s){let e=reactExports.useContext(DataRouterStateContext);return e||invariant$1(!1),e}function useRouteContext(s){let e=reactExports.useContext(RouteContext);return e||invariant$1(!1),e}function useCurrentRouteId(s){let e=useRouteContext(),i=e.matches[e.matches.length-1];return i.route.id||invariant$1(!1),i.route.id}function useRouteError(){var s;let e=reactExports.useContext(RouteErrorContext),i=useDataRouterState(),o=useCurrentRouteId();return e!==void 0?e:(s=i.errors)==null?void 0:s[o]}function useNavigateStable(){let{router:s}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),e=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),i=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{i.current=!0}),reactExports.useCallback(function(a,j){j===void 0&&(j={}),i.current&&(typeof a=="number"?s.navigate(a):s.navigate(a,_extends$1({fromRouteId:e},j)))},[s,e])}const alreadyWarned$1={};function warningOnce(s,e,i){alreadyWarned$1[s]||(alreadyWarned$1[s]=!0)}function logV6DeprecationWarnings(s,e){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function Route(s){invariant$1(!1)}function Router(s){let{basename:e="/",children:i=null,location:o,navigationType:a=Action.Pop,navigator:j,static:_e=!1,future:tt}=s;useInRouterContext()&&invariant$1(!1);let et=e.replace(/^\/*/,"/"),rt=reactExports.useMemo(()=>({basename:et,navigator:j,static:_e,future:_extends$1({v7_relativeSplatPath:!1},tt)}),[et,tt,j,_e]);typeof o=="string"&&(o=parsePath(o));let{pathname:dt="/",search:vt="",hash:Ct="",state:Wt=null,key:Bt="default"}=o,qt=reactExports.useMemo(()=>{let Ut=stripBasename(dt,et);return Ut==null?null:{location:{pathname:Ut,search:vt,hash:Ct,state:Wt,key:Bt},navigationType:a}},[et,dt,vt,Ct,Wt,Bt,a]);return qt==null?null:reactExports.createElement(NavigationContext.Provider,{value:rt},reactExports.createElement(LocationContext.Provider,{children:i,value:qt}))}function Routes(s){let{children:e,location:i}=s;return useRoutes(createRoutesFromChildren(e),i)}new Promise(()=>{});function createRoutesFromChildren(s,e){e===void 0&&(e=[]);let i=[];return reactExports.Children.forEach(s,(o,a)=>{if(!reactExports.isValidElement(o))return;let j=[...e,a];if(o.type===reactExports.Fragment){i.push.apply(i,createRoutesFromChildren(o.props.children,j));return}o.type!==Route&&invariant$1(!1),!o.props.index||!o.props.children||invariant$1(!1);let _e={id:o.props.id||j.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(_e.children=createRoutesFromChildren(o.props.children,j)),i.push(_e)}),i}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(s[o]=i[o])}return s},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(s,e){if(s==null)return{};var i={},o=Object.keys(s),a,j;for(j=0;j<o.length;j++)a=o[j],!(e.indexOf(a)>=0)&&(i[a]=s[a]);return i}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,e){return s.button===0&&(!e||e==="_self")&&!isModifiedEvent(s)}function createSearchParams(s){return s===void 0&&(s=""),new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,i)=>{let o=s[i];return e.concat(Array.isArray(o)?o.map(a=>[i,a]):[[i,o]])},[]))}function getSearchParamsForLocation(s,e){let i=createSearchParams(s);return e&&e.forEach((o,a)=>{i.has(a)||e.getAll(a).forEach(j=>{i.append(a,j)})}),i}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(s){let{basename:e,children:i,future:o,window:a}=s,j=reactExports.useRef();j.current==null&&(j.current=createBrowserHistory({window:a,v5Compat:!0}));let _e=j.current,[tt,et]=reactExports.useState({action:_e.action,location:_e.location}),{v7_startTransition:rt}=o||{},dt=reactExports.useCallback(vt=>{rt&&startTransitionImpl?startTransitionImpl(()=>et(vt)):et(vt)},[et,rt]);return reactExports.useLayoutEffect(()=>_e.listen(dt),[_e,dt]),reactExports.useEffect(()=>logV6DeprecationWarnings(o),[o]),reactExports.createElement(Router,{basename:e,children:i,location:tt.location,navigationType:tt.action,navigator:_e,future:o})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(e,i){let{onClick:o,relative:a,reloadDocument:j,replace:_e,state:tt,target:et,to:rt,preventScrollReset:dt,viewTransition:vt}=e,Ct=_objectWithoutPropertiesLoose(e,_excluded),{basename:Wt}=reactExports.useContext(NavigationContext),Bt,qt=!1;if(typeof rt=="string"&&ABSOLUTE_URL_REGEX.test(rt)&&(Bt=rt,isBrowser$1))try{let un=new URL(window.location.href),dn=rt.startsWith("//")?new URL(un.protocol+rt):new URL(rt),hn=stripBasename(dn.pathname,Wt);dn.origin===un.origin&&hn!=null?rt=hn+dn.search+dn.hash:qt=!0}catch{}let Ut=useHref(rt,{relative:a}),kt=useLinkClickHandler(rt,{replace:_e,state:tt,target:et,preventScrollReset:dt,relative:a,viewTransition:vt});function Nt(un){o&&o(un),un.defaultPrevented||kt(un)}return reactExports.createElement("a",_extends({},Ct,{href:Bt||Ut,onClick:qt||j?o:Nt,ref:i,target:et}))});var DataRouterHook;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(s,e){let{target:i,replace:o,state:a,preventScrollReset:j,relative:_e,viewTransition:tt}=e===void 0?{}:e,et=useNavigate(),rt=useLocation(),dt=useResolvedPath(s,{relative:_e});return reactExports.useCallback(vt=>{if(shouldProcessLinkClick(vt,i)){vt.preventDefault();let Ct=o!==void 0?o:createPath(rt)===createPath(dt);et(s,{replace:Ct,state:a,preventScrollReset:j,relative:_e,viewTransition:tt})}},[rt,et,dt,o,a,i,s,j,_e,tt])}function useSearchParams(s){let e=reactExports.useRef(createSearchParams(s)),i=reactExports.useRef(!1),o=useLocation(),a=reactExports.useMemo(()=>getSearchParamsForLocation(o.search,i.current?null:e.current),[o.search]),j=useNavigate(),_e=reactExports.useCallback((tt,et)=>{const rt=createSearchParams(typeof tt=="function"?tt(a):tt);i.current=!0,j("?"+rt,et)},[j,a]);return[a,_e]}function r(s){var e,i,o="";if(typeof s=="string"||typeof s=="number")o+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(e=0;e<a;e++)s[e]&&(i=r(s[e]))&&(o&&(o+=" "),o+=i)}else for(i in s)s[i]&&(o&&(o+=" "),o+=i);return o}function clsx(){for(var s,e,i=0,o="",a=arguments.length;i<a;i++)(s=arguments[i])&&(e=r(s))&&(o&&(o+=" "),o+=e);return o}const c=s=>typeof s=="number"&&!isNaN(s),d=s=>typeof s=="string",u=s=>typeof s=="function",p=s=>d(s)||u(s)?s:null,m=s=>reactExports.isValidElement(s)||d(s)||u(s)||c(s);function f(s,e,i){i===void 0&&(i=300);const{scrollHeight:o,style:a}=s;requestAnimationFrame(()=>{a.minHeight="initial",a.height=o+"px",a.transition=`all ${i}ms`,requestAnimationFrame(()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(e,i)})})}function g(s){let{enter:e,exit:i,appendPosition:o=!1,collapse:a=!0,collapseDuration:j=300}=s;return function(_e){let{children:tt,position:et,preventExitTransition:rt,done:dt,nodeRef:vt,isIn:Ct,playToast:Wt}=_e;const Bt=o?`${e}--${et}`:e,qt=o?`${i}--${et}`:i,Ut=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{const kt=vt.current,Nt=Bt.split(" "),un=dn=>{dn.target===vt.current&&(Wt(),kt.removeEventListener("animationend",un),kt.removeEventListener("animationcancel",un),Ut.current===0&&dn.type!=="animationcancel"&&kt.classList.remove(...Nt))};kt.classList.add(...Nt),kt.addEventListener("animationend",un),kt.addEventListener("animationcancel",un)},[]),reactExports.useEffect(()=>{const kt=vt.current,Nt=()=>{kt.removeEventListener("animationend",Nt),a?f(kt,dt,j):dt()};Ct||(rt?Nt():(Ut.current=1,kt.className+=` ${qt}`,kt.addEventListener("animationend",Nt)))},[Ct]),React.createElement(React.Fragment,null,tt)}}function y(s,e){return s!=null?{content:s.content,containerId:s.props.containerId,id:s.props.toastId,theme:s.props.theme,type:s.props.type,data:s.props.data||{},isLoading:s.props.isLoading,icon:s.props.icon,status:e}:{}}const v=new Map;let h=[];const T=new Set,E=s=>T.forEach(e=>e(s)),b=()=>v.size>0;function I(s,e){var i;if(e)return!((i=v.get(e))==null||!i.isToastActive(s));let o=!1;return v.forEach(a=>{a.isToastActive(s)&&(o=!0)}),o}function _(s,e){m(s)&&(b()||h.push({content:s,options:e}),v.forEach(i=>{i.buildToast(s,e)}))}function C(s,e){v.forEach(i=>{e!=null&&e!=null&&e.containerId?(e==null?void 0:e.containerId)===i.id&&i.toggle(s,e==null?void 0:e.id):i.toggle(s,e==null?void 0:e.id)})}function L$1(s){const{subscribe:e,getSnapshot:i,setProps:o}=reactExports.useRef(function(j){const _e=j.containerId||1;return{subscribe(tt){const et=function(dt,vt,Ct){let Wt=1,Bt=0,qt=[],Ut=[],kt=[],Nt=vt;const un=new Map,dn=new Set,hn=()=>{kt=Array.from(un.values()),dn.forEach(pt=>pt())},gn=pt=>{Ut=pt==null?[]:Ut.filter(Dt=>Dt!==pt),hn()},It=pt=>{const{toastId:Dt,onOpen:mn,updateId:Lt,children:yn}=pt.props,fn=Lt==null;pt.staleId&&un.delete(pt.staleId),un.set(Dt,pt),Ut=[...Ut,pt.props.toastId].filter($n=>$n!==pt.staleId),hn(),Ct(y(pt,fn?"added":"updated")),fn&&u(mn)&&mn(reactExports.isValidElement(yn)&&yn.props)};return{id:dt,props:Nt,observe:pt=>(dn.add(pt),()=>dn.delete(pt)),toggle:(pt,Dt)=>{un.forEach(mn=>{Dt!=null&&Dt!==mn.props.toastId||u(mn.toggle)&&mn.toggle(pt)})},removeToast:gn,toasts:un,clearQueue:()=>{Bt-=qt.length,qt=[]},buildToast:(pt,Dt)=>{if((Tn=>{let{containerId:pn,toastId:En,updateId:An}=Tn;const bn=pn?pn!==dt:dt!==1,wn=un.has(En)&&An==null;return bn||wn})(Dt))return;const{toastId:mn,updateId:Lt,data:yn,staleId:fn,delay:$n}=Dt,Ln=()=>{gn(mn)},jn=Lt==null;jn&&Bt++;const On={...Nt,style:Nt.toastStyle,key:Wt++,...Object.fromEntries(Object.entries(Dt).filter(Tn=>{let[pn,En]=Tn;return En!=null})),toastId:mn,updateId:Lt,data:yn,closeToast:Ln,isIn:!1,className:p(Dt.className||Nt.toastClassName),bodyClassName:p(Dt.bodyClassName||Nt.bodyClassName),progressClassName:p(Dt.progressClassName||Nt.progressClassName),autoClose:!Dt.isLoading&&(Vn=Dt.autoClose,Rn=Nt.autoClose,Vn===!1||c(Vn)&&Vn>0?Vn:Rn),deleteToast(){const Tn=un.get(mn),{onClose:pn,children:En}=Tn.props;u(pn)&&pn(reactExports.isValidElement(En)&&En.props),Ct(y(Tn,"removed")),un.delete(mn),Bt--,Bt<0&&(Bt=0),qt.length>0?It(qt.shift()):hn()}};var Vn,Rn;On.closeButton=Nt.closeButton,Dt.closeButton===!1||m(Dt.closeButton)?On.closeButton=Dt.closeButton:Dt.closeButton===!0&&(On.closeButton=!m(Nt.closeButton)||Nt.closeButton);let Dn=pt;reactExports.isValidElement(pt)&&!d(pt.type)?Dn=reactExports.cloneElement(pt,{closeToast:Ln,toastProps:On,data:yn}):u(pt)&&(Dn=pt({closeToast:Ln,toastProps:On,data:yn}));const Fn={content:Dn,props:On,staleId:fn};Nt.limit&&Nt.limit>0&&Bt>Nt.limit&&jn?qt.push(Fn):c($n)?setTimeout(()=>{It(Fn)},$n):It(Fn)},setProps(pt){Nt=pt},setToggle:(pt,Dt)=>{un.get(pt).toggle=Dt},isToastActive:pt=>Ut.some(Dt=>Dt===pt),getSnapshot:()=>kt}}(_e,j,E);v.set(_e,et);const rt=et.observe(tt);return h.forEach(dt=>_(dt.content,dt.options)),h=[],()=>{rt(),v.delete(_e)}},setProps(tt){var et;(et=v.get(_e))==null||et.setProps(tt)},getSnapshot(){var tt;return(tt=v.get(_e))==null?void 0:tt.getSnapshot()}}}(s)).current;o(s);const a=reactExports.useSyncExternalStore(e,i,i);return{getToastToRender:function(j){if(!a)return[];const _e=new Map;return s.newestOnTop&&a.reverse(),a.forEach(tt=>{const{position:et}=tt.props;_e.has(et)||_e.set(et,[]),_e.get(et).push(tt)}),Array.from(_e,tt=>j(tt[0],tt[1]))},isToastActive:I,count:a==null?void 0:a.length}}function N$1(s){const[e,i]=reactExports.useState(!1),[o,a]=reactExports.useState(!1),j=reactExports.useRef(null),_e=reactExports.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:tt,pauseOnHover:et,closeToast:rt,onClick:dt,closeOnClick:vt}=s;var Ct,Wt;function Bt(){i(!0)}function qt(){i(!1)}function Ut(un){const dn=j.current;_e.canDrag&&dn&&(_e.didMove=!0,e&&qt(),_e.delta=s.draggableDirection==="x"?un.clientX-_e.start:un.clientY-_e.start,_e.start!==un.clientX&&(_e.canCloseOnClick=!1),dn.style.transform=`translate3d(${s.draggableDirection==="x"?`${_e.delta}px, var(--y)`:`0, calc(${_e.delta}px + var(--y))`},0)`,dn.style.opacity=""+(1-Math.abs(_e.delta/_e.removalDistance)))}function kt(){document.removeEventListener("pointermove",Ut),document.removeEventListener("pointerup",kt);const un=j.current;if(_e.canDrag&&_e.didMove&&un){if(_e.canDrag=!1,Math.abs(_e.delta)>_e.removalDistance)return a(!0),s.closeToast(),void s.collapseAll();un.style.transition="transform 0.2s, opacity 0.2s",un.style.removeProperty("transform"),un.style.removeProperty("opacity")}}(Wt=v.get((Ct={id:s.toastId,containerId:s.containerId,fn:i}).containerId||1))==null||Wt.setToggle(Ct.id,Ct.fn),reactExports.useEffect(()=>{if(s.pauseOnFocusLoss)return document.hasFocus()||qt(),window.addEventListener("focus",Bt),window.addEventListener("blur",qt),()=>{window.removeEventListener("focus",Bt),window.removeEventListener("blur",qt)}},[s.pauseOnFocusLoss]);const Nt={onPointerDown:function(un){if(s.draggable===!0||s.draggable===un.pointerType){_e.didMove=!1,document.addEventListener("pointermove",Ut),document.addEventListener("pointerup",kt);const dn=j.current;_e.canCloseOnClick=!0,_e.canDrag=!0,dn.style.transition="none",s.draggableDirection==="x"?(_e.start=un.clientX,_e.removalDistance=dn.offsetWidth*(s.draggablePercent/100)):(_e.start=un.clientY,_e.removalDistance=dn.offsetHeight*(s.draggablePercent===80?1.5*s.draggablePercent:s.draggablePercent)/100)}},onPointerUp:function(un){const{top:dn,bottom:hn,left:gn,right:It}=j.current.getBoundingClientRect();un.nativeEvent.type!=="touchend"&&s.pauseOnHover&&un.clientX>=gn&&un.clientX<=It&&un.clientY>=dn&&un.clientY<=hn?qt():Bt()}};return tt&&et&&(Nt.onMouseEnter=qt,s.stacked||(Nt.onMouseLeave=Bt)),vt&&(Nt.onClick=un=>{dt&&dt(un),_e.canCloseOnClick&&rt()}),{playToast:Bt,pauseToast:qt,isRunning:e,preventExitTransition:o,toastRef:j,eventHandlers:Nt}}function $$1(s){let{delay:e,isRunning:i,closeToast:o,type:a="default",hide:j,className:_e,style:tt,controlledProgress:et,progress:rt,rtl:dt,isIn:vt,theme:Ct}=s;const Wt=j||et&&rt===0,Bt={...tt,animationDuration:`${e}ms`,animationPlayState:i?"running":"paused"};et&&(Bt.transform=`scaleX(${rt})`);const qt=clsx("Toastify__progress-bar",et?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${Ct}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":dt}),Ut=u(_e)?_e({rtl:dt,type:a,defaultClassName:qt}):clsx(qt,_e),kt={[et&&rt>=1?"onTransitionEnd":"onAnimationEnd"]:et&&rt<1?null:()=>{vt&&o()}};return React.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":Wt},React.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${Ct} Toastify__progress-bar--${a}`}),React.createElement("div",{role:"progressbar","aria-hidden":Wt?"true":"false","aria-label":"notification timer",className:Ut,style:Bt,...kt}))}let w=1;const k$1=()=>""+w++;function P(s){return s&&(d(s.toastId)||c(s.toastId))?s.toastId:k$1()}function M$1(s,e){return _(s,e),e.toastId}function x$1(s,e){return{...e,type:e&&e.type||s,toastId:P(e)}}function A(s){return(e,i)=>M$1(e,x$1(s,i))}function B$1(s,e){return M$1(s,x$1("default",e))}B$1.loading=(s,e)=>M$1(s,x$1("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),B$1.promise=function(s,e,i){let o,{pending:a,error:j,success:_e}=e;a&&(o=d(a)?B$1.loading(a,i):B$1.loading(a.render,{...i,...a}));const tt={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},et=(dt,vt,Ct)=>{if(vt==null)return void B$1.dismiss(o);const Wt={type:dt,...tt,...i,data:Ct},Bt=d(vt)?{render:vt}:vt;return o?B$1.update(o,{...Wt,...Bt}):B$1(Bt.render,{...Wt,...Bt}),Ct},rt=u(s)?s():s;return rt.then(dt=>et("success",_e,dt)).catch(dt=>et("error",j,dt)),rt},B$1.success=A("success"),B$1.info=A("info"),B$1.error=A("error"),B$1.warning=A("warning"),B$1.warn=B$1.warning,B$1.dark=(s,e)=>M$1(s,x$1("default",{theme:"dark",...e})),B$1.dismiss=function(s){(function(e){var i;if(b()){if(e==null||d(i=e)||c(i))v.forEach(o=>{o.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const o=v.get(e.containerId);o?o.removeToast(e.id):v.forEach(a=>{a.removeToast(e.id)})}}else h=h.filter(o=>e!=null&&o.options.toastId!==e)})(s)},B$1.clearWaitingQueue=function(s){s===void 0&&(s={}),v.forEach(e=>{!e.props.limit||s.containerId&&e.id!==s.containerId||e.clearQueue()})},B$1.isActive=I,B$1.update=function(s,e){e===void 0&&(e={});const i=((o,a)=>{var j;let{containerId:_e}=a;return(j=v.get(_e||1))==null?void 0:j.toasts.get(o)})(s,e);if(i){const{props:o,content:a}=i,j={delay:100,...o,...e,toastId:e.toastId||s,updateId:k$1()};j.toastId!==s&&(j.staleId=s);const _e=j.render||a;delete j.render,M$1(_e,j)}},B$1.done=s=>{B$1.update(s,{progress:1})},B$1.onChange=function(s){return T.add(s),()=>{T.delete(s)}},B$1.play=s=>C(!0,s),B$1.pause=s=>C(!1,s);const O$1=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,D=s=>{let{theme:e,type:i,isLoading:o,...a}=s;return React.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${i})`,...a})},z$1={info:function(s){return React.createElement(D,{...s},React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(s){return React.createElement(D,{...s},React.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(s){return React.createElement(D,{...s},React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(s){return React.createElement(D,{...s},React.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return React.createElement("div",{className:"Toastify__spinner"})}},R=s=>{const{isRunning:e,preventExitTransition:i,toastRef:o,eventHandlers:a,playToast:j}=N$1(s),{closeButton:_e,children:tt,autoClose:et,onClick:rt,type:dt,hideProgressBar:vt,closeToast:Ct,transition:Wt,position:Bt,className:qt,style:Ut,bodyClassName:kt,bodyStyle:Nt,progressClassName:un,progressStyle:dn,updateId:hn,role:gn,progress:It,rtl:pt,toastId:Dt,deleteToast:mn,isIn:Lt,isLoading:yn,closeOnClick:fn,theme:$n}=s,Ln=clsx("Toastify__toast",`Toastify__toast-theme--${$n}`,`Toastify__toast--${dt}`,{"Toastify__toast--rtl":pt},{"Toastify__toast--close-on-click":fn}),jn=u(qt)?qt({rtl:pt,position:Bt,type:dt,defaultClassName:Ln}):clsx(Ln,qt),On=function(Fn){let{theme:Tn,type:pn,isLoading:En,icon:An}=Fn,bn=null;const wn={theme:Tn,type:pn};return An===!1||(u(An)?bn=An({...wn,isLoading:En}):reactExports.isValidElement(An)?bn=reactExports.cloneElement(An,wn):En?bn=z$1.spinner():(Cn=>Cn in z$1)(pn)&&(bn=z$1[pn](wn))),bn}(s),Vn=!!It||!et,Rn={closeToast:Ct,type:dt,theme:$n};let Dn=null;return _e===!1||(Dn=u(_e)?_e(Rn):reactExports.isValidElement(_e)?reactExports.cloneElement(_e,Rn):function(Fn){let{closeToast:Tn,theme:pn,ariaLabel:En="close"}=Fn;return React.createElement("button",{className:`Toastify__close-button Toastify__close-button--${pn}`,type:"button",onClick:An=>{An.stopPropagation(),Tn(An)},"aria-label":En},React.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},React.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(Rn)),React.createElement(Wt,{isIn:Lt,done:mn,position:Bt,preventExitTransition:i,nodeRef:o,playToast:j},React.createElement("div",{id:Dt,onClick:rt,"data-in":Lt,className:jn,...a,style:Ut,ref:o},React.createElement("div",{...Lt&&{role:gn},className:u(kt)?kt({type:dt}):clsx("Toastify__toast-body",kt),style:Nt},On!=null&&React.createElement("div",{className:clsx("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!yn})},On),React.createElement("div",null,tt)),Dn,React.createElement($$1,{...hn&&!Vn?{key:`pb-${hn}`}:{},rtl:pt,theme:$n,delay:et,isRunning:e,isIn:Lt,closeToast:Ct,hide:vt,type:dt,style:dn,className:un,controlledProgress:Vn,progress:It||0})))},S=function(s,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${s}-enter`,exit:`Toastify--animate Toastify__${s}-exit`,appendPosition:e}},H=g(S("bounce",!0));g(S("slide",!0));g(S("zoom"));g(S("flip"));const q$1={position:"top-right",transition:H,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function Q$1(s){let e={...q$1,...s};const i=s.stacked,[o,a]=reactExports.useState(!0),j=reactExports.useRef(null),{getToastToRender:_e,isToastActive:tt,count:et}=L$1(e),{className:rt,style:dt,rtl:vt,containerId:Ct}=e;function Wt(qt){const Ut=clsx("Toastify__toast-container",`Toastify__toast-container--${qt}`,{"Toastify__toast-container--rtl":vt});return u(rt)?rt({position:qt,rtl:vt,defaultClassName:Ut}):clsx(Ut,p(rt))}function Bt(){i&&(a(!0),B$1.play())}return O$1(()=>{if(i){var qt;const Ut=j.current.querySelectorAll('[data-in="true"]'),kt=12,Nt=(qt=e.position)==null?void 0:qt.includes("top");let un=0,dn=0;Array.from(Ut).reverse().forEach((hn,gn)=>{const It=hn;It.classList.add("Toastify__toast--stacked"),gn>0&&(It.dataset.collapsed=`${o}`),It.dataset.pos||(It.dataset.pos=Nt?"top":"bot");const pt=un*(o?.2:1)+(o?0:kt*gn);It.style.setProperty("--y",`${Nt?pt:-1*pt}px`),It.style.setProperty("--g",`${kt}`),It.style.setProperty("--s",""+(1-(o?dn:0))),un+=It.offsetHeight,dn+=.025})}},[o,et,i]),React.createElement("div",{ref:j,className:"Toastify",id:Ct,onMouseEnter:()=>{i&&(a(!1),B$1.pause())},onMouseLeave:Bt},_e((qt,Ut)=>{const kt=Ut.length?{...dt}:{...dt,pointerEvents:"none"};return React.createElement("div",{className:Wt(qt),style:kt,key:`container-${qt}`},Ut.map(Nt=>{let{content:un,props:dn}=Nt;return React.createElement(R,{...dn,stacked:i,collapseAll:Bt,isIn:tt(dn.toastId,dn.containerId),style:dn.style,key:`toast-${dn.key}`},un)}))}))}const getDefaultsFromPostinstall=()=>{};var define_process_env_default={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(s){const e=[];let i=0;for(let o=0;o<s.length;o++){let a=s.charCodeAt(o);a<128?e[i++]=a:a<2048?(e[i++]=a>>6|192,e[i++]=a&63|128):(a&64512)===55296&&o+1<s.length&&(s.charCodeAt(o+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++o)&1023),e[i++]=a>>18|240,e[i++]=a>>12&63|128,e[i++]=a>>6&63|128,e[i++]=a&63|128):(e[i++]=a>>12|224,e[i++]=a>>6&63|128,e[i++]=a&63|128)}return e},byteArrayToString=function(s){const e=[];let i=0,o=0;for(;i<s.length;){const a=s[i++];if(a<128)e[o++]=String.fromCharCode(a);else if(a>191&&a<224){const j=s[i++];e[o++]=String.fromCharCode((a&31)<<6|j&63)}else if(a>239&&a<365){const j=s[i++],_e=s[i++],tt=s[i++],et=((a&7)<<18|(j&63)<<12|(_e&63)<<6|tt&63)-65536;e[o++]=String.fromCharCode(55296+(et>>10)),e[o++]=String.fromCharCode(56320+(et&1023))}else{const j=s[i++],_e=s[i++];e[o++]=String.fromCharCode((a&15)<<12|(j&63)<<6|_e&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let a=0;a<s.length;a+=3){const j=s[a],_e=a+1<s.length,tt=_e?s[a+1]:0,et=a+2<s.length,rt=et?s[a+2]:0,dt=j>>2,vt=(j&3)<<4|tt>>4;let Ct=(tt&15)<<2|rt>>6,Wt=rt&63;et||(Wt=64,_e||(Ct=64)),o.push(i[dt],i[vt],i[Ct],i[Wt])}return o.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(stringToByteArray$1(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):byteArrayToString(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const i=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let a=0;a<s.length;){const j=i[s.charAt(a++)],tt=a<s.length?i[s.charAt(a)]:0;++a;const rt=a<s.length?i[s.charAt(a)]:64;++a;const vt=a<s.length?i[s.charAt(a)]:64;if(++a,j==null||tt==null||rt==null||vt==null)throw new DecodeBase64StringError;const Ct=j<<2|tt>>4;if(o.push(Ct),rt!==64){const Wt=tt<<4&240|rt>>2;if(o.push(Wt),vt!==64){const Bt=rt<<6&192|vt;o.push(Bt)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(s){const e=stringToByteArray$1(s);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(s){return base64Encode(s).replace(/\./g,"")},base64Decode=function(s){try{return base64.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default>"u")return;const s=define_process_env_default.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&base64Decode(s[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},getDefaultEmulatorHost=s=>{var e,i;return(i=(e=getDefaults())===null||e===void 0?void 0:e.emulatorHosts)===null||i===void 0?void 0:i[s]},getDefaultEmulatorHostnameAndPort=s=>{const e=getDefaultEmulatorHost(s);if(!e)return;const i=e.lastIndexOf(":");if(i<=0||i+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(i+1),10);return e[0]==="["?[e.substring(1,i-1),o]:[e.substring(0,i),o]},getDefaultAppConfig=()=>{var s;return(s=getDefaults())===null||s===void 0?void 0:s.config},getExperimentalSetting=s=>{var e;return(e=getDefaults())===null||e===void 0?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}wrapCallback(e){return(i,o)=>{i?this.reject(i):this.resolve(o),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(i):e(i,o))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pingServer(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},o=e||"demo-project",a=s.iat||0,j=s.sub||s.user_id;if(!j)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const _e=Object.assign({iss:`https://securetoken.google.com/${o}`,aud:o,iat:a,exp:a+3600,auth_time:a,sub:j,user_id:j,firebase:{sign_in_provider:"custom",identities:{}}},s);return[base64urlEncodeWithoutPadding(JSON.stringify(i)),base64urlEncodeWithoutPadding(JSON.stringify(_e)),""].join(".")}const emulatorStatus={};function getEmulatorSummary(){const s={prod:[],emulator:[]};for(const e of Object.keys(emulatorStatus))emulatorStatus[e]?s.emulator.push(e):s.prod.push(e);return s}function getOrCreateEl(s){let e=document.getElementById(s),i=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),i=!0),{created:i,element:e}}let previouslyDismissed=!1;function updateEmulatorBanner(s,e){if(typeof window>"u"||typeof document>"u"||!isCloudWorkstation(window.location.host)||emulatorStatus[s]===e||emulatorStatus[s]||previouslyDismissed)return;emulatorStatus[s]=e;function i(Ct){return`__firebase__banner__${Ct}`}const o="__firebase__banner",j=getEmulatorSummary().prod.length>0;function _e(){const Ct=document.getElementById(o);Ct&&Ct.remove()}function tt(Ct){Ct.style.display="flex",Ct.style.background="#7faaf0",Ct.style.position="fixed",Ct.style.bottom="5px",Ct.style.left="5px",Ct.style.padding=".5em",Ct.style.borderRadius="5px",Ct.style.alignItems="center"}function et(Ct,Wt){Ct.setAttribute("width","24"),Ct.setAttribute("id",Wt),Ct.setAttribute("height","24"),Ct.setAttribute("viewBox","0 0 24 24"),Ct.setAttribute("fill","none"),Ct.style.marginLeft="-6px"}function rt(){const Ct=document.createElement("span");return Ct.style.cursor="pointer",Ct.style.marginLeft="16px",Ct.style.fontSize="24px",Ct.innerHTML=" &times;",Ct.onclick=()=>{previouslyDismissed=!0,_e()},Ct}function dt(Ct,Wt){Ct.setAttribute("id",Wt),Ct.innerText="Learn more",Ct.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",Ct.setAttribute("target","__blank"),Ct.style.paddingLeft="5px",Ct.style.textDecoration="underline"}function vt(){const Ct=getOrCreateEl(o),Wt=i("text"),Bt=document.getElementById(Wt)||document.createElement("span"),qt=i("learnmore"),Ut=document.getElementById(qt)||document.createElement("a"),kt=i("preprendIcon"),Nt=document.getElementById(kt)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(Ct.created){const un=Ct.element;tt(un),dt(Ut,qt);const dn=rt();et(Nt,kt),un.append(Nt,Bt,Ut,dn),document.body.appendChild(un)}j?(Bt.innerText="Preview backend disconnected.",Nt.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Nt.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,Bt.innerText="Preview backend running in this workspace."),Bt.setAttribute("id",Wt)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",vt):vt()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){var s;const e=(s=getDefaults())===null||s===void 0?void 0:s.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isCloudflareWorker(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function isBrowserExtension(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const s=getUA();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function isSafari(){return!isNode()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((s,e)=>{try{let i=!0;const o="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(o);a.onsuccess=()=>{a.result.close(),i||self.indexedDB.deleteDatabase(o),s(!0)},a.onupgradeneeded=()=>{i=!1},a.onerror=()=>{var j;e(((j=a.error)===null||j===void 0?void 0:j.message)||"")}}catch(i){e(i)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,i,o){super(i),this.code=e,this.customData=o,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,i,o){this.service=e,this.serviceName=i,this.errors=o}create(e,...i){const o=i[0]||{},a=`${this.service}/${e}`,j=this.errors[e],_e=j?replaceTemplate(j,o):"Error",tt=`${this.serviceName}: ${_e} (${a}).`;return new FirebaseError(a,tt,o)}}function replaceTemplate(s,e){return s.replace(PATTERN,(i,o)=>{const a=e[o];return a!=null?String(a):`<${o}?>`})}const PATTERN=/\{\$([^}]+)}/g;function isEmpty$1(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function deepEqual(s,e){if(s===e)return!0;const i=Object.keys(s),o=Object.keys(e);for(const a of i){if(!o.includes(a))return!1;const j=s[a],_e=e[a];if(isObject(j)&&isObject(_e)){if(!deepEqual(j,_e))return!1}else if(j!==_e)return!1}for(const a of o)if(!i.includes(a))return!1;return!0}function isObject(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(s){const e=[];for(const[i,o]of Object.entries(s))Array.isArray(o)?o.forEach(a=>{e.push(encodeURIComponent(i)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(i)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function querystringDecode(s){const e={};return s.replace(/^\?/,"").split("&").forEach(o=>{if(o){const[a,j]=o.split("=");e[decodeURIComponent(a)]=decodeURIComponent(j)}}),e}function extractQuerystring(s){const e=s.indexOf("?");if(!e)return"";const i=s.indexOf("#",e);return s.substring(e,i>0?i:void 0)}function createSubscribe(s,e){const i=new ObserverProxy(s,e);return i.subscribe.bind(i)}class ObserverProxy{constructor(e,i){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=i,this.task.then(()=>{e(this)}).catch(o=>{this.error(o)})}next(e){this.forEachObserver(i=>{i.next(e)})}error(e){this.forEachObserver(i=>{i.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,i,o){let a;if(e===void 0&&i===void 0&&o===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?a=e:a={next:e,error:i,complete:o},a.next===void 0&&(a.next=noop),a.error===void 0&&(a.error=noop),a.complete===void 0&&(a.complete=noop);const j=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),j}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let i=0;i<this.observers.length;i++)this.sendOne(i,e)}sendOne(e,i){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{i(this.observers[e])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(s,e){if(typeof s!="object"||s===null)return!1;for(const i of e)if(i in s&&typeof s[i]=="function")return!0;return!1}function noop(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(s){return s&&s._delegate?s._delegate:s}class Component{constructor(e,i,o){this.name=e,this.instanceFactory=i,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,i){this.name=e,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const i=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(i)){const o=new Deferred;if(this.instancesDeferred.set(i,o),this.isInitialized(i)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:i});a&&o.resolve(a)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(e){var i;const o=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(i=e==null?void 0:e.optional)!==null&&i!==void 0?i:!1;if(this.isInitialized(o)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:o})}catch(j){if(a)return null;throw j}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);try{const j=this.getOrInitializeService({instanceIdentifier:a});o.resolve(j)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...e.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:i={}}=e,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:o,options:i});for(const[j,_e]of this.instancesDeferred.entries()){const tt=this.normalizeInstanceIdentifier(j);o===tt&&_e.resolve(a)}return a}onInit(e,i){var o;const a=this.normalizeInstanceIdentifier(i),j=(o=this.onInitCallbacks.get(a))!==null&&o!==void 0?o:new Set;j.add(e),this.onInitCallbacks.set(a,j);const _e=this.instances.get(a);return _e&&e(_e,a),()=>{j.delete(e)}}invokeOnInitCallbacks(e,i){const o=this.onInitCallbacks.get(i);if(o)for(const a of o)try{a(e,i)}catch{}}getOrInitializeService({instanceIdentifier:e,options:i={}}){let o=this.instances.get(e);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:i}),this.instances.set(e,o),this.instancesOptions.set(e,i),this.invokeOnInitCallbacks(o,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,o)}catch{}return o||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(s){return s===DEFAULT_ENTRY_NAME$1?void 0:s}function isComponentEager(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const i=this.getProvider(e.name);if(i.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);i.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const i=new Provider(e,this);return this.providers.set(e,i),i}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(s,e,...i)=>{if(e<s.logLevel)return;const o=new Date().toISOString(),a=ConsoleMethod[e];if(a)console[a](`[${o}]  ${s.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}const instanceOfAny=(s,e)=>e.some(i=>s instanceof i);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(s){const e=new Promise((i,o)=>{const a=()=>{s.removeEventListener("success",j),s.removeEventListener("error",_e)},j=()=>{i(wrap(s.result)),a()},_e=()=>{o(s.error),a()};s.addEventListener("success",j),s.addEventListener("error",_e)});return e.then(i=>{i instanceof IDBCursor&&cursorRequestMap.set(i,s)}).catch(()=>{}),reverseTransformCache.set(e,s),e}function cacheDonePromiseForTransaction(s){if(transactionDoneMap.has(s))return;const e=new Promise((i,o)=>{const a=()=>{s.removeEventListener("complete",j),s.removeEventListener("error",_e),s.removeEventListener("abort",_e)},j=()=>{i(),a()},_e=()=>{o(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",j),s.addEventListener("error",_e),s.addEventListener("abort",_e)});transactionDoneMap.set(s,e)}let idbProxyTraps={get(s,e,i){if(s instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(s);if(e==="objectStoreNames")return s.objectStoreNames||transactionStoreNamesMap.get(s);if(e==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return wrap(s[e])},set(s,e,i){return s[e]=i,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function replaceTraps(s){idbProxyTraps=s(idbProxyTraps)}function wrapFunction(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...i){const o=s.call(unwrap(this),e,...i);return transactionStoreNamesMap.set(o,e.sort?e.sort():[e]),wrap(o)}:getCursorAdvanceMethods().includes(s)?function(...e){return s.apply(unwrap(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(s.apply(unwrap(this),e))}}function transformCachableValue(s){return typeof s=="function"?wrapFunction(s):(s instanceof IDBTransaction&&cacheDonePromiseForTransaction(s),instanceOfAny(s,getIdbProxyableTypes())?new Proxy(s,idbProxyTraps):s)}function wrap(s){if(s instanceof IDBRequest)return promisifyRequest(s);if(transformCache.has(s))return transformCache.get(s);const e=transformCachableValue(s);return e!==s&&(transformCache.set(s,e),reverseTransformCache.set(e,s)),e}const unwrap=s=>reverseTransformCache.get(s);function openDB(s,e,{blocked:i,upgrade:o,blocking:a,terminated:j}={}){const _e=indexedDB.open(s,e),tt=wrap(_e);return o&&_e.addEventListener("upgradeneeded",et=>{o(wrap(_e.result),et.oldVersion,et.newVersion,wrap(_e.transaction),et)}),i&&_e.addEventListener("blocked",et=>i(et.oldVersion,et.newVersion,et)),tt.then(et=>{j&&et.addEventListener("close",()=>j()),a&&et.addEventListener("versionchange",rt=>a(rt.oldVersion,rt.newVersion,rt))}).catch(()=>{}),tt}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const i=e.replace(/FromIndex$/,""),o=e!==i,a=writeMethods.includes(i);if(!(i in(o?IDBIndex:IDBObjectStore).prototype)||!(a||readMethods.includes(i)))return;const j=async function(_e,...tt){const et=this.transaction(_e,a?"readwrite":"readonly");let rt=et.store;return o&&(rt=rt.index(tt.shift())),(await Promise.all([rt[i](...tt),a&&et.done]))[0]};return cachedMethods.set(e,j),j}replaceTraps(s=>({...s,get:(e,i,o)=>getMethod(e,i)||s.get(e,i,o),has:(e,i)=>!!getMethod(e,i)||s.has(e,i)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(isVersionServiceProvider(i)){const o=i.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(i=>i).join(" ")}}function isVersionServiceProvider(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$q="@firebase/app",version$1$1="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4="@firebase/storage-compat",name$3$1="@firebase/firestore",name$2$1="@firebase/ai",name$1$1="@firebase/firestore-compat",name$r="firebase",version$4="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4]:"fire-gcs-compat",[name$3$1]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2$1]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(s,e){try{s.container.addComponent(e)}catch(i){logger.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,i)}}function _registerComponent(s){const e=s.name;if(_components.has(e))return logger.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,s);for(const i of _apps.values())_addComponent(i,s);for(const i of _serverApps.values())_addComponent(i,s);return!0}function _getProvider(s,e){const i=s.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),s.container.getProvider(e)}function _isFirebaseServerApp(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,i,o){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},i),this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$4;function initializeApp(s,e={}){let i=s;typeof e!="object"&&(e={name:e});const o=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!0},e),a=o.name;if(typeof a!="string"||!a)throw ERROR_FACTORY.create("bad-app-name",{appName:String(a)});if(i||(i=getDefaultAppConfig()),!i)throw ERROR_FACTORY.create("no-options");const j=_apps.get(a);if(j){if(deepEqual(i,j.options)&&deepEqual(o,j.config))return j;throw ERROR_FACTORY.create("duplicate-app",{appName:a})}const _e=new ComponentContainer(a);for(const et of _components.values())_e.addComponent(et);const tt=new FirebaseAppImpl(i,o,_e);return _apps.set(a,tt),tt}function getApp(s=DEFAULT_ENTRY_NAME){const e=_apps.get(s);if(!e&&s===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY.create("no-app",{appName:s});return e}function registerVersion(s,e,i){var o;let a=(o=PLATFORM_LOG_STRING[s])!==null&&o!==void 0?o:s;i&&(a+=`-${i}`);const j=a.match(/\s|\//),_e=e.match(/\s|\//);if(j||_e){const tt=[`Unable to register library "${a}" with version "${e}":`];j&&tt.push(`library name "${a}" contains illegal characters (whitespace or "/")`),j&&_e&&tt.push("and"),_e&&tt.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger.warn(tt.join(" "));return}_registerComponent(new Component(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(STORE_NAME)}catch(i){console.warn(i)}}}}).catch(s=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:s.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(s){try{const i=(await getDbPromise()).transaction(STORE_NAME),o=await i.objectStore(STORE_NAME).get(computeKey(s));return await i.done,o}catch(e){if(e instanceof FirebaseError)logger.warn(e.message);else{const i=ERROR_FACTORY.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger.warn(i.message)}}}async function writeHeartbeatsToIndexedDB(s,e){try{const o=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await o.objectStore(STORE_NAME).put(e,computeKey(s)),await o.done}catch(i){if(i instanceof FirebaseError)logger.warn(i.message);else{const o=ERROR_FACTORY.create("idb-set",{originalErrorMessage:i==null?void 0:i.message});logger.warn(o.message)}}}function computeKey(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,MAX_NUM_STORED_HEARTBEATS=30;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(i),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){var e,i;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),j=getUTCDateString();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((i=this._heartbeatsCache)===null||i===void 0?void 0:i.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===j||this._heartbeatsCache.heartbeats.some(_e=>_e.date===j))return;if(this._heartbeatsCache.heartbeats.push({date:j,agent:a}),this._heartbeatsCache.heartbeats.length>MAX_NUM_STORED_HEARTBEATS){const _e=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(_e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(o){logger.warn(o)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const i=getUTCDateString(),{heartbeatsToSend:o,unsentEntries:a}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),j=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=i,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),j}catch(i){return logger.warn(i),""}}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(s,e=MAX_HEADER_BYTES){const i=[];let o=s.slice();for(const a of s){const j=i.find(_e=>_e.agent===a.agent);if(j){if(j.dates.push(a.date),countBytes(i)>e){j.dates.pop();break}}else if(i.push({agent:a.agent,dates:[a.date]}),countBytes(i)>e){i.pop();break}o=o.slice(1)}return{heartbeatsToSend:i,unsentEntries:o}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const i=await readHeartbeatsFromIndexedDB(this.app);return i!=null&&i.heartbeats?i:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var i;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(i=e.lastSentHeartbeatDate)!==null&&i!==void 0?i:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var i;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(i=e.lastSentHeartbeatDate)!==null&&i!==void 0?i:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function countBytes(s){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:s})).length}function getEarliestHeartbeatIdx(s){if(s.length===0)return-1;let e=0,i=s[0].date;for(let o=1;o<s.length;o++)s[o].date<i&&(i=s[o].date,e=o);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(s){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$q,version$1$1,s),registerVersion(name$q,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var name$3="firebase",version$3="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$3,version$3,"app");function __rest$2(s,e){var i={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&e.indexOf(o)<0&&(i[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(s);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(s,o[a])&&(i[o[a]]=s[o[a]]);return i}typeof SuppressedError=="function"&&SuppressedError;function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logWarn(s,...e){logClient.logLevel<=LogLevel.WARN&&logClient.warn(`Auth (${SDK_VERSION}): ${s}`,...e)}function _logError(s,...e){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(s,...e){throw createErrorInternal(s,...e)}function _createError(s,...e){return createErrorInternal(s,...e)}function _errorWithCustomMessage(s,e,i){const o=Object.assign(Object.assign({},prodErrorMap()),{[e]:i});return new ErrorFactory("auth","Firebase",o).create(e,{appName:s.name})}function _serverAppCurrentUserOperationNotSupportedError(s){return _errorWithCustomMessage(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function createErrorInternal(s,...e){if(typeof s!="string"){const i=e[0],o=[...e.slice(1)];return o[0]&&(o[0].appName=s.name),s._errorFactory.create(i,...o)}return _DEFAULT_AUTH_ERROR_FACTORY.create(s,...e)}function _assert(s,e,...i){if(!s)throw createErrorInternal(e,...i)}function debugFail(s){const e="INTERNAL ASSERTION FAILED: "+s;throw _logError(e),new Error(e)}function debugAssert(s,e){s||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,i){this.shortDelay=e,this.longDelay=i,debugAssert(i>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(s,e){debugAssert(s.emulator,"Emulator should always be set here");const{url:i}=s.emulator;return e?`${i}${e.startsWith("/")?e.slice(1):e}`:i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,i,o){this.fetchImpl=e,i&&(this.headersImpl=i),o&&(this.responseImpl=o)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CookieAuthProxiedEndpoints=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(s,e){return s.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:s.tenantId}):e}async function _performApiRequest(s,e,i,o,a={}){return _performFetchWithErrorHandling(s,a,async()=>{let j={},_e={};o&&(e==="GET"?_e=o:j={body:JSON.stringify(o)});const tt=querystring(Object.assign({key:s.config.apiKey},_e)).slice(1),et=await s._getAdditionalHeaders();et["Content-Type"]="application/json",s.languageCode&&(et["X-Firebase-Locale"]=s.languageCode);const rt=Object.assign({method:e,headers:et},j);return isCloudflareWorker()||(rt.referrerPolicy="no-referrer"),s.emulatorConfig&&isCloudWorkstation(s.emulatorConfig.host)&&(rt.credentials="include"),FetchProvider.fetch()(await _getFinalTarget(s,s.config.apiHost,i,tt),rt)})}async function _performFetchWithErrorHandling(s,e,i){s._canInitEmulator=!1;const o=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const a=new NetworkTimeout(s),j=await Promise.race([i(),a.promise]);a.clearNetworkTimeout();const _e=await j.json();if("needConfirmation"in _e)throw _makeTaggedError(s,"account-exists-with-different-credential",_e);if(j.ok&&!("errorMessage"in _e))return _e;{const tt=j.ok?_e.errorMessage:_e.error.message,[et,rt]=tt.split(" : ");if(et==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(s,"credential-already-in-use",_e);if(et==="EMAIL_EXISTS")throw _makeTaggedError(s,"email-already-in-use",_e);if(et==="USER_DISABLED")throw _makeTaggedError(s,"user-disabled",_e);const dt=o[et]||et.toLowerCase().replace(/[_\s]+/g,"-");if(rt)throw _errorWithCustomMessage(s,dt,rt);_fail(s,dt)}}catch(a){if(a instanceof FirebaseError)throw a;_fail(s,"network-request-failed",{message:String(a)})}}async function _performSignInRequest(s,e,i,o,a={}){const j=await _performApiRequest(s,e,i,o,a);return"mfaPendingCredential"in j&&_fail(s,"multi-factor-auth-required",{_serverResponse:j}),j}async function _getFinalTarget(s,e,i,o){const a=`${e}${i}?${o}`,j=s,_e=j.config.emulator?_emulatorUrl(s.config,a):`${s.config.apiScheme}://${a}`;return CookieAuthProxiedEndpoints.includes(i)&&(await j._persistenceManagerAvailable,j._getPersistenceType()==="COOKIE")?j._getPersistence()._getFinalTarget(_e).toString():_e}function _parseEnforcementState(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class NetworkTimeout{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((i,o)=>{this.timer=setTimeout(()=>o(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}}function _makeTaggedError(s,e,i){const o={appName:s.name};i.email&&(o.email=i.email),i.phoneNumber&&(o.phoneNumber=i.phoneNumber);const a=_createError(s,e,o);return a.customData._tokenResponse=i,a}function isEnterprise(s){return s!==void 0&&s.enterprise!==void 0}class RecaptchaConfig{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const i of this.recaptchaEnforcementState)if(i.provider&&i.provider===e)return _parseEnforcementState(i.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function getRecaptchaConfig(s,e){return _performApiRequest(s,"GET","/v2/recaptchaConfig",_addTidIfNecessary(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(s,e){return _performApiRequest(s,"POST","/v1/accounts:delete",e)}async function getAccountInfo(s,e){return _performApiRequest(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(s,e=!1){const i=getModularInstance(s),o=await i.getIdToken(e),a=_parseToken(o);_assert(a&&a.exp&&a.auth_time&&a.iat,i.auth,"internal-error");const j=typeof a.firebase=="object"?a.firebase:void 0,_e=j==null?void 0:j.sign_in_provider;return{claims:a,token:o,authTime:utcTimestampToDateString(secondsStringToMilliseconds(a.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(a.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(a.exp)),signInProvider:_e||null,signInSecondFactor:(j==null?void 0:j.sign_in_second_factor)||null}}function secondsStringToMilliseconds(s){return Number(s)*1e3}function _parseToken(s){const[e,i,o]=s.split(".");if(e===void 0||i===void 0||o===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const a=base64Decode(i);return a?JSON.parse(a):(_logError("Failed to decode base64 JWT payload"),null)}catch(a){return _logError("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function _tokenExpiresIn(s){const e=_parseToken(s);return _assert(e,"internal-error"),_assert(typeof e.exp<"u","internal-error"),_assert(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(s,e,i=!1){if(i)return e;try{return await e}catch(o){throw o instanceof FirebaseError&&isUserInvalidated(o)&&s.auth.currentUser===s&&await s.auth.signOut(),o}}function isUserInvalidated({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var i;if(e){const o=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),o}else{this.errorBackoff=3e4;const a=((i=this.user.stsTokenManager.expirationTime)!==null&&i!==void 0?i:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const i=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},i)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,i){this.createdAt=e,this.lastLoginAt=i,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(s){var e;const i=s.auth,o=await s.getIdToken(),a=await _logoutIfInvalidated(s,getAccountInfo(i,{idToken:o}));_assert(a==null?void 0:a.users.length,i,"internal-error");const j=a.users[0];s._notifyReloadListener(j);const _e=!((e=j.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(j.providerUserInfo):[],tt=mergeProviderData(s.providerData,_e),et=s.isAnonymous,rt=!(s.email&&j.passwordHash)&&!(tt!=null&&tt.length),dt=et?rt:!1,vt={uid:j.localId,displayName:j.displayName||null,photoURL:j.photoUrl||null,email:j.email||null,emailVerified:j.emailVerified||!1,phoneNumber:j.phoneNumber||null,tenantId:j.tenantId||null,providerData:tt,metadata:new UserMetadata(j.createdAt,j.lastLoginAt),isAnonymous:dt};Object.assign(s,vt)}async function reload(s){const e=getModularInstance(s);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(s,e){return[...s.filter(o=>!e.some(a=>a.providerId===o.providerId)),...e]}function extractProviderData(s){return s.map(e=>{var{providerId:i}=e,o=__rest$2(e,["providerId"]);return{providerId:i,uid:o.rawId||"",displayName:o.displayName||null,email:o.email||null,phoneNumber:o.phoneNumber||null,photoURL:o.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(s,e){const i=await _performFetchWithErrorHandling(s,{},async()=>{const o=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:j}=s.config,_e=await _getFinalTarget(s,a,"/v1/token",`key=${j}`),tt=await s._getAdditionalHeaders();tt["Content-Type"]="application/x-www-form-urlencoded";const et={method:"POST",headers:tt,body:o};return s.emulatorConfig&&isCloudWorkstation(s.emulatorConfig.host)&&(et.credentials="include"),FetchProvider.fetch()(_e,et)});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}async function revokeToken(s,e){return _performApiRequest(s,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(typeof e.idToken<"u","internal-error"),_assert(typeof e.refreshToken<"u","internal-error");const i="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,i)}updateFromIdToken(e){_assert(e.length!==0,"internal-error");const i=_tokenExpiresIn(e);this.updateTokensAndExpiration(e,null,i)}async getToken(e,i=!1){return!i&&this.accessToken&&!this.isExpired?this.accessToken:(_assert(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,i){const{accessToken:o,refreshToken:a,expiresIn:j}=await requestStsToken(e,i);this.updateTokensAndExpiration(o,a,Number(j))}updateTokensAndExpiration(e,i,o){this.refreshToken=i||null,this.accessToken=e||null,this.expirationTime=Date.now()+o*1e3}static fromJSON(e,i){const{refreshToken:o,accessToken:a,expirationTime:j}=i,_e=new StsTokenManager;return o&&(_assert(typeof o=="string","internal-error",{appName:e}),_e.refreshToken=o),a&&(_assert(typeof a=="string","internal-error",{appName:e}),_e.accessToken=a),j&&(_assert(typeof j=="number","internal-error",{appName:e}),_e.expirationTime=j),_e}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(s,e){_assert(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:i,auth:o,stsTokenManager:a}=e,j=__rest$2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=i,this.auth=o,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=j.displayName||null,this.email=j.email||null,this.emailVerified=j.emailVerified||!1,this.phoneNumber=j.phoneNumber||null,this.photoURL=j.photoURL||null,this.isAnonymous=j.isAnonymous||!1,this.tenantId=j.tenantId||null,this.providerData=j.providerData?[...j.providerData]:[],this.metadata=new UserMetadata(j.createdAt||void 0,j.lastLoginAt||void 0)}async getIdToken(e){const i=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(i,this.auth,"internal-error"),this.accessToken!==i&&(this.accessToken=i,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),i}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(i=>Object.assign({},i)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const i=new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return i.metadata._copy(this.metadata),i}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,i=!1){let o=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),o=!0),i&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),o&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_isFirebaseServerApp(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,i){var o,a,j,_e,tt,et,rt,dt;const vt=(o=i.displayName)!==null&&o!==void 0?o:void 0,Ct=(a=i.email)!==null&&a!==void 0?a:void 0,Wt=(j=i.phoneNumber)!==null&&j!==void 0?j:void 0,Bt=(_e=i.photoURL)!==null&&_e!==void 0?_e:void 0,qt=(tt=i.tenantId)!==null&&tt!==void 0?tt:void 0,Ut=(et=i._redirectEventId)!==null&&et!==void 0?et:void 0,kt=(rt=i.createdAt)!==null&&rt!==void 0?rt:void 0,Nt=(dt=i.lastLoginAt)!==null&&dt!==void 0?dt:void 0,{uid:un,emailVerified:dn,isAnonymous:hn,providerData:gn,stsTokenManager:It}=i;_assert(un&&It,e,"internal-error");const pt=StsTokenManager.fromJSON(this.name,It);_assert(typeof un=="string",e,"internal-error"),assertStringOrUndefined(vt,e.name),assertStringOrUndefined(Ct,e.name),_assert(typeof dn=="boolean",e,"internal-error"),_assert(typeof hn=="boolean",e,"internal-error"),assertStringOrUndefined(Wt,e.name),assertStringOrUndefined(Bt,e.name),assertStringOrUndefined(qt,e.name),assertStringOrUndefined(Ut,e.name),assertStringOrUndefined(kt,e.name),assertStringOrUndefined(Nt,e.name);const Dt=new UserImpl({uid:un,auth:e,email:Ct,emailVerified:dn,displayName:vt,isAnonymous:hn,photoURL:Bt,phoneNumber:Wt,tenantId:qt,stsTokenManager:pt,createdAt:kt,lastLoginAt:Nt});return gn&&Array.isArray(gn)&&(Dt.providerData=gn.map(mn=>Object.assign({},mn))),Ut&&(Dt._redirectEventId=Ut),Dt}static async _fromIdTokenResponse(e,i,o=!1){const a=new StsTokenManager;a.updateFromServerResponse(i);const j=new UserImpl({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o});return await _reloadWithoutSaving(j),j}static async _fromGetAccountInfoResponse(e,i,o){const a=i.users[0];_assert(a.localId!==void 0,"internal-error");const j=a.providerUserInfo!==void 0?extractProviderData(a.providerUserInfo):[],_e=!(a.email&&a.passwordHash)&&!(j!=null&&j.length),tt=new StsTokenManager;tt.updateFromIdToken(o);const et=new UserImpl({uid:a.localId,auth:e,stsTokenManager:tt,isAnonymous:_e}),rt={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:j,metadata:new UserMetadata(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(j!=null&&j.length)};return Object.assign(et,rt),et}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(s){debugAssert(s instanceof Function,"Expected a class definition");let e=instanceCache.get(s);return e?(debugAssert(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,instanceCache.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,i){this.storage[e]=i}async _get(e){const i=this.storage[e];return i===void 0?null:i}async _remove(e){delete this.storage[e]}_addListener(e,i){}_removeListener(e,i){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(s,e,i){return`firebase:${s}:${e}:${i}`}class PersistenceUserManager{constructor(e,i,o){this.persistence=e,this.auth=i,this.userKey=o;const{config:a,name:j}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,a.apiKey,j),this.fullPersistenceKey=_persistenceKeyName("persistence",a.apiKey,j),this.boundEventHandler=i._onStorageEvent.bind(i),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const i=await getAccountInfo(this.auth,{idToken:e}).catch(()=>{});return i?UserImpl._fromGetAccountInfoResponse(this.auth,i,e):null}return UserImpl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const i=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,i)return this.setCurrentUser(i)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,i,o="authUser"){if(!i.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,o);const a=(await Promise.all(i.map(async rt=>{if(await rt._isAvailable())return rt}))).filter(rt=>rt);let j=a[0]||_getInstance(inMemoryPersistence);const _e=_persistenceKeyName(o,e.config.apiKey,e.name);let tt=null;for(const rt of i)try{const dt=await rt._get(_e);if(dt){let vt;if(typeof dt=="string"){const Ct=await getAccountInfo(e,{idToken:dt}).catch(()=>{});if(!Ct)break;vt=await UserImpl._fromGetAccountInfoResponse(e,Ct,dt)}else vt=UserImpl._fromJSON(e,dt);rt!==j&&(tt=vt),j=rt;break}}catch{}const et=a.filter(rt=>rt._shouldAllowMigration);return!j._shouldAllowMigration||!et.length?new PersistenceUserManager(j,e,o):(j=et[0],tt&&await j._set(_e,tt.toJSON()),await Promise.all(i.map(async rt=>{if(rt!==j)try{await rt._remove(_e)}catch{}})),new PersistenceUserManager(j,e,o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const i=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,o=s.match(i);if((o==null?void 0:o.length)===2)return o[1]}return"Other"}function _isFirefox(s=getUA()){return/firefox\//i.test(s)}function _isSafari(s=getUA()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(s=getUA()){return/crios\//i.test(s)}function _isIEMobile(s=getUA()){return/iemobile/i.test(s)}function _isAndroid(s=getUA()){return/android/i.test(s)}function _isBlackBerry(s=getUA()){return/blackberry/i.test(s)}function _isWebOS(s=getUA()){return/webos/i.test(s)}function _isIOS(s=getUA()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function _isIOSStandalone(s=getUA()){var e;return _isIOS(s)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(s=getUA()){return _isIOS(s)||_isAndroid(s)||_isWebOS(s)||_isBlackBerry(s)||/windows phone/i.test(s)||_isIEMobile(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(s,e=[]){let i;switch(s){case"Browser":i=_getBrowserName(getUA());break;case"Worker":i=`${_getBrowserName(getUA())}-${s}`;break;default:i=s}const o=e.length?e.join(","):"FirebaseCore-web";return`${i}/JsCore/${SDK_VERSION}/${o}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,i){const o=j=>new Promise((_e,tt)=>{try{const et=e(j);_e(et)}catch(et){tt(et)}});o.onAbort=i,this.queue.push(o);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const i=[];try{for(const o of this.queue)await o(e),o.onAbort&&i.push(o.onAbort)}catch(o){i.reverse();for(const a of i)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:o==null?void 0:o.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(s,e={}){return _performApiRequest(s,"GET","/v2/passwordPolicy",_addTidIfNecessary(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MINIMUM_MIN_PASSWORD_LENGTH=6;class PasswordPolicyImpl{constructor(e){var i,o,a,j;const _e=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(i=_e.minPasswordLength)!==null&&i!==void 0?i:MINIMUM_MIN_PASSWORD_LENGTH,_e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=_e.maxPasswordLength),_e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=_e.containsLowercaseCharacter),_e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=_e.containsUppercaseCharacter),_e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=_e.containsNumericCharacter),_e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=_e.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(o=e.allowedNonAlphanumericCharacters)===null||o===void 0?void 0:o.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(j=e.forceUpgradeOnSignin)!==null&&j!==void 0?j:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var i,o,a,j,_e,tt;const et={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,et),this.validatePasswordCharacterOptions(e,et),et.isValid&&(et.isValid=(i=et.meetsMinPasswordLength)!==null&&i!==void 0?i:!0),et.isValid&&(et.isValid=(o=et.meetsMaxPasswordLength)!==null&&o!==void 0?o:!0),et.isValid&&(et.isValid=(a=et.containsLowercaseLetter)!==null&&a!==void 0?a:!0),et.isValid&&(et.isValid=(j=et.containsUppercaseLetter)!==null&&j!==void 0?j:!0),et.isValid&&(et.isValid=(_e=et.containsNumericCharacter)!==null&&_e!==void 0?_e:!0),et.isValid&&(et.isValid=(tt=et.containsNonAlphanumericCharacter)!==null&&tt!==void 0?tt:!0),et}validatePasswordLengthOptions(e,i){const o=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;o&&(i.meetsMinPasswordLength=e.length>=o),a&&(i.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,i){this.updatePasswordCharacterOptionsStatuses(i,!1,!1,!1,!1);let o;for(let a=0;a<e.length;a++)o=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(i,o>="a"&&o<="z",o>="A"&&o<="Z",o>="0"&&o<="9",this.allowedNonAlphanumericCharacters.includes(o))}updatePasswordCharacterOptionsStatuses(e,i,o,a,j){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=i)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=o)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=j))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,i,o,a){this.app=e,this.heartbeatServiceProvider=i,this.appCheckServiceProvider=o,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(j=>this._resolvePersistenceManagerAvailable=j)}_initializeWithPersistence(e,i){return i&&(this._popupRedirectResolver=_getInstance(i)),this._initializationPromise=this.queue(async()=>{var o,a,j;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),(o=this._resolvePersistenceManagerAvailable)===null||o===void 0||o.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(i),this.lastNotifiedUid=((j=this.currentUser)===null||j===void 0?void 0:j.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const i=await getAccountInfo(this,{idToken:e}),o=await UserImpl._fromGetAccountInfoResponse(this,i,e);await this.directlySetCurrentUser(o)}catch(i){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",i),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(_isFirebaseServerApp(this.app)){const _e=this.app.settings.authIdToken;return _e?new Promise(tt=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(_e).then(tt,tt))}):this.directlySetCurrentUser(null)}const o=await this.assertedPersistence.getCurrentUser();let a=o,j=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const _e=(i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId,tt=a==null?void 0:a._redirectEventId,et=await this.tryRedirectSignIn(e);(!_e||_e===tt)&&(et!=null&&et.user)&&(a=et.user,j=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(j)try{await this.beforeStateQueue.runMiddleware(a)}catch(_e){a=o,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(_e))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return _assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let i=null;try{i=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return i}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(i){if((i==null?void 0:i.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_isFirebaseServerApp(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));const i=e?getModularInstance(e):null;return i&&_assert(i.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(i&&i._clone(this))}async _updateCurrentUser(e,i=!1){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),i||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const i=this._getPasswordPolicyInternal();return i.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):i.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _getPasswordPolicy(this),i=new PasswordPolicyImpl(e);this.tenantId===null?this._projectPasswordPolicy=i:this._tenantPasswordPolicies[this.tenantId]=i}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,i,o){return this.registerStateListener(this.authStateSubscription,e,i,o)}beforeAuthStateChanged(e,i){return this.beforeStateQueue.pushCallback(e,i)}onIdTokenChanged(e,i,o){return this.registerStateListener(this.idTokenSubscription,e,i,o)}authStateReady(){return new Promise((e,i)=>{if(this.currentUser)e();else{const o=this.onAuthStateChanged(()=>{o(),e()},i)}})}async revokeAccessToken(e){if(this.currentUser){const i=await this.currentUser.getIdToken(),o={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:i};this.tenantId!=null&&(o.tenantId=this.tenantId),await revokeToken(this,o)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,i){const o=await this.getOrInitRedirectPersistenceManager(i);return e===null?o.removeCurrentUser():o.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const i=e&&_getInstance(e)||this._popupRedirectResolver;_assert(i,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(i._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var i,o;return this._isInitialized&&await this.queue(async()=>{}),((i=this._currentUser)===null||i===void 0?void 0:i._redirectEventId)===e?this._currentUser:((o=this.redirectUser)===null||o===void 0?void 0:o._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,i;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const o=(i=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&i!==void 0?i:null;this.lastNotifiedUid!==o&&(this.lastNotifiedUid=o,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,i,o,a){if(this._deleted)return()=>{};const j=typeof i=="function"?i:i.next.bind(i);let _e=!1;const tt=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(tt,this,"internal-error"),tt.then(()=>{_e||j(this.currentUser)}),typeof i=="function"){const et=e.addObserver(i,o,a);return()=>{_e=!0,et()}}else{const et=e.addObserver(i);return()=>{_e=!0,et()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const i={"X-Client-Version":this.clientVersion};this.app.options.appId&&(i["X-Firebase-gmpid"]=this.app.options.appId);const o=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());o&&(i["X-Firebase-Client"]=o);const a=await this._getAppCheckToken();return a&&(i["X-Firebase-AppCheck"]=a),i}async _getAppCheckToken(){var e;if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const i=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return i!=null&&i.error&&_logWarn(`Error while retrieving App Check token: ${i.error}`),i==null?void 0:i.token}}function _castAuth(s){return getModularInstance(s)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(i=>this.observer=i)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let externalJSProvider={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(s){externalJSProvider=s}function _loadJS(s){return externalJSProvider.loadJS(s)}function _recaptchaEnterpriseScriptUrl(){return externalJSProvider.recaptchaEnterpriseScript}function _gapiScriptUrl(){return externalJSProvider.gapiScript}function _generateCallbackName(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class MockGreCAPTCHATopLevel{constructor(){this.enterprise=new MockGreCAPTCHA}ready(e){e()}execute(e,i){return Promise.resolve("token")}render(e,i){return""}}class MockGreCAPTCHA{ready(e){e()}execute(e,i){return Promise.resolve("token")}render(e,i){return""}}const RECAPTCHA_ENTERPRISE_VERIFIER_TYPE="recaptcha-enterprise",FAKE_TOKEN="NO_RECAPTCHA";class RecaptchaEnterpriseVerifier{constructor(e){this.type=RECAPTCHA_ENTERPRISE_VERIFIER_TYPE,this.auth=_castAuth(e)}async verify(e="verify",i=!1){async function o(j){if(!i){if(j.tenantId==null&&j._agentRecaptchaConfig!=null)return j._agentRecaptchaConfig.siteKey;if(j.tenantId!=null&&j._tenantRecaptchaConfigs[j.tenantId]!==void 0)return j._tenantRecaptchaConfigs[j.tenantId].siteKey}return new Promise(async(_e,tt)=>{getRecaptchaConfig(j,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(et=>{if(et.recaptchaKey===void 0)tt(new Error("recaptcha Enterprise site key undefined"));else{const rt=new RecaptchaConfig(et);return j.tenantId==null?j._agentRecaptchaConfig=rt:j._tenantRecaptchaConfigs[j.tenantId]=rt,_e(rt.siteKey)}}).catch(et=>{tt(et)})})}function a(j,_e,tt){const et=window.grecaptcha;isEnterprise(et)?et.enterprise.ready(()=>{et.enterprise.execute(j,{action:e}).then(rt=>{_e(rt)}).catch(()=>{_e(FAKE_TOKEN)})}):tt(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MockGreCAPTCHATopLevel().execute("siteKey",{action:"verify"}):new Promise((j,_e)=>{o(this.auth).then(tt=>{if(!i&&isEnterprise(window.grecaptcha))a(tt,j,_e);else{if(typeof window>"u"){_e(new Error("RecaptchaVerifier is only supported in browser"));return}let et=_recaptchaEnterpriseScriptUrl();et.length!==0&&(et+=tt),_loadJS(et).then(()=>{a(tt,j,_e)}).catch(rt=>{_e(rt)})}}).catch(tt=>{_e(tt)})})}}async function injectRecaptchaFields(s,e,i,o=!1,a=!1){const j=new RecaptchaEnterpriseVerifier(s);let _e;if(a)_e=FAKE_TOKEN;else try{_e=await j.verify(i)}catch{_e=await j.verify(i,!0)}const tt=Object.assign({},e);if(i==="mfaSmsEnrollment"||i==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in tt){const et=tt.phoneEnrollmentInfo.phoneNumber,rt=tt.phoneEnrollmentInfo.recaptchaToken;Object.assign(tt,{phoneEnrollmentInfo:{phoneNumber:et,recaptchaToken:rt,captchaResponse:_e,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in tt){const et=tt.phoneSignInInfo.recaptchaToken;Object.assign(tt,{phoneSignInInfo:{recaptchaToken:et,captchaResponse:_e,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return tt}return o?Object.assign(tt,{captchaResp:_e}):Object.assign(tt,{captchaResponse:_e}),Object.assign(tt,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(tt,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),tt}async function handleRecaptchaFlow(s,e,i,o,a){var j;if(!((j=s._getRecaptchaConfig())===null||j===void 0)&&j.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const _e=await injectRecaptchaFields(s,e,i,i==="getOobCode");return o(s,_e)}else return o(s,e).catch(async _e=>{if(_e.code==="auth/missing-recaptcha-token"){console.log(`${i} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const tt=await injectRecaptchaFields(s,e,i,i==="getOobCode");return o(s,tt)}else return Promise.reject(_e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(s,e){const i=_getProvider(s,"auth");if(i.isInitialized()){const a=i.getImmediate(),j=i.getOptions();if(deepEqual(j,e??{}))return a;_fail(a,"already-initialized")}return i.initialize({options:e})}function _initializeAuthInstance(s,e){const i=(e==null?void 0:e.persistence)||[],o=(Array.isArray(i)?i:[i]).map(_getInstance);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(o,e==null?void 0:e.popupRedirectResolver)}function connectAuthEmulator(s,e,i){const o=_castAuth(s);_assert(/^https?:\/\//.test(e),o,"invalid-emulator-scheme");const a=!1,j=extractProtocol(e),{host:_e,port:tt}=extractHostAndPort(e),et=tt===null?"":`:${tt}`,rt={url:`${j}//${_e}${et}/`},dt=Object.freeze({host:_e,port:tt,protocol:j.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!o._canInitEmulator){_assert(o.config.emulator&&o.emulatorConfig,o,"emulator-config-failed"),_assert(deepEqual(rt,o.config.emulator)&&deepEqual(dt,o.emulatorConfig),o,"emulator-config-failed");return}o.config.emulator=rt,o.emulatorConfig=dt,o.settings.appVerificationDisabledForTesting=!0,isCloudWorkstation(_e)?(pingServer(`${j}//${_e}${et}`),updateEmulatorBanner("Auth",!0)):emitEmulatorWarning()}function extractProtocol(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function extractHostAndPort(s){const e=extractProtocol(s),i=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!i)return{host:"",port:null};const o=i[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(o);if(a){const j=a[1];return{host:j,port:parsePort(o.substr(j.length+1))}}else{const[j,_e]=o.split(":");return{host:j,port:parsePort(_e)}}}function parsePort(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function emitEmulatorWarning(){function s(){const e=document.createElement("p"),i=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",i.position="fixed",i.width="100%",i.backgroundColor="#ffffff",i.border=".1em solid #000000",i.color="#b50000",i.bottom="0px",i.left="0px",i.margin="0px",i.zIndex="10000",i.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,i){this.providerId=e,this.signInMethod=i}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,i){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}async function linkEmailPassword(s,e){return _performApiRequest(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(s,e){return _performSignInRequest(s,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(s,e){return _performSignInRequest(s,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(s,e))}async function signInWithEmailLinkForLinking(s,e){return _performSignInRequest(s,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthCredential extends AuthCredential{constructor(e,i,o,a=null){super("password",o),this._email=e,this._password=i,this._tenantId=a}static _fromEmailAndPassword(e,i){return new EmailAuthCredential(e,i,"password")}static _fromEmailAndCode(e,i,o=null){return new EmailAuthCredential(e,i,"emailLink",o)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const i=typeof e=="string"?JSON.parse(e):e;if(i!=null&&i.email&&(i!=null&&i.password)){if(i.signInMethod==="password")return this._fromEmailAndPassword(i.email,i.password);if(i.signInMethod==="emailLink")return this._fromEmailAndCode(i.email,i.password,i.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const i={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,i,"signInWithPassword",signInWithPassword);case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,i){switch(this.signInMethod){case"password":const o={idToken:i,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,o,"signUpPassword",linkEmailPassword);case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:i,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(s,e){return _performSignInRequest(s,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const i=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(i.idToken=e.idToken),e.accessToken&&(i.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(i.nonce=e.nonce),e.pendingToken&&(i.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(i.accessToken=e.oauthToken,i.secret=e.oauthTokenSecret):_fail("argument-error"),i}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const i=typeof e=="string"?JSON.parse(e):e,{providerId:o,signInMethod:a}=i,j=__rest$2(i,["providerId","signInMethod"]);if(!o||!a)return null;const _e=new OAuthCredential(o,a);return _e.idToken=j.idToken||void 0,_e.accessToken=j.accessToken||void 0,_e.secret=j.secret,_e.nonce=j.nonce,_e.pendingToken=j.pendingToken||null,_e}_getIdTokenResponse(e){const i=this.buildRequest();return signInWithIdp(e,i)}_linkToIdToken(e,i){const o=this.buildRequest();return o.idToken=i,signInWithIdp(e,o)}_getReauthenticationResolver(e){const i=this.buildRequest();return i.autoCreate=!1,signInWithIdp(e,i)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const i={};this.idToken&&(i.id_token=this.idToken),this.accessToken&&(i.access_token=this.accessToken),this.secret&&(i.oauth_token_secret=this.secret),i.providerId=this.providerId,this.nonce&&!this.pendingToken&&(i.nonce=this.nonce),e.postBody=querystring(i)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parseMode(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function parseDeepLink(s){const e=querystringDecode(extractQuerystring(s)).link,i=e?querystringDecode(extractQuerystring(e)).deep_link_id:null,o=querystringDecode(extractQuerystring(s)).deep_link_id;return(o?querystringDecode(extractQuerystring(o)).link:null)||o||i||e||s}class ActionCodeURL{constructor(e){var i,o,a,j,_e,tt;const et=querystringDecode(extractQuerystring(e)),rt=(i=et.apiKey)!==null&&i!==void 0?i:null,dt=(o=et.oobCode)!==null&&o!==void 0?o:null,vt=parseMode((a=et.mode)!==null&&a!==void 0?a:null);_assert(rt&&dt&&vt,"argument-error"),this.apiKey=rt,this.operation=vt,this.code=dt,this.continueUrl=(j=et.continueUrl)!==null&&j!==void 0?j:null,this.languageCode=(_e=et.lang)!==null&&_e!==void 0?_e:null,this.tenantId=(tt=et.tenantId)!==null&&tt!==void 0?tt:null}static parseLink(e){const i=parseDeepLink(e);try{return new ActionCodeURL(i)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,i){return EmailAuthCredential._fromEmailAndPassword(e,i)}static credentialWithLink(e,i){const o=ActionCodeURL.parseLink(i);return _assert(o,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,o.code,o.tenantId)}}EmailAuthProvider.PROVIDER_ID="password";EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password";EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,i){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:i})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:i,oauthAccessToken:o}=e;if(!i&&!o)return null;try{return GoogleAuthProvider.credential(i,o)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,i){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:i})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:i,oauthTokenSecret:o}=e;if(!i||!o)return null;try{return TwitterAuthProvider.credential(i,o)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,i,o,a=!1){const j=await UserImpl._fromIdTokenResponse(e,o,a),_e=providerIdForResponse(o);return new UserCredentialImpl({user:j,providerId:_e,_tokenResponse:o,operationType:i})}static async _forOperation(e,i,o){await e._updateTokensIfNecessary(o,!0);const a=providerIdForResponse(o);return new UserCredentialImpl({user:e,providerId:a,_tokenResponse:o,operationType:i})}}function providerIdForResponse(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,i,o,a){var j;super(i.code,i.message),this.operationType=o,this.user=a,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:(j=e.tenantId)!==null&&j!==void 0?j:void 0,_serverResponse:i.customData._serverResponse,operationType:o}}static _fromErrorAndOperation(e,i,o,a){return new MultiFactorError(e,i,o,a)}}function _processCredentialSavingMfaContextIfNecessary(s,e,i,o){return(e==="reauthenticate"?i._getReauthenticationResolver(s):i._getIdTokenResponse(s)).catch(j=>{throw j.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(s,j,e,o):j})}async function _link$1(s,e,i=!1){const o=await _logoutIfInvalidated(s,e._linkToIdToken(s.auth,await s.getIdToken()),i);return UserCredentialImpl._forOperation(s,"link",o)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(s,e,i=!1){const{auth:o}=s;if(_isFirebaseServerApp(o.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(o));const a="reauthenticate";try{const j=await _logoutIfInvalidated(s,_processCredentialSavingMfaContextIfNecessary(o,a,e,s),i);_assert(j.idToken,o,"internal-error");const _e=_parseToken(j.idToken);_assert(_e,o,"internal-error");const{sub:tt}=_e;return _assert(s.uid===tt,o,"user-mismatch"),UserCredentialImpl._forOperation(s,a,j)}catch(j){throw(j==null?void 0:j.code)==="auth/user-not-found"&&_fail(o,"user-mismatch"),j}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(s,e,i=!1){if(_isFirebaseServerApp(s.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(s));const o="signIn",a=await _processCredentialSavingMfaContextIfNecessary(s,o,e),j=await UserCredentialImpl._fromIdTokenResponse(s,o,a);return i||await s._updateCurrentUser(j.user),j}async function signInWithCredential(s,e){return _signInWithCredential(_castAuth(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function recachePasswordPolicy(s){const e=_castAuth(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function signInWithEmailAndPassword(s,e,i){return _isFirebaseServerApp(s.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(s)):signInWithCredential(getModularInstance(s),EmailAuthProvider.credential(e,i)).catch(async o=>{throw o.code==="auth/password-does-not-meet-requirements"&&recachePasswordPolicy(s),o})}function onIdTokenChanged(s,e,i,o){return getModularInstance(s).onIdTokenChanged(e,i,o)}function beforeAuthStateChanged(s,e,i){return getModularInstance(s).beforeAuthStateChanged(e,i)}function onAuthStateChanged(s,e,i,o){return getModularInstance(s).onAuthStateChanged(e,i,o)}function signOut(s){return getModularInstance(s).signOut()}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,i){this.storageRetriever=e,this.type=i}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,i){return this.storage.setItem(e,JSON.stringify(i)),Promise.resolve()}_get(e){const i=this.storage.getItem(e);return Promise.resolve(i?JSON.parse(i):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,i)=>this.onStorageEvent(e,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const i of Object.keys(this.listeners)){const o=this.storage.getItem(i),a=this.localCache[i];o!==a&&e(i,a,o)}}onStorageEvent(e,i=!1){if(!e.key){this.forAllChangedKeys((_e,tt,et)=>{this.notifyListeners(_e,et)});return}const o=e.key;i?this.detachListener():this.stopPolling();const a=()=>{const _e=this.storage.getItem(o);!i&&this.localCache[o]===_e||this.notifyListeners(o,_e)},j=this.storage.getItem(o);_isIE10()&&j!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,IE10_LOCAL_STORAGE_SYNC_DELAY):a()}notifyListeners(e,i){this.localCache[e]=i;const o=this.listeners[e];if(o)for(const a of Array.from(o))a(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,i,o)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:i,newValue:o}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(i)}_removeListener(e,i){this.listeners[e]&&(this.listeners[e].delete(i),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,i){await super._set(e,i),this.localCache[e]=JSON.stringify(i)}async _get(e){const i=await super._get(e);return this.localCache[e]=JSON.stringify(i),i}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,i){}_removeListener(e,i){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(i){return{fulfilled:!1,reason:i}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const i=this.receivers.find(a=>a.isListeningto(e));if(i)return i;const o=new Receiver(e);return this.receivers.push(o),o}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const i=e,{eventId:o,eventType:a,data:j}=i.data,_e=this.handlersMap[a];if(!(_e!=null&&_e.size))return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:a});const tt=Array.from(_e).map(async rt=>rt(i.origin,j)),et=await _allSettled(tt);i.ports[0].postMessage({status:"done",eventId:o,eventType:a,response:et})}_subscribe(e,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(i)}_unsubscribe(e,i){this.handlersMap[e]&&i&&this.handlersMap[e].delete(i),(!i||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(s="",e=10){let i="";for(let o=0;o<e;o++)i+=Math.floor(Math.random()*10);return s+i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,i,o=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let j,_e;return new Promise((tt,et)=>{const rt=_generateEventId("",20);a.port1.start();const dt=setTimeout(()=>{et(new Error("unsupported_event"))},o);_e={messageChannel:a,onMessage(vt){const Ct=vt;if(Ct.data.eventId===rt)switch(Ct.data.status){case"ack":clearTimeout(dt),j=setTimeout(()=>{et(new Error("timeout"))},3e3);break;case"done":clearTimeout(j),tt(Ct.data.response);break;default:clearTimeout(dt),clearTimeout(j),et(new Error("invalid_response"));break}}},this.handlers.add(_e),a.port1.addEventListener("message",_e.onMessage),this.target.postMessage({eventType:e,eventId:rt,data:i},[a.port2])}).finally(()=>{_e&&this.removeMessageHandler(_e)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(s){_window().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope<"u"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)===null||s===void 0?void 0:s.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,i)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{i(this.request.error)})})}}function getObjectStore(s,e){return s.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const s=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(s).toPromise()}function _openDatabase(){const s=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,i)=>{s.addEventListener("error",()=>{i(s.error)}),s.addEventListener("upgradeneeded",()=>{const o=s.result;try{o.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(a){i(a)}}),s.addEventListener("success",async()=>{const o=s.result;o.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(o):(o.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(s,e,i){const o=getObjectStore(s,!0).put({[DB_DATA_KEYPATH]:e,value:i});return new DBPromise(o).toPromise()}async function getObject(s,e){const i=getObjectStore(s,!1).get(e),o=await new DBPromise(i).toPromise();return o===void 0?null:o.value}function _deleteObject(s,e){const i=getObjectStore(s,!0).delete(e);return new DBPromise(i).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let i=0;for(;;)try{const o=await this._openDb();return await e(o)}catch(o){if(i++>_TRANSACTION_RETRY_COUNT)throw o;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(e,i)=>["keyChanged"])}async initializeSender(){var e,i;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const o=await this.sender._send("ping",{},800);o&&!((e=o[0])===null||e===void 0)&&e.fulfilled&&!((i=o[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,i){return this._withPendingWrite(async()=>(await this._withRetries(o=>_putObject(o,e,i)),this.localCache[e]=i,this.notifyServiceWorker(e)))}async _get(e){const i=await this._withRetries(o=>getObject(o,e));return this.localCache[e]=i,i}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(i=>_deleteObject(i,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const j=getObjectStore(a,!1).getAll();return new DBPromise(j).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const i=[],o=new Set;if(e.length!==0)for(const{fbase_key:a,value:j}of e)o.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(j)&&(this.notifyListeners(a,j),i.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!o.has(a)&&(this.notifyListeners(a,null),i.push(a));return i}notifyListeners(e,i){this.localCache[e]=i;const o=this.listeners[e];if(o)for(const a of Array.from(o))a(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(i)}_removeListener(e,i){this.listeners[e]&&(this.listeners[e].delete(i),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(s,e){return e?_getInstance(e):(_assert(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,i){return signInWithIdp(e,this._buildIdpRequest(i))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const i={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(i.idToken=e),i}}function _signIn(s){return _signInWithCredential(s.auth,new IdpCredential(s),s.bypassAuthState)}function _reauth(s){const{auth:e,user:i}=s;return _assert(i,e,"internal-error"),_reauthenticate(i,new IdpCredential(s),s.bypassAuthState)}async function _link(s){const{auth:e,user:i}=s;return _assert(i,e,"internal-error"),_link$1(i,new IdpCredential(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,i,o,a,j=!1){this.auth=e,this.resolver=o,this.user=a,this.bypassAuthState=j,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(i)?i:[i]}execute(){return new Promise(async(e,i)=>{this.pendingPromise={resolve:e,reject:i};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(o){this.reject(o)}})}async onAuthEvent(e){const{urlResponse:i,sessionId:o,postBody:a,tenantId:j,error:_e,type:tt}=e;if(_e){this.reject(_e);return}const et={auth:this.auth,requestUri:i,sessionId:o,tenantId:j||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(tt)(et))}catch(rt){this.reject(rt)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,i,o,a,j){super(e,i,a,j),this.provider=o,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var i,o;if(!((o=(i=this.authWindow)===null||i===void 0?void 0:i.window)===null||o===void 0)&&o.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,i,o=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,o),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const o=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(o)}catch(i){e=()=>Promise.reject(i)}redirectOutcomeMap.set(this.auth._key(),e)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const i=await this.auth._redirectUserForId(e.eventId);if(i)return this.user=i,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(s,e){const i=pendingRedirectKey(e),o=resolverPersistence(s);if(!await o._isAvailable())return!1;const a=await o._get(i)==="true";return await o._remove(i),a}function _overrideRedirectResult(s,e){redirectOutcomeMap.set(s._key(),e)}function resolverPersistence(s){return _getInstance(s._redirectPersistence)}function pendingRedirectKey(s){return _persistenceKeyName(PENDING_REDIRECT_KEY,s.config.apiKey,s.name)}async function _getRedirectResult(s,e,i=!1){if(_isFirebaseServerApp(s.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(s));const o=_castAuth(s),a=_withDefaultResolver(o,e),_e=await new RedirectAction(o,a,i).execute();return _e&&!i&&(delete _e.user._redirectEventId,await o._persistUserIfCurrent(_e.user),await o._setRedirectUser(null,e)),_e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let i=!1;return this.consumers.forEach(o=>{this.isEventForConsumer(e,o)&&(i=!0,this.sendToConsumer(e,o),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,i||(this.queuedRedirectEvent=e,i=!0)),i}sendToConsumer(e,i){var o;if(e.error&&!isNullRedirectEvent(e)){const a=((o=e.error.code)===null||o===void 0?void 0:o.split("auth/")[1])||"internal-error";i.onError(_createError(this.auth,a))}else i.onAuthEvent(e)}isEventForConsumer(e,i){const o=i.eventId===null||!!e.eventId&&e.eventId===i.eventId;return i.filter.includes(e.type)&&o}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(s,e={}){return _performApiRequest(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(s){if(s.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(s);for(const i of e)try{if(matchDomain(i))return}catch{}_fail(s,"unauthorized-domain")}function matchDomain(s){const e=_getCurrentUrl(),{protocol:i,hostname:o}=new URL(e);if(s.startsWith("chrome-extension://")){const _e=new URL(s);return _e.hostname===""&&o===""?i==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):i==="chrome-extension:"&&_e.hostname===o}if(!HTTP_REGEX.test(i))return!1;if(IP_ADDRESS_REGEX.test(s))return o===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(o)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const s=_window().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let i=0;i<s.CP.length;i++)s.CP[i]=null}}function loadGapi(s){return new Promise((e,i)=>{var o,a,j;function _e(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),i(_createError(s,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((a=(o=_window().gapi)===null||o===void 0?void 0:o.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((j=_window().gapi)===null||j===void 0)&&j.load)_e();else{const tt=_generateCallbackName("iframefcb");return _window()[tt]=()=>{gapi.load?_e():i(_createError(s,"network-request-failed"))},_loadJS(`${_gapiScriptUrl()}?onload=${tt}`).catch(et=>i(et))}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(s){return cachedGApiLoader=cachedGApiLoader||loadGapi(s),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(s){const e=s.config;_assert(e.authDomain,s,"auth-domain-config-required");const i=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${s.config.authDomain}/${IFRAME_PATH}`,o={apiKey:e.apiKey,appName:s.name,v:SDK_VERSION},a=EID_FROM_APIHOST.get(s.config.apiHost);a&&(o.eid=a);const j=s._getFrameworks();return j.length&&(o.fw=j.join(",")),`${i}?${querystring(o).slice(1)}`}async function _openIframe(s){const e=await _loadGapi(s),i=_window().gapi;return _assert(i,s,"internal-error"),e.open({where:document.body,url:getIframeUrl(s),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},o=>new Promise(async(a,j)=>{await o.restyle({setHideOnLeave:!1});const _e=_createError(s,"network-request-failed"),tt=_window().setTimeout(()=>{j(_e)},PING_TIMEOUT.get());function et(){_window().clearTimeout(tt),a(o)}o.ping(et).then(et,()=>{j(_e)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(s,e,i,o=DEFAULT_WIDTH,a=DEFAULT_HEIGHT){const j=Math.max((window.screen.availHeight-a)/2,0).toString(),_e=Math.max((window.screen.availWidth-o)/2,0).toString();let tt="";const et=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:o.toString(),height:a.toString(),top:j,left:_e}),rt=getUA().toLowerCase();i&&(tt=_isChromeIOS(rt)?TARGET_BLANK:i),_isFirefox(rt)&&(e=e||FIREFOX_EMPTY_URL,et.scrollbars="yes");const dt=Object.entries(et).reduce((Ct,[Wt,Bt])=>`${Ct}${Wt}=${Bt},`,"");if(_isIOSStandalone(rt)&&tt!=="_self")return openAsNewWindowIOS(e||"",tt),new AuthPopup(null);const vt=window.open(e||"",tt,dt);_assert(vt,s,"popup-blocked");try{vt.focus()}catch{}return new AuthPopup(vt)}function openAsNewWindowIOS(s,e){const i=document.createElement("a");i.href=s,i.target=e;const o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),i.dispatchEvent(o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");async function _getRedirectUrl(s,e,i,o,a,j){_assert(s.config.authDomain,s,"auth-domain-config-required"),_assert(s.config.apiKey,s,"invalid-api-key");const _e={apiKey:s.config.apiKey,appName:s.name,authType:i,redirectUrl:o,v:SDK_VERSION,eventId:a};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(s.languageCode),_e.providerId=e.providerId||"",isEmpty$1(e.getCustomParameters())||(_e.customParameters=JSON.stringify(e.getCustomParameters()));for(const[dt,vt]of Object.entries({}))_e[dt]=vt}if(e instanceof BaseOAuthProvider){const dt=e.getScopes().filter(vt=>vt!=="");dt.length>0&&(_e.scopes=dt.join(","))}s.tenantId&&(_e.tid=s.tenantId);const tt=_e;for(const dt of Object.keys(tt))tt[dt]===void 0&&delete tt[dt];const et=await s._getAppCheckToken(),rt=et?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(et)}`:"";return`${getHandlerBase(s)}?${querystring(tt).slice(1)}${rt}`}function getHandlerBase({config:s}){return s.emulator?_emulatorUrl(s,EMULATOR_WIDGET_PATH):`https://${s.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,i,o,a){var j;debugAssert((j=this.eventManagers[e._key()])===null||j===void 0?void 0:j.manager,"_initialize() not called before _openPopup()");const _e=await _getRedirectUrl(e,i,o,_getCurrentUrl(),a);return _open(e,_e,_generateEventId())}async _openRedirect(e,i,o,a){await this._originValidation(e);const j=await _getRedirectUrl(e,i,o,_getCurrentUrl(),a);return _setWindowLocation(j),new Promise(()=>{})}_initialize(e){const i=e._key();if(this.eventManagers[i]){const{manager:a,promise:j}=this.eventManagers[i];return a?Promise.resolve(a):(debugAssert(j,"If manager is not set, promise should be"),j)}const o=this.initAndGetManager(e);return this.eventManagers[i]={promise:o},o.catch(()=>{delete this.eventManagers[i]}),o}async initAndGetManager(e){const i=await _openIframe(e),o=new AuthEventManager(e);return i.register("authEvent",a=>(_assert(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:o.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:o},this.iframes[e._key()]=i,o}_isIframeWebStorageSupported(e,i){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},a=>{var j;const _e=(j=a==null?void 0:a[0])===null||j===void 0?void 0:j[WEB_STORAGE_SUPPORT_KEY];_e!==void 0&&i(!!_e),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const i=e._key();return this.originValidationPromises[i]||(this.originValidationPromises[i]=_validateOrigin(e)),this.originValidationPromises[i]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name$2="@firebase/auth",version$2="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const i=this.auth.onIdTokenChanged(o=>{e((o==null?void 0:o.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,i),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const i=this.internalListeners.get(e);i&&(this.internalListeners.delete(e),i(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(s){_registerComponent(new Component("auth",(e,{options:i})=>{const o=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),j=e.getProvider("app-check-internal"),{apiKey:_e,authDomain:tt}=o.options;_assert(_e&&!_e.includes(":"),"invalid-api-key",{appName:o.name});const et={apiKey:_e,authDomain:tt,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(s)},rt=new AuthImpl(o,a,j,et);return _initializeAuthInstance(rt,i),rt},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,i,o)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const i=_castAuth(e.getProvider("auth").getImmediate());return(o=>new AuthInterop(o))(i)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$2,version$2,getVersionForPlatform(s)),registerVersion(name$2,version$2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60,authIdTokenMaxAge=getExperimentalSetting("authIdTokenMaxAge")||DEFAULT_ID_TOKEN_MAX_AGE;let lastPostedIdToken=null;const mintCookieFactory=s=>async e=>{const i=e&&await e.getIdTokenResult(),o=i&&(new Date().getTime()-Date.parse(i.issuedAtTime))/1e3;if(o&&o>authIdTokenMaxAge)return;const a=i==null?void 0:i.token;lastPostedIdToken!==a&&(lastPostedIdToken=a,await fetch(s,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function getAuth(s=getApp()){const e=_getProvider(s,"auth");if(e.isInitialized())return e.getImmediate();const i=initializeAuth(s,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]}),o=getExperimentalSetting("authTokenSyncURL");if(o&&typeof isSecureContext=="boolean"&&isSecureContext){const j=new URL(o,location.origin);if(location.origin===j.origin){const _e=mintCookieFactory(j.toString());beforeAuthStateChanged(i,_e,()=>_e(i.currentUser)),onIdTokenChanged(i,tt=>_e(tt))}}const a=getDefaultEmulatorHost("auth");return a&&connectAuthEmulator(i,`http://${a}`),i}function getScriptParentElement(){var s,e;return(e=(s=document.getElementsByTagName("head"))===null||s===void 0?void 0:s[0])!==null&&e!==void 0?e:document}_setExternalJSProvider({loadJS(s){return new Promise((e,i)=>{const o=document.createElement("script");o.setAttribute("src",s),o.onload=e,o.onerror=a=>{const j=_createError("internal-error");j.customData=a,i(j)},o.type="text/javascript",o.charset="UTF-8",getScriptParentElement().appendChild(o)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});registerAuth("Browser");var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer,Md5;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(It,pt){function Dt(){}Dt.prototype=pt.prototype,It.D=pt.prototype,It.prototype=new Dt,It.prototype.constructor=It,It.C=function(mn,Lt,yn){for(var fn=Array(arguments.length-2),$n=2;$n<arguments.length;$n++)fn[$n-2]=arguments[$n];return pt.prototype[Lt].apply(mn,fn)}}function i(){this.blockSize=-1}function o(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(o,i),o.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(It,pt,Dt){Dt||(Dt=0);var mn=Array(16);if(typeof pt=="string")for(var Lt=0;16>Lt;++Lt)mn[Lt]=pt.charCodeAt(Dt++)|pt.charCodeAt(Dt++)<<8|pt.charCodeAt(Dt++)<<16|pt.charCodeAt(Dt++)<<24;else for(Lt=0;16>Lt;++Lt)mn[Lt]=pt[Dt++]|pt[Dt++]<<8|pt[Dt++]<<16|pt[Dt++]<<24;pt=It.g[0],Dt=It.g[1],Lt=It.g[2];var yn=It.g[3],fn=pt+(yn^Dt&(Lt^yn))+mn[0]+3614090360&4294967295;pt=Dt+(fn<<7&4294967295|fn>>>25),fn=yn+(Lt^pt&(Dt^Lt))+mn[1]+3905402710&4294967295,yn=pt+(fn<<12&4294967295|fn>>>20),fn=Lt+(Dt^yn&(pt^Dt))+mn[2]+606105819&4294967295,Lt=yn+(fn<<17&4294967295|fn>>>15),fn=Dt+(pt^Lt&(yn^pt))+mn[3]+3250441966&4294967295,Dt=Lt+(fn<<22&4294967295|fn>>>10),fn=pt+(yn^Dt&(Lt^yn))+mn[4]+4118548399&4294967295,pt=Dt+(fn<<7&4294967295|fn>>>25),fn=yn+(Lt^pt&(Dt^Lt))+mn[5]+1200080426&4294967295,yn=pt+(fn<<12&4294967295|fn>>>20),fn=Lt+(Dt^yn&(pt^Dt))+mn[6]+2821735955&4294967295,Lt=yn+(fn<<17&4294967295|fn>>>15),fn=Dt+(pt^Lt&(yn^pt))+mn[7]+4249261313&4294967295,Dt=Lt+(fn<<22&4294967295|fn>>>10),fn=pt+(yn^Dt&(Lt^yn))+mn[8]+1770035416&4294967295,pt=Dt+(fn<<7&4294967295|fn>>>25),fn=yn+(Lt^pt&(Dt^Lt))+mn[9]+2336552879&4294967295,yn=pt+(fn<<12&4294967295|fn>>>20),fn=Lt+(Dt^yn&(pt^Dt))+mn[10]+4294925233&4294967295,Lt=yn+(fn<<17&4294967295|fn>>>15),fn=Dt+(pt^Lt&(yn^pt))+mn[11]+2304563134&4294967295,Dt=Lt+(fn<<22&4294967295|fn>>>10),fn=pt+(yn^Dt&(Lt^yn))+mn[12]+1804603682&4294967295,pt=Dt+(fn<<7&4294967295|fn>>>25),fn=yn+(Lt^pt&(Dt^Lt))+mn[13]+4254626195&4294967295,yn=pt+(fn<<12&4294967295|fn>>>20),fn=Lt+(Dt^yn&(pt^Dt))+mn[14]+2792965006&4294967295,Lt=yn+(fn<<17&4294967295|fn>>>15),fn=Dt+(pt^Lt&(yn^pt))+mn[15]+1236535329&4294967295,Dt=Lt+(fn<<22&4294967295|fn>>>10),fn=pt+(Lt^yn&(Dt^Lt))+mn[1]+4129170786&4294967295,pt=Dt+(fn<<5&4294967295|fn>>>27),fn=yn+(Dt^Lt&(pt^Dt))+mn[6]+3225465664&4294967295,yn=pt+(fn<<9&4294967295|fn>>>23),fn=Lt+(pt^Dt&(yn^pt))+mn[11]+643717713&4294967295,Lt=yn+(fn<<14&4294967295|fn>>>18),fn=Dt+(yn^pt&(Lt^yn))+mn[0]+3921069994&4294967295,Dt=Lt+(fn<<20&4294967295|fn>>>12),fn=pt+(Lt^yn&(Dt^Lt))+mn[5]+3593408605&4294967295,pt=Dt+(fn<<5&4294967295|fn>>>27),fn=yn+(Dt^Lt&(pt^Dt))+mn[10]+38016083&4294967295,yn=pt+(fn<<9&4294967295|fn>>>23),fn=Lt+(pt^Dt&(yn^pt))+mn[15]+3634488961&4294967295,Lt=yn+(fn<<14&4294967295|fn>>>18),fn=Dt+(yn^pt&(Lt^yn))+mn[4]+3889429448&4294967295,Dt=Lt+(fn<<20&4294967295|fn>>>12),fn=pt+(Lt^yn&(Dt^Lt))+mn[9]+568446438&4294967295,pt=Dt+(fn<<5&4294967295|fn>>>27),fn=yn+(Dt^Lt&(pt^Dt))+mn[14]+3275163606&4294967295,yn=pt+(fn<<9&4294967295|fn>>>23),fn=Lt+(pt^Dt&(yn^pt))+mn[3]+4107603335&4294967295,Lt=yn+(fn<<14&4294967295|fn>>>18),fn=Dt+(yn^pt&(Lt^yn))+mn[8]+1163531501&4294967295,Dt=Lt+(fn<<20&4294967295|fn>>>12),fn=pt+(Lt^yn&(Dt^Lt))+mn[13]+2850285829&4294967295,pt=Dt+(fn<<5&4294967295|fn>>>27),fn=yn+(Dt^Lt&(pt^Dt))+mn[2]+4243563512&4294967295,yn=pt+(fn<<9&4294967295|fn>>>23),fn=Lt+(pt^Dt&(yn^pt))+mn[7]+1735328473&4294967295,Lt=yn+(fn<<14&4294967295|fn>>>18),fn=Dt+(yn^pt&(Lt^yn))+mn[12]+2368359562&4294967295,Dt=Lt+(fn<<20&4294967295|fn>>>12),fn=pt+(Dt^Lt^yn)+mn[5]+4294588738&4294967295,pt=Dt+(fn<<4&4294967295|fn>>>28),fn=yn+(pt^Dt^Lt)+mn[8]+2272392833&4294967295,yn=pt+(fn<<11&4294967295|fn>>>21),fn=Lt+(yn^pt^Dt)+mn[11]+1839030562&4294967295,Lt=yn+(fn<<16&4294967295|fn>>>16),fn=Dt+(Lt^yn^pt)+mn[14]+4259657740&4294967295,Dt=Lt+(fn<<23&4294967295|fn>>>9),fn=pt+(Dt^Lt^yn)+mn[1]+2763975236&4294967295,pt=Dt+(fn<<4&4294967295|fn>>>28),fn=yn+(pt^Dt^Lt)+mn[4]+1272893353&4294967295,yn=pt+(fn<<11&4294967295|fn>>>21),fn=Lt+(yn^pt^Dt)+mn[7]+4139469664&4294967295,Lt=yn+(fn<<16&4294967295|fn>>>16),fn=Dt+(Lt^yn^pt)+mn[10]+3200236656&4294967295,Dt=Lt+(fn<<23&4294967295|fn>>>9),fn=pt+(Dt^Lt^yn)+mn[13]+681279174&4294967295,pt=Dt+(fn<<4&4294967295|fn>>>28),fn=yn+(pt^Dt^Lt)+mn[0]+3936430074&4294967295,yn=pt+(fn<<11&4294967295|fn>>>21),fn=Lt+(yn^pt^Dt)+mn[3]+3572445317&4294967295,Lt=yn+(fn<<16&4294967295|fn>>>16),fn=Dt+(Lt^yn^pt)+mn[6]+76029189&4294967295,Dt=Lt+(fn<<23&4294967295|fn>>>9),fn=pt+(Dt^Lt^yn)+mn[9]+3654602809&4294967295,pt=Dt+(fn<<4&4294967295|fn>>>28),fn=yn+(pt^Dt^Lt)+mn[12]+3873151461&4294967295,yn=pt+(fn<<11&4294967295|fn>>>21),fn=Lt+(yn^pt^Dt)+mn[15]+530742520&4294967295,Lt=yn+(fn<<16&4294967295|fn>>>16),fn=Dt+(Lt^yn^pt)+mn[2]+3299628645&4294967295,Dt=Lt+(fn<<23&4294967295|fn>>>9),fn=pt+(Lt^(Dt|~yn))+mn[0]+4096336452&4294967295,pt=Dt+(fn<<6&4294967295|fn>>>26),fn=yn+(Dt^(pt|~Lt))+mn[7]+1126891415&4294967295,yn=pt+(fn<<10&4294967295|fn>>>22),fn=Lt+(pt^(yn|~Dt))+mn[14]+2878612391&4294967295,Lt=yn+(fn<<15&4294967295|fn>>>17),fn=Dt+(yn^(Lt|~pt))+mn[5]+4237533241&4294967295,Dt=Lt+(fn<<21&4294967295|fn>>>11),fn=pt+(Lt^(Dt|~yn))+mn[12]+1700485571&4294967295,pt=Dt+(fn<<6&4294967295|fn>>>26),fn=yn+(Dt^(pt|~Lt))+mn[3]+2399980690&4294967295,yn=pt+(fn<<10&4294967295|fn>>>22),fn=Lt+(pt^(yn|~Dt))+mn[10]+4293915773&4294967295,Lt=yn+(fn<<15&4294967295|fn>>>17),fn=Dt+(yn^(Lt|~pt))+mn[1]+2240044497&4294967295,Dt=Lt+(fn<<21&4294967295|fn>>>11),fn=pt+(Lt^(Dt|~yn))+mn[8]+1873313359&4294967295,pt=Dt+(fn<<6&4294967295|fn>>>26),fn=yn+(Dt^(pt|~Lt))+mn[15]+4264355552&4294967295,yn=pt+(fn<<10&4294967295|fn>>>22),fn=Lt+(pt^(yn|~Dt))+mn[6]+2734768916&4294967295,Lt=yn+(fn<<15&4294967295|fn>>>17),fn=Dt+(yn^(Lt|~pt))+mn[13]+1309151649&4294967295,Dt=Lt+(fn<<21&4294967295|fn>>>11),fn=pt+(Lt^(Dt|~yn))+mn[4]+4149444226&4294967295,pt=Dt+(fn<<6&4294967295|fn>>>26),fn=yn+(Dt^(pt|~Lt))+mn[11]+3174756917&4294967295,yn=pt+(fn<<10&4294967295|fn>>>22),fn=Lt+(pt^(yn|~Dt))+mn[2]+718787259&4294967295,Lt=yn+(fn<<15&4294967295|fn>>>17),fn=Dt+(yn^(Lt|~pt))+mn[9]+3951481745&4294967295,It.g[0]=It.g[0]+pt&4294967295,It.g[1]=It.g[1]+(Lt+(fn<<21&4294967295|fn>>>11))&4294967295,It.g[2]=It.g[2]+Lt&4294967295,It.g[3]=It.g[3]+yn&4294967295}o.prototype.u=function(It,pt){pt===void 0&&(pt=It.length);for(var Dt=pt-this.blockSize,mn=this.B,Lt=this.h,yn=0;yn<pt;){if(Lt==0)for(;yn<=Dt;)a(this,It,yn),yn+=this.blockSize;if(typeof It=="string"){for(;yn<pt;)if(mn[Lt++]=It.charCodeAt(yn++),Lt==this.blockSize){a(this,mn),Lt=0;break}}else for(;yn<pt;)if(mn[Lt++]=It[yn++],Lt==this.blockSize){a(this,mn),Lt=0;break}}this.h=Lt,this.o+=pt},o.prototype.v=function(){var It=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);It[0]=128;for(var pt=1;pt<It.length-8;++pt)It[pt]=0;var Dt=8*this.o;for(pt=It.length-8;pt<It.length;++pt)It[pt]=Dt&255,Dt/=256;for(this.u(It),It=Array(16),pt=Dt=0;4>pt;++pt)for(var mn=0;32>mn;mn+=8)It[Dt++]=this.g[pt]>>>mn&255;return It};function j(It,pt){var Dt=tt;return Object.prototype.hasOwnProperty.call(Dt,It)?Dt[It]:Dt[It]=pt(It)}function _e(It,pt){this.h=pt;for(var Dt=[],mn=!0,Lt=It.length-1;0<=Lt;Lt--){var yn=It[Lt]|0;mn&&yn==pt||(Dt[Lt]=yn,mn=!1)}this.g=Dt}var tt={};function et(It){return-128<=It&&128>It?j(It,function(pt){return new _e([pt|0],0>pt?-1:0)}):new _e([It|0],0>It?-1:0)}function rt(It){if(isNaN(It)||!isFinite(It))return vt;if(0>It)return Ut(rt(-It));for(var pt=[],Dt=1,mn=0;It>=Dt;mn++)pt[mn]=It/Dt|0,Dt*=4294967296;return new _e(pt,0)}function dt(It,pt){if(It.length==0)throw Error("number format error: empty string");if(pt=pt||10,2>pt||36<pt)throw Error("radix out of range: "+pt);if(It.charAt(0)=="-")return Ut(dt(It.substring(1),pt));if(0<=It.indexOf("-"))throw Error('number format error: interior "-" character');for(var Dt=rt(Math.pow(pt,8)),mn=vt,Lt=0;Lt<It.length;Lt+=8){var yn=Math.min(8,It.length-Lt),fn=parseInt(It.substring(Lt,Lt+yn),pt);8>yn?(yn=rt(Math.pow(pt,yn)),mn=mn.j(yn).add(rt(fn))):(mn=mn.j(Dt),mn=mn.add(rt(fn)))}return mn}var vt=et(0),Ct=et(1),Wt=et(16777216);s=_e.prototype,s.m=function(){if(qt(this))return-Ut(this).m();for(var It=0,pt=1,Dt=0;Dt<this.g.length;Dt++){var mn=this.i(Dt);It+=(0<=mn?mn:4294967296+mn)*pt,pt*=4294967296}return It},s.toString=function(It){if(It=It||10,2>It||36<It)throw Error("radix out of range: "+It);if(Bt(this))return"0";if(qt(this))return"-"+Ut(this).toString(It);for(var pt=rt(Math.pow(It,6)),Dt=this,mn="";;){var Lt=dn(Dt,pt).g;Dt=kt(Dt,Lt.j(pt));var yn=((0<Dt.g.length?Dt.g[0]:Dt.h)>>>0).toString(It);if(Dt=Lt,Bt(Dt))return yn+mn;for(;6>yn.length;)yn="0"+yn;mn=yn+mn}},s.i=function(It){return 0>It?0:It<this.g.length?this.g[It]:this.h};function Bt(It){if(It.h!=0)return!1;for(var pt=0;pt<It.g.length;pt++)if(It.g[pt]!=0)return!1;return!0}function qt(It){return It.h==-1}s.l=function(It){return It=kt(this,It),qt(It)?-1:Bt(It)?0:1};function Ut(It){for(var pt=It.g.length,Dt=[],mn=0;mn<pt;mn++)Dt[mn]=~It.g[mn];return new _e(Dt,~It.h).add(Ct)}s.abs=function(){return qt(this)?Ut(this):this},s.add=function(It){for(var pt=Math.max(this.g.length,It.g.length),Dt=[],mn=0,Lt=0;Lt<=pt;Lt++){var yn=mn+(this.i(Lt)&65535)+(It.i(Lt)&65535),fn=(yn>>>16)+(this.i(Lt)>>>16)+(It.i(Lt)>>>16);mn=fn>>>16,yn&=65535,fn&=65535,Dt[Lt]=fn<<16|yn}return new _e(Dt,Dt[Dt.length-1]&-2147483648?-1:0)};function kt(It,pt){return It.add(Ut(pt))}s.j=function(It){if(Bt(this)||Bt(It))return vt;if(qt(this))return qt(It)?Ut(this).j(Ut(It)):Ut(Ut(this).j(It));if(qt(It))return Ut(this.j(Ut(It)));if(0>this.l(Wt)&&0>It.l(Wt))return rt(this.m()*It.m());for(var pt=this.g.length+It.g.length,Dt=[],mn=0;mn<2*pt;mn++)Dt[mn]=0;for(mn=0;mn<this.g.length;mn++)for(var Lt=0;Lt<It.g.length;Lt++){var yn=this.i(mn)>>>16,fn=this.i(mn)&65535,$n=It.i(Lt)>>>16,Ln=It.i(Lt)&65535;Dt[2*mn+2*Lt]+=fn*Ln,Nt(Dt,2*mn+2*Lt),Dt[2*mn+2*Lt+1]+=yn*Ln,Nt(Dt,2*mn+2*Lt+1),Dt[2*mn+2*Lt+1]+=fn*$n,Nt(Dt,2*mn+2*Lt+1),Dt[2*mn+2*Lt+2]+=yn*$n,Nt(Dt,2*mn+2*Lt+2)}for(mn=0;mn<pt;mn++)Dt[mn]=Dt[2*mn+1]<<16|Dt[2*mn];for(mn=pt;mn<2*pt;mn++)Dt[mn]=0;return new _e(Dt,0)};function Nt(It,pt){for(;(It[pt]&65535)!=It[pt];)It[pt+1]+=It[pt]>>>16,It[pt]&=65535,pt++}function un(It,pt){this.g=It,this.h=pt}function dn(It,pt){if(Bt(pt))throw Error("division by zero");if(Bt(It))return new un(vt,vt);if(qt(It))return pt=dn(Ut(It),pt),new un(Ut(pt.g),Ut(pt.h));if(qt(pt))return pt=dn(It,Ut(pt)),new un(Ut(pt.g),pt.h);if(30<It.g.length){if(qt(It)||qt(pt))throw Error("slowDivide_ only works with positive integers.");for(var Dt=Ct,mn=pt;0>=mn.l(It);)Dt=hn(Dt),mn=hn(mn);var Lt=gn(Dt,1),yn=gn(mn,1);for(mn=gn(mn,2),Dt=gn(Dt,2);!Bt(mn);){var fn=yn.add(mn);0>=fn.l(It)&&(Lt=Lt.add(Dt),yn=fn),mn=gn(mn,1),Dt=gn(Dt,1)}return pt=kt(It,Lt.j(pt)),new un(Lt,pt)}for(Lt=vt;0<=It.l(pt);){for(Dt=Math.max(1,Math.floor(It.m()/pt.m())),mn=Math.ceil(Math.log(Dt)/Math.LN2),mn=48>=mn?1:Math.pow(2,mn-48),yn=rt(Dt),fn=yn.j(pt);qt(fn)||0<fn.l(It);)Dt-=mn,yn=rt(Dt),fn=yn.j(pt);Bt(yn)&&(yn=Ct),Lt=Lt.add(yn),It=kt(It,fn)}return new un(Lt,It)}s.A=function(It){return dn(this,It).h},s.and=function(It){for(var pt=Math.max(this.g.length,It.g.length),Dt=[],mn=0;mn<pt;mn++)Dt[mn]=this.i(mn)&It.i(mn);return new _e(Dt,this.h&It.h)},s.or=function(It){for(var pt=Math.max(this.g.length,It.g.length),Dt=[],mn=0;mn<pt;mn++)Dt[mn]=this.i(mn)|It.i(mn);return new _e(Dt,this.h|It.h)},s.xor=function(It){for(var pt=Math.max(this.g.length,It.g.length),Dt=[],mn=0;mn<pt;mn++)Dt[mn]=this.i(mn)^It.i(mn);return new _e(Dt,this.h^It.h)};function hn(It){for(var pt=It.g.length+1,Dt=[],mn=0;mn<pt;mn++)Dt[mn]=It.i(mn)<<1|It.i(mn-1)>>>31;return new _e(Dt,It.h)}function gn(It,pt){var Dt=pt>>5;pt%=32;for(var mn=It.g.length-Dt,Lt=[],yn=0;yn<mn;yn++)Lt[yn]=0<pt?It.i(yn+Dt)>>>pt|It.i(yn+Dt+1)<<32-pt:It.i(yn+Dt);return new _e(Lt,It.h)}o.prototype.digest=o.prototype.v,o.prototype.reset=o.prototype.s,o.prototype.update=o.prototype.u,Md5=o,_e.prototype.add=_e.prototype.add,_e.prototype.multiply=_e.prototype.j,_e.prototype.modulo=_e.prototype.A,_e.prototype.compare=_e.prototype.l,_e.prototype.toNumber=_e.prototype.m,_e.prototype.toString=_e.prototype.toString,_e.prototype.getBits=_e.prototype.i,_e.fromNumber=rt,_e.fromString=dt,Integer=_e}).apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{});var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XhrIo,WebChannel,EventType,ErrorCode$1,Stat,Event$1,getStatEventTarget,createWebChannelTransport;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(nt,Gt,vn){return nt==Array.prototype||nt==Object.prototype||(nt[Gt]=vn.value),nt};function i(nt){nt=[typeof globalThis=="object"&&globalThis,nt,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var Gt=0;Gt<nt.length;++Gt){var vn=nt[Gt];if(vn&&vn.Math==Math)return vn}throw Error("Cannot find global object")}var o=i(this);function a(nt,Gt){if(Gt)e:{var vn=o;nt=nt.split(".");for(var In=0;In<nt.length-1;In++){var tr=nt[In];if(!(tr in vn))break e;vn=vn[tr]}nt=nt[nt.length-1],In=vn[nt],Gt=Gt(In),Gt!=In&&Gt!=null&&e(vn,nt,{configurable:!0,writable:!0,value:Gt})}}function j(nt,Gt){nt instanceof String&&(nt+="");var vn=0,In=!1,tr={next:function(){if(!In&&vn<nt.length){var dr=vn++;return{value:Gt(dr,nt[dr]),done:!1}}return In=!0,{done:!0,value:void 0}}};return tr[Symbol.iterator]=function(){return tr},tr}a("Array.prototype.values",function(nt){return nt||function(){return j(this,function(Gt,vn){return vn})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var _e=_e||{},tt=this||self;function et(nt){var Gt=typeof nt;return Gt=Gt!="object"?Gt:nt?Array.isArray(nt)?"array":Gt:"null",Gt=="array"||Gt=="object"&&typeof nt.length=="number"}function rt(nt){var Gt=typeof nt;return Gt=="object"&&nt!=null||Gt=="function"}function dt(nt,Gt,vn){return nt.call.apply(nt.bind,arguments)}function vt(nt,Gt,vn){if(!nt)throw Error();if(2<arguments.length){var In=Array.prototype.slice.call(arguments,2);return function(){var tr=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(tr,In),nt.apply(Gt,tr)}}return function(){return nt.apply(Gt,arguments)}}function Ct(nt,Gt,vn){return Ct=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?dt:vt,Ct.apply(null,arguments)}function Wt(nt,Gt){var vn=Array.prototype.slice.call(arguments,1);return function(){var In=vn.slice();return In.push.apply(In,arguments),nt.apply(this,In)}}function Bt(nt,Gt){function vn(){}vn.prototype=Gt.prototype,nt.aa=Gt.prototype,nt.prototype=new vn,nt.prototype.constructor=nt,nt.Qb=function(In,tr,dr){for(var Pr=Array(arguments.length-2),Wr=2;Wr<arguments.length;Wr++)Pr[Wr-2]=arguments[Wr];return Gt.prototype[tr].apply(In,Pr)}}function qt(nt){const Gt=nt.length;if(0<Gt){const vn=Array(Gt);for(let In=0;In<Gt;In++)vn[In]=nt[In];return vn}return[]}function Ut(nt,Gt){for(let vn=1;vn<arguments.length;vn++){const In=arguments[vn];if(et(In)){const tr=nt.length||0,dr=In.length||0;nt.length=tr+dr;for(let Pr=0;Pr<dr;Pr++)nt[tr+Pr]=In[Pr]}else nt.push(In)}}class kt{constructor(Gt,vn){this.i=Gt,this.j=vn,this.h=0,this.g=null}get(){let Gt;return 0<this.h?(this.h--,Gt=this.g,this.g=Gt.next,Gt.next=null):Gt=this.i(),Gt}}function Nt(nt){return/^[\s\xa0]*$/.test(nt)}function un(){var nt=tt.navigator;return nt&&(nt=nt.userAgent)?nt:""}function dn(nt){return dn[" "](nt),nt}dn[" "]=function(){};var hn=un().indexOf("Gecko")!=-1&&!(un().toLowerCase().indexOf("webkit")!=-1&&un().indexOf("Edge")==-1)&&!(un().indexOf("Trident")!=-1||un().indexOf("MSIE")!=-1)&&un().indexOf("Edge")==-1;function gn(nt,Gt,vn){for(const In in nt)Gt.call(vn,nt[In],In,nt)}function It(nt,Gt){for(const vn in nt)Gt.call(void 0,nt[vn],vn,nt)}function pt(nt){const Gt={};for(const vn in nt)Gt[vn]=nt[vn];return Gt}const Dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mn(nt,Gt){let vn,In;for(let tr=1;tr<arguments.length;tr++){In=arguments[tr];for(vn in In)nt[vn]=In[vn];for(let dr=0;dr<Dt.length;dr++)vn=Dt[dr],Object.prototype.hasOwnProperty.call(In,vn)&&(nt[vn]=In[vn])}}function Lt(nt){var Gt=1;nt=nt.split(":");const vn=[];for(;0<Gt&&nt.length;)vn.push(nt.shift()),Gt--;return nt.length&&vn.push(nt.join(":")),vn}function yn(nt){tt.setTimeout(()=>{throw nt},0)}function fn(){var nt=Rn;let Gt=null;return nt.g&&(Gt=nt.g,nt.g=nt.g.next,nt.g||(nt.h=null),Gt.next=null),Gt}class $n{constructor(){this.h=this.g=null}add(Gt,vn){const In=Ln.get();In.set(Gt,vn),this.h?this.h.next=In:this.g=In,this.h=In}}var Ln=new kt(()=>new jn,nt=>nt.reset());class jn{constructor(){this.next=this.g=this.h=null}set(Gt,vn){this.h=Gt,this.g=vn,this.next=null}reset(){this.next=this.g=this.h=null}}let On,Vn=!1,Rn=new $n,Dn=()=>{const nt=tt.Promise.resolve(void 0);On=()=>{nt.then(Fn)}};var Fn=()=>{for(var nt;nt=fn();){try{nt.h.call(nt.g)}catch(vn){yn(vn)}var Gt=Ln;Gt.j(nt),100>Gt.h&&(Gt.h++,nt.next=Gt.g,Gt.g=nt)}Vn=!1};function Tn(){this.s=this.s,this.C=this.C}Tn.prototype.s=!1,Tn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Tn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pn(nt,Gt){this.type=nt,this.g=this.target=Gt,this.defaultPrevented=!1}pn.prototype.h=function(){this.defaultPrevented=!0};var En=function(){if(!tt.addEventListener||!Object.defineProperty)return!1;var nt=!1,Gt=Object.defineProperty({},"passive",{get:function(){nt=!0}});try{const vn=()=>{};tt.addEventListener("test",vn,Gt),tt.removeEventListener("test",vn,Gt)}catch{}return nt}();function An(nt,Gt){if(pn.call(this,nt?nt.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,nt){var vn=this.type=nt.type,In=nt.changedTouches&&nt.changedTouches.length?nt.changedTouches[0]:null;if(this.target=nt.target||nt.srcElement,this.g=Gt,Gt=nt.relatedTarget){if(hn){e:{try{dn(Gt.nodeName);var tr=!0;break e}catch{}tr=!1}tr||(Gt=null)}}else vn=="mouseover"?Gt=nt.fromElement:vn=="mouseout"&&(Gt=nt.toElement);this.relatedTarget=Gt,In?(this.clientX=In.clientX!==void 0?In.clientX:In.pageX,this.clientY=In.clientY!==void 0?In.clientY:In.pageY,this.screenX=In.screenX||0,this.screenY=In.screenY||0):(this.clientX=nt.clientX!==void 0?nt.clientX:nt.pageX,this.clientY=nt.clientY!==void 0?nt.clientY:nt.pageY,this.screenX=nt.screenX||0,this.screenY=nt.screenY||0),this.button=nt.button,this.key=nt.key||"",this.ctrlKey=nt.ctrlKey,this.altKey=nt.altKey,this.shiftKey=nt.shiftKey,this.metaKey=nt.metaKey,this.pointerId=nt.pointerId||0,this.pointerType=typeof nt.pointerType=="string"?nt.pointerType:bn[nt.pointerType]||"",this.state=nt.state,this.i=nt,nt.defaultPrevented&&An.aa.h.call(this)}}Bt(An,pn);var bn={2:"touch",3:"pen",4:"mouse"};An.prototype.h=function(){An.aa.h.call(this);var nt=this.i;nt.preventDefault?nt.preventDefault():nt.returnValue=!1};var wn="closure_listenable_"+(1e6*Math.random()|0),Cn=0;function Un(nt,Gt,vn,In,tr){this.listener=nt,this.proxy=null,this.src=Gt,this.type=vn,this.capture=!!In,this.ha=tr,this.key=++Cn,this.da=this.fa=!1}function Gn(nt){nt.da=!0,nt.listener=null,nt.proxy=null,nt.src=null,nt.ha=null}function er(nt){this.src=nt,this.g={},this.h=0}er.prototype.add=function(nt,Gt,vn,In,tr){var dr=nt.toString();nt=this.g[dr],nt||(nt=this.g[dr]=[],this.h++);var Pr=ar(nt,Gt,In,tr);return-1<Pr?(Gt=nt[Pr],vn||(Gt.fa=!1)):(Gt=new Un(Gt,this.src,dr,!!In,tr),Gt.fa=vn,nt.push(Gt)),Gt};function nr(nt,Gt){var vn=Gt.type;if(vn in nt.g){var In=nt.g[vn],tr=Array.prototype.indexOf.call(In,Gt,void 0),dr;(dr=0<=tr)&&Array.prototype.splice.call(In,tr,1),dr&&(Gn(Gt),nt.g[vn].length==0&&(delete nt.g[vn],nt.h--))}}function ar(nt,Gt,vn,In){for(var tr=0;tr<nt.length;++tr){var dr=nt[tr];if(!dr.da&&dr.listener==Gt&&dr.capture==!!vn&&dr.ha==In)return tr}return-1}var or="closure_lm_"+(1e6*Math.random()|0),lr={};function zn(nt,Gt,vn,In,tr){if(Array.isArray(Gt)){for(var dr=0;dr<Gt.length;dr++)zn(nt,Gt[dr],vn,In,tr);return null}return vn=qn(vn),nt&&nt[wn]?nt.K(Gt,vn,rt(In)?!!In.capture:!1,tr):Hn(nt,Gt,vn,!1,In,tr)}function Hn(nt,Gt,vn,In,tr,dr){if(!Gt)throw Error("Invalid event type");var Pr=rt(tr)?!!tr.capture:!!tr,Wr=fr(nt);if(Wr||(nt[or]=Wr=new er(nt)),vn=Wr.add(Gt,vn,In,Pr,dr),vn.proxy)return vn;if(In=Pn(),vn.proxy=In,In.src=nt,In.listener=vn,nt.addEventListener)En||(tr=Pr),tr===void 0&&(tr=!1),nt.addEventListener(Gt.toString(),In,tr);else if(nt.attachEvent)nt.attachEvent(Kn(Gt.toString()),In);else if(nt.addListener&&nt.removeListener)nt.addListener(In);else throw Error("addEventListener and attachEvent are unavailable.");return vn}function Pn(){function nt(vn){return Gt.call(nt.src,nt.listener,vn)}const Gt=sr;return nt}function kn(nt,Gt,vn,In,tr){if(Array.isArray(Gt))for(var dr=0;dr<Gt.length;dr++)kn(nt,Gt[dr],vn,In,tr);else In=rt(In)?!!In.capture:!!In,vn=qn(vn),nt&&nt[wn]?(nt=nt.i,Gt=String(Gt).toString(),Gt in nt.g&&(dr=nt.g[Gt],vn=ar(dr,vn,In,tr),-1<vn&&(Gn(dr[vn]),Array.prototype.splice.call(dr,vn,1),dr.length==0&&(delete nt.g[Gt],nt.h--)))):nt&&(nt=fr(nt))&&(Gt=nt.g[Gt.toString()],nt=-1,Gt&&(nt=ar(Gt,vn,In,tr)),(vn=-1<nt?Gt[nt]:null)&&Bn(vn))}function Bn(nt){if(typeof nt!="number"&&nt&&!nt.da){var Gt=nt.src;if(Gt&&Gt[wn])nr(Gt.i,nt);else{var vn=nt.type,In=nt.proxy;Gt.removeEventListener?Gt.removeEventListener(vn,In,nt.capture):Gt.detachEvent?Gt.detachEvent(Kn(vn),In):Gt.addListener&&Gt.removeListener&&Gt.removeListener(In),(vn=fr(Gt))?(nr(vn,nt),vn.h==0&&(vn.src=null,Gt[or]=null)):Gn(nt)}}}function Kn(nt){return nt in lr?lr[nt]:lr[nt]="on"+nt}function sr(nt,Gt){if(nt.da)nt=!0;else{Gt=new An(Gt,this);var vn=nt.listener,In=nt.ha||nt.src;nt.fa&&Bn(nt),nt=vn.call(In,Gt)}return nt}function fr(nt){return nt=nt[or],nt instanceof er?nt:null}var ur="__closure_events_fn_"+(1e9*Math.random()>>>0);function qn(nt){return typeof nt=="function"?nt:(nt[ur]||(nt[ur]=function(Gt){return nt.handleEvent(Gt)}),nt[ur])}function gr(){Tn.call(this),this.i=new er(this),this.M=this,this.F=null}Bt(gr,Tn),gr.prototype[wn]=!0,gr.prototype.removeEventListener=function(nt,Gt,vn,In){kn(this,nt,Gt,vn,In)};function mr(nt,Gt){var vn,In=nt.F;if(In)for(vn=[];In;In=In.F)vn.push(In);if(nt=nt.M,In=Gt.type||Gt,typeof Gt=="string")Gt=new pn(Gt,nt);else if(Gt instanceof pn)Gt.target=Gt.target||nt;else{var tr=Gt;Gt=new pn(In,nt),mn(Gt,tr)}if(tr=!0,vn)for(var dr=vn.length-1;0<=dr;dr--){var Pr=Gt.g=vn[dr];tr=Dr(Pr,In,!0,Gt)&&tr}if(Pr=Gt.g=nt,tr=Dr(Pr,In,!0,Gt)&&tr,tr=Dr(Pr,In,!1,Gt)&&tr,vn)for(dr=0;dr<vn.length;dr++)Pr=Gt.g=vn[dr],tr=Dr(Pr,In,!1,Gt)&&tr}gr.prototype.N=function(){if(gr.aa.N.call(this),this.i){var nt=this.i,Gt;for(Gt in nt.g){for(var vn=nt.g[Gt],In=0;In<vn.length;In++)Gn(vn[In]);delete nt.g[Gt],nt.h--}}this.F=null},gr.prototype.K=function(nt,Gt,vn,In){return this.i.add(String(nt),Gt,!1,vn,In)},gr.prototype.L=function(nt,Gt,vn,In){return this.i.add(String(nt),Gt,!0,vn,In)};function Dr(nt,Gt,vn,In){if(Gt=nt.i.g[String(Gt)],!Gt)return!0;Gt=Gt.concat();for(var tr=!0,dr=0;dr<Gt.length;++dr){var Pr=Gt[dr];if(Pr&&!Pr.da&&Pr.capture==vn){var Wr=Pr.listener,Xr=Pr.ha||Pr.src;Pr.fa&&nr(nt.i,Pr),tr=Wr.call(Xr,In)!==!1&&tr}}return tr&&!In.defaultPrevented}function Cr(nt,Gt,vn){if(typeof nt=="function")vn&&(nt=Ct(nt,vn));else if(nt&&typeof nt.handleEvent=="function")nt=Ct(nt.handleEvent,nt);else throw Error("Invalid listener argument");return 2147483647<Number(Gt)?-1:tt.setTimeout(nt,Gt||0)}function Mr(nt){nt.g=Cr(()=>{nt.g=null,nt.i&&(nt.i=!1,Mr(nt))},nt.l);const Gt=nt.h;nt.h=null,nt.m.apply(null,Gt)}class Tr extends Tn{constructor(Gt,vn){super(),this.m=Gt,this.l=vn,this.h=null,this.i=!1,this.g=null}j(Gt){this.h=arguments,this.g?this.i=!0:Mr(this)}N(){super.N(),this.g&&(tt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rr(nt){Tn.call(this),this.h=nt,this.g={}}Bt(Rr,Tn);var Or=[];function jr(nt){gn(nt.g,function(Gt,vn){this.g.hasOwnProperty(vn)&&Bn(Gt)},nt),nt.g={}}Rr.prototype.N=function(){Rr.aa.N.call(this),jr(this)},Rr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hr=tt.JSON.stringify,Xn=tt.JSON.parse,Zn=class{stringify(nt){return tt.JSON.stringify(nt,void 0)}parse(nt){return tt.JSON.parse(nt,void 0)}};function vr(){}vr.prototype.h=null;function Fr(nt){return nt.h||(nt.h=nt.i())}function Lr(){}var Nn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ir(){pn.call(this,"d")}Bt(ir,pn);function _r(){pn.call(this,"c")}Bt(_r,pn);var Ar={},xr=null;function Er(){return xr=xr||new gr}Ar.La="serverreachability";function xn(nt){pn.call(this,Ar.La,nt)}Bt(xn,pn);function Sn(nt){const Gt=Er();mr(Gt,new xn(Gt))}Ar.STAT_EVENT="statevent";function Mn(nt,Gt){pn.call(this,Ar.STAT_EVENT,nt),this.stat=Gt}Bt(Mn,pn);function Qn(nt){const Gt=Er();mr(Gt,new Mn(Gt,nt))}Ar.Ma="timingevent";function rr(nt,Gt){pn.call(this,Ar.Ma,nt),this.size=Gt}Bt(rr,pn);function cr(nt,Gt){if(typeof nt!="function")throw Error("Fn must not be null and must be a function");return tt.setTimeout(function(){nt()},Gt)}function pr(){this.g=!0}pr.prototype.xa=function(){this.g=!1};function br(nt,Gt,vn,In,tr,dr){nt.info(function(){if(nt.g)if(dr)for(var Pr="",Wr=dr.split("&"),Xr=0;Xr<Wr.length;Xr++){var Br=Wr[Xr].split("=");if(1<Br.length){var Yr=Br[0];Br=Br[1];var Qr=Yr.split("_");Pr=2<=Qr.length&&Qr[1]=="type"?Pr+(Yr+"="+Br+"&"):Pr+(Yr+"=redacted&")}}else Pr=null;else Pr=dr;return"XMLHTTP REQ ("+In+") [attempt "+tr+"]: "+Gt+`
`+vn+`
`+Pr})}function Sr(nt,Gt,vn,In,tr,dr,Pr){nt.info(function(){return"XMLHTTP RESP ("+In+") [ attempt "+tr+"]: "+Gt+`
`+vn+`
`+dr+" "+Pr})}function yr(nt,Gt,vn,In){nt.info(function(){return"XMLHTTP TEXT ("+Gt+"): "+Ir(nt,vn)+(In?" "+In:"")})}function Nr(nt,Gt){nt.info(function(){return"TIMEOUT: "+Gt})}pr.prototype.info=function(){};function Ir(nt,Gt){if(!nt.g)return Gt;if(!Gt)return null;try{var vn=JSON.parse(Gt);if(vn){for(nt=0;nt<vn.length;nt++)if(Array.isArray(vn[nt])){var In=vn[nt];if(!(2>In.length)){var tr=In[1];if(Array.isArray(tr)&&!(1>tr.length)){var dr=tr[0];if(dr!="noop"&&dr!="stop"&&dr!="close")for(var Pr=1;Pr<tr.length;Pr++)tr[Pr]=""}}}}return hr(vn)}catch{return Gt}}var wr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},kr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Vr;function $r(){}Bt($r,vr),$r.prototype.g=function(){return new XMLHttpRequest},$r.prototype.i=function(){return{}},Vr=new $r;function Ur(nt,Gt,vn,In){this.j=nt,this.i=Gt,this.l=vn,this.R=In||1,this.U=new Rr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Kr}function Kr(){this.i=null,this.g="",this.h=!1}var Hr={},Jr={};function es(nt,Gt,vn){nt.L=1,nt.v=Us(ss(Gt)),nt.m=vn,nt.P=!0,ns(nt,null)}function ns(nt,Gt){nt.F=Date.now(),Fs(nt),nt.A=ss(nt.v);var vn=nt.A,In=nt.R;Array.isArray(In)||(In=[String(In)]),Pl(vn.i,"t",In),nt.C=0,vn=nt.j.J,nt.h=new Kr,nt.g=Hl(nt.j,vn?Gt:null,!nt.m),0<nt.O&&(nt.M=new Tr(Ct(nt.Y,nt,nt.g),nt.O)),Gt=nt.U,vn=nt.g,In=nt.ca;var tr="readystatechange";Array.isArray(tr)||(tr&&(Or[0]=tr.toString()),tr=Or);for(var dr=0;dr<tr.length;dr++){var Pr=zn(vn,tr[dr],In||Gt.handleEvent,!1,Gt.h||Gt);if(!Pr)break;Gt.g[Pr.key]=Pr}Gt=nt.H?pt(nt.H):{},nt.m?(nt.u||(nt.u="POST"),Gt["Content-Type"]="application/x-www-form-urlencoded",nt.g.ea(nt.A,nt.u,nt.m,Gt)):(nt.u="GET",nt.g.ea(nt.A,nt.u,null,Gt)),Sn(),br(nt.i,nt.u,nt.A,nt.l,nt.R,nt.m)}Ur.prototype.ca=function(nt){nt=nt.target;const Gt=this.M;Gt&&is(nt)==3?Gt.j():this.Y(nt)},Ur.prototype.Y=function(nt){try{if(nt==this.g)e:{const Qr=is(this.g);var Gt=this.g.Ba();const ms=this.g.Z();if(!(3>Qr)&&(Qr!=3||this.g&&(this.h.h||this.g.oa()||Nl(this.g)))){this.J||Qr!=4||Gt==7||(Gt==8||0>=ms?Sn(3):Sn(2)),co(this);var vn=this.g.Z();this.X=vn;t:if(As(this)){var In=Nl(this.g);nt="";var tr=In.length,dr=is(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cs(this),Ts(this);var Pr="";break t}this.h.i=new tt.TextDecoder}for(Gt=0;Gt<tr;Gt++)this.h.h=!0,nt+=this.h.i.decode(In[Gt],{stream:!(dr&&Gt==tr-1)});In.length=0,this.h.g+=nt,this.C=0,Pr=this.h.g}else Pr=this.g.oa();if(this.o=vn==200,Sr(this.i,this.u,this.A,this.l,this.R,Qr,vn),this.o){if(this.T&&!this.K){t:{if(this.g){var Wr,Xr=this.g;if((Wr=Xr.g?Xr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nt(Wr)){var Br=Wr;break t}}Br=null}if(vn=Br)yr(this.i,this.l,vn,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,uo(this,vn);else{this.o=!1,this.s=3,Qn(12),cs(this),Ts(this);break e}}if(this.P){vn=!0;let rs;for(;!this.J&&this.C<Pr.length;)if(rs=Cu(this,Pr),rs==Jr){Qr==4&&(this.s=4,Qn(14),vn=!1),yr(this.i,this.l,null,"[Incomplete Response]");break}else if(rs==Hr){this.s=4,Qn(15),yr(this.i,this.l,Pr,"[Invalid Chunk]"),vn=!1;break}else yr(this.i,this.l,rs,null),uo(this,rs);if(As(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qr!=4||Pr.length!=0||this.h.h||(this.s=1,Qn(16),vn=!1),this.o=this.o&&vn,!vn)yr(this.i,this.l,Pr,"[Invalid Chunked Response]"),cs(this),Ts(this);else if(0<Pr.length&&!this.W){this.W=!0;var Yr=this.j;Yr.g==this&&Yr.ba&&!Yr.M&&(Yr.j.info("Great, no buffering proxy detected. Bytes received: "+Pr.length),_o(Yr),Yr.M=!0,Qn(11))}}else yr(this.i,this.l,Pr,null),uo(this,Pr);Qr==4&&cs(this),this.o&&!this.J&&(Qr==4?Ul(this.j,this):(this.o=!1,Fs(this)))}else Gu(this.g),vn==400&&0<Pr.indexOf("Unknown SID")?(this.s=3,Qn(12)):(this.s=0,Qn(13)),cs(this),Ts(this)}}}catch{}finally{}};function As(nt){return nt.g?nt.u=="GET"&&nt.L!=2&&nt.j.Ca:!1}function Cu(nt,Gt){var vn=nt.C,In=Gt.indexOf(`
`,vn);return In==-1?Jr:(vn=Number(Gt.substring(vn,In)),isNaN(vn)?Hr:(In+=1,In+vn>Gt.length?Jr:(Gt=Gt.slice(In,In+vn),nt.C=In+vn,Gt)))}Ur.prototype.cancel=function(){this.J=!0,cs(this)};function Fs(nt){nt.S=Date.now()+nt.I,na(nt,nt.I)}function na(nt,Gt){if(nt.B!=null)throw Error("WatchDog timer not null");nt.B=cr(Ct(nt.ba,nt),Gt)}function co(nt){nt.B&&(tt.clearTimeout(nt.B),nt.B=null)}Ur.prototype.ba=function(){this.B=null;const nt=Date.now();0<=nt-this.S?(Nr(this.i,this.A),this.L!=2&&(Sn(),Qn(17)),cs(this),this.s=2,Ts(this)):na(this,this.S-nt)};function Ts(nt){nt.j.G==0||nt.J||Ul(nt.j,nt)}function cs(nt){co(nt);var Gt=nt.M;Gt&&typeof Gt.ma=="function"&&Gt.ma(),nt.M=null,jr(nt.U),nt.g&&(Gt=nt.g,nt.g=null,Gt.abort(),Gt.ma())}function uo(nt,Gt){try{var vn=nt.j;if(vn.G!=0&&(vn.g==nt||ho(vn.h,nt))){if(!nt.K&&ho(vn.h,nt)&&vn.G==3){try{var In=vn.Da.g.parse(Gt)}catch{In=null}if(Array.isArray(In)&&In.length==3){var tr=In;if(tr[0]==0){e:if(!vn.u){if(vn.g)if(vn.g.F+3e3<nt.F)Gs(vn),Hs(vn);else break e;go(vn),Qn(18)}}else vn.za=tr[1],0<vn.za-vn.T&&37500>tr[2]&&vn.F&&vn.v==0&&!vn.C&&(vn.C=cr(Ct(vn.Za,vn),6e3));if(1>=ba(vn.h)&&vn.ca){try{vn.ca()}catch{}vn.ca=void 0}}else hs(vn,11)}else if((nt.K||vn.g==nt)&&Gs(vn),!Nt(Gt))for(tr=vn.Da.g.parse(Gt),Gt=0;Gt<tr.length;Gt++){let Br=tr[Gt];if(vn.T=Br[0],Br=Br[1],vn.G==2)if(Br[0]=="c"){vn.K=Br[1],vn.ia=Br[2];const Yr=Br[3];Yr!=null&&(vn.la=Yr,vn.j.info("VER="+vn.la));const Qr=Br[4];Qr!=null&&(vn.Aa=Qr,vn.j.info("SVER="+vn.Aa));const ms=Br[5];ms!=null&&typeof ms=="number"&&0<ms&&(In=1.5*ms,vn.L=In,vn.j.info("backChannelRequestTimeoutMs_="+In)),In=vn;const rs=nt.g;if(rs){const Xs=rs.g?rs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xs){var dr=In.h;dr.g||Xs.indexOf("spdy")==-1&&Xs.indexOf("quic")==-1&&Xs.indexOf("h2")==-1||(dr.j=dr.l,dr.g=new Set,dr.h&&(fo(dr,dr.h),dr.h=null))}if(In.D){const yo=rs.g?rs.g.getResponseHeader("X-HTTP-Session-Id"):null;yo&&(In.ya=yo,qr(In.I,In.D,yo))}}vn.G=3,vn.l&&vn.l.ua(),vn.ba&&(vn.R=Date.now()-nt.F,vn.j.info("Handshake RTT: "+vn.R+"ms")),In=vn;var Pr=nt;if(In.qa=Wl(In,In.J?In.ia:null,In.W),Pr.K){xa(In.h,Pr);var Wr=Pr,Xr=In.L;Xr&&(Wr.I=Xr),Wr.B&&(co(Wr),Fs(Wr)),In.g=Pr}else Fl(In);0<vn.i.length&&qs(vn)}else Br[0]!="stop"&&Br[0]!="close"||hs(vn,7);else vn.G==3&&(Br[0]=="stop"||Br[0]=="close"?Br[0]=="stop"?hs(vn,7):mo(vn):Br[0]!="noop"&&vn.l&&vn.l.ta(Br),vn.v=0)}}Sn(4)}catch{}}var ku=class{constructor(nt,Gt){this.g=nt,this.map=Gt}};function ga(nt){this.l=nt||10,tt.PerformanceNavigationTiming?(nt=tt.performance.getEntriesByType("navigation"),nt=0<nt.length&&(nt[0].nextHopProtocol=="hq"||nt[0].nextHopProtocol=="h2")):nt=!!(tt.chrome&&tt.chrome.loadTimes&&tt.chrome.loadTimes()&&tt.chrome.loadTimes().wasFetchedViaSpdy),this.j=nt?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _a(nt){return nt.h?!0:nt.g?nt.g.size>=nt.j:!1}function ba(nt){return nt.h?1:nt.g?nt.g.size:0}function ho(nt,Gt){return nt.h?nt.h==Gt:nt.g?nt.g.has(Gt):!1}function fo(nt,Gt){nt.g?nt.g.add(Gt):nt.h=Gt}function xa(nt,Gt){nt.h&&nt.h==Gt?nt.h=null:nt.g&&nt.g.has(Gt)&&nt.g.delete(Gt)}ga.prototype.cancel=function(){if(this.i=$a(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const nt of this.g.values())nt.cancel();this.g.clear()}};function $a(nt){if(nt.h!=null)return nt.i.concat(nt.h.D);if(nt.g!=null&&nt.g.size!==0){let Gt=nt.i;for(const vn of nt.g.values())Gt=Gt.concat(vn.D);return Gt}return qt(nt.i)}function Du(nt){if(nt.V&&typeof nt.V=="function")return nt.V();if(typeof Map<"u"&&nt instanceof Map||typeof Set<"u"&&nt instanceof Set)return Array.from(nt.values());if(typeof nt=="string")return nt.split("");if(et(nt)){for(var Gt=[],vn=nt.length,In=0;In<vn;In++)Gt.push(nt[In]);return Gt}Gt=[],vn=0;for(In in nt)Gt[vn++]=nt[In];return Gt}function Nu(nt){if(nt.na&&typeof nt.na=="function")return nt.na();if(!nt.V||typeof nt.V!="function"){if(typeof Map<"u"&&nt instanceof Map)return Array.from(nt.keys());if(!(typeof Set<"u"&&nt instanceof Set)){if(et(nt)||typeof nt=="string"){var Gt=[];nt=nt.length;for(var vn=0;vn<nt;vn++)Gt.push(vn);return Gt}Gt=[],vn=0;for(const In in nt)Gt[vn++]=In;return Gt}}}function _l(nt,Gt){if(nt.forEach&&typeof nt.forEach=="function")nt.forEach(Gt,void 0);else if(et(nt)||typeof nt=="string")Array.prototype.forEach.call(nt,Gt,void 0);else for(var vn=Nu(nt),In=Du(nt),tr=In.length,dr=0;dr<tr;dr++)Gt.call(void 0,In[dr],vn&&vn[dr],nt)}var yl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vu(nt,Gt){if(nt){nt=nt.split("&");for(var vn=0;vn<nt.length;vn++){var In=nt[vn].indexOf("="),tr=null;if(0<=In){var dr=nt[vn].substring(0,In);tr=nt[vn].substring(In+1)}else dr=nt[vn];Gt(dr,tr?decodeURIComponent(tr.replace(/\+/g," ")):"")}}}function us(nt){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,nt instanceof us){this.h=nt.h,js(this,nt.j),this.o=nt.o,this.g=nt.g,$s(this,nt.s),this.l=nt.l;var Gt=nt.i,vn=new Ss;vn.i=Gt.i,Gt.g&&(vn.g=new Map(Gt.g),vn.h=Gt.h),El(this,vn),this.m=nt.m}else nt&&(Gt=String(nt).match(yl))?(this.h=!1,js(this,Gt[1]||"",!0),this.o=Rs(Gt[2]||""),this.g=Rs(Gt[3]||"",!0),$s(this,Gt[4]),this.l=Rs(Gt[5]||"",!0),El(this,Gt[6]||"",!0),this.m=Rs(Gt[7]||"")):(this.h=!1,this.i=new Ss(null,this.h))}us.prototype.toString=function(){var nt=[],Gt=this.j;Gt&&nt.push(Ps(Gt,Al,!0),":");var vn=this.g;return(vn||Gt=="file")&&(nt.push("//"),(Gt=this.o)&&nt.push(Ps(Gt,Al,!0),"@"),nt.push(encodeURIComponent(String(vn)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),vn=this.s,vn!=null&&nt.push(":",String(vn))),(vn=this.l)&&(this.g&&vn.charAt(0)!="/"&&nt.push("/"),nt.push(Ps(vn,vn.charAt(0)=="/"?Mu:Lu,!0))),(vn=this.i.toString())&&nt.push("?",vn),(vn=this.m)&&nt.push("#",Ps(vn,ju)),nt.join("")};function ss(nt){return new us(nt)}function js(nt,Gt,vn){nt.j=vn?Rs(Gt,!0):Gt,nt.j&&(nt.j=nt.j.replace(/:$/,""))}function $s(nt,Gt){if(Gt){if(Gt=Number(Gt),isNaN(Gt)||0>Gt)throw Error("Bad port number "+Gt);nt.s=Gt}else nt.s=null}function El(nt,Gt,vn){Gt instanceof Ss?(nt.i=Gt,$u(nt.i,nt.h)):(vn||(Gt=Ps(Gt,Fu)),nt.i=new Ss(Gt,nt.h))}function qr(nt,Gt,vn){nt.i.set(Gt,vn)}function Us(nt){return qr(nt,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),nt}function Rs(nt,Gt){return nt?Gt?decodeURI(nt.replace(/%25/g,"%2525")):decodeURIComponent(nt):""}function Ps(nt,Gt,vn){return typeof nt=="string"?(nt=encodeURI(nt).replace(Gt,Ou),vn&&(nt=nt.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),nt):null}function Ou(nt){return nt=nt.charCodeAt(0),"%"+(nt>>4&15).toString(16)+(nt&15).toString(16)}var Al=/[#\/\?@]/g,Lu=/[#\?:]/g,Mu=/[#\?]/g,Fu=/[#\?@]/g,ju=/#/g;function Ss(nt,Gt){this.h=this.g=null,this.i=nt||null,this.j=!!Gt}function as(nt){nt.g||(nt.g=new Map,nt.h=0,nt.i&&Vu(nt.i,function(Gt,vn){nt.add(decodeURIComponent(Gt.replace(/\+/g," ")),vn)}))}s=Ss.prototype,s.add=function(nt,Gt){as(this),this.i=null,nt=fs(this,nt);var vn=this.g.get(nt);return vn||this.g.set(nt,vn=[]),vn.push(Gt),this.h+=1,this};function Tl(nt,Gt){as(nt),Gt=fs(nt,Gt),nt.g.has(Gt)&&(nt.i=null,nt.h-=nt.g.get(Gt).length,nt.g.delete(Gt))}function Rl(nt,Gt){return as(nt),Gt=fs(nt,Gt),nt.g.has(Gt)}s.forEach=function(nt,Gt){as(this),this.g.forEach(function(vn,In){vn.forEach(function(tr){nt.call(Gt,tr,In,this)},this)},this)},s.na=function(){as(this);const nt=Array.from(this.g.values()),Gt=Array.from(this.g.keys()),vn=[];for(let In=0;In<Gt.length;In++){const tr=nt[In];for(let dr=0;dr<tr.length;dr++)vn.push(Gt[In])}return vn},s.V=function(nt){as(this);let Gt=[];if(typeof nt=="string")Rl(this,nt)&&(Gt=Gt.concat(this.g.get(fs(this,nt))));else{nt=Array.from(this.g.values());for(let vn=0;vn<nt.length;vn++)Gt=Gt.concat(nt[vn])}return Gt},s.set=function(nt,Gt){return as(this),this.i=null,nt=fs(this,nt),Rl(this,nt)&&(this.h-=this.g.get(nt).length),this.g.set(nt,[Gt]),this.h+=1,this},s.get=function(nt,Gt){return nt?(nt=this.V(nt),0<nt.length?String(nt[0]):Gt):Gt};function Pl(nt,Gt,vn){Tl(nt,Gt),0<vn.length&&(nt.i=null,nt.g.set(fs(nt,Gt),qt(vn)),nt.h+=vn.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const nt=[],Gt=Array.from(this.g.keys());for(var vn=0;vn<Gt.length;vn++){var In=Gt[vn];const dr=encodeURIComponent(String(In)),Pr=this.V(In);for(In=0;In<Pr.length;In++){var tr=dr;Pr[In]!==""&&(tr+="="+encodeURIComponent(String(Pr[In]))),nt.push(tr)}}return this.i=nt.join("&")};function fs(nt,Gt){return Gt=String(Gt),nt.j&&(Gt=Gt.toLowerCase()),Gt}function $u(nt,Gt){Gt&&!nt.j&&(as(nt),nt.i=null,nt.g.forEach(function(vn,In){var tr=In.toLowerCase();In!=tr&&(Tl(this,In),Pl(this,tr,vn))},nt)),nt.j=Gt}function Uu(nt,Gt){const vn=new pr;if(tt.Image){const In=new Image;In.onload=Wt(ls,vn,"TestLoadImage: loaded",!0,Gt,In),In.onerror=Wt(ls,vn,"TestLoadImage: error",!1,Gt,In),In.onabort=Wt(ls,vn,"TestLoadImage: abort",!1,Gt,In),In.ontimeout=Wt(ls,vn,"TestLoadImage: timeout",!1,Gt,In),tt.setTimeout(function(){In.ontimeout&&In.ontimeout()},1e4),In.src=nt}else Gt(!1)}function Bu(nt,Gt){const vn=new pr,In=new AbortController,tr=setTimeout(()=>{In.abort(),ls(vn,"TestPingServer: timeout",!1,Gt)},1e4);fetch(nt,{signal:In.signal}).then(dr=>{clearTimeout(tr),dr.ok?ls(vn,"TestPingServer: ok",!0,Gt):ls(vn,"TestPingServer: server error",!1,Gt)}).catch(()=>{clearTimeout(tr),ls(vn,"TestPingServer: error",!1,Gt)})}function ls(nt,Gt,vn,In,tr){try{tr&&(tr.onload=null,tr.onerror=null,tr.onabort=null,tr.ontimeout=null),In(vn)}catch{}}function zu(){this.g=new Zn}function Wu(nt,Gt,vn){const In=vn||"";try{_l(nt,function(tr,dr){let Pr=tr;rt(tr)&&(Pr=hr(tr)),Gt.push(In+dr+"="+encodeURIComponent(Pr))})}catch(tr){throw Gt.push(In+"type="+encodeURIComponent("_badmap")),tr}}function Bs(nt){this.l=nt.Ub||null,this.j=nt.eb||!1}Bt(Bs,vr),Bs.prototype.g=function(){return new zs(this.l,this.j)},Bs.prototype.i=function(nt){return function(){return nt}}({});function zs(nt,Gt){gr.call(this),this.D=nt,this.o=Gt,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}Bt(zs,gr),s=zs.prototype,s.open=function(nt,Gt){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=nt,this.A=Gt,this.readyState=1,bs(this)},s.send=function(nt){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const Gt={headers:this.u,method:this.B,credentials:this.m,cache:void 0};nt&&(Gt.body=nt),(this.D||tt).fetch(new Request(this.A,Gt)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Is(this)),this.readyState=0},s.Sa=function(nt){if(this.g&&(this.l=nt,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=nt.headers,this.readyState=2,bs(this)),this.g&&(this.readyState=3,bs(this),this.g)))if(this.responseType==="arraybuffer")nt.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof tt.ReadableStream<"u"&&"body"in nt){if(this.j=nt.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Sl(this)}else nt.text().then(this.Ra.bind(this),this.ga.bind(this))};function Sl(nt){nt.j.read().then(nt.Pa.bind(nt)).catch(nt.ga.bind(nt))}s.Pa=function(nt){if(this.g){if(this.o&&nt.value)this.response.push(nt.value);else if(!this.o){var Gt=nt.value?nt.value:new Uint8Array(0);(Gt=this.v.decode(Gt,{stream:!nt.done}))&&(this.response=this.responseText+=Gt)}nt.done?Is(this):bs(this),this.readyState==3&&Sl(this)}},s.Ra=function(nt){this.g&&(this.response=this.responseText=nt,Is(this))},s.Qa=function(nt){this.g&&(this.response=nt,Is(this))},s.ga=function(){this.g&&Is(this)};function Is(nt){nt.readyState=4,nt.l=null,nt.j=null,nt.v=null,bs(nt)}s.setRequestHeader=function(nt,Gt){this.u.append(nt,Gt)},s.getResponseHeader=function(nt){return this.h&&this.h.get(nt.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const nt=[],Gt=this.h.entries();for(var vn=Gt.next();!vn.done;)vn=vn.value,nt.push(vn[0]+": "+vn[1]),vn=Gt.next();return nt.join(`\r
`)};function bs(nt){nt.onreadystatechange&&nt.onreadystatechange.call(nt)}Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(nt){this.m=nt?"include":"same-origin"}});function Il(nt){let Gt="";return gn(nt,function(vn,In){Gt+=In,Gt+=":",Gt+=vn,Gt+=`\r
`}),Gt}function po(nt,Gt,vn){e:{for(In in vn){var In=!1;break e}In=!0}In||(vn=Il(vn),typeof nt=="string"?vn!=null&&encodeURIComponent(String(vn)):qr(nt,Gt,vn))}function Gr(nt){gr.call(this),this.headers=new Map,this.o=nt||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}Bt(Gr,gr);var Hu=/^https?$/i,qu=["POST","PUT"];s=Gr.prototype,s.Ha=function(nt){this.J=nt},s.ea=function(nt,Gt,vn,In){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+nt);Gt=Gt?Gt.toUpperCase():"GET",this.D=nt,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vr.g(),this.v=this.o?Fr(this.o):Fr(Vr),this.g.onreadystatechange=Ct(this.Ea,this);try{this.B=!0,this.g.open(Gt,String(nt),!0),this.B=!1}catch(dr){wl(this,dr);return}if(nt=vn||"",vn=new Map(this.headers),In)if(Object.getPrototypeOf(In)===Object.prototype)for(var tr in In)vn.set(tr,In[tr]);else if(typeof In.keys=="function"&&typeof In.get=="function")for(const dr of In.keys())vn.set(dr,In.get(dr));else throw Error("Unknown input type for opt_headers: "+String(In));In=Array.from(vn.keys()).find(dr=>dr.toLowerCase()=="content-type"),tr=tt.FormData&&nt instanceof tt.FormData,!(0<=Array.prototype.indexOf.call(qu,Gt,void 0))||In||tr||vn.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[dr,Pr]of vn)this.g.setRequestHeader(dr,Pr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Dl(this),this.u=!0,this.g.send(nt),this.u=!1}catch(dr){wl(this,dr)}};function wl(nt,Gt){nt.h=!1,nt.g&&(nt.j=!0,nt.g.abort(),nt.j=!1),nt.l=Gt,nt.m=5,xl(nt),Ws(nt)}function xl(nt){nt.A||(nt.A=!0,mr(nt,"complete"),mr(nt,"error"))}s.abort=function(nt){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=nt||7,mr(this,"complete"),mr(this,"abort"),Ws(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ws(this,!0)),Gr.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?Cl(this):this.bb())},s.bb=function(){Cl(this)};function Cl(nt){if(nt.h&&typeof _e<"u"&&(!nt.v[1]||is(nt)!=4||nt.Z()!=2)){if(nt.u&&is(nt)==4)Cr(nt.Ea,0,nt);else if(mr(nt,"readystatechange"),is(nt)==4){nt.h=!1;try{const Pr=nt.Z();e:switch(Pr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Gt=!0;break e;default:Gt=!1}var vn;if(!(vn=Gt)){var In;if(In=Pr===0){var tr=String(nt.D).match(yl)[1]||null;!tr&&tt.self&&tt.self.location&&(tr=tt.self.location.protocol.slice(0,-1)),In=!Hu.test(tr?tr.toLowerCase():"")}vn=In}if(vn)mr(nt,"complete"),mr(nt,"success");else{nt.m=6;try{var dr=2<is(nt)?nt.g.statusText:""}catch{dr=""}nt.l=dr+" ["+nt.Z()+"]",xl(nt)}}finally{Ws(nt)}}}}function Ws(nt,Gt){if(nt.g){Dl(nt);const vn=nt.g,In=nt.v[0]?()=>{}:null;nt.g=null,nt.v=null,Gt||mr(nt,"ready");try{vn.onreadystatechange=In}catch{}}}function Dl(nt){nt.I&&(tt.clearTimeout(nt.I),nt.I=null)}s.isActive=function(){return!!this.g};function is(nt){return nt.g?nt.g.readyState:0}s.Z=function(){try{return 2<is(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(nt){if(this.g){var Gt=this.g.responseText;return nt&&Gt.indexOf(nt)==0&&(Gt=Gt.substring(nt.length)),Xn(Gt)}};function Nl(nt){try{if(!nt.g)return null;if("response"in nt.g)return nt.g.response;switch(nt.H){case"":case"text":return nt.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in nt.g)return nt.g.mozResponseArrayBuffer}return null}catch{return null}}function Gu(nt){const Gt={};nt=(nt.g&&2<=is(nt)&&nt.g.getAllResponseHeaders()||"").split(`\r
`);for(let In=0;In<nt.length;In++){if(Nt(nt[In]))continue;var vn=Lt(nt[In]);const tr=vn[0];if(vn=vn[1],typeof vn!="string")continue;vn=vn.trim();const dr=Gt[tr]||[];Gt[tr]=dr,dr.push(vn)}It(Gt,function(In){return In.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ws(nt,Gt,vn){return vn&&vn.internalChannelParams&&vn.internalChannelParams[nt]||Gt}function Vl(nt){this.Aa=0,this.i=[],this.j=new pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ws("failFast",!1,nt),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ws("baseRetryDelayMs",5e3,nt),this.cb=ws("retryDelaySeedMs",1e4,nt),this.Wa=ws("forwardChannelMaxRetries",2,nt),this.wa=ws("forwardChannelRequestTimeoutMs",2e4,nt),this.pa=nt&&nt.xmlHttpFactory||void 0,this.Xa=nt&&nt.Tb||void 0,this.Ca=nt&&nt.useFetchStreams||!1,this.L=void 0,this.J=nt&&nt.supportsCrossDomainXhr||!1,this.K="",this.h=new ga(nt&&nt.concurrentRequestLimit),this.Da=new zu,this.P=nt&&nt.fastHandshake||!1,this.O=nt&&nt.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=nt&&nt.Rb||!1,nt&&nt.xa&&this.j.xa(),nt&&nt.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&nt&&nt.detectBufferingProxy||!1,this.ja=void 0,nt&&nt.longPollingTimeout&&0<nt.longPollingTimeout&&(this.ja=nt.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Vl.prototype,s.la=8,s.G=1,s.connect=function(nt,Gt,vn,In){Qn(0),this.W=nt,this.H=Gt||{},vn&&In!==void 0&&(this.H.OSID=vn,this.H.OAID=In),this.F=this.X,this.I=Wl(this,null,this.W),qs(this)};function mo(nt){if(Ol(nt),nt.G==3){var Gt=nt.U++,vn=ss(nt.I);if(qr(vn,"SID",nt.K),qr(vn,"RID",Gt),qr(vn,"TYPE","terminate"),xs(nt,vn),Gt=new Ur(nt,nt.j,Gt),Gt.L=2,Gt.v=Us(ss(vn)),vn=!1,tt.navigator&&tt.navigator.sendBeacon)try{vn=tt.navigator.sendBeacon(Gt.v.toString(),"")}catch{}!vn&&tt.Image&&(new Image().src=Gt.v,vn=!0),vn||(Gt.g=Hl(Gt.j,null),Gt.g.ea(Gt.v)),Gt.F=Date.now(),Fs(Gt)}zl(nt)}function Hs(nt){nt.g&&(_o(nt),nt.g.cancel(),nt.g=null)}function Ol(nt){Hs(nt),nt.u&&(tt.clearTimeout(nt.u),nt.u=null),Gs(nt),nt.h.cancel(),nt.s&&(typeof nt.s=="number"&&tt.clearTimeout(nt.s),nt.s=null)}function qs(nt){if(!_a(nt.h)&&!nt.s){nt.s=!0;var Gt=nt.Ga;On||Dn(),Vn||(On(),Vn=!0),Rn.add(Gt,nt),nt.B=0}}function Ku(nt,Gt){return ba(nt.h)>=nt.h.j-(nt.s?1:0)?!1:nt.s?(nt.i=Gt.D.concat(nt.i),!0):nt.G==1||nt.G==2||nt.B>=(nt.Va?0:nt.Wa)?!1:(nt.s=cr(Ct(nt.Ga,nt,Gt),Bl(nt,nt.B)),nt.B++,!0)}s.Ga=function(nt){if(this.s)if(this.s=null,this.G==1){if(!nt){this.U=Math.floor(1e5*Math.random()),nt=this.U++;const tr=new Ur(this,this.j,nt);let dr=this.o;if(this.S&&(dr?(dr=pt(dr),mn(dr,this.S)):dr=this.S),this.m!==null||this.O||(tr.H=dr,dr=null),this.P)e:{for(var Gt=0,vn=0;vn<this.i.length;vn++){t:{var In=this.i[vn];if("__data__"in In.map&&(In=In.map.__data__,typeof In=="string")){In=In.length;break t}In=void 0}if(In===void 0)break;if(Gt+=In,4096<Gt){Gt=vn;break e}if(Gt===4096||vn===this.i.length-1){Gt=vn+1;break e}}Gt=1e3}else Gt=1e3;Gt=Ml(this,tr,Gt),vn=ss(this.I),qr(vn,"RID",nt),qr(vn,"CVER",22),this.D&&qr(vn,"X-HTTP-Session-Id",this.D),xs(this,vn),dr&&(this.O?Gt="headers="+encodeURIComponent(String(Il(dr)))+"&"+Gt:this.m&&po(vn,this.m,dr)),fo(this.h,tr),this.Ua&&qr(vn,"TYPE","init"),this.P?(qr(vn,"$req",Gt),qr(vn,"SID","null"),tr.T=!0,es(tr,vn,null)):es(tr,vn,Gt),this.G=2}}else this.G==3&&(nt?Ll(this,nt):this.i.length==0||_a(this.h)||Ll(this))};function Ll(nt,Gt){var vn;Gt?vn=Gt.l:vn=nt.U++;const In=ss(nt.I);qr(In,"SID",nt.K),qr(In,"RID",vn),qr(In,"AID",nt.T),xs(nt,In),nt.m&&nt.o&&po(In,nt.m,nt.o),vn=new Ur(nt,nt.j,vn,nt.B+1),nt.m===null&&(vn.H=nt.o),Gt&&(nt.i=Gt.D.concat(nt.i)),Gt=Ml(nt,vn,1e3),vn.I=Math.round(.5*nt.wa)+Math.round(.5*nt.wa*Math.random()),fo(nt.h,vn),es(vn,In,Gt)}function xs(nt,Gt){nt.H&&gn(nt.H,function(vn,In){qr(Gt,In,vn)}),nt.l&&_l({},function(vn,In){qr(Gt,In,vn)})}function Ml(nt,Gt,vn){vn=Math.min(nt.i.length,vn);var In=nt.l?Ct(nt.l.Na,nt.l,nt):null;e:{var tr=nt.i;let dr=-1;for(;;){const Pr=["count="+vn];dr==-1?0<vn?(dr=tr[0].g,Pr.push("ofs="+dr)):dr=0:Pr.push("ofs="+dr);let Wr=!0;for(let Xr=0;Xr<vn;Xr++){let Br=tr[Xr].g;const Yr=tr[Xr].map;if(Br-=dr,0>Br)dr=Math.max(0,tr[Xr].g-100),Wr=!1;else try{Wu(Yr,Pr,"req"+Br+"_")}catch{In&&In(Yr)}}if(Wr){In=Pr.join("&");break e}}}return nt=nt.i.splice(0,vn),Gt.D=nt,In}function Fl(nt){if(!nt.g&&!nt.u){nt.Y=1;var Gt=nt.Fa;On||Dn(),Vn||(On(),Vn=!0),Rn.add(Gt,nt),nt.v=0}}function go(nt){return nt.g||nt.u||3<=nt.v?!1:(nt.Y++,nt.u=cr(Ct(nt.Fa,nt),Bl(nt,nt.v)),nt.v++,!0)}s.Fa=function(){if(this.u=null,$l(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var nt=2*this.R;this.j.info("BP detection timer enabled: "+nt),this.A=cr(Ct(this.ab,this),nt)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qn(10),Hs(this),$l(this))};function _o(nt){nt.A!=null&&(tt.clearTimeout(nt.A),nt.A=null)}function $l(nt){nt.g=new Ur(nt,nt.j,"rpc",nt.Y),nt.m===null&&(nt.g.H=nt.o),nt.g.O=0;var Gt=ss(nt.qa);qr(Gt,"RID","rpc"),qr(Gt,"SID",nt.K),qr(Gt,"AID",nt.T),qr(Gt,"CI",nt.F?"0":"1"),!nt.F&&nt.ja&&qr(Gt,"TO",nt.ja),qr(Gt,"TYPE","xmlhttp"),xs(nt,Gt),nt.m&&nt.o&&po(Gt,nt.m,nt.o),nt.L&&(nt.g.I=nt.L);var vn=nt.g;nt=nt.ia,vn.L=1,vn.v=Us(ss(Gt)),vn.m=null,vn.P=!0,ns(vn,nt)}s.Za=function(){this.C!=null&&(this.C=null,Hs(this),go(this),Qn(19))};function Gs(nt){nt.C!=null&&(tt.clearTimeout(nt.C),nt.C=null)}function Ul(nt,Gt){var vn=null;if(nt.g==Gt){Gs(nt),_o(nt),nt.g=null;var In=2}else if(ho(nt.h,Gt))vn=Gt.D,xa(nt.h,Gt),In=1;else return;if(nt.G!=0){if(Gt.o)if(In==1){vn=Gt.m?Gt.m.length:0,Gt=Date.now()-Gt.F;var tr=nt.B;In=Er(),mr(In,new rr(In,vn)),qs(nt)}else Fl(nt);else if(tr=Gt.s,tr==3||tr==0&&0<Gt.X||!(In==1&&Ku(nt,Gt)||In==2&&go(nt)))switch(vn&&0<vn.length&&(Gt=nt.h,Gt.i=Gt.i.concat(vn)),tr){case 1:hs(nt,5);break;case 4:hs(nt,10);break;case 3:hs(nt,6);break;default:hs(nt,2)}}}function Bl(nt,Gt){let vn=nt.Ta+Math.floor(Math.random()*nt.cb);return nt.isActive()||(vn*=2),vn*Gt}function hs(nt,Gt){if(nt.j.info("Error code "+Gt),Gt==2){var vn=Ct(nt.fb,nt),In=nt.Xa;const tr=!In;In=new us(In||"//www.google.com/images/cleardot.gif"),tt.location&&tt.location.protocol=="http"||js(In,"https"),Us(In),tr?Uu(In.toString(),vn):Bu(In.toString(),vn)}else Qn(2);nt.G=0,nt.l&&nt.l.sa(Gt),zl(nt),Ol(nt)}s.fb=function(nt){nt?(this.j.info("Successfully pinged google.com"),Qn(2)):(this.j.info("Failed to ping google.com"),Qn(1))};function zl(nt){if(nt.G=0,nt.ka=[],nt.l){const Gt=$a(nt.h);(Gt.length!=0||nt.i.length!=0)&&(Ut(nt.ka,Gt),Ut(nt.ka,nt.i),nt.h.i.length=0,qt(nt.i),nt.i.length=0),nt.l.ra()}}function Wl(nt,Gt,vn){var In=vn instanceof us?ss(vn):new us(vn);if(In.g!="")Gt&&(In.g=Gt+"."+In.g),$s(In,In.s);else{var tr=tt.location;In=tr.protocol,Gt=Gt?Gt+"."+tr.hostname:tr.hostname,tr=+tr.port;var dr=new us(null);In&&js(dr,In),Gt&&(dr.g=Gt),tr&&$s(dr,tr),vn&&(dr.l=vn),In=dr}return vn=nt.D,Gt=nt.ya,vn&&Gt&&qr(In,vn,Gt),qr(In,"VER",nt.la),xs(nt,In),In}function Hl(nt,Gt,vn){if(Gt&&!nt.J)throw Error("Can't create secondary domain capable XhrIo object.");return Gt=nt.Ca&&!nt.pa?new Gr(new Bs({eb:vn})):new Gr(nt.pa),Gt.Ha(nt.J),Gt}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gl(){}s=Gl.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function Ks(){}Ks.prototype.g=function(nt,Gt){return new Zr(nt,Gt)};function Zr(nt,Gt){gr.call(this),this.g=new Vl(Gt),this.l=nt,this.h=Gt&&Gt.messageUrlParams||null,nt=Gt&&Gt.messageHeaders||null,Gt&&Gt.clientProtocolHeaderRequired&&(nt?nt["X-Client-Protocol"]="webchannel":nt={"X-Client-Protocol":"webchannel"}),this.g.o=nt,nt=Gt&&Gt.initMessageHeaders||null,Gt&&Gt.messageContentType&&(nt?nt["X-WebChannel-Content-Type"]=Gt.messageContentType:nt={"X-WebChannel-Content-Type":Gt.messageContentType}),Gt&&Gt.va&&(nt?nt["X-WebChannel-Client-Profile"]=Gt.va:nt={"X-WebChannel-Client-Profile":Gt.va}),this.g.S=nt,(nt=Gt&&Gt.Sb)&&!Nt(nt)&&(this.g.m=nt),this.v=Gt&&Gt.supportsCrossDomainXhr||!1,this.u=Gt&&Gt.sendRawJson||!1,(Gt=Gt&&Gt.httpSessionIdParam)&&!Nt(Gt)&&(this.g.D=Gt,nt=this.h,nt!==null&&Gt in nt&&(nt=this.h,Gt in nt&&delete nt[Gt])),this.j=new ps(this)}Bt(Zr,gr),Zr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zr.prototype.close=function(){mo(this.g)},Zr.prototype.o=function(nt){var Gt=this.g;if(typeof nt=="string"){var vn={};vn.__data__=nt,nt=vn}else this.u&&(vn={},vn.__data__=hr(nt),nt=vn);Gt.i.push(new ku(Gt.Ya++,nt)),Gt.G==3&&qs(Gt)},Zr.prototype.N=function(){this.g.l=null,delete this.j,mo(this.g),delete this.g,Zr.aa.N.call(this)};function Kl(nt){ir.call(this),nt.__headers__&&(this.headers=nt.__headers__,this.statusCode=nt.__status__,delete nt.__headers__,delete nt.__status__);var Gt=nt.__sm__;if(Gt){e:{for(const vn in Gt){nt=vn;break e}nt=void 0}(this.i=nt)&&(nt=this.i,Gt=Gt!==null&&nt in Gt?Gt[nt]:void 0),this.data=Gt}else this.data=nt}Bt(Kl,ir);function Xl(){_r.call(this),this.status=1}Bt(Xl,_r);function ps(nt){this.g=nt}Bt(ps,Gl),ps.prototype.ua=function(){mr(this.g,"a")},ps.prototype.ta=function(nt){mr(this.g,new Kl(nt))},ps.prototype.sa=function(nt){mr(this.g,new Xl)},ps.prototype.ra=function(){mr(this.g,"b")},Ks.prototype.createWebChannel=Ks.prototype.g,Zr.prototype.send=Zr.prototype.o,Zr.prototype.open=Zr.prototype.m,Zr.prototype.close=Zr.prototype.close,createWebChannelTransport=function(){return new Ks},getStatEventTarget=function(){return Er()},Event$1=Ar,Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},wr.NO_ERROR=0,wr.TIMEOUT=8,wr.HTTP_ERROR=6,ErrorCode$1=wr,kr.COMPLETE="complete",EventType=kr,Lr.EventType=Nn,Nn.OPEN="a",Nn.CLOSE="b",Nn.ERROR="c",Nn.MESSAGE="d",gr.prototype.listen=gr.prototype.K,WebChannel=Lr,Gr.prototype.listenOnce=Gr.prototype.L,Gr.prototype.getLastError=Gr.prototype.Ka,Gr.prototype.getLastErrorCode=Gr.prototype.Ba,Gr.prototype.getStatus=Gr.prototype.Z,Gr.prototype.getResponseJson=Gr.prototype.Oa,Gr.prototype.getResponseText=Gr.prototype.oa,Gr.prototype.send=Gr.prototype.ea,Gr.prototype.setWithCredentials=Gr.prototype.Ha,XhrIo=Gr}).apply(typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{});const F="@firebase/firestore",M="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=new Logger("@firebase/firestore");function __PRIVATE_getLogLevel(){return O.logLevel}function __PRIVATE_logDebug(s,...e){if(O.logLevel<=LogLevel.DEBUG){const i=e.map(__PRIVATE_argToString);O.debug(`Firestore (${x}): ${s}`,...i)}}function __PRIVATE_logError(s,...e){if(O.logLevel<=LogLevel.ERROR){const i=e.map(__PRIVATE_argToString);O.error(`Firestore (${x}): ${s}`,...i)}}function __PRIVATE_logWarn(s,...e){if(O.logLevel<=LogLevel.WARN){const i=e.map(__PRIVATE_argToString);O.warn(`Firestore (${x}): ${s}`,...i)}}function __PRIVATE_argToString(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(i){return JSON.stringify(i)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(s,e,i){let o="Unexpected state";typeof e=="string"?o=e:i=e,__PRIVATE__fail(s,o,i)}function __PRIVATE__fail(s,e,i){let o=`FIRESTORE (${x}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(i!==void 0)try{o+=" CONTEXT: "+JSON.stringify(i)}catch{o+=" CONTEXT: "+i}throw __PRIVATE_logError(o),new Error(o)}function __PRIVATE_hardAssert(s,e,i,o){let a="Unexpected state";typeof i=="string"?a=i:o=i,s||__PRIVATE__fail(e,a,o)}function __PRIVATE_debugCast(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FirestoreError extends FirebaseError{constructor(e,i){super(e,i),this.code=e,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor(e,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,i){e.enqueueRetryable(()=>i(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,i){this.changeListener=i,e.enqueueRetryable(()=>i(this.token.user))}shutdown(){this.changeListener=null}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,i){__PRIVATE_hardAssert(this.o===void 0,42304);let o=this.i;const a=et=>this.i!==o?(o=this.i,i(et)):Promise.resolve();let j=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),j.resolve(),j=new __PRIVATE_Deferred,e.enqueueRetryable(()=>a(this.currentUser))};const _e=()=>{const et=j;e.enqueueRetryable(async()=>{await et.promise,await a(this.currentUser)})},tt=et=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=et,this.o&&(this.auth.addAuthTokenListener(this.o),_e())};this.t.onInit(et=>tt(et)),setTimeout(()=>{if(!this.auth){const et=this.t.getImmediate({optional:!0});et?tt(et):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),j.resolve(),j=new __PRIVATE_Deferred)}},0),_e()}getToken(){const e=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then(o=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(__PRIVATE_hardAssert(typeof o.accessToken=="string",31837,{l:o}),new __PRIVATE_OAuthToken(o.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(e===null||typeof e=="string",2055,{h:e}),new User(e)}}class __PRIVATE_FirstPartyToken{constructor(e,i,o){this.P=e,this.T=i,this.I=o,this.type="FirstParty",this.user=User.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,i,o){this.P=e,this.T=i,this.I=o}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.P,this.T,this.I))}start(e,i){e.enqueueRetryable(()=>i(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,i){this.V=i,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,i){__PRIVATE_hardAssert(this.o===void 0,3512);const o=j=>{j.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${j.error.message}`);const _e=j.token!==this.m;return this.m=j.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${_e?"new":"existing"} token.`),_e?i(j.token):Promise.resolve()};this.o=j=>{e.enqueueRetryable(()=>o(j))};const a=j=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=j,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(j=>a(j)),setTimeout(()=>{if(!this.appCheck){const j=this.V.getImmediate({optional:!0});j?a(j):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AppCheckToken(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(i=>i?(__PRIVATE_hardAssert(typeof i.token=="string",44558,{tokenResult:i}),this.m=i.token,new AppCheckToken(i.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),i=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(i);else for(let o=0;o<s;o++)i[o]=Math.floor(256*Math.random());return i}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AutoId{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=62*Math.floor(4.129032258064516);let o="";for(;o.length<20;){const a=__PRIVATE_randomBytes(40);for(let j=0;j<a.length;++j)o.length<20&&a[j]<i&&(o+=e.charAt(a[j]%62))}return o}}function __PRIVATE_primitiveComparator(s,e){return s<e?-1:s>e?1:0}function __PRIVATE_compareUtf8Strings(s,e){let i=0;for(;i<s.length&&i<e.length;){const o=s.codePointAt(i),a=e.codePointAt(i);if(o!==a){if(o<128&&a<128)return __PRIVATE_primitiveComparator(o,a);{const j=__PRIVATE_newTextEncoder(),_e=__PRIVATE_compareByteArrays$1(j.encode(__PRIVATE_getUtf8SafeSubstring(s,i)),j.encode(__PRIVATE_getUtf8SafeSubstring(e,i)));return _e!==0?_e:__PRIVATE_primitiveComparator(o,a)}}i+=o>65535?2:1}return __PRIVATE_primitiveComparator(s.length,e.length)}function __PRIVATE_getUtf8SafeSubstring(s,e){return s.codePointAt(e)>65535?s.substring(e,e+2):s.substring(e,e+1)}function __PRIVATE_compareByteArrays$1(s,e){for(let i=0;i<s.length&&i<e.length;++i)if(s[i]!==e[i])return __PRIVATE_primitiveComparator(s[i],e[i]);return __PRIVATE_primitiveComparator(s.length,e.length)}function __PRIVATE_arrayEquals(s,e,i){return s.length===e.length&&s.every((o,a)=>i(o,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B="__name__";class BasePath{constructor(e,i,o){i===void 0?i=0:i>e.length&&fail(637,{offset:i,range:e.length}),o===void 0?o=e.length-i:o>e.length-i&&fail(1746,{length:o,range:e.length-i}),this.segments=e,this.offset=i,this.len=o}get length(){return this.len}isEqual(e){return BasePath.comparator(this,e)===0}child(e){const i=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(o=>{i.push(o)}):i.push(e),this.construct(i)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}forEach(e){for(let i=this.offset,o=this.limit();i<o;i++)e(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,i){const o=Math.min(e.length,i.length);for(let a=0;a<o;a++){const j=BasePath.compareSegments(e.get(a),i.get(a));if(j!==0)return j}return __PRIVATE_primitiveComparator(e.length,i.length)}static compareSegments(e,i){const o=BasePath.isNumericId(e),a=BasePath.isNumericId(i);return o&&!a?-1:!o&&a?1:o&&a?BasePath.extractNumericId(e).compare(BasePath.extractNumericId(i)):__PRIVATE_compareUtf8Strings(e,i)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Integer.fromString(e.substring(4,e.length-2))}}class ResourcePath extends BasePath{construct(e,i,o){return new ResourcePath(e,i,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const i=[];for(const o of e){if(o.indexOf("//")>=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);i.push(...o.split("/").filter(a=>a.length>0))}return new ResourcePath(i)}static emptyPath(){return new ResourcePath([])}}const L=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class FieldPath$1 extends BasePath{construct(e,i,o){return new FieldPath$1(e,i,o)}static isValidIdentifier(e){return L.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===B}static keyField(){return new FieldPath$1([B])}static fromServerFormat(e){const i=[];let o="",a=0;const j=()=>{if(o.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(o),o=""};let _e=!1;for(;a<e.length;){const tt=e[a];if(tt==="\\"){if(a+1===e.length)throw new FirestoreError(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const et=e[a+1];if(et!=="\\"&&et!=="."&&et!=="`")throw new FirestoreError(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);o+=et,a+=2}else tt==="`"?(_e=!_e,a++):tt!=="."||_e?(o+=tt,a++):(j(),a++)}if(j(),_e)throw new FirestoreError(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(i)}static emptyPath(){return new FieldPath$1([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentKey{constructor(e){this.path=e}static fromPath(e){return new DocumentKey(ResourcePath.fromString(e))}static fromName(e){return new DocumentKey(ResourcePath.fromString(e).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ResourcePath.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,i){return ResourcePath.comparator(e.path,i.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DocumentKey(new ResourcePath(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(s,e,i){if(!i)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function __PRIVATE_validateIsNotUsedTogether(s,e,i,o){if(e===!0&&o===!0)throw new FirestoreError(N.INVALID_ARGUMENT,`${s} and ${i} cannot be used together.`)}function __PRIVATE_validateDocumentPath(s){if(!DocumentKey.isDocumentKey(s))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function __PRIVATE_validateCollectionPath(s){if(DocumentKey.isDocumentKey(s))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function __PRIVATE_isPlainObject(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function __PRIVATE_valueDescription(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(o){return o.constructor?o.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":fail(12329,{type:typeof s})}function __PRIVATE_cast(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new FirestoreError(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=__PRIVATE_valueDescription(s);throw new FirestoreError(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${i}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function property(s,e){const i={typeString:s};return e&&(i.value=e),i}function __PRIVATE_validateJSON(s,e){if(!__PRIVATE_isPlainObject(s))throw new FirestoreError(N.INVALID_ARGUMENT,"JSON must be an object");let i;for(const o in e)if(e[o]){const a=e[o].typeString,j="value"in e[o]?{value:e[o].value}:void 0;if(!(o in s)){i=`JSON missing required field: '${o}'`;break}const _e=s[o];if(a&&typeof _e!==a){i=`JSON field '${o}' must be a ${a}.`;break}if(j!==void 0&&_e!==j.value){i=`Expected '${o}' field to equal '${j.value}'`;break}}if(i)throw new FirestoreError(N.INVALID_ARGUMENT,i);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k=-62135596800,q=1e6;class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){const i=Math.floor(e/1e3),o=Math.floor((e-1e3*i)*q);return new Timestamp(i,o)}constructor(e,i){if(this.seconds=e,this.nanoseconds=i,i<0)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(e<k)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/q}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Timestamp._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(__PRIVATE_validateJSON(e,Timestamp._jsonSchema))return new Timestamp(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-k;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Timestamp._jsonSchemaVersion="firestore/timestamp/1.0",Timestamp._jsonSchema={type:property("string",Timestamp._jsonSchemaVersion),seconds:property("number"),nanoseconds:property("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q=-1;function __PRIVATE_newIndexOffsetSuccessorFromReadTime(s,e){const i=s.toTimestamp().seconds,o=s.toTimestamp().nanoseconds+1,a=SnapshotVersion.fromTimestamp(o===1e9?new Timestamp(i+1,0):new Timestamp(i,o));return new IndexOffset(a,DocumentKey.empty(),e)}function __PRIVATE_newIndexOffsetFromDocument(s){return new IndexOffset(s.readTime,s.key,Q)}class IndexOffset{constructor(e,i,o){this.readTime=e,this.documentKey=i,this.largestBatchId=o}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),Q)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),Q)}}function __PRIVATE_indexOffsetComparator(s,e){let i=s.readTime.compareTo(e.readTime);return i!==0?i:(i=DocumentKey.comparator(s.documentKey,e.documentKey),i!==0?i:__PRIVATE_primitiveComparator(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(s){if(s.code!==N.FAILED_PRECONDITION||s.message!==$)throw s;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)},i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)})}catch(e){return this.next(void 0,e)}next(e,i){return this.callbackAttached&&fail(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((o,a)=>{this.nextCallback=j=>{this.wrapSuccess(e,j).next(o,a)},this.catchCallback=j=>{this.wrapFailure(i,j).next(o,a)}})}toPromise(){return new Promise((e,i)=>{this.next(e,i)})}wrapUserFunction(e){try{const i=e();return i instanceof PersistencePromise?i:PersistencePromise.resolve(i)}catch(i){return PersistencePromise.reject(i)}}wrapSuccess(e,i){return e?this.wrapUserFunction(()=>e(i)):PersistencePromise.resolve(i)}wrapFailure(e,i){return e?this.wrapUserFunction(()=>e(i)):PersistencePromise.reject(i)}static resolve(e){return new PersistencePromise((i,o)=>{i(e)})}static reject(e){return new PersistencePromise((i,o)=>{o(e)})}static waitFor(e){return new PersistencePromise((i,o)=>{let a=0,j=0,_e=!1;e.forEach(tt=>{++a,tt.next(()=>{++j,_e&&j===a&&i()},et=>o(et))}),_e=!0,j===a&&i()})}static or(e){let i=PersistencePromise.resolve(!1);for(const o of e)i=i.next(a=>a?PersistencePromise.resolve(a):o());return i}static forEach(e,i){const o=[];return e.forEach((a,j)=>{o.push(i.call(this,a,j))}),this.waitFor(o)}static mapArray(e,i){return new PersistencePromise((o,a)=>{const j=e.length,_e=new Array(j);let tt=0;for(let et=0;et<j;et++){const rt=et;i(e[rt]).next(dt=>{_e[rt]=dt,++tt,tt===j&&o(_e)},dt=>a(dt))}})}static doWhile(e,i){return new PersistencePromise((o,a)=>{const j=()=>{e()===!0?i().next(()=>{j()},a):o()};j()})}}function __PRIVATE_getAndroidVersion(s){const e=s.match(/Android ([\d.]+)/i),i=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(i)}function __PRIVATE_isIndexedDbTransactionError(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ListenSequence{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=o=>this._e(o),this.ae=o=>i.writeSequenceNumber(o))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}__PRIVATE_ListenSequence.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G=-1;function __PRIVATE_isNullOrUndefined(s){return s==null}function __PRIVATE_isNegativeZero(s){return s===0&&1/s==-1/0}function isSafeInteger(s){return typeof s=="number"&&Number.isInteger(s)&&!__PRIVATE_isNegativeZero(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z="";function __PRIVATE_encodeResourcePath(s){let e="";for(let i=0;i<s.length;i++)e.length>0&&(e=__PRIVATE_encodeSeparator(e)),e=__PRIVATE_encodeSegment(s.get(i),e);return __PRIVATE_encodeSeparator(e)}function __PRIVATE_encodeSegment(s,e){let i=e;const o=s.length;for(let a=0;a<o;a++){const j=s.charAt(a);switch(j){case"\0":i+="";break;case z:i+="";break;default:i+=j}}return i}function __PRIVATE_encodeSeparator(s){return s+z+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(s){let e=0;for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&e++;return e}function forEach(s,e){for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&e(i,s[i])}function isEmpty(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMap{constructor(e,i){this.comparator=e,this.root=i||LLRBNode.EMPTY}insert(e,i){return new SortedMap(this.comparator,this.root.insert(e,i,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return i.value;o<0?i=i.left:o>0&&(i=i.right)}return null}indexOf(e){let i=0,o=this.root;for(;!o.isEmpty();){const a=this.comparator(e,o.key);if(a===0)return i+o.left.size;a<0?o=o.left:(i+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((i,o)=>(e(i,o),!1))}toString(){const e=[];return this.inorderTraversal((i,o)=>(e.push(`${i}:${o}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}}class SortedMapIterator{constructor(e,i,o,a){this.isReverse=a,this.nodeStack=[];let j=1;for(;!e.isEmpty();)if(j=i?o(e.key,i):1,i&&a&&(j*=-1),j<0)e=this.isReverse?e.left:e.right;else{if(j===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const i={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class LLRBNode{constructor(e,i,o,a,j){this.key=e,this.value=i,this.color=o??LLRBNode.RED,this.left=a??LLRBNode.EMPTY,this.right=j??LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,i,o,a,j){return new LLRBNode(e??this.key,i??this.value,o??this.color,a??this.left,j??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,o){let a=this;const j=o(e,a.key);return a=j<0?a.copy(null,null,null,a.left.insert(e,i,o),null):j===0?a.copy(null,i,null,null,null):a.copy(null,null,null,null,a.right.insert(e,i,o)),a.fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,i){let o,a=this;if(i(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,i),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),i(e,a.key)===0){if(a.right.isEmpty())return LLRBNode.EMPTY;o=a.right.min(),a=a.copy(o.key,o.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,i))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fail(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fail(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fail(27949);return e+(this.isRed()?0:1)}}LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1;LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail(57766)}get value(){throw fail(16141)}get color(){throw fail(16727)}get left(){throw fail(29726)}get right(){throw fail(36894)}copy(e,i,o,a,j){return this}insert(e,i,o){return new LLRBNode(e,i)}remove(e,i){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((i,o)=>(e(i),!1))}forEachInRange(e,i){const o=this.data.getIteratorFrom(e[0]);for(;o.hasNext();){const a=o.getNext();if(this.comparator(a.key,e[1])>=0)return;i(a.key)}}forEachWhile(e,i){let o;for(o=i!==void 0?this.data.getIteratorFrom(i):this.data.getIterator();o.hasNext();)if(!e(o.getNext().key))return}firstAfterOrEqual(e){const i=this.data.getIteratorFrom(e);return i.hasNext()?i.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let i=this;return i.size<e.size&&(i=e,e=this),e.forEach(o=>{i=i.add(o)}),i}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;const i=this.data.getIterator(),o=e.data.getIterator();for(;i.hasNext();){const a=i.getNext().key,j=o.getNext().key;if(this.comparator(a,j)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(i=>{e.push(i)}),e}toString(){const e=[];return this.forEach(i=>e.push(i)),"SortedSet("+e.toString()+")"}copy(e){const i=new SortedSet(this.comparator);return i.data=e,i}}class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let i=new SortedSet(FieldPath$1.comparator);for(const o of this.fields)i=i.add(o);for(const o of e)i=i.add(o);return new FieldMask(i.toArray())}covers(e){for(const i of this.fields)if(i.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(i,o)=>i.isEqual(o))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){const i=function(a){try{return atob(a)}catch(j){throw typeof DOMException<"u"&&j instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+j):j}}(e);return new ByteString(i)}static fromUint8Array(e){const i=function(a){let j="";for(let _e=0;_e<a.length;++_e)j+=String.fromCharCode(a[_e]);return j}(e);return new ByteString(i)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(i){return btoa(i)}(this.binaryString)}toUint8Array(){return function(i){const o=new Uint8Array(i.length);for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return o}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ByteString.EMPTY_BYTE_STRING=new ByteString("");const it=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(s){if(__PRIVATE_hardAssert(!!s,39018),typeof s=="string"){let e=0;const i=it.exec(s);if(__PRIVATE_hardAssert(!!i,46558,{timestamp:s}),i[1]){let a=i[1];a=(a+"000000000").substr(0,9),e=Number(a)}const o=new Date(s);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:__PRIVATE_normalizeNumber(s.seconds),nanos:__PRIVATE_normalizeNumber(s.nanos)}}function __PRIVATE_normalizeNumber(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function __PRIVATE_normalizeByteString(s){return typeof s=="string"?ByteString.fromBase64String(s):ByteString.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="server_timestamp",ot="__type__",_t="__previous_value__",at="__local_write_time__";function __PRIVATE_isServerTimestamp(s){var e,i;return((i=(((e=s==null?void 0:s.mapValue)===null||e===void 0?void 0:e.fields)||{})[ot])===null||i===void 0?void 0:i.stringValue)===st}function __PRIVATE_getPreviousValue(s){const e=s.mapValue.fields[_t];return __PRIVATE_isServerTimestamp(e)?__PRIVATE_getPreviousValue(e):e}function __PRIVATE_getLocalWriteTime(s){const e=__PRIVATE_normalizeTimestamp(s.mapValue.fields[at].timestampValue);return new Timestamp(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DatabaseInfo{constructor(e,i,o,a,j,_e,tt,et,rt,dt){this.databaseId=e,this.appId=i,this.persistenceKey=o,this.host=a,this.ssl=j,this.forceLongPolling=_e,this.autoDetectLongPolling=tt,this.longPollingOptions=et,this.useFetchStreams=rt,this.isUsingEmulator=dt}}const ut="(default)";class DatabaseId{constructor(e,i){this.projectId=e,this.database=i||ut}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===ut}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="__type__",lt="__max__",ht={mapValue:{}},Pt="__vector__",Tt="value";function __PRIVATE_typeOrder(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?__PRIVATE_isServerTimestamp(s)?4:__PRIVATE_isMaxValue(s)?9007199254740991:__PRIVATE_isVectorValue(s)?10:11:fail(28295,{value:s})}function __PRIVATE_valueEquals(s,e){if(s===e)return!0;const i=__PRIVATE_typeOrder(s);if(i!==__PRIVATE_typeOrder(e))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(s).isEqual(__PRIVATE_getLocalWriteTime(e));case 3:return function(a,j){if(typeof a.timestampValue=="string"&&typeof j.timestampValue=="string"&&a.timestampValue.length===j.timestampValue.length)return a.timestampValue===j.timestampValue;const _e=__PRIVATE_normalizeTimestamp(a.timestampValue),tt=__PRIVATE_normalizeTimestamp(j.timestampValue);return _e.seconds===tt.seconds&&_e.nanos===tt.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(a,j){return __PRIVATE_normalizeByteString(a.bytesValue).isEqual(__PRIVATE_normalizeByteString(j.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(a,j){return __PRIVATE_normalizeNumber(a.geoPointValue.latitude)===__PRIVATE_normalizeNumber(j.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(a.geoPointValue.longitude)===__PRIVATE_normalizeNumber(j.geoPointValue.longitude)}(s,e);case 2:return function(a,j){if("integerValue"in a&&"integerValue"in j)return __PRIVATE_normalizeNumber(a.integerValue)===__PRIVATE_normalizeNumber(j.integerValue);if("doubleValue"in a&&"doubleValue"in j){const _e=__PRIVATE_normalizeNumber(a.doubleValue),tt=__PRIVATE_normalizeNumber(j.doubleValue);return _e===tt?__PRIVATE_isNegativeZero(_e)===__PRIVATE_isNegativeZero(tt):isNaN(_e)&&isNaN(tt)}return!1}(s,e);case 9:return __PRIVATE_arrayEquals(s.arrayValue.values||[],e.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(a,j){const _e=a.mapValue.fields||{},tt=j.mapValue.fields||{};if(__PRIVATE_objectSize(_e)!==__PRIVATE_objectSize(tt))return!1;for(const et in _e)if(_e.hasOwnProperty(et)&&(tt[et]===void 0||!__PRIVATE_valueEquals(_e[et],tt[et])))return!1;return!0}(s,e);default:return fail(52216,{left:s})}}function __PRIVATE_arrayValueContains(s,e){return(s.values||[]).find(i=>__PRIVATE_valueEquals(i,e))!==void 0}function __PRIVATE_valueCompare(s,e){if(s===e)return 0;const i=__PRIVATE_typeOrder(s),o=__PRIVATE_typeOrder(e);if(i!==o)return __PRIVATE_primitiveComparator(i,o);switch(i){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(s.booleanValue,e.booleanValue);case 2:return function(j,_e){const tt=__PRIVATE_normalizeNumber(j.integerValue||j.doubleValue),et=__PRIVATE_normalizeNumber(_e.integerValue||_e.doubleValue);return tt<et?-1:tt>et?1:tt===et?0:isNaN(tt)?isNaN(et)?0:-1:1}(s,e);case 3:return __PRIVATE_compareTimestamps(s.timestampValue,e.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(s),__PRIVATE_getLocalWriteTime(e));case 5:return __PRIVATE_compareUtf8Strings(s.stringValue,e.stringValue);case 6:return function(j,_e){const tt=__PRIVATE_normalizeByteString(j),et=__PRIVATE_normalizeByteString(_e);return tt.compareTo(et)}(s.bytesValue,e.bytesValue);case 7:return function(j,_e){const tt=j.split("/"),et=_e.split("/");for(let rt=0;rt<tt.length&&rt<et.length;rt++){const dt=__PRIVATE_primitiveComparator(tt[rt],et[rt]);if(dt!==0)return dt}return __PRIVATE_primitiveComparator(tt.length,et.length)}(s.referenceValue,e.referenceValue);case 8:return function(j,_e){const tt=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(j.latitude),__PRIVATE_normalizeNumber(_e.latitude));return tt!==0?tt:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(j.longitude),__PRIVATE_normalizeNumber(_e.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return __PRIVATE_compareArrays(s.arrayValue,e.arrayValue);case 10:return function(j,_e){var tt,et,rt,dt;const vt=j.fields||{},Ct=_e.fields||{},Wt=(tt=vt[Tt])===null||tt===void 0?void 0:tt.arrayValue,Bt=(et=Ct[Tt])===null||et===void 0?void 0:et.arrayValue,qt=__PRIVATE_primitiveComparator(((rt=Wt==null?void 0:Wt.values)===null||rt===void 0?void 0:rt.length)||0,((dt=Bt==null?void 0:Bt.values)===null||dt===void 0?void 0:dt.length)||0);return qt!==0?qt:__PRIVATE_compareArrays(Wt,Bt)}(s.mapValue,e.mapValue);case 11:return function(j,_e){if(j===ht.mapValue&&_e===ht.mapValue)return 0;if(j===ht.mapValue)return 1;if(_e===ht.mapValue)return-1;const tt=j.fields||{},et=Object.keys(tt),rt=_e.fields||{},dt=Object.keys(rt);et.sort(),dt.sort();for(let vt=0;vt<et.length&&vt<dt.length;++vt){const Ct=__PRIVATE_compareUtf8Strings(et[vt],dt[vt]);if(Ct!==0)return Ct;const Wt=__PRIVATE_valueCompare(tt[et[vt]],rt[dt[vt]]);if(Wt!==0)return Wt}return __PRIVATE_primitiveComparator(et.length,dt.length)}(s.mapValue,e.mapValue);default:throw fail(23264,{le:i})}}function __PRIVATE_compareTimestamps(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return __PRIVATE_primitiveComparator(s,e);const i=__PRIVATE_normalizeTimestamp(s),o=__PRIVATE_normalizeTimestamp(e),a=__PRIVATE_primitiveComparator(i.seconds,o.seconds);return a!==0?a:__PRIVATE_primitiveComparator(i.nanos,o.nanos)}function __PRIVATE_compareArrays(s,e){const i=s.values||[],o=e.values||[];for(let a=0;a<i.length&&a<o.length;++a){const j=__PRIVATE_valueCompare(i[a],o[a]);if(j)return j}return __PRIVATE_primitiveComparator(i.length,o.length)}function canonicalId(s){return __PRIVATE_canonifyValue(s)}function __PRIVATE_canonifyValue(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(i){const o=__PRIVATE_normalizeTimestamp(i);return`time(${o.seconds},${o.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(i){return __PRIVATE_normalizeByteString(i).toBase64()}(s.bytesValue):"referenceValue"in s?function(i){return DocumentKey.fromName(i).toString()}(s.referenceValue):"geoPointValue"in s?function(i){return`geo(${i.latitude},${i.longitude})`}(s.geoPointValue):"arrayValue"in s?function(i){let o="[",a=!0;for(const j of i.values||[])a?a=!1:o+=",",o+=__PRIVATE_canonifyValue(j);return o+"]"}(s.arrayValue):"mapValue"in s?function(i){const o=Object.keys(i.fields||{}).sort();let a="{",j=!0;for(const _e of o)j?j=!1:a+=",",a+=`${_e}:${__PRIVATE_canonifyValue(i.fields[_e])}`;return a+"}"}(s.mapValue):fail(61005,{value:s})}function __PRIVATE_estimateByteSize(s){switch(__PRIVATE_typeOrder(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=__PRIVATE_getPreviousValue(s);return e?16+__PRIVATE_estimateByteSize(e):16;case 5:return 2*s.stringValue.length;case 6:return __PRIVATE_normalizeByteString(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(o){return(o.values||[]).reduce((a,j)=>a+__PRIVATE_estimateByteSize(j),0)}(s.arrayValue);case 10:case 11:return function(o){let a=0;return forEach(o.fields,(j,_e)=>{a+=j.length+__PRIVATE_estimateByteSize(_e)}),a}(s.mapValue);default:throw fail(13486,{value:s})}}function __PRIVATE_refValue(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function isInteger(s){return!!s&&"integerValue"in s}function isArray(s){return!!s&&"arrayValue"in s}function __PRIVATE_isNullValue(s){return!!s&&"nullValue"in s}function __PRIVATE_isNanValue(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function __PRIVATE_isMapValue(s){return!!s&&"mapValue"in s}function __PRIVATE_isVectorValue(s){var e,i;return((i=(((e=s==null?void 0:s.mapValue)===null||e===void 0?void 0:e.fields)||{})[ct])===null||i===void 0?void 0:i.stringValue)===Pt}function __PRIVATE_deepClone(s){if(s.geoPointValue)return{geoPointValue:Object.assign({},s.geoPointValue)};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:Object.assign({},s.timestampValue)};if(s.mapValue){const e={mapValue:{fields:{}}};return forEach(s.mapValue.fields,(i,o)=>e.mapValue.fields[i]=__PRIVATE_deepClone(o)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let i=0;i<(s.arrayValue.values||[]).length;++i)e.arrayValue.values[i]=__PRIVATE_deepClone(s.arrayValue.values[i]);return e}return Object.assign({},s)}function __PRIVATE_isMaxValue(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===lt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectValue{constructor(e){this.value=e}static empty(){return new ObjectValue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let i=this.value;for(let o=0;o<e.length-1;++o)if(i=(i.mapValue.fields||{})[e.get(o)],!__PRIVATE_isMapValue(i))return null;return i=(i.mapValue.fields||{})[e.lastSegment()],i||null}}set(e,i){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(i)}setAll(e){let i=FieldPath$1.emptyPath(),o={},a=[];e.forEach((_e,tt)=>{if(!i.isImmediateParentOf(tt)){const et=this.getFieldsMap(i);this.applyChanges(et,o,a),o={},a=[],i=tt.popLast()}_e?o[tt.lastSegment()]=__PRIVATE_deepClone(_e):a.push(tt.lastSegment())});const j=this.getFieldsMap(i);this.applyChanges(j,o,a)}delete(e){const i=this.field(e.popLast());__PRIVATE_isMapValue(i)&&i.mapValue.fields&&delete i.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let o=0;o<e.length;++o){let a=i.mapValue.fields[e.get(o)];__PRIVATE_isMapValue(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},i.mapValue.fields[e.get(o)]=a),i=a}return i.mapValue.fields}applyChanges(e,i,o){forEach(i,(a,j)=>e[a]=j);for(const a of o)delete e[a]}clone(){return new ObjectValue(__PRIVATE_deepClone(this.value))}}function __PRIVATE_extractFieldMask(s){const e=[];return forEach(s.fields,(i,o)=>{const a=new FieldPath$1([i]);if(__PRIVATE_isMapValue(o)){const j=__PRIVATE_extractFieldMask(o.mapValue).fields;if(j.length===0)e.push(a);else for(const _e of j)e.push(a.child(_e))}else e.push(a)}),new FieldMask(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutableDocument{constructor(e,i,o,a,j,_e,tt){this.key=e,this.documentType=i,this.version=o,this.readTime=a,this.createTime=j,this.data=_e,this.documentState=tt}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newFoundDocument(e,i,o,a){return new MutableDocument(e,1,i,SnapshotVersion.min(),o,a,0)}static newNoDocument(e,i){return new MutableDocument(e,2,i,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newUnknownDocument(e,i){return new MutableDocument(e,3,i,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),2)}convertToFoundDocument(e,i){return!this.createTime.isEqual(SnapshotVersion.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bound{constructor(e,i){this.position=e,this.inclusive=i}}function __PRIVATE_boundCompareToDocument(s,e,i){let o=0;for(let a=0;a<s.position.length;a++){const j=e[a],_e=s.position[a];if(j.field.isKeyField()?o=DocumentKey.comparator(DocumentKey.fromName(_e.referenceValue),i.key):o=__PRIVATE_valueCompare(_e,i.data.field(j.field)),j.dir==="desc"&&(o*=-1),o!==0)break}return o}function __PRIVATE_boundEquals(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let i=0;i<s.position.length;i++)if(!__PRIVATE_valueEquals(s.position[i],e.position[i]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OrderBy{constructor(e,i="asc"){this.field=e,this.dir=i}}function __PRIVATE_orderByEquals(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Filter{}class FieldFilter extends Filter{constructor(e,i,o){super(),this.field=e,this.op=i,this.value=o}static create(e,i,o){return e.isKeyField()?i==="in"||i==="not-in"?this.createKeyFieldInFilter(e,i,o):new __PRIVATE_KeyFieldFilter(e,i,o):i==="array-contains"?new __PRIVATE_ArrayContainsFilter(e,o):i==="in"?new __PRIVATE_InFilter(e,o):i==="not-in"?new __PRIVATE_NotInFilter(e,o):i==="array-contains-any"?new __PRIVATE_ArrayContainsAnyFilter(e,o):new FieldFilter(e,i,o)}static createKeyFieldInFilter(e,i,o){return i==="in"?new __PRIVATE_KeyFieldInFilter(e,o):new __PRIVATE_KeyFieldNotInFilter(e,o)}matches(e){const i=e.data.field(this.field);return this.op==="!="?i!==null&&i.nullValue===void 0&&this.matchesComparison(__PRIVATE_valueCompare(i,this.value)):i!==null&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(i)&&this.matchesComparison(__PRIVATE_valueCompare(i,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fail(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class CompositeFilter extends Filter{constructor(e,i){super(),this.filters=e,this.op=i,this.he=null}static create(e,i){return new CompositeFilter(e,i)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?this.filters.find(i=>!i.matches(e))===void 0:this.filters.find(i=>i.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,i)=>e.concat(i.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function __PRIVATE_compositeFilterIsConjunction(s){return s.op==="and"}function __PRIVATE_compositeFilterIsFlatConjunction(s){return __PRIVATE_compositeFilterIsFlat(s)&&__PRIVATE_compositeFilterIsConjunction(s)}function __PRIVATE_compositeFilterIsFlat(s){for(const e of s.filters)if(e instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(s){if(s instanceof FieldFilter)return s.field.canonicalString()+s.op.toString()+canonicalId(s.value);if(__PRIVATE_compositeFilterIsFlatConjunction(s))return s.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{const e=s.filters.map(i=>__PRIVATE_canonifyFilter(i)).join(",");return`${s.op}(${e})`}}function __PRIVATE_filterEquals(s,e){return s instanceof FieldFilter?function(o,a){return a instanceof FieldFilter&&o.op===a.op&&o.field.isEqual(a.field)&&__PRIVATE_valueEquals(o.value,a.value)}(s,e):s instanceof CompositeFilter?function(o,a){return a instanceof CompositeFilter&&o.op===a.op&&o.filters.length===a.filters.length?o.filters.reduce((j,_e,tt)=>j&&__PRIVATE_filterEquals(_e,a.filters[tt]),!0):!1}(s,e):void fail(19439)}function __PRIVATE_stringifyFilter(s){return s instanceof FieldFilter?function(i){return`${i.field.canonicalString()} ${i.op} ${canonicalId(i.value)}`}(s):s instanceof CompositeFilter?function(i){return i.op.toString()+" {"+i.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}"}(s):"Filter"}class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,i,o){super(e,i,o),this.key=DocumentKey.fromName(o.referenceValue)}matches(e){const i=DocumentKey.comparator(e.key,this.key);return this.matchesComparison(i)}}class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,i){super(e,"in",i),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",i)}matches(e){return this.keys.some(i=>i.isEqual(e.key))}}class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,i){super(e,"not-in",i),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",i)}matches(e){return!this.keys.some(i=>i.isEqual(e.key))}}function __PRIVATE_extractDocumentKeysFromArrayValue(s,e){var i;return(((i=e.arrayValue)===null||i===void 0?void 0:i.values)||[]).map(o=>DocumentKey.fromName(o.referenceValue))}class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,i){super(e,"array-contains",i)}matches(e){const i=e.data.field(this.field);return isArray(i)&&__PRIVATE_arrayValueContains(i.arrayValue,this.value)}}class __PRIVATE_InFilter extends FieldFilter{constructor(e,i){super(e,"in",i)}matches(e){const i=e.data.field(this.field);return i!==null&&__PRIVATE_arrayValueContains(this.value.arrayValue,i)}}class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,i){super(e,"not-in",i)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=e.data.field(this.field);return i!==null&&i.nullValue===void 0&&!__PRIVATE_arrayValueContains(this.value.arrayValue,i)}}class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,i){super(e,"array-contains-any",i)}matches(e){const i=e.data.field(this.field);return!(!isArray(i)||!i.arrayValue.values)&&i.arrayValue.values.some(o=>__PRIVATE_arrayValueContains(this.value.arrayValue,o))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetImpl{constructor(e,i=null,o=[],a=[],j=null,_e=null,tt=null){this.path=e,this.collectionGroup=i,this.orderBy=o,this.filters=a,this.limit=j,this.startAt=_e,this.endAt=tt,this.Pe=null}}function __PRIVATE_newTarget(s,e=null,i=[],o=[],a=null,j=null,_e=null){return new __PRIVATE_TargetImpl(s,e,i,o,a,j,_e)}function __PRIVATE_canonifyTarget(s){const e=__PRIVATE_debugCast(s);if(e.Pe===null){let i=e.path.canonicalString();e.collectionGroup!==null&&(i+="|cg:"+e.collectionGroup),i+="|f:",i+=e.filters.map(o=>__PRIVATE_canonifyFilter(o)).join(","),i+="|ob:",i+=e.orderBy.map(o=>function(j){return j.field.canonicalString()+j.dir}(o)).join(","),__PRIVATE_isNullOrUndefined(e.limit)||(i+="|l:",i+=e.limit),e.startAt&&(i+="|lb:",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(o=>canonicalId(o)).join(",")),e.endAt&&(i+="|ub:",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(o=>canonicalId(o)).join(",")),e.Pe=i}return e.Pe}function __PRIVATE_targetEquals(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<s.orderBy.length;i++)if(!__PRIVATE_orderByEquals(s.orderBy[i],e.orderBy[i]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let i=0;i<s.filters.length;i++)if(!__PRIVATE_filterEquals(s.filters[i],e.filters[i]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!__PRIVATE_boundEquals(s.startAt,e.startAt)&&__PRIVATE_boundEquals(s.endAt,e.endAt)}function __PRIVATE_targetIsDocumentTarget(s){return DocumentKey.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryImpl{constructor(e,i=null,o=[],a=[],j=null,_e="F",tt=null,et=null){this.path=e,this.collectionGroup=i,this.explicitOrderBy=o,this.filters=a,this.limit=j,this.limitType=_e,this.startAt=tt,this.endAt=et,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function __PRIVATE_newQuery(s,e,i,o,a,j,_e,tt){return new __PRIVATE_QueryImpl(s,e,i,o,a,j,_e,tt)}function __PRIVATE_newQueryForPath(s){return new __PRIVATE_QueryImpl(s)}function __PRIVATE_queryMatchesAllDocuments(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(s){return s.collectionGroup!==null}function __PRIVATE_queryNormalizedOrderBy(s){const e=__PRIVATE_debugCast(s);if(e.Te===null){e.Te=[];const i=new Set;for(const j of e.explicitOrderBy)e.Te.push(j),i.add(j.field.canonicalString());const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(_e){let tt=new SortedSet(FieldPath$1.comparator);return _e.filters.forEach(et=>{et.getFlattenedFilters().forEach(rt=>{rt.isInequality()&&(tt=tt.add(rt.field))})}),tt})(e).forEach(j=>{i.has(j.canonicalString())||j.isKeyField()||e.Te.push(new OrderBy(j,o))}),i.has(FieldPath$1.keyField().canonicalString())||e.Te.push(new OrderBy(FieldPath$1.keyField(),o))}return e.Te}function __PRIVATE_queryToTarget(s){const e=__PRIVATE_debugCast(s);return e.Ie||(e.Ie=__PRIVATE__queryToTarget(e,__PRIVATE_queryNormalizedOrderBy(s))),e.Ie}function __PRIVATE__queryToTarget(s,e){if(s.limitType==="F")return __PRIVATE_newTarget(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(a=>{const j=a.dir==="desc"?"asc":"desc";return new OrderBy(a.field,j)});const i=s.endAt?new Bound(s.endAt.position,s.endAt.inclusive):null,o=s.startAt?new Bound(s.startAt.position,s.startAt.inclusive):null;return __PRIVATE_newTarget(s.path,s.collectionGroup,e,s.filters,s.limit,i,o)}}function __PRIVATE_queryWithAddedFilter(s,e){const i=s.filters.concat([e]);return new __PRIVATE_QueryImpl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),i,s.limit,s.limitType,s.startAt,s.endAt)}function __PRIVATE_queryWithLimit(s,e,i){return new __PRIVATE_QueryImpl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,i,s.startAt,s.endAt)}function __PRIVATE_queryEquals(s,e){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(s),__PRIVATE_queryToTarget(e))&&s.limitType===e.limitType}function __PRIVATE_canonifyQuery(s){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(s))}|lt:${s.limitType}`}function __PRIVATE_stringifyQuery(s){return`Query(target=${function(i){let o=i.path.canonicalString();return i.collectionGroup!==null&&(o+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(o+=`, filters: [${i.filters.map(a=>__PRIVATE_stringifyFilter(a)).join(", ")}]`),__PRIVATE_isNullOrUndefined(i.limit)||(o+=", limit: "+i.limit),i.orderBy.length>0&&(o+=`, orderBy: [${i.orderBy.map(a=>function(_e){return`${_e.field.canonicalString()} (${_e.dir})`}(a)).join(", ")}]`),i.startAt&&(o+=", startAt: ",o+=i.startAt.inclusive?"b:":"a:",o+=i.startAt.position.map(a=>canonicalId(a)).join(",")),i.endAt&&(o+=", endAt: ",o+=i.endAt.inclusive?"a:":"b:",o+=i.endAt.position.map(a=>canonicalId(a)).join(",")),`Target(${o})`}(__PRIVATE_queryToTarget(s))}; limitType=${s.limitType})`}function __PRIVATE_queryMatches(s,e){return e.isFoundDocument()&&function(o,a){const j=a.key.path;return o.collectionGroup!==null?a.key.hasCollectionId(o.collectionGroup)&&o.path.isPrefixOf(j):DocumentKey.isDocumentKey(o.path)?o.path.isEqual(j):o.path.isImmediateParentOf(j)}(s,e)&&function(o,a){for(const j of __PRIVATE_queryNormalizedOrderBy(o))if(!j.field.isKeyField()&&a.data.field(j.field)===null)return!1;return!0}(s,e)&&function(o,a){for(const j of o.filters)if(!j.matches(a))return!1;return!0}(s,e)&&function(o,a){return!(o.startAt&&!function(_e,tt,et){const rt=__PRIVATE_boundCompareToDocument(_e,tt,et);return _e.inclusive?rt<=0:rt<0}(o.startAt,__PRIVATE_queryNormalizedOrderBy(o),a)||o.endAt&&!function(_e,tt,et){const rt=__PRIVATE_boundCompareToDocument(_e,tt,et);return _e.inclusive?rt>=0:rt>0}(o.endAt,__PRIVATE_queryNormalizedOrderBy(o),a))}(s,e)}function __PRIVATE_queryCollectionGroup(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function __PRIVATE_newQueryComparator(s){return(e,i)=>{let o=!1;for(const a of __PRIVATE_queryNormalizedOrderBy(s)){const j=__PRIVATE_compareDocs(a,e,i);if(j!==0)return j;o=o||a.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(s,e,i){const o=s.field.isKeyField()?DocumentKey.comparator(e.key,i.key):function(j,_e,tt){const et=_e.data.field(j),rt=tt.data.field(j);return et!==null&&rt!==null?__PRIVATE_valueCompare(et,rt):fail(42886)}(s.field,e,i);switch(s.dir){case"asc":return o;case"desc":return-1*o;default:return fail(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectMap{constructor(e,i){this.mapKeyFn=e,this.equalsFn=i,this.inner={},this.innerSize=0}get(e){const i=this.mapKeyFn(e),o=this.inner[i];if(o!==void 0){for(const[a,j]of o)if(this.equalsFn(a,e))return j}}has(e){return this.get(e)!==void 0}set(e,i){const o=this.mapKeyFn(e),a=this.inner[o];if(a===void 0)return this.inner[o]=[[e,i]],void this.innerSize++;for(let j=0;j<a.length;j++)if(this.equalsFn(a[j][0],e))return void(a[j]=[e,i]);a.push([e,i]),this.innerSize++}delete(e){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return!1;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return o.length===1?delete this.inner[i]:o.splice(a,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(i,o)=>{for(const[a,j]of o)e(a,j)})}isEmpty(){return isEmpty(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et=new SortedMap(DocumentKey.comparator);function __PRIVATE_mutableDocumentMap(){return Et}const At=new SortedMap(DocumentKey.comparator);function documentMap(...s){let e=At;for(const i of s)e=e.insert(i.key,i);return e}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(s){let e=At;return s.forEach((i,o)=>e=e.insert(i,o.overlayedDocument)),e}function __PRIVATE_newOverlayMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newMutationMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(s=>s.toString(),(s,e)=>s.isEqual(e))}const Rt=new SortedMap(DocumentKey.comparator),Vt=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...s){let e=Vt;for(const i of s)e=e.add(i);return e}const mt=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return mt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(e)?"-0":e}}function __PRIVATE_toInteger(s){return{integerValue:""+s}}function toNumber(s,e){return isSafeInteger(e)?__PRIVATE_toInteger(e):__PRIVATE_toDouble(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransformOperation{constructor(){this._=void 0}}function __PRIVATE_applyTransformOperationToLocalView(s,e,i){return s instanceof __PRIVATE_ServerTimestampTransform?function(a,j){const _e={fields:{[ot]:{stringValue:st},[at]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return j&&__PRIVATE_isServerTimestamp(j)&&(j=__PRIVATE_getPreviousValue(j)),j&&(_e.fields[_t]=j),{mapValue:_e}}(i,e):s instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(s,e):s instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(s,e):function(a,j){const _e=__PRIVATE_computeTransformOperationBaseValue(a,j),tt=asNumber(_e)+asNumber(a.Ee);return isInteger(_e)&&isInteger(a.Ee)?__PRIVATE_toInteger(tt):__PRIVATE_toDouble(a.serializer,tt)}(s,e)}function __PRIVATE_applyTransformOperationToRemoteDocument(s,e,i){return s instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(s,e):s instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(s,e):i}function __PRIVATE_computeTransformOperationBaseValue(s,e){return s instanceof __PRIVATE_NumericIncrementTransformOperation?function(o){return isInteger(o)||function(j){return!!j&&"doubleValue"in j}(o)}(e)?e:{integerValue:0}:null}class __PRIVATE_ServerTimestampTransform extends TransformOperation{}class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayUnionTransformOperation(s,e){const i=__PRIVATE_coercedFieldValuesArray(e);for(const o of s.elements)i.some(a=>__PRIVATE_valueEquals(a,o))||i.push(o);return{arrayValue:{values:i}}}class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayRemoveTransformOperation(s,e){let i=__PRIVATE_coercedFieldValuesArray(e);for(const o of s.elements)i=i.filter(a=>!__PRIVATE_valueEquals(a,o));return{arrayValue:{values:i}}}class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,i){super(),this.serializer=e,this.Ee=i}}function asNumber(s){return __PRIVATE_normalizeNumber(s.integerValue||s.doubleValue)}function __PRIVATE_coercedFieldValuesArray(s){return isArray(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldTransform{constructor(e,i){this.field=e,this.transform=i}}function __PRIVATE_fieldTransformEquals(s,e){return s.field.isEqual(e.field)&&function(o,a){return o instanceof __PRIVATE_ArrayUnionTransformOperation&&a instanceof __PRIVATE_ArrayUnionTransformOperation||o instanceof __PRIVATE_ArrayRemoveTransformOperation&&a instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(o.elements,a.elements,__PRIVATE_valueEquals):o instanceof __PRIVATE_NumericIncrementTransformOperation&&a instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(o.Ee,a.Ee):o instanceof __PRIVATE_ServerTimestampTransform&&a instanceof __PRIVATE_ServerTimestampTransform}(s.transform,e.transform)}class MutationResult{constructor(e,i){this.version=e,this.transformResults=i}}class Precondition{constructor(e,i){this.updateTime=e,this.exists=i}static none(){return new Precondition}static exists(e){return new Precondition(void 0,e)}static updateTime(e){return new Precondition(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function __PRIVATE_preconditionIsValidForDocument(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Mutation{}function __PRIVATE_calculateOverlayMutation(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new __PRIVATE_DeleteMutation(s.key,Precondition.none()):new __PRIVATE_SetMutation(s.key,s.data,Precondition.none());{const i=s.data,o=ObjectValue.empty();let a=new SortedSet(FieldPath$1.comparator);for(let j of e.fields)if(!a.has(j)){let _e=i.field(j);_e===null&&j.length>1&&(j=j.popLast(),_e=i.field(j)),_e===null?o.delete(j):o.set(j,_e),a=a.add(j)}return new __PRIVATE_PatchMutation(s.key,o,new FieldMask(a.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(s,e,i){s instanceof __PRIVATE_SetMutation?function(a,j,_e){const tt=a.value.clone(),et=__PRIVATE_serverTransformResults(a.fieldTransforms,j,_e.transformResults);tt.setAll(et),j.convertToFoundDocument(_e.version,tt).setHasCommittedMutations()}(s,e,i):s instanceof __PRIVATE_PatchMutation?function(a,j,_e){if(!__PRIVATE_preconditionIsValidForDocument(a.precondition,j))return void j.convertToUnknownDocument(_e.version);const tt=__PRIVATE_serverTransformResults(a.fieldTransforms,j,_e.transformResults),et=j.data;et.setAll(__PRIVATE_getPatch(a)),et.setAll(tt),j.convertToFoundDocument(_e.version,et).setHasCommittedMutations()}(s,e,i):function(a,j,_e){j.convertToNoDocument(_e.version).setHasCommittedMutations()}(0,e,i)}function __PRIVATE_mutationApplyToLocalView(s,e,i,o){return s instanceof __PRIVATE_SetMutation?function(j,_e,tt,et){if(!__PRIVATE_preconditionIsValidForDocument(j.precondition,_e))return tt;const rt=j.value.clone(),dt=__PRIVATE_localTransformResults(j.fieldTransforms,et,_e);return rt.setAll(dt),_e.convertToFoundDocument(_e.version,rt).setHasLocalMutations(),null}(s,e,i,o):s instanceof __PRIVATE_PatchMutation?function(j,_e,tt,et){if(!__PRIVATE_preconditionIsValidForDocument(j.precondition,_e))return tt;const rt=__PRIVATE_localTransformResults(j.fieldTransforms,et,_e),dt=_e.data;return dt.setAll(__PRIVATE_getPatch(j)),dt.setAll(rt),_e.convertToFoundDocument(_e.version,dt).setHasLocalMutations(),tt===null?null:tt.unionWith(j.fieldMask.fields).unionWith(j.fieldTransforms.map(vt=>vt.field))}(s,e,i,o):function(j,_e,tt){return __PRIVATE_preconditionIsValidForDocument(j.precondition,_e)?(_e.convertToNoDocument(_e.version).setHasLocalMutations(),null):tt}(s,e,i)}function __PRIVATE_mutationExtractBaseValue(s,e){let i=null;for(const o of s.fieldTransforms){const a=e.data.field(o.field),j=__PRIVATE_computeTransformOperationBaseValue(o.transform,a||null);j!=null&&(i===null&&(i=ObjectValue.empty()),i.set(o.field,j))}return i||null}function __PRIVATE_mutationEquals(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(o,a){return o===void 0&&a===void 0||!(!o||!a)&&__PRIVATE_arrayEquals(o,a,(j,_e)=>__PRIVATE_fieldTransformEquals(j,_e))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class __PRIVATE_SetMutation extends Mutation{constructor(e,i,o,a=[]){super(),this.key=e,this.value=i,this.precondition=o,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class __PRIVATE_PatchMutation extends Mutation{constructor(e,i,o,a,j=[]){super(),this.key=e,this.data=i,this.fieldMask=o,this.precondition=a,this.fieldTransforms=j,this.type=1}getFieldMask(){return this.fieldMask}}function __PRIVATE_getPatch(s){const e=new Map;return s.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){const o=s.data.field(i);e.set(i,o)}}),e}function __PRIVATE_serverTransformResults(s,e,i){const o=new Map;__PRIVATE_hardAssert(s.length===i.length,32656,{Ae:i.length,Re:s.length});for(let a=0;a<i.length;a++){const j=s[a],_e=j.transform,tt=e.data.field(j.field);o.set(j.field,__PRIVATE_applyTransformOperationToRemoteDocument(_e,tt,i[a]))}return o}function __PRIVATE_localTransformResults(s,e,i){const o=new Map;for(const a of s){const j=a.transform,_e=i.data.field(a.field);o.set(a.field,__PRIVATE_applyTransformOperationToLocalView(j,_e,e))}return o}class __PRIVATE_DeleteMutation extends Mutation{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class __PRIVATE_VerifyMutation extends Mutation{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutationBatch{constructor(e,i,o,a){this.batchId=e,this.localWriteTime=i,this.baseMutations=o,this.mutations=a}applyToRemoteDocument(e,i){const o=i.mutationResults;for(let a=0;a<this.mutations.length;a++){const j=this.mutations[a];j.key.isEqual(e.key)&&__PRIVATE_mutationApplyToRemoteDocument(j,e,o[a])}}applyToLocalView(e,i){for(const o of this.baseMutations)o.key.isEqual(e.key)&&(i=__PRIVATE_mutationApplyToLocalView(o,e,i,this.localWriteTime));for(const o of this.mutations)o.key.isEqual(e.key)&&(i=__PRIVATE_mutationApplyToLocalView(o,e,i,this.localWriteTime));return i}applyToLocalDocumentSet(e,i){const o=__PRIVATE_newMutationMap();return this.mutations.forEach(a=>{const j=e.get(a.key),_e=j.overlayedDocument;let tt=this.applyToLocalView(_e,j.mutatedFields);tt=i.has(a.key)?null:tt;const et=__PRIVATE_calculateOverlayMutation(_e,tt);et!==null&&o.set(a.key,et),_e.isValidDocument()||_e.convertToNoDocument(SnapshotVersion.min())}),o}keys(){return this.mutations.reduce((e,i)=>e.add(i.key),__PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(i,o)=>__PRIVATE_mutationEquals(i,o))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(i,o)=>__PRIVATE_mutationEquals(i,o))}}class MutationBatchResult{constructor(e,i,o,a){this.batch=e,this.commitVersion=i,this.mutationResults=o,this.docVersions=a}static from(e,i,o){__PRIVATE_hardAssert(e.mutations.length===o.length,58842,{Ve:e.mutations.length,me:o.length});let a=function(){return Rt}();const j=e.mutations;for(let _e=0;_e<j.length;_e++)a=a.insert(j[_e].key,o[_e].version);return new MutationBatchResult(e,i,o,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overlay{constructor(e,i){this.largestBatchId=e,this.mutation=i}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistenceFilter{constructor(e,i){this.count=e,this.unchangedNames=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,gt;function __PRIVATE_isPermanentError(s){switch(s){case N.OK:return fail(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return fail(15467,{code:s})}}function __PRIVATE_mapCodeFromRpcCode(s){if(s===void 0)return __PRIVATE_logError("GRPC error has no .code"),N.UNKNOWN;switch(s){case ft.OK:return N.OK;case ft.CANCELLED:return N.CANCELLED;case ft.UNKNOWN:return N.UNKNOWN;case ft.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ft.INTERNAL:return N.INTERNAL;case ft.UNAVAILABLE:return N.UNAVAILABLE;case ft.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ft.NOT_FOUND:return N.NOT_FOUND;case ft.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ft.ABORTED:return N.ABORTED;case ft.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ft.DATA_LOSS:return N.DATA_LOSS;default:return fail(39323,{code:s})}}(gt=ft||(ft={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt=new Integer([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(s){const e=__PRIVATE_newTextEncoder().encode(s),i=new Md5;return i.update(e),new Uint8Array(i.digest())}function __PRIVATE_get64BitUints(s){const e=new DataView(s.buffer),i=e.getUint32(0,!0),o=e.getUint32(4,!0),a=e.getUint32(8,!0),j=e.getUint32(12,!0);return[new Integer([i,o],0),new Integer([a,j],0)]}class BloomFilter{constructor(e,i,o){if(this.bitmap=e,this.padding=i,this.hashCount=o,i<0||i>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${i}`);if(o<0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${o}`);if(e.length>0&&this.hashCount===0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${o}`);if(e.length===0&&i!==0)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${i}`);this.fe=8*e.length-i,this.ge=Integer.fromNumber(this.fe)}pe(e,i,o){let a=e.add(i.multiply(Integer.fromNumber(o)));return a.compare(yt)===1&&(a=new Integer([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const i=__PRIVATE_getMd5HashValue(e),[o,a]=__PRIVATE_get64BitUints(i);for(let j=0;j<this.hashCount;j++){const _e=this.pe(o,a,j);if(!this.ye(_e))return!1}return!0}static create(e,i,o){const a=e%8==0?0:8-e%8,j=new Uint8Array(Math.ceil(e/8)),_e=new BloomFilter(j,a,i);return o.forEach(tt=>_e.insert(tt)),_e}insert(e){if(this.fe===0)return;const i=__PRIVATE_getMd5HashValue(e),[o,a]=__PRIVATE_get64BitUints(i);for(let j=0;j<this.hashCount;j++){const _e=this.pe(o,a,j);this.we(_e)}}we(e){const i=Math.floor(e/8),o=e%8;this.bitmap[i]|=1<<o}}class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteEvent{constructor(e,i,o,a,j){this.snapshotVersion=e,this.targetChanges=i,this.targetMismatches=o,this.documentUpdates=a,this.resolvedLimboDocuments=j}static createSynthesizedRemoteEventForCurrentChange(e,i,o){const a=new Map;return a.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,i,o)),new RemoteEvent(SnapshotVersion.min(),a,new SortedMap(__PRIVATE_primitiveComparator),__PRIVATE_mutableDocumentMap(),__PRIVATE_documentKeySet())}}class TargetChange{constructor(e,i,o,a,j){this.resumeToken=e,this.current=i,this.addedDocuments=o,this.modifiedDocuments=a,this.removedDocuments=j}static createSynthesizedTargetChangeForCurrentChange(e,i,o){return new TargetChange(o,i,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentWatchChange{constructor(e,i,o,a){this.Se=e,this.removedTargetIds=i,this.key=o,this.be=a}}class __PRIVATE_ExistenceFilterChange{constructor(e,i){this.targetId=e,this.De=i}}class __PRIVATE_WatchTargetChange{constructor(e,i,o=ByteString.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=i,this.resumeToken=o,this.cause=a}}class __PRIVATE_TargetState{constructor(){this.ve=0,this.Ce=__PRIVATE_snapshotChangesMap(),this.Fe=ByteString.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=__PRIVATE_documentKeySet(),i=__PRIVATE_documentKeySet(),o=__PRIVATE_documentKeySet();return this.Ce.forEach((a,j)=>{switch(j){case 0:e=e.add(a);break;case 2:i=i.add(a);break;case 1:o=o.add(a);break;default:fail(38017,{changeType:j})}}),new TargetChange(this.Fe,this.Me,e,i,o)}ke(){this.xe=!1,this.Ce=__PRIVATE_snapshotChangesMap()}qe(e,i){this.xe=!0,this.Ce=this.Ce.insert(e,i)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,__PRIVATE_hardAssert(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class __PRIVATE_WatchChangeAggregator{constructor(e){this.We=e,this.Ge=new Map,this.ze=__PRIVATE_mutableDocumentMap(),this.je=__PRIVATE_documentTargetMap(),this.Je=__PRIVATE_documentTargetMap(),this.He=new SortedMap(__PRIVATE_primitiveComparator)}Ye(e){for(const i of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(i,e.be):this.Xe(i,e.key,e.be);for(const i of e.removedTargetIds)this.Xe(i,e.key,e.be)}et(e){this.forEachTarget(e,i=>{const o=this.tt(i);switch(e.state){case 0:this.nt(i)&&o.Be(e.resumeToken);break;case 1:o.Ue(),o.Oe||o.ke(),o.Be(e.resumeToken);break;case 2:o.Ue(),o.Oe||this.removeTarget(i);break;case 3:this.nt(i)&&(o.Ke(),o.Be(e.resumeToken));break;case 4:this.nt(i)&&(this.rt(i),o.Be(e.resumeToken));break;default:fail(56790,{state:e.state})}})}forEachTarget(e,i){e.targetIds.length>0?e.targetIds.forEach(i):this.Ge.forEach((o,a)=>{this.nt(a)&&i(a)})}it(e){const i=e.targetId,o=e.De.count,a=this.st(i);if(a){const j=a.target;if(__PRIVATE_targetIsDocumentTarget(j))if(o===0){const _e=new DocumentKey(j.path);this.Xe(i,_e,MutableDocument.newNoDocument(_e,SnapshotVersion.min()))}else __PRIVATE_hardAssert(o===1,20013,{expectedCount:o});else{const _e=this.ot(i);if(_e!==o){const tt=this._t(e),et=tt?this.ut(tt,e,_e):1;if(et!==0){this.rt(i);const rt=et===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(i,rt)}}}}}_t(e){const i=e.De.unchangedNames;if(!i||!i.bits)return null;const{bits:{bitmap:o="",padding:a=0},hashCount:j=0}=i;let _e,tt;try{_e=__PRIVATE_normalizeByteString(o).toUint8Array()}catch(et){if(et instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+et.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw et}try{tt=new BloomFilter(_e,a,j)}catch(et){return __PRIVATE_logWarn(et instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",et),null}return tt.fe===0?null:tt}ut(e,i,o){return i.De.count===o-this.ht(e,i.targetId)?0:2}ht(e,i){const o=this.We.getRemoteKeysForTarget(i);let a=0;return o.forEach(j=>{const _e=this.We.lt(),tt=`projects/${_e.projectId}/databases/${_e.database}/documents/${j.path.canonicalString()}`;e.mightContain(tt)||(this.Xe(i,j,null),a++)}),a}Pt(e){const i=new Map;this.Ge.forEach((j,_e)=>{const tt=this.st(_e);if(tt){if(j.current&&__PRIVATE_targetIsDocumentTarget(tt.target)){const et=new DocumentKey(tt.target.path);this.Tt(et).has(_e)||this.It(_e,et)||this.Xe(_e,et,MutableDocument.newNoDocument(et,e))}j.Ne&&(i.set(_e,j.Le()),j.ke())}});let o=__PRIVATE_documentKeySet();this.Je.forEach((j,_e)=>{let tt=!0;_e.forEachWhile(et=>{const rt=this.st(et);return!rt||rt.purpose==="TargetPurposeLimboResolution"||(tt=!1,!1)}),tt&&(o=o.add(j))}),this.ze.forEach((j,_e)=>_e.setReadTime(e));const a=new RemoteEvent(e,i,this.He,this.ze,o);return this.ze=__PRIVATE_mutableDocumentMap(),this.je=__PRIVATE_documentTargetMap(),this.Je=__PRIVATE_documentTargetMap(),this.He=new SortedMap(__PRIVATE_primitiveComparator),a}Ze(e,i){if(!this.nt(e))return;const o=this.It(e,i.key)?2:0;this.tt(e).qe(i.key,o),this.ze=this.ze.insert(i.key,i),this.je=this.je.insert(i.key,this.Tt(i.key).add(e)),this.Je=this.Je.insert(i.key,this.dt(i.key).add(e))}Xe(e,i,o){if(!this.nt(e))return;const a=this.tt(e);this.It(e,i)?a.qe(i,1):a.Qe(i),this.Je=this.Je.insert(i,this.dt(i).delete(e)),this.Je=this.Je.insert(i,this.dt(i).add(e)),o&&(this.ze=this.ze.insert(i,o))}removeTarget(e){this.Ge.delete(e)}ot(e){const i=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let i=this.Ge.get(e);return i||(i=new __PRIVATE_TargetState,this.Ge.set(e,i)),i}dt(e){let i=this.Je.get(e);return i||(i=new SortedSet(__PRIVATE_primitiveComparator),this.Je=this.Je.insert(e,i)),i}Tt(e){let i=this.je.get(e);return i||(i=new SortedSet(__PRIVATE_primitiveComparator),this.je=this.je.insert(e,i)),i}nt(e){const i=this.st(e)!==null;return i||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),i}st(e){const i=this.Ge.get(e);return i&&i.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new __PRIVATE_TargetState),this.We.getRemoteKeysForTarget(e).forEach(i=>{this.Xe(e,i,null)})}It(e,i){return this.We.getRemoteKeysForTarget(e).has(i)}}function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}const wt={asc:"ASCENDING",desc:"DESCENDING"},St={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bt={and:"AND",or:"OR"};class JsonProtoSerializer{constructor(e,i){this.databaseId=e,this.useProto3Json=i}}function __PRIVATE_toInt32Proto(s,e){return s.useProto3Json||__PRIVATE_isNullOrUndefined(e)?e:{value:e}}function toTimestamp(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __PRIVATE_toBytes(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function __PRIVATE_toVersion(s,e){return toTimestamp(s,e.toTimestamp())}function __PRIVATE_fromVersion(s){return __PRIVATE_hardAssert(!!s,49232),SnapshotVersion.fromTimestamp(function(i){const o=__PRIVATE_normalizeTimestamp(i);return new Timestamp(o.seconds,o.nanos)}(s))}function __PRIVATE_toResourceName(s,e){return __PRIVATE_toResourcePath(s,e).canonicalString()}function __PRIVATE_toResourcePath(s,e){const i=function(a){return new ResourcePath(["projects",a.projectId,"databases",a.database])}(s).child("documents");return e===void 0?i:i.child(e)}function __PRIVATE_fromResourceName(s){const e=ResourcePath.fromString(s);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(e),10190,{key:e.toString()}),e}function __PRIVATE_toName(s,e){return __PRIVATE_toResourceName(s.databaseId,e.path)}function fromName(s,e){const i=__PRIVATE_fromResourceName(e);if(i.get(1)!==s.databaseId.projectId)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+s.databaseId.projectId);if(i.get(3)!==s.databaseId.database)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+s.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(i))}function __PRIVATE_toQueryPath(s,e){return __PRIVATE_toResourceName(s.databaseId,e)}function __PRIVATE_fromQueryPath(s){const e=__PRIVATE_fromResourceName(s);return e.length===4?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(e)}function __PRIVATE_getEncodedDatabaseId(s){return new ResourcePath(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(s){return __PRIVATE_hardAssert(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function __PRIVATE_toMutationDocument(s,e,i){return{name:__PRIVATE_toName(s,e),fields:i.value.mapValue.fields}}function __PRIVATE_fromWatchChange(s,e){let i;if("targetChange"in e){e.targetChange;const o=function(rt){return rt==="NO_CHANGE"?0:rt==="ADD"?1:rt==="REMOVE"?2:rt==="CURRENT"?3:rt==="RESET"?4:fail(39313,{state:rt})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],j=function(rt,dt){return rt.useProto3Json?(__PRIVATE_hardAssert(dt===void 0||typeof dt=="string",58123),ByteString.fromBase64String(dt||"")):(__PRIVATE_hardAssert(dt===void 0||dt instanceof Buffer||dt instanceof Uint8Array,16193),ByteString.fromUint8Array(dt||new Uint8Array))}(s,e.targetChange.resumeToken),_e=e.targetChange.cause,tt=_e&&function(rt){const dt=rt.code===void 0?N.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(rt.code);return new FirestoreError(dt,rt.message||"")}(_e);i=new __PRIVATE_WatchTargetChange(o,a,j,tt||null)}else if("documentChange"in e){e.documentChange;const o=e.documentChange;o.document,o.document.name,o.document.updateTime;const a=fromName(s,o.document.name),j=__PRIVATE_fromVersion(o.document.updateTime),_e=o.document.createTime?__PRIVATE_fromVersion(o.document.createTime):SnapshotVersion.min(),tt=new ObjectValue({mapValue:{fields:o.document.fields}}),et=MutableDocument.newFoundDocument(a,j,_e,tt),rt=o.targetIds||[],dt=o.removedTargetIds||[];i=new __PRIVATE_DocumentWatchChange(rt,dt,et.key,et)}else if("documentDelete"in e){e.documentDelete;const o=e.documentDelete;o.document;const a=fromName(s,o.document),j=o.readTime?__PRIVATE_fromVersion(o.readTime):SnapshotVersion.min(),_e=MutableDocument.newNoDocument(a,j),tt=o.removedTargetIds||[];i=new __PRIVATE_DocumentWatchChange([],tt,_e.key,_e)}else if("documentRemove"in e){e.documentRemove;const o=e.documentRemove;o.document;const a=fromName(s,o.document),j=o.removedTargetIds||[];i=new __PRIVATE_DocumentWatchChange([],j,a,null)}else{if(!("filter"in e))return fail(11601,{At:e});{e.filter;const o=e.filter;o.targetId;const{count:a=0,unchangedNames:j}=o,_e=new ExistenceFilter(a,j),tt=o.targetId;i=new __PRIVATE_ExistenceFilterChange(tt,_e)}}return i}function toMutation(s,e){let i;if(e instanceof __PRIVATE_SetMutation)i={update:__PRIVATE_toMutationDocument(s,e.key,e.value)};else if(e instanceof __PRIVATE_DeleteMutation)i={delete:__PRIVATE_toName(s,e.key)};else if(e instanceof __PRIVATE_PatchMutation)i={update:__PRIVATE_toMutationDocument(s,e.key,e.data),updateMask:__PRIVATE_toDocumentMask(e.fieldMask)};else{if(!(e instanceof __PRIVATE_VerifyMutation))return fail(16599,{Rt:e.type});i={verify:__PRIVATE_toName(s,e.key)}}return e.fieldTransforms.length>0&&(i.updateTransforms=e.fieldTransforms.map(o=>function(j,_e){const tt=_e.transform;if(tt instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:_e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(tt instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:_e.field.canonicalString(),appendMissingElements:{values:tt.elements}};if(tt instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:_e.field.canonicalString(),removeAllFromArray:{values:tt.elements}};if(tt instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:_e.field.canonicalString(),increment:tt.Ee};throw fail(20930,{transform:_e.transform})}(0,o))),e.precondition.isNone||(i.currentDocument=function(a,j){return j.updateTime!==void 0?{updateTime:__PRIVATE_toVersion(a,j.updateTime)}:j.exists!==void 0?{exists:j.exists}:fail(27497)}(s,e.precondition)),i}function __PRIVATE_fromWriteResults(s,e){return s&&s.length>0?(__PRIVATE_hardAssert(e!==void 0,14353),s.map(i=>function(a,j){let _e=a.updateTime?__PRIVATE_fromVersion(a.updateTime):__PRIVATE_fromVersion(j);return _e.isEqual(SnapshotVersion.min())&&(_e=__PRIVATE_fromVersion(j)),new MutationResult(_e,a.transformResults||[])}(i,e))):[]}function __PRIVATE_toDocumentsTarget(s,e){return{documents:[__PRIVATE_toQueryPath(s,e.path)]}}function __PRIVATE_toQueryTarget(s,e){const i={structuredQuery:{}},o=e.path;let a;e.collectionGroup!==null?(a=o,i.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=o.popLast(),i.structuredQuery.from=[{collectionId:o.lastSegment()}]),i.parent=__PRIVATE_toQueryPath(s,a);const j=function(rt){if(rt.length!==0)return __PRIVATE_toFilter(CompositeFilter.create(rt,"and"))}(e.filters);j&&(i.structuredQuery.where=j);const _e=function(rt){if(rt.length!==0)return rt.map(dt=>function(Ct){return{field:__PRIVATE_toFieldPathReference(Ct.field),direction:__PRIVATE_toDirection(Ct.dir)}}(dt))}(e.orderBy);_e&&(i.structuredQuery.orderBy=_e);const tt=__PRIVATE_toInt32Proto(s,e.limit);return tt!==null&&(i.structuredQuery.limit=tt),e.startAt&&(i.structuredQuery.startAt=function(rt){return{before:rt.inclusive,values:rt.position}}(e.startAt)),e.endAt&&(i.structuredQuery.endAt=function(rt){return{before:!rt.inclusive,values:rt.position}}(e.endAt)),{Vt:i,parent:a}}function __PRIVATE_convertQueryTargetToQuery(s){let e=__PRIVATE_fromQueryPath(s.parent);const i=s.structuredQuery,o=i.from?i.from.length:0;let a=null;if(o>0){__PRIVATE_hardAssert(o===1,65062);const dt=i.from[0];dt.allDescendants?a=dt.collectionId:e=e.child(dt.collectionId)}let j=[];i.where&&(j=function(vt){const Ct=__PRIVATE_fromFilter(vt);return Ct instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlatConjunction(Ct)?Ct.getFilters():[Ct]}(i.where));let _e=[];i.orderBy&&(_e=function(vt){return vt.map(Ct=>function(Bt){return new OrderBy(__PRIVATE_fromFieldPathReference(Bt.field),function(Ut){switch(Ut){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Bt.direction))}(Ct))}(i.orderBy));let tt=null;i.limit&&(tt=function(vt){let Ct;return Ct=typeof vt=="object"?vt.value:vt,__PRIVATE_isNullOrUndefined(Ct)?null:Ct}(i.limit));let et=null;i.startAt&&(et=function(vt){const Ct=!!vt.before,Wt=vt.values||[];return new Bound(Wt,Ct)}(i.startAt));let rt=null;return i.endAt&&(rt=function(vt){const Ct=!vt.before,Wt=vt.values||[];return new Bound(Wt,Ct)}(i.endAt)),__PRIVATE_newQuery(e,a,_e,j,tt,"F",et,rt)}function __PRIVATE_toListenRequestLabels(s,e){const i=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail(28987,{purpose:a})}}(e.purpose);return i==null?null:{"goog-listen-tags":i}}function __PRIVATE_fromFilter(s){return s.unaryFilter!==void 0?function(i){switch(i.unaryFilter.op){case"IS_NAN":const o=__PRIVATE_fromFieldPathReference(i.unaryFilter.field);return FieldFilter.create(o,"==",{doubleValue:NaN});case"IS_NULL":const a=__PRIVATE_fromFieldPathReference(i.unaryFilter.field);return FieldFilter.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const j=__PRIVATE_fromFieldPathReference(i.unaryFilter.field);return FieldFilter.create(j,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const _e=__PRIVATE_fromFieldPathReference(i.unaryFilter.field);return FieldFilter.create(_e,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fail(61313);default:return fail(60726)}}(s):s.fieldFilter!==void 0?function(i){return FieldFilter.create(__PRIVATE_fromFieldPathReference(i.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fail(58110);default:return fail(50506)}}(i.fieldFilter.op),i.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(i){return CompositeFilter.create(i.compositeFilter.filters.map(o=>__PRIVATE_fromFilter(o)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return fail(1026)}}(i.compositeFilter.op))}(s):fail(30097,{filter:s})}function __PRIVATE_toDirection(s){return wt[s]}function __PRIVATE_toOperatorName(s){return St[s]}function __PRIVATE_toCompositeOperatorName(s){return bt[s]}function __PRIVATE_toFieldPathReference(s){return{fieldPath:s.canonicalString()}}function __PRIVATE_fromFieldPathReference(s){return FieldPath$1.fromServerFormat(s.fieldPath)}function __PRIVATE_toFilter(s){return s instanceof FieldFilter?function(i){if(i.op==="=="){if(__PRIVATE_isNanValue(i.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(i.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(i.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(i.field),op:"IS_NULL"}}}else if(i.op==="!="){if(__PRIVATE_isNanValue(i.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(i.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(i.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(i.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(i.field),op:__PRIVATE_toOperatorName(i.op),value:i.value}}}(s):s instanceof CompositeFilter?function(i){const o=i.getFilters().map(a=>__PRIVATE_toFilter(a));return o.length===1?o[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(i.op),filters:o}}}(s):fail(54877,{filter:s})}function __PRIVATE_toDocumentMask(s){const e=[];return s.fields.forEach(i=>e.push(i.canonicalString())),{fieldPaths:e}}function __PRIVATE_isValidResourceName(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TargetData{constructor(e,i,o,a,j=SnapshotVersion.min(),_e=SnapshotVersion.min(),tt=ByteString.EMPTY_BYTE_STRING,et=null){this.target=e,this.targetId=i,this.purpose=o,this.sequenceNumber=a,this.snapshotVersion=j,this.lastLimboFreeSnapshotVersion=_e,this.resumeToken=tt,this.expectedCount=et}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,i){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalSerializer{constructor(e){this.gt=e}}function __PRIVATE_fromBundledQuery(s){const e=__PRIVATE_convertQueryTargetToQuery({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?__PRIVATE_queryWithLimit(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryIndexManager{constructor(){this.Dn=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,i){return this.Dn.add(i),PersistencePromise.resolve()}getCollectionParents(e,i){return PersistencePromise.resolve(this.Dn.getEntries(i))}addFieldIndex(e,i){return PersistencePromise.resolve()}deleteFieldIndex(e,i){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,i){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,i){return PersistencePromise.resolve(null)}getIndexType(e,i){return PersistencePromise.resolve(0)}getFieldIndexes(e,i){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,i){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,i){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,i,o){return PersistencePromise.resolve()}updateIndexEntries(e,i){return PersistencePromise.resolve()}}class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){const i=e.lastSegment(),o=e.popLast(),a=this.index[i]||new SortedSet(ResourcePath.comparator),j=!a.has(o);return this.index[i]=a.add(o),j}has(e){const i=e.lastSegment(),o=e.popLast(),a=this.index[i];return a&&a.has(o)}getEntries(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mt=41943040;class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,i,o){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=i,this.maximumSequenceNumbersToCollect=o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(Mt,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetIdGenerator{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new __PRIVATE_TargetIdGenerator(0)}static ur(){return new __PRIVATE_TargetIdGenerator(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt="LruGarbageCollector",Ot=1048576;function __PRIVATE_bufferEntryComparator([s,e],[i,o]){const a=__PRIVATE_primitiveComparator(s,i);return a===0?__PRIVATE_primitiveComparator(e,o):a}class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Tr=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.Ir=0}dr(){return++this.Ir}Er(e){const i=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(i);else{const o=this.buffer.last();__PRIVATE_bufferEntryComparator(i,o)<0&&(this.buffer=this.buffer.delete(o).add(i))}}get maxValue(){return this.buffer.last()[0]}}class __PRIVATE_LruScheduler{constructor(e,i,o){this.garbageCollector=e,this.asyncQueue=i,this.localStore=o,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){__PRIVATE_logDebug(xt,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(i){__PRIVATE_isIndexedDbTransactionError(i)?__PRIVATE_logDebug(xt,"Ignoring IndexedDB error during garbage collection: ",i):await __PRIVATE_ignoreIfPrimaryLeaseLoss(i)}await this.Rr(3e5)})}}class __PRIVATE_LruGarbageCollectorImpl{constructor(e,i){this.Vr=e,this.params=i}calculateTargetCount(e,i){return this.Vr.mr(e).next(o=>Math.floor(i/100*o))}nthSequenceNumber(e,i){if(i===0)return PersistencePromise.resolve(__PRIVATE_ListenSequence.ue);const o=new __PRIVATE_RollingSequenceNumberBuffer(i);return this.Vr.forEachTarget(e,a=>o.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>o.Er(a))).next(()=>o.maxValue)}removeTargets(e,i,o){return this.Vr.removeTargets(e,i,o)}removeOrphanedDocuments(e,i){return this.Vr.removeOrphanedDocuments(e,i)}collect(e,i){return this.params.cacheSizeCollectionThreshold===-1?(__PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(Ft)):this.getCacheSize(e).next(o=>o<this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${o} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ft):this.pr(e,i))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,i){let o,a,j,_e,tt,et,rt;const dt=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(vt=>(vt>this.params.maximumSequenceNumbersToCollect?(__PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${vt}`),a=this.params.maximumSequenceNumbersToCollect):a=vt,_e=Date.now(),this.nthSequenceNumber(e,a))).next(vt=>(o=vt,tt=Date.now(),this.removeTargets(e,o,i))).next(vt=>(j=vt,et=Date.now(),this.removeOrphanedDocuments(e,o))).next(vt=>(rt=Date.now(),__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${_e-dt}ms
	Determined least recently used ${a} in `+(tt-_e)+`ms
	Removed ${j} targets in `+(et-tt)+`ms
	Removed ${vt} documents in `+(rt-et)+`ms
Total Duration: ${rt-dt}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:j,documentsRemoved:vt})))}}function __PRIVATE_newLruGarbageCollector(s,e){return new __PRIVATE_LruGarbageCollectorImpl(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,i)=>e.isEqual(i)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,i){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(i))}getEntry(e,i){this.assertNotApplied();const o=this.changes.get(i);return o!==void 0?PersistencePromise.resolve(o):this.getFromCache(e,i)}getEntries(e,i){return this.getAllFromCache(e,i)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OverlayedDocument{constructor(e,i){this.overlayedDocument=e,this.mutatedFields=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LocalDocumentsView{constructor(e,i,o,a){this.remoteDocumentCache=e,this.mutationQueue=i,this.documentOverlayCache=o,this.indexManager=a}getDocument(e,i){let o=null;return this.documentOverlayCache.getOverlay(e,i).next(a=>(o=a,this.remoteDocumentCache.getEntry(e,i))).next(a=>(o!==null&&__PRIVATE_mutationApplyToLocalView(o.mutation,a,FieldMask.empty(),Timestamp.now()),a))}getDocuments(e,i){return this.remoteDocumentCache.getEntries(e,i).next(o=>this.getLocalViewOfDocuments(e,o,__PRIVATE_documentKeySet()).next(()=>o))}getLocalViewOfDocuments(e,i,o=__PRIVATE_documentKeySet()){const a=__PRIVATE_newOverlayMap();return this.populateOverlays(e,a,i).next(()=>this.computeViews(e,i,a,o).next(j=>{let _e=documentMap();return j.forEach((tt,et)=>{_e=_e.insert(tt,et.overlayedDocument)}),_e}))}getOverlayedDocuments(e,i){const o=__PRIVATE_newOverlayMap();return this.populateOverlays(e,o,i).next(()=>this.computeViews(e,i,o,__PRIVATE_documentKeySet()))}populateOverlays(e,i,o){const a=[];return o.forEach(j=>{i.has(j)||a.push(j)}),this.documentOverlayCache.getOverlays(e,a).next(j=>{j.forEach((_e,tt)=>{i.set(_e,tt)})})}computeViews(e,i,o,a){let j=__PRIVATE_mutableDocumentMap();const _e=__PRIVATE_newDocumentKeyMap(),tt=function(){return __PRIVATE_newDocumentKeyMap()}();return i.forEach((et,rt)=>{const dt=o.get(rt.key);a.has(rt.key)&&(dt===void 0||dt.mutation instanceof __PRIVATE_PatchMutation)?j=j.insert(rt.key,rt):dt!==void 0?(_e.set(rt.key,dt.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(dt.mutation,rt,dt.mutation.getFieldMask(),Timestamp.now())):_e.set(rt.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,j).next(et=>(et.forEach((rt,dt)=>_e.set(rt,dt)),i.forEach((rt,dt)=>{var vt;return tt.set(rt,new OverlayedDocument(dt,(vt=_e.get(rt))!==null&&vt!==void 0?vt:null))}),tt))}recalculateAndSaveOverlays(e,i){const o=__PRIVATE_newDocumentKeyMap();let a=new SortedMap((_e,tt)=>_e-tt),j=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,i).next(_e=>{for(const tt of _e)tt.keys().forEach(et=>{const rt=i.get(et);if(rt===null)return;let dt=o.get(et)||FieldMask.empty();dt=tt.applyToLocalView(rt,dt),o.set(et,dt);const vt=(a.get(tt.batchId)||__PRIVATE_documentKeySet()).add(et);a=a.insert(tt.batchId,vt)})}).next(()=>{const _e=[],tt=a.getReverseIterator();for(;tt.hasNext();){const et=tt.getNext(),rt=et.key,dt=et.value,vt=__PRIVATE_newMutationMap();dt.forEach(Ct=>{if(!j.has(Ct)){const Wt=__PRIVATE_calculateOverlayMutation(i.get(Ct),o.get(Ct));Wt!==null&&vt.set(Ct,Wt),j=j.add(Ct)}}),_e.push(this.documentOverlayCache.saveOverlays(e,rt,vt))}return PersistencePromise.waitFor(_e)}).next(()=>o)}recalculateAndSaveOverlaysForDocumentKeys(e,i){return this.remoteDocumentCache.getEntries(e,i).next(o=>this.recalculateAndSaveOverlays(e,o))}getDocumentsMatchingQuery(e,i,o,a){return function(_e){return DocumentKey.isDocumentKey(_e.path)&&_e.collectionGroup===null&&_e.filters.length===0}(i)?this.getDocumentsMatchingDocumentQuery(e,i.path):__PRIVATE_isCollectionGroupQuery(i)?this.getDocumentsMatchingCollectionGroupQuery(e,i,o,a):this.getDocumentsMatchingCollectionQuery(e,i,o,a)}getNextDocuments(e,i,o,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,i,o,a).next(j=>{const _e=a-j.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,i,o.largestBatchId,a-j.size):PersistencePromise.resolve(__PRIVATE_newOverlayMap());let tt=Q,et=j;return _e.next(rt=>PersistencePromise.forEach(rt,(dt,vt)=>(tt<vt.largestBatchId&&(tt=vt.largestBatchId),j.get(dt)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,dt).next(Ct=>{et=et.insert(dt,Ct)}))).next(()=>this.populateOverlays(e,rt,j)).next(()=>this.computeViews(e,et,rt,__PRIVATE_documentKeySet())).next(dt=>({batchId:tt,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(dt)})))})}getDocumentsMatchingDocumentQuery(e,i){return this.getDocument(e,new DocumentKey(i)).next(o=>{let a=documentMap();return o.isFoundDocument()&&(a=a.insert(o.key,o)),a})}getDocumentsMatchingCollectionGroupQuery(e,i,o,a){const j=i.collectionGroup;let _e=documentMap();return this.indexManager.getCollectionParents(e,j).next(tt=>PersistencePromise.forEach(tt,et=>{const rt=function(vt,Ct){return new __PRIVATE_QueryImpl(Ct,null,vt.explicitOrderBy.slice(),vt.filters.slice(),vt.limit,vt.limitType,vt.startAt,vt.endAt)}(i,et.child(j));return this.getDocumentsMatchingCollectionQuery(e,rt,o,a).next(dt=>{dt.forEach((vt,Ct)=>{_e=_e.insert(vt,Ct)})})}).next(()=>_e))}getDocumentsMatchingCollectionQuery(e,i,o,a){let j;return this.documentOverlayCache.getOverlaysForCollection(e,i.path,o.largestBatchId).next(_e=>(j=_e,this.remoteDocumentCache.getDocumentsMatchingQuery(e,i,o,j,a))).next(_e=>{j.forEach((et,rt)=>{const dt=rt.getKey();_e.get(dt)===null&&(_e=_e.insert(dt,MutableDocument.newInvalidDocument(dt)))});let tt=documentMap();return _e.forEach((et,rt)=>{const dt=j.get(et);dt!==void 0&&__PRIVATE_mutationApplyToLocalView(dt.mutation,rt,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(i,rt)&&(tt=tt.insert(et,rt))}),tt})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,i){return PersistencePromise.resolve(this.Br.get(i))}saveBundleMetadata(e,i){return this.Br.set(i.id,function(a){return{id:a.id,version:a.version,createTime:__PRIVATE_fromVersion(a.createTime)}}(i)),PersistencePromise.resolve()}getNamedQuery(e,i){return PersistencePromise.resolve(this.Lr.get(i))}saveNamedQuery(e,i){return this.Lr.set(i.name,function(a){return{name:a.name,query:__PRIVATE_fromBundledQuery(a.bundledQuery),readTime:__PRIVATE_fromVersion(a.readTime)}}(i)),PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.kr=new Map}getOverlay(e,i){return PersistencePromise.resolve(this.overlays.get(i))}getOverlays(e,i){const o=__PRIVATE_newOverlayMap();return PersistencePromise.forEach(i,a=>this.getOverlay(e,a).next(j=>{j!==null&&o.set(a,j)})).next(()=>o)}saveOverlays(e,i,o){return o.forEach((a,j)=>{this.wt(e,i,j)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,i,o){const a=this.kr.get(o);return a!==void 0&&(a.forEach(j=>this.overlays=this.overlays.remove(j)),this.kr.delete(o)),PersistencePromise.resolve()}getOverlaysForCollection(e,i,o){const a=__PRIVATE_newOverlayMap(),j=i.length+1,_e=new DocumentKey(i.child("")),tt=this.overlays.getIteratorFrom(_e);for(;tt.hasNext();){const et=tt.getNext().value,rt=et.getKey();if(!i.isPrefixOf(rt.path))break;rt.path.length===j&&et.largestBatchId>o&&a.set(et.getKey(),et)}return PersistencePromise.resolve(a)}getOverlaysForCollectionGroup(e,i,o,a){let j=new SortedMap((rt,dt)=>rt-dt);const _e=this.overlays.getIterator();for(;_e.hasNext();){const rt=_e.getNext().value;if(rt.getKey().getCollectionGroup()===i&&rt.largestBatchId>o){let dt=j.get(rt.largestBatchId);dt===null&&(dt=__PRIVATE_newOverlayMap(),j=j.insert(rt.largestBatchId,dt)),dt.set(rt.getKey(),rt)}}const tt=__PRIVATE_newOverlayMap(),et=j.getIterator();for(;et.hasNext()&&(et.getNext().value.forEach((rt,dt)=>tt.set(rt,dt)),!(tt.size()>=a)););return PersistencePromise.resolve(tt)}wt(e,i,o){const a=this.overlays.get(o.key);if(a!==null){const _e=this.kr.get(a.largestBatchId).delete(o.key);this.kr.set(a.largestBatchId,_e)}this.overlays=this.overlays.insert(o.key,new Overlay(i,o));let j=this.kr.get(i);j===void 0&&(j=__PRIVATE_documentKeySet(),this.kr.set(i,j)),this.kr.set(i,j.add(o.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,i){return this.sessionToken=i,PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ReferenceSet{constructor(){this.qr=new SortedSet(__PRIVATE_DocReference.Qr),this.$r=new SortedSet(__PRIVATE_DocReference.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,i){const o=new __PRIVATE_DocReference(e,i);this.qr=this.qr.add(o),this.$r=this.$r.add(o)}Kr(e,i){e.forEach(o=>this.addReference(o,i))}removeReference(e,i){this.Wr(new __PRIVATE_DocReference(e,i))}Gr(e,i){e.forEach(o=>this.removeReference(o,i))}zr(e){const i=new DocumentKey(new ResourcePath([])),o=new __PRIVATE_DocReference(i,e),a=new __PRIVATE_DocReference(i,e+1),j=[];return this.$r.forEachInRange([o,a],_e=>{this.Wr(_e),j.push(_e.key)}),j}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const i=new DocumentKey(new ResourcePath([])),o=new __PRIVATE_DocReference(i,e),a=new __PRIVATE_DocReference(i,e+1);let j=__PRIVATE_documentKeySet();return this.$r.forEachInRange([o,a],_e=>{j=j.add(_e.key)}),j}containsKey(e){const i=new __PRIVATE_DocReference(e,0),o=this.qr.firstAfterOrEqual(i);return o!==null&&e.isEqual(o.key)}}class __PRIVATE_DocReference{constructor(e,i){this.key=e,this.Hr=i}static Qr(e,i){return DocumentKey.comparator(e.key,i.key)||__PRIVATE_primitiveComparator(e.Hr,i.Hr)}static Ur(e,i){return __PRIVATE_primitiveComparator(e.Hr,i.Hr)||DocumentKey.comparator(e.key,i.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryMutationQueue{constructor(e,i){this.indexManager=e,this.referenceDelegate=i,this.mutationQueue=[],this.er=1,this.Yr=new SortedSet(__PRIVATE_DocReference.Qr)}checkEmpty(e){return PersistencePromise.resolve(this.mutationQueue.length===0)}addMutationBatch(e,i,o,a){const j=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const _e=new MutationBatch(j,i,o,a);this.mutationQueue.push(_e);for(const tt of a)this.Yr=this.Yr.add(new __PRIVATE_DocReference(tt.key,j)),this.indexManager.addToCollectionParentIndex(e,tt.key.path.popLast());return PersistencePromise.resolve(_e)}lookupMutationBatch(e,i){return PersistencePromise.resolve(this.Zr(i))}getNextMutationBatchAfterBatchId(e,i){const o=i+1,a=this.Xr(o),j=a<0?0:a;return PersistencePromise.resolve(this.mutationQueue.length>j?this.mutationQueue[j]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(this.mutationQueue.length===0?G:this.er-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,i){const o=new __PRIVATE_DocReference(i,0),a=new __PRIVATE_DocReference(i,Number.POSITIVE_INFINITY),j=[];return this.Yr.forEachInRange([o,a],_e=>{const tt=this.Zr(_e.Hr);j.push(tt)}),PersistencePromise.resolve(j)}getAllMutationBatchesAffectingDocumentKeys(e,i){let o=new SortedSet(__PRIVATE_primitiveComparator);return i.forEach(a=>{const j=new __PRIVATE_DocReference(a,0),_e=new __PRIVATE_DocReference(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([j,_e],tt=>{o=o.add(tt.Hr)})}),PersistencePromise.resolve(this.ei(o))}getAllMutationBatchesAffectingQuery(e,i){const o=i.path,a=o.length+1;let j=o;DocumentKey.isDocumentKey(j)||(j=j.child(""));const _e=new __PRIVATE_DocReference(new DocumentKey(j),0);let tt=new SortedSet(__PRIVATE_primitiveComparator);return this.Yr.forEachWhile(et=>{const rt=et.key.path;return!!o.isPrefixOf(rt)&&(rt.length===a&&(tt=tt.add(et.Hr)),!0)},_e),PersistencePromise.resolve(this.ei(tt))}ei(e){const i=[];return e.forEach(o=>{const a=this.Zr(o);a!==null&&i.push(a)}),i}removeMutationBatch(e,i){__PRIVATE_hardAssert(this.ti(i.batchId,"removed")===0,55003),this.mutationQueue.shift();let o=this.Yr;return PersistencePromise.forEach(i.mutations,a=>{const j=new __PRIVATE_DocReference(a.key,i.batchId);return o=o.delete(j),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=o})}rr(e){}containsKey(e,i){const o=new __PRIVATE_DocReference(i,0),a=this.Yr.firstAfterOrEqual(o);return PersistencePromise.resolve(i.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}ti(e,i){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const i=this.Xr(e);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.ni=e,this.docs=function(){return new SortedMap(DocumentKey.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,i){const o=i.key,a=this.docs.get(o),j=a?a.size:0,_e=this.ni(i);return this.docs=this.docs.insert(o,{document:i.mutableCopy(),size:_e}),this.size+=_e-j,this.indexManager.addToCollectionParentIndex(e,o.path.popLast())}removeEntry(e){const i=this.docs.get(e);i&&(this.docs=this.docs.remove(e),this.size-=i.size)}getEntry(e,i){const o=this.docs.get(i);return PersistencePromise.resolve(o?o.document.mutableCopy():MutableDocument.newInvalidDocument(i))}getEntries(e,i){let o=__PRIVATE_mutableDocumentMap();return i.forEach(a=>{const j=this.docs.get(a);o=o.insert(a,j?j.document.mutableCopy():MutableDocument.newInvalidDocument(a))}),PersistencePromise.resolve(o)}getDocumentsMatchingQuery(e,i,o,a){let j=__PRIVATE_mutableDocumentMap();const _e=i.path,tt=new DocumentKey(_e.child("__id-9223372036854775808__")),et=this.docs.getIteratorFrom(tt);for(;et.hasNext();){const{key:rt,value:{document:dt}}=et.getNext();if(!_e.isPrefixOf(rt.path))break;rt.path.length>_e.length+1||__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(dt),o)<=0||(a.has(dt.key)||__PRIVATE_queryMatches(i,dt))&&(j=j.insert(dt.key,dt.mutableCopy()))}return PersistencePromise.resolve(j)}getAllFromCollectionGroup(e,i,o,a){fail(9500)}ri(e,i){return PersistencePromise.forEach(this.docs,o=>i(o))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}}class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.Or=e}applyChanges(e){const i=[];return this.changes.forEach((o,a)=>{a.isValidDocument()?i.push(this.Or.addEntry(e,a)):this.Or.removeEntry(o)}),PersistencePromise.waitFor(i)}getFromCache(e,i){return this.Or.getEntry(e,i)}getAllFromCache(e,i){return this.Or.getEntries(e,i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.ii=new ObjectMap(i=>__PRIVATE_canonifyTarget(i),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this.si=0,this.oi=new __PRIVATE_ReferenceSet,this.targetCount=0,this._i=__PRIVATE_TargetIdGenerator.ar()}forEachTarget(e,i){return this.ii.forEach((o,a)=>i(a)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,i,o){return o&&(this.lastRemoteSnapshotVersion=o),i>this.si&&(this.si=i),PersistencePromise.resolve()}hr(e){this.ii.set(e.target,e);const i=e.targetId;i>this.highestTargetId&&(this._i=new __PRIVATE_TargetIdGenerator(i),this.highestTargetId=i),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,i){return this.hr(i),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,i){return this.hr(i),PersistencePromise.resolve()}removeTargetData(e,i){return this.ii.delete(i.target),this.oi.zr(i.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,i,o){let a=0;const j=[];return this.ii.forEach((_e,tt)=>{tt.sequenceNumber<=i&&o.get(tt.targetId)===null&&(this.ii.delete(_e),j.push(this.removeMatchingKeysForTargetId(e,tt.targetId)),a++)}),PersistencePromise.waitFor(j).next(()=>a)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,i){const o=this.ii.get(i)||null;return PersistencePromise.resolve(o)}addMatchingKeys(e,i,o){return this.oi.Kr(i,o),PersistencePromise.resolve()}removeMatchingKeys(e,i,o){this.oi.Gr(i,o);const a=this.persistence.referenceDelegate,j=[];return a&&i.forEach(_e=>{j.push(a.markPotentiallyOrphaned(e,_e))}),PersistencePromise.waitFor(j)}removeMatchingKeysForTargetId(e,i){return this.oi.zr(i),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,i){const o=this.oi.Jr(i);return PersistencePromise.resolve(o)}containsKey(e,i){return PersistencePromise.resolve(this.oi.containsKey(i))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryPersistence{constructor(e,i){this.ai={},this.overlays={},this.ui=new __PRIVATE_ListenSequence(0),this.ci=!1,this.ci=!0,this.li=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.hi=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=function(a){return new __PRIVATE_MemoryRemoteDocumentCacheImpl(a)}(o=>this.referenceDelegate.Pi(o)),this.serializer=new __PRIVATE_LocalSerializer(i),this.Ti=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let i=this.overlays[e.toKey()];return i||(i=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=i),i}getMutationQueue(e,i){let o=this.ai[e.toKey()];return o||(o=new __PRIVATE_MemoryMutationQueue(i,this.referenceDelegate),this.ai[e.toKey()]=o),o}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,i,o){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);const a=new __PRIVATE_MemoryTransaction(this.ui.next());return this.referenceDelegate.Ii(),o(a).next(j=>this.referenceDelegate.di(a).next(()=>j)).toPromise().then(j=>(a.raiseOnCommittedEvent(),j))}Ei(e,i){return PersistencePromise.or(Object.values(this.ai).map(o=>()=>o.containsKey(e,i)))}}class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}}class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Ai=new __PRIVATE_ReferenceSet,this.Ri=null}static Vi(e){return new __PRIVATE_MemoryEagerDelegate(e)}get mi(){if(this.Ri)return this.Ri;throw fail(60996)}addReference(e,i,o){return this.Ai.addReference(o,i),this.mi.delete(o.toString()),PersistencePromise.resolve()}removeReference(e,i,o){return this.Ai.removeReference(o,i),this.mi.add(o.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,i){return this.mi.add(i.toString()),PersistencePromise.resolve()}removeTarget(e,i){this.Ai.zr(i.targetId).forEach(a=>this.mi.add(a.toString()));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,i.targetId).next(a=>{a.forEach(j=>this.mi.add(j.toString()))}).next(()=>o.removeTargetData(e,i))}Ii(){this.Ri=new Set}di(e){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.mi,o=>{const a=DocumentKey.fromPath(o);return this.fi(e,a).next(j=>{j||i.removeEntry(a,SnapshotVersion.min())})}).next(()=>(this.Ri=null,i.apply(e)))}updateLimboDocument(e,i){return this.fi(e,i).next(o=>{o?this.mi.delete(i.toString()):this.mi.add(i.toString())})}Pi(e){return 0}fi(e,i){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Ai.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(e,i),()=>this.persistence.Ei(e,i)])}}class __PRIVATE_MemoryLruDelegate{constructor(e,i){this.persistence=e,this.gi=new ObjectMap(o=>__PRIVATE_encodeResourcePath(o.path),(o,a)=>o.isEqual(a)),this.garbageCollector=__PRIVATE_newLruGarbageCollector(this,i)}static Vi(e,i){return new __PRIVATE_MemoryLruDelegate(e,i)}Ii(){}di(e){return PersistencePromise.resolve()}forEachTarget(e,i){return this.persistence.getTargetCache().forEachTarget(e,i)}mr(e){const i=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(o=>i.next(a=>o+a))}yr(e){let i=0;return this.gr(e,o=>{i++}).next(()=>i)}gr(e,i){return PersistencePromise.forEach(this.gi,(o,a)=>this.Sr(e,o,a).next(j=>j?PersistencePromise.resolve():i(a)))}removeTargets(e,i,o){return this.persistence.getTargetCache().removeTargets(e,i,o)}removeOrphanedDocuments(e,i){let o=0;const a=this.persistence.getRemoteDocumentCache(),j=a.newChangeBuffer();return a.ri(e,_e=>this.Sr(e,_e,i).next(tt=>{tt||(o++,j.removeEntry(_e,SnapshotVersion.min()))})).next(()=>j.apply(e)).next(()=>o)}markPotentiallyOrphaned(e,i){return this.gi.set(i,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,i){const o=i.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,o)}addReference(e,i,o){return this.gi.set(o,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,i,o){return this.gi.set(o,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,i){return this.gi.set(i,e.currentSequenceNumber),PersistencePromise.resolve()}Pi(e){let i=e.key.toString().length;return e.isFoundDocument()&&(i+=__PRIVATE_estimateByteSize(e.data.value)),i}Sr(e,i,o){return PersistencePromise.or([()=>this.persistence.Ei(e,i),()=>this.persistence.getTargetCache().containsKey(e,i),()=>{const a=this.gi.get(i);return PersistencePromise.resolve(a!==void 0&&a>o)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalViewChanges{constructor(e,i,o,a){this.targetId=e,this.fromCache=i,this.Is=o,this.ds=a}static Es(e,i){let o=__PRIVATE_documentKeySet(),a=__PRIVATE_documentKeySet();for(const j of i.docChanges)switch(j.type){case 0:o=o.add(j.doc.key);break;case 1:a=a.add(j.doc.key)}return new __PRIVATE_LocalViewChanges(e,i.fromCache,o,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryEngine{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return isSafari()?8:__PRIVATE_getAndroidVersion(getUA())>0?6:4}()}initialize(e,i){this.gs=e,this.indexManager=i,this.As=!0}getDocumentsMatchingQuery(e,i,o,a){const j={result:null};return this.ps(e,i).next(_e=>{j.result=_e}).next(()=>{if(!j.result)return this.ys(e,i,a,o).next(_e=>{j.result=_e})}).next(()=>{if(j.result)return;const _e=new QueryContext;return this.ws(e,i,_e).next(tt=>{if(j.result=tt,this.Rs)return this.Ss(e,i,_e,tt.size)})}).next(()=>j.result)}Ss(e,i,o,a){return o.documentReadCount<this.Vs?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(i),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(i),"scans",o.documentReadCount,"local documents and returns",a,"documents as results."),o.documentReadCount>this.fs*a?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(i),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(i))):PersistencePromise.resolve())}ps(e,i){if(__PRIVATE_queryMatchesAllDocuments(i))return PersistencePromise.resolve(null);let o=__PRIVATE_queryToTarget(i);return this.indexManager.getIndexType(e,o).next(a=>a===0?null:(i.limit!==null&&a===1&&(i=__PRIVATE_queryWithLimit(i,null,"F"),o=__PRIVATE_queryToTarget(i)),this.indexManager.getDocumentsMatchingTarget(e,o).next(j=>{const _e=__PRIVATE_documentKeySet(...j);return this.gs.getDocuments(e,_e).next(tt=>this.indexManager.getMinOffset(e,o).next(et=>{const rt=this.bs(i,tt);return this.Ds(i,rt,_e,et.readTime)?this.ps(e,__PRIVATE_queryWithLimit(i,null,"F")):this.vs(e,rt,i,et)}))})))}ys(e,i,o,a){return __PRIVATE_queryMatchesAllDocuments(i)||a.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.gs.getDocuments(e,o).next(j=>{const _e=this.bs(i,j);return this.Ds(i,_e,o,a)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),__PRIVATE_stringifyQuery(i)),this.vs(e,_e,i,__PRIVATE_newIndexOffsetSuccessorFromReadTime(a,Q)).next(tt=>tt))})}bs(e,i){let o=new SortedSet(__PRIVATE_newQueryComparator(e));return i.forEach((a,j)=>{__PRIVATE_queryMatches(e,j)&&(o=o.add(j))}),o}Ds(e,i,o,a){if(e.limit===null)return!1;if(o.size!==i.size)return!0;const j=e.limitType==="F"?i.last():i.first();return!!j&&(j.hasPendingWrites||j.version.compareTo(a)>0)}ws(e,i,o){return __PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(i)),this.gs.getDocumentsMatchingQuery(e,i,IndexOffset.min(),o)}vs(e,i,o,a){return this.gs.getDocumentsMatchingQuery(e,o,a).next(j=>(i.forEach(_e=>{j=j.insert(_e.key,_e)}),j))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="LocalStore",$t=3e8;class __PRIVATE_LocalStoreImpl{constructor(e,i,o,a){this.persistence=e,this.Cs=i,this.serializer=a,this.Fs=new SortedMap(__PRIVATE_primitiveComparator),this.Ms=new ObjectMap(j=>__PRIVATE_canonifyTarget(j),__PRIVATE_targetEquals),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(o)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",i=>e.collect(i,this.Fs))}}function __PRIVATE_newLocalStore(s,e,i,o){return new __PRIVATE_LocalStoreImpl(s,e,i,o)}async function __PRIVATE_localStoreHandleUserChange(s,e){const i=__PRIVATE_debugCast(s);return await i.persistence.runTransaction("Handle user change","readonly",o=>{let a;return i.mutationQueue.getAllMutationBatches(o).next(j=>(a=j,i.Ns(e),i.mutationQueue.getAllMutationBatches(o))).next(j=>{const _e=[],tt=[];let et=__PRIVATE_documentKeySet();for(const rt of a){_e.push(rt.batchId);for(const dt of rt.mutations)et=et.add(dt.key)}for(const rt of j){tt.push(rt.batchId);for(const dt of rt.mutations)et=et.add(dt.key)}return i.localDocuments.getDocuments(o,et).next(rt=>({Bs:rt,removedBatchIds:_e,addedBatchIds:tt}))})})}function __PRIVATE_localStoreAcknowledgeBatch(s,e){const i=__PRIVATE_debugCast(s);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",o=>{const a=e.batch.keys(),j=i.Os.newChangeBuffer({trackRemovals:!0});return function(tt,et,rt,dt){const vt=rt.batch,Ct=vt.keys();let Wt=PersistencePromise.resolve();return Ct.forEach(Bt=>{Wt=Wt.next(()=>dt.getEntry(et,Bt)).next(qt=>{const Ut=rt.docVersions.get(Bt);__PRIVATE_hardAssert(Ut!==null,48541),qt.version.compareTo(Ut)<0&&(vt.applyToRemoteDocument(qt,rt),qt.isValidDocument()&&(qt.setReadTime(rt.commitVersion),dt.addEntry(qt)))})}),Wt.next(()=>tt.mutationQueue.removeMutationBatch(et,vt))}(i,o,e,j).next(()=>j.apply(o)).next(()=>i.mutationQueue.performConsistencyCheck(o)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(o,a,e.batch.batchId)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(o,function(tt){let et=__PRIVATE_documentKeySet();for(let rt=0;rt<tt.mutationResults.length;++rt)tt.mutationResults[rt].transformResults.length>0&&(et=et.add(tt.batch.mutations[rt].key));return et}(e))).next(()=>i.localDocuments.getDocuments(o,a))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(s){const e=__PRIVATE_debugCast(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",i=>e.hi.getLastRemoteSnapshotVersion(i))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(s,e){const i=__PRIVATE_debugCast(s),o=e.snapshotVersion;let a=i.Fs;return i.persistence.runTransaction("Apply remote event","readwrite-primary",j=>{const _e=i.Os.newChangeBuffer({trackRemovals:!0});a=i.Fs;const tt=[];e.targetChanges.forEach((dt,vt)=>{const Ct=a.get(vt);if(!Ct)return;tt.push(i.hi.removeMatchingKeys(j,dt.removedDocuments,vt).next(()=>i.hi.addMatchingKeys(j,dt.addedDocuments,vt)));let Wt=Ct.withSequenceNumber(j.currentSequenceNumber);e.targetMismatches.get(vt)!==null?Wt=Wt.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):dt.resumeToken.approximateByteSize()>0&&(Wt=Wt.withResumeToken(dt.resumeToken,o)),a=a.insert(vt,Wt),function(qt,Ut,kt){return qt.resumeToken.approximateByteSize()===0||Ut.snapshotVersion.toMicroseconds()-qt.snapshotVersion.toMicroseconds()>=$t?!0:kt.addedDocuments.size+kt.modifiedDocuments.size+kt.removedDocuments.size>0}(Ct,Wt,dt)&&tt.push(i.hi.updateTargetData(j,Wt))});let et=__PRIVATE_mutableDocumentMap(),rt=__PRIVATE_documentKeySet();if(e.documentUpdates.forEach(dt=>{e.resolvedLimboDocuments.has(dt)&&tt.push(i.persistence.referenceDelegate.updateLimboDocument(j,dt))}),tt.push(__PRIVATE_populateDocumentChangeBuffer(j,_e,e.documentUpdates).next(dt=>{et=dt.Ls,rt=dt.ks})),!o.isEqual(SnapshotVersion.min())){const dt=i.hi.getLastRemoteSnapshotVersion(j).next(vt=>i.hi.setTargetsMetadata(j,j.currentSequenceNumber,o));tt.push(dt)}return PersistencePromise.waitFor(tt).next(()=>_e.apply(j)).next(()=>i.localDocuments.getLocalViewOfDocuments(j,et,rt)).next(()=>et)}).then(j=>(i.Fs=a,j))}function __PRIVATE_populateDocumentChangeBuffer(s,e,i){let o=__PRIVATE_documentKeySet(),a=__PRIVATE_documentKeySet();return i.forEach(j=>o=o.add(j)),e.getEntries(s,o).next(j=>{let _e=__PRIVATE_mutableDocumentMap();return i.forEach((tt,et)=>{const rt=j.get(tt);et.isFoundDocument()!==rt.isFoundDocument()&&(a=a.add(tt)),et.isNoDocument()&&et.version.isEqual(SnapshotVersion.min())?(e.removeEntry(tt,et.readTime),_e=_e.insert(tt,et)):!rt.isValidDocument()||et.version.compareTo(rt.version)>0||et.version.compareTo(rt.version)===0&&rt.hasPendingWrites?(e.addEntry(et),_e=_e.insert(tt,et)):__PRIVATE_logDebug(Qt,"Ignoring outdated watch update for ",tt,". Current version:",rt.version," Watch version:",et.version)}),{Ls:_e,ks:a}})}function __PRIVATE_localStoreGetNextMutationBatch(s,e){const i=__PRIVATE_debugCast(s);return i.persistence.runTransaction("Get next mutation batch","readonly",o=>(e===void 0&&(e=G),i.mutationQueue.getNextMutationBatchAfterBatchId(o,e)))}function __PRIVATE_localStoreAllocateTarget(s,e){const i=__PRIVATE_debugCast(s);return i.persistence.runTransaction("Allocate target","readwrite",o=>{let a;return i.hi.getTargetData(o,e).next(j=>j?(a=j,PersistencePromise.resolve(a)):i.hi.allocateTargetId(o).next(_e=>(a=new TargetData(e,_e,"TargetPurposeListen",o.currentSequenceNumber),i.hi.addTargetData(o,a).next(()=>a))))}).then(o=>{const a=i.Fs.get(o.targetId);return(a===null||o.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(i.Fs=i.Fs.insert(o.targetId,o),i.Ms.set(e,o.targetId)),o})}async function __PRIVATE_localStoreReleaseTarget(s,e,i){const o=__PRIVATE_debugCast(s),a=o.Fs.get(e),j=i?"readwrite":"readwrite-primary";try{i||await o.persistence.runTransaction("Release target",j,_e=>o.persistence.referenceDelegate.removeTarget(_e,a))}catch(_e){if(!__PRIVATE_isIndexedDbTransactionError(_e))throw _e;__PRIVATE_logDebug(Qt,`Failed to update sequence numbers for target ${e}: ${_e}`)}o.Fs=o.Fs.remove(e),o.Ms.delete(a.target)}function __PRIVATE_localStoreExecuteQuery(s,e,i){const o=__PRIVATE_debugCast(s);let a=SnapshotVersion.min(),j=__PRIVATE_documentKeySet();return o.persistence.runTransaction("Execute query","readwrite",_e=>function(et,rt,dt){const vt=__PRIVATE_debugCast(et),Ct=vt.Ms.get(dt);return Ct!==void 0?PersistencePromise.resolve(vt.Fs.get(Ct)):vt.hi.getTargetData(rt,dt)}(o,_e,__PRIVATE_queryToTarget(e)).next(tt=>{if(tt)return a=tt.lastLimboFreeSnapshotVersion,o.hi.getMatchingKeysForTargetId(_e,tt.targetId).next(et=>{j=et})}).next(()=>o.Cs.getDocumentsMatchingQuery(_e,e,i?a:SnapshotVersion.min(),i?j:__PRIVATE_documentKeySet())).next(tt=>(__PRIVATE_setMaxReadTime(o,__PRIVATE_queryCollectionGroup(e),tt),{documents:tt,qs:j})))}function __PRIVATE_setMaxReadTime(s,e,i){let o=s.xs.get(e)||SnapshotVersion.min();i.forEach((a,j)=>{j.readTime.compareTo(o)>0&&(o=j.readTime)}),s.xs.set(e,o)}class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class __PRIVATE_MemorySharedClientState{constructor(){this.Fo=new __PRIVATE_LocalClientState,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,i,o){}addLocalQueryTarget(e,i=!0){return i&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,i,o){this.Mo[e]=i}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,i,o){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_NoopConnectivityMonitor{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt="ConnectivityMonitor";class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){__PRIVATE_logDebug(zt,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){__PRIVATE_logDebug(zt,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jt=null;function __PRIVATE_generateUniqueDebugId(){return jt===null?jt=function(){return 268435456+Math.round(2147483648*Math.random())}():jt++,"0x"+jt.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="RestConnection",Ht={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class __PRIVATE_RestConnection{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=i+"://"+e.host,this.Uo=`projects/${o}/databases/${a}`,this.Ko=this.databaseId.database===ut?`project_id=${o}`:`project_id=${o}&database_id=${a}`}Wo(e,i,o,a,j){const _e=__PRIVATE_generateUniqueDebugId(),tt=this.Go(e,i.toUriEncodedString());__PRIVATE_logDebug(Jt,`Sending RPC '${e}' ${_e}:`,tt,o);const et={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(et,a,j);const{host:rt}=new URL(tt),dt=isCloudWorkstation(rt);return this.jo(e,tt,et,o,dt).then(vt=>(__PRIVATE_logDebug(Jt,`Received RPC '${e}' ${_e}: `,vt),vt),vt=>{throw __PRIVATE_logWarn(Jt,`RPC '${e}' ${_e} failed with error: `,vt,"url: ",tt,"request:",o),vt})}Jo(e,i,o,a,j,_e){return this.Wo(e,i,o,a,j)}zo(e,i,o){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+x}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((a,j)=>e[j]=a),o&&o.headers.forEach((a,j)=>e[j]=a)}Go(e,i){const o=Ht[e];return`${this.$o}/v1/${i}:${o}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_StreamBridge{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class __PRIVATE_WebChannelConnection extends __PRIVATE_RestConnection{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,i,o,a,j){const _e=__PRIVATE_generateUniqueDebugId();return new Promise((tt,et)=>{const rt=new XhrIo;rt.setWithCredentials(!0),rt.listenOnce(EventType.COMPLETE,()=>{try{switch(rt.getLastErrorCode()){case ErrorCode$1.NO_ERROR:const vt=rt.getResponseJson();__PRIVATE_logDebug(Yt,`XHR for RPC '${e}' ${_e} received:`,JSON.stringify(vt)),tt(vt);break;case ErrorCode$1.TIMEOUT:__PRIVATE_logDebug(Yt,`RPC '${e}' ${_e} timed out`),et(new FirestoreError(N.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode$1.HTTP_ERROR:const Ct=rt.getStatus();if(__PRIVATE_logDebug(Yt,`RPC '${e}' ${_e} failed with status:`,Ct,"response text:",rt.getResponseText()),Ct>0){let Wt=rt.getResponseJson();Array.isArray(Wt)&&(Wt=Wt[0]);const Bt=Wt==null?void 0:Wt.error;if(Bt&&Bt.status&&Bt.message){const qt=function(kt){const Nt=kt.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(Nt)>=0?Nt:N.UNKNOWN}(Bt.status);et(new FirestoreError(qt,Bt.message))}else et(new FirestoreError(N.UNKNOWN,"Server responded with status "+rt.getStatus()))}else et(new FirestoreError(N.UNAVAILABLE,"Connection failed."));break;default:fail(9055,{c_:e,streamId:_e,l_:rt.getLastErrorCode(),h_:rt.getLastError()})}}finally{__PRIVATE_logDebug(Yt,`RPC '${e}' ${_e} completed.`)}});const dt=JSON.stringify(a);__PRIVATE_logDebug(Yt,`RPC '${e}' ${_e} sending request:`,a),rt.send(i,"POST",dt,o,15)})}P_(e,i,o){const a=__PRIVATE_generateUniqueDebugId(),j=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],_e=createWebChannelTransport(),tt=getStatEventTarget(),et={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},rt=this.longPollingOptions.timeoutSeconds;rt!==void 0&&(et.longPollingTimeout=Math.round(1e3*rt)),this.useFetchStreams&&(et.useFetchStreams=!0),this.zo(et.initMessageHeaders,i,o),et.encodeInitMessageHeaders=!0;const dt=j.join("");__PRIVATE_logDebug(Yt,`Creating RPC '${e}' stream ${a}: ${dt}`,et);const vt=_e.createWebChannel(dt,et);this.T_(vt);let Ct=!1,Wt=!1;const Bt=new __PRIVATE_StreamBridge({Ho:Ut=>{Wt?__PRIVATE_logDebug(Yt,`Not sending because RPC '${e}' stream ${a} is closed:`,Ut):(Ct||(__PRIVATE_logDebug(Yt,`Opening RPC '${e}' stream ${a} transport.`),vt.open(),Ct=!0),__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} sending:`,Ut),vt.send(Ut))},Yo:()=>vt.close()}),qt=(Ut,kt,Nt)=>{Ut.listen(kt,un=>{try{Nt(un)}catch(dn){setTimeout(()=>{throw dn},0)}})};return qt(vt,WebChannel.EventType.OPEN,()=>{Wt||(__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} transport opened.`),Bt.s_())}),qt(vt,WebChannel.EventType.CLOSE,()=>{Wt||(Wt=!0,__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} transport closed`),Bt.__(),this.I_(vt))}),qt(vt,WebChannel.EventType.ERROR,Ut=>{Wt||(Wt=!0,__PRIVATE_logWarn(Yt,`RPC '${e}' stream ${a} transport errored. Name:`,Ut.name,"Message:",Ut.message),Bt.__(new FirestoreError(N.UNAVAILABLE,"The operation could not be completed")))}),qt(vt,WebChannel.EventType.MESSAGE,Ut=>{var kt;if(!Wt){const Nt=Ut.data[0];__PRIVATE_hardAssert(!!Nt,16349);const un=Nt,dn=(un==null?void 0:un.error)||((kt=un[0])===null||kt===void 0?void 0:kt.error);if(dn){__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} received error:`,dn);const hn=dn.status;let gn=function(Dt){const mn=ft[Dt];if(mn!==void 0)return __PRIVATE_mapCodeFromRpcCode(mn)}(hn),It=dn.message;gn===void 0&&(gn=N.INTERNAL,It="Unknown error status: "+hn+" with message "+dn.message),Wt=!0,Bt.__(new FirestoreError(gn,It)),vt.close()}else __PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} received:`,Nt),Bt.a_(Nt)}}),qt(tt,Event$1.STAT_EVENT,Ut=>{Ut.stat===Stat.PROXY?__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} detected buffering proxy`):Ut.stat===Stat.NOPROXY&&__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{Bt.o_()},0),Bt}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(i=>i===e)}}function getDocument(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(s){return new JsonProtoSerializer(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor(e,i,o=1e3,a=1.5,j=6e4){this.Fi=e,this.timerId=i,this.d_=o,this.E_=a,this.A_=j,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const i=Math.floor(this.R_+this.p_()),o=Math.max(0,Date.now()-this.m_),a=Math.max(0,i-o);a>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${i} ms, last attempt: ${o} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="PersistentStream";class __PRIVATE_PersistentStream{constructor(e,i,o,a,j,_e,tt,et){this.Fi=e,this.w_=o,this.S_=a,this.connection=j,this.authCredentialsProvider=_e,this.appCheckCredentialsProvider=tt,this.listener=et,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new __PRIVATE_ExponentialBackoff(e,i)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,i){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():i&&i.code===N.RESOURCE_EXHAUSTED?(__PRIVATE_logError(i.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):i&&i.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(i)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),i=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([o,a])=>{this.b_===i&&this.W_(o,a)},o=>{e(()=>{const a=new FirestoreError(N.UNKNOWN,"Fetching auth token failed: "+o.message);return this.G_(a)})})}W_(e,i){const o=this.K_(this.b_);this.stream=this.z_(e,i),this.stream.Zo(()=>{o(()=>this.listener.Zo())}),this.stream.e_(()=>{o(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{o(()=>this.G_(a))}),this.stream.onMessage(a=>{o(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return __PRIVATE_logDebug(Zt,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return i=>{this.Fi.enqueueAndForget(()=>this.b_===e?i():(__PRIVATE_logDebug(Zt,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,i,o,a,j,_e){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,o,a,_e),this.serializer=j}z_(e,i){return this.connection.P_("Listen",e,i)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const i=__PRIVATE_fromWatchChange(this.serializer,e),o=function(j){if(!("targetChange"in j))return SnapshotVersion.min();const _e=j.targetChange;return _e.targetIds&&_e.targetIds.length?SnapshotVersion.min():_e.readTime?__PRIVATE_fromVersion(_e.readTime):SnapshotVersion.min()}(e);return this.listener.J_(i,o)}H_(e){const i={};i.database=__PRIVATE_getEncodedDatabaseId(this.serializer),i.addTarget=function(j,_e){let tt;const et=_e.target;if(tt=__PRIVATE_targetIsDocumentTarget(et)?{documents:__PRIVATE_toDocumentsTarget(j,et)}:{query:__PRIVATE_toQueryTarget(j,et).Vt},tt.targetId=_e.targetId,_e.resumeToken.approximateByteSize()>0){tt.resumeToken=__PRIVATE_toBytes(j,_e.resumeToken);const rt=__PRIVATE_toInt32Proto(j,_e.expectedCount);rt!==null&&(tt.expectedCount=rt)}else if(_e.snapshotVersion.compareTo(SnapshotVersion.min())>0){tt.readTime=toTimestamp(j,_e.snapshotVersion.toTimestamp());const rt=__PRIVATE_toInt32Proto(j,_e.expectedCount);rt!==null&&(tt.expectedCount=rt)}return tt}(this.serializer,e);const o=__PRIVATE_toListenRequestLabels(this.serializer,e);o&&(i.labels=o),this.k_(i)}Y_(e){const i={};i.database=__PRIVATE_getEncodedDatabaseId(this.serializer),i.removeTarget=e,this.k_(i)}}class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,i,o,a,j,_e){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,o,a,_e),this.serializer=j}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,i){return this.connection.P_("Write",e,i)}j_(e){return __PRIVATE_hardAssert(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){__PRIVATE_hardAssert(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const i=__PRIVATE_fromWriteResults(e.writeResults,e.commitTime),o=__PRIVATE_fromVersion(e.commitTime);return this.listener.ta(o,i)}na(){const e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.k_(e)}X_(e){const i={streamToken:this.lastStreamToken,writes:e.map(o=>toMutation(this.serializer,o))};this.k_(i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Datastore{}class __PRIVATE_DatastoreImpl extends Datastore{constructor(e,i,o,a){super(),this.authCredentials=e,this.appCheckCredentials=i,this.connection=o,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,i,o,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([j,_e])=>this.connection.Wo(e,__PRIVATE_toResourcePath(i,o),a,j,_e)).catch(j=>{throw j.name==="FirebaseError"?(j.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),j):new FirestoreError(N.UNKNOWN,j.toString())})}Jo(e,i,o,a,j){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([_e,tt])=>this.connection.Jo(e,__PRIVATE_toResourcePath(i,o),a,_e,tt,j)).catch(_e=>{throw _e.name==="FirebaseError"?(_e.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_e):new FirestoreError(N.UNKNOWN,_e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class __PRIVATE_OnlineStateTracker{constructor(e,i){this.asyncQueue=e,this.onlineStateHandler=i,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const i=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(__PRIVATE_logError(i),this._a=!1):__PRIVATE_logDebug("OnlineStateTracker",i)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="RemoteStore";class __PRIVATE_RemoteStoreImpl{constructor(e,i,o,a,j){this.localStore=e,this.datastore=i,this.asyncQueue=o,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=j,this.Ea.xo(_e=>{o.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug(Xt,"Restarting streams for network reachability change."),await async function(et){const rt=__PRIVATE_debugCast(et);rt.Ia.add(4),await __PRIVATE_disableNetworkInternal(rt),rt.Aa.set("Unknown"),rt.Ia.delete(4),await __PRIVATE_enableNetworkInternal(rt)}(this))})}),this.Aa=new __PRIVATE_OnlineStateTracker(o,a)}}async function __PRIVATE_enableNetworkInternal(s){if(__PRIVATE_canUseNetwork(s))for(const e of s.da)await e(!0)}async function __PRIVATE_disableNetworkInternal(s){for(const e of s.da)await e(!1)}function __PRIVATE_remoteStoreListen(s,e){const i=__PRIVATE_debugCast(s);i.Ta.has(e.targetId)||(i.Ta.set(e.targetId,e),__PRIVATE_shouldStartWatchStream(i)?__PRIVATE_startWatchStream(i):__PRIVATE_ensureWatchStream(i).x_()&&__PRIVATE_sendWatchRequest(i,e))}function __PRIVATE_remoteStoreUnlisten(s,e){const i=__PRIVATE_debugCast(s),o=__PRIVATE_ensureWatchStream(i);i.Ta.delete(e),o.x_()&&__PRIVATE_sendUnwatchRequest(i,e),i.Ta.size===0&&(o.x_()?o.B_():__PRIVATE_canUseNetwork(i)&&i.Aa.set("Unknown"))}function __PRIVATE_sendWatchRequest(s,e){if(s.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(SnapshotVersion.min())>0){const i=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(i)}__PRIVATE_ensureWatchStream(s).H_(e)}function __PRIVATE_sendUnwatchRequest(s,e){s.Ra.$e(e),__PRIVATE_ensureWatchStream(s).Y_(e)}function __PRIVATE_startWatchStream(s){s.Ra=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>s.Ta.get(e)||null,lt:()=>s.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(s).start(),s.Aa.aa()}function __PRIVATE_shouldStartWatchStream(s){return __PRIVATE_canUseNetwork(s)&&!__PRIVATE_ensureWatchStream(s).M_()&&s.Ta.size>0}function __PRIVATE_canUseNetwork(s){return __PRIVATE_debugCast(s).Ia.size===0}function __PRIVATE_cleanUpWatchStreamState(s){s.Ra=void 0}async function __PRIVATE_onWatchStreamConnected(s){s.Aa.set("Online")}async function __PRIVATE_onWatchStreamOpen(s){s.Ta.forEach((e,i)=>{__PRIVATE_sendWatchRequest(s,e)})}async function __PRIVATE_onWatchStreamClose(s,e){__PRIVATE_cleanUpWatchStreamState(s),__PRIVATE_shouldStartWatchStream(s)?(s.Aa.la(e),__PRIVATE_startWatchStream(s)):s.Aa.set("Unknown")}async function __PRIVATE_onWatchStreamChange(s,e,i){if(s.Aa.set("Online"),e instanceof __PRIVATE_WatchTargetChange&&e.state===2&&e.cause)try{await async function(a,j){const _e=j.cause;for(const tt of j.targetIds)a.Ta.has(tt)&&(await a.remoteSyncer.rejectListen(tt,_e),a.Ta.delete(tt),a.Ra.removeTarget(tt))}(s,e)}catch(o){__PRIVATE_logDebug(Xt,"Failed to remove targets %s: %s ",e.targetIds.join(","),o),await __PRIVATE_disableNetworkUntilRecovery(s,o)}else if(e instanceof __PRIVATE_DocumentWatchChange?s.Ra.Ye(e):e instanceof __PRIVATE_ExistenceFilterChange?s.Ra.it(e):s.Ra.et(e),!i.isEqual(SnapshotVersion.min()))try{const o=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(s.localStore);i.compareTo(o)>=0&&await function(j,_e){const tt=j.Ra.Pt(_e);return tt.targetChanges.forEach((et,rt)=>{if(et.resumeToken.approximateByteSize()>0){const dt=j.Ta.get(rt);dt&&j.Ta.set(rt,dt.withResumeToken(et.resumeToken,_e))}}),tt.targetMismatches.forEach((et,rt)=>{const dt=j.Ta.get(et);if(!dt)return;j.Ta.set(et,dt.withResumeToken(ByteString.EMPTY_BYTE_STRING,dt.snapshotVersion)),__PRIVATE_sendUnwatchRequest(j,et);const vt=new TargetData(dt.target,et,rt,dt.sequenceNumber);__PRIVATE_sendWatchRequest(j,vt)}),j.remoteSyncer.applyRemoteEvent(tt)}(s,i)}catch(o){__PRIVATE_logDebug(Xt,"Failed to raise snapshot:",o),await __PRIVATE_disableNetworkUntilRecovery(s,o)}}async function __PRIVATE_disableNetworkUntilRecovery(s,e,i){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;s.Ia.add(1),await __PRIVATE_disableNetworkInternal(s),s.Aa.set("Offline"),i||(i=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug(Xt,"Retrying IndexedDB access"),await i(),s.Ia.delete(1),await __PRIVATE_enableNetworkInternal(s)})}function __PRIVATE_executeWithRecovery(s,e){return e().catch(i=>__PRIVATE_disableNetworkUntilRecovery(s,i,e))}async function __PRIVATE_fillWritePipeline(s){const e=__PRIVATE_debugCast(s),i=__PRIVATE_ensureWriteStream(e);let o=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:G;for(;__PRIVATE_canAddToWritePipeline(e);)try{const a=await __PRIVATE_localStoreGetNextMutationBatch(e.localStore,o);if(a===null){e.Pa.length===0&&i.B_();break}o=a.batchId,__PRIVATE_addToWritePipeline(e,a)}catch(a){await __PRIVATE_disableNetworkUntilRecovery(e,a)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_canAddToWritePipeline(s){return __PRIVATE_canUseNetwork(s)&&s.Pa.length<10}function __PRIVATE_addToWritePipeline(s,e){s.Pa.push(e);const i=__PRIVATE_ensureWriteStream(s);i.x_()&&i.Z_&&i.X_(e.mutations)}function __PRIVATE_shouldStartWriteStream(s){return __PRIVATE_canUseNetwork(s)&&!__PRIVATE_ensureWriteStream(s).M_()&&s.Pa.length>0}function __PRIVATE_startWriteStream(s){__PRIVATE_ensureWriteStream(s).start()}async function __PRIVATE_onWriteStreamOpen(s){__PRIVATE_ensureWriteStream(s).na()}async function __PRIVATE_onWriteHandshakeComplete(s){const e=__PRIVATE_ensureWriteStream(s);for(const i of s.Pa)e.X_(i.mutations)}async function __PRIVATE_onMutationResult(s,e,i){const o=s.Pa.shift(),a=MutationBatchResult.from(o,e,i);await __PRIVATE_executeWithRecovery(s,()=>s.remoteSyncer.applySuccessfulWrite(a)),await __PRIVATE_fillWritePipeline(s)}async function __PRIVATE_onWriteStreamClose(s,e){e&&__PRIVATE_ensureWriteStream(s).Z_&&await async function(o,a){if(function(_e){return __PRIVATE_isPermanentError(_e)&&_e!==N.ABORTED}(a.code)){const j=o.Pa.shift();__PRIVATE_ensureWriteStream(o).N_(),await __PRIVATE_executeWithRecovery(o,()=>o.remoteSyncer.rejectFailedWrite(j.batchId,a)),await __PRIVATE_fillWritePipeline(o)}}(s,e),__PRIVATE_shouldStartWriteStream(s)&&__PRIVATE_startWriteStream(s)}async function __PRIVATE_remoteStoreHandleCredentialChange(s,e){const i=__PRIVATE_debugCast(s);i.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(Xt,"RemoteStore received new credentials");const o=__PRIVATE_canUseNetwork(i);i.Ia.add(3),await __PRIVATE_disableNetworkInternal(i),o&&i.Aa.set("Unknown"),await i.remoteSyncer.handleCredentialChange(e),i.Ia.delete(3),await __PRIVATE_enableNetworkInternal(i)}async function __PRIVATE_remoteStoreApplyPrimaryState(s,e){const i=__PRIVATE_debugCast(s);e?(i.Ia.delete(2),await __PRIVATE_enableNetworkInternal(i)):e||(i.Ia.add(2),await __PRIVATE_disableNetworkInternal(i),i.Aa.set("Unknown"))}function __PRIVATE_ensureWatchStream(s){return s.Va||(s.Va=function(i,o,a){const j=__PRIVATE_debugCast(i);return j.ia(),new __PRIVATE_PersistentListenStream(o,j.connection,j.authCredentials,j.appCheckCredentials,j.serializer,a)}(s.datastore,s.asyncQueue,{Zo:__PRIVATE_onWatchStreamConnected.bind(null,s),e_:__PRIVATE_onWatchStreamOpen.bind(null,s),n_:__PRIVATE_onWatchStreamClose.bind(null,s),J_:__PRIVATE_onWatchStreamChange.bind(null,s)}),s.da.push(async e=>{e?(s.Va.N_(),__PRIVATE_shouldStartWatchStream(s)?__PRIVATE_startWatchStream(s):s.Aa.set("Unknown")):(await s.Va.stop(),__PRIVATE_cleanUpWatchStreamState(s))})),s.Va}function __PRIVATE_ensureWriteStream(s){return s.ma||(s.ma=function(i,o,a){const j=__PRIVATE_debugCast(i);return j.ia(),new __PRIVATE_PersistentWriteStream(o,j.connection,j.authCredentials,j.appCheckCredentials,j.serializer,a)}(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),e_:__PRIVATE_onWriteStreamOpen.bind(null,s),n_:__PRIVATE_onWriteStreamClose.bind(null,s),ea:__PRIVATE_onWriteHandshakeComplete.bind(null,s),ta:__PRIVATE_onMutationResult.bind(null,s)}),s.da.push(async e=>{e?(s.ma.N_(),await __PRIVATE_fillWritePipeline(s)):(await s.ma.stop(),s.Pa.length>0&&(__PRIVATE_logDebug(Xt,`Stopping write stream with ${s.Pa.length} pending writes`),s.Pa=[]))})),s.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor(e,i,o,a,j){this.asyncQueue=e,this.timerId=i,this.targetTimeMs=o,this.op=a,this.removalCallback=j,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(_e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,i,o,a,j){const _e=Date.now()+o,tt=new DelayedOperation(e,i,_e,a,j);return tt.start(o),tt}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function __PRIVATE_wrapInUserErrorIfRecoverable(s,e){if(__PRIVATE_logError("AsyncQueue",`${e}: ${s}`),__PRIVATE_isIndexedDbTransactionError(s))return new FirestoreError(N.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSet{static emptySet(e){return new DocumentSet(e.comparator)}constructor(e){this.comparator=e?(i,o)=>e(i,o)||DocumentKey.comparator(i.key,o.key):(i,o)=>DocumentKey.comparator(i.key,o.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const i=this.keyedMap.get(e);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((i,o)=>(e(i),!1))}add(e){const i=this.delete(e.key);return i.copy(i.keyedMap.insert(e.key,e),i.sortedSet.insert(e,null))}delete(e){const i=this.get(e);return i?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(i)):this}isEqual(e){if(!(e instanceof DocumentSet)||this.size!==e.size)return!1;const i=this.sortedSet.getIterator(),o=e.sortedSet.getIterator();for(;i.hasNext();){const a=i.getNext().key,j=o.getNext().key;if(!a.isEqual(j))return!1}return!0}toString(){const e=[];return this.forEach(i=>{e.push(i.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,i){const o=new DocumentSet;return o.comparator=this.comparator,o.keyedMap=e,o.sortedSet=i,o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentChangeSet{constructor(){this.fa=new SortedMap(DocumentKey.comparator)}track(e){const i=e.doc.key,o=this.fa.get(i);o?e.type!==0&&o.type===3?this.fa=this.fa.insert(i,e):e.type===3&&o.type!==1?this.fa=this.fa.insert(i,{type:o.type,doc:e.doc}):e.type===2&&o.type===2?this.fa=this.fa.insert(i,{type:2,doc:e.doc}):e.type===2&&o.type===0?this.fa=this.fa.insert(i,{type:0,doc:e.doc}):e.type===1&&o.type===0?this.fa=this.fa.remove(i):e.type===1&&o.type===2?this.fa=this.fa.insert(i,{type:1,doc:o.doc}):e.type===0&&o.type===1?this.fa=this.fa.insert(i,{type:2,doc:e.doc}):fail(63341,{At:e,ga:o}):this.fa=this.fa.insert(i,e)}pa(){const e=[];return this.fa.inorderTraversal((i,o)=>{e.push(o)}),e}}class ViewSnapshot{constructor(e,i,o,a,j,_e,tt,et,rt){this.query=e,this.docs=i,this.oldDocs=o,this.docChanges=a,this.mutatedKeys=j,this.fromCache=_e,this.syncStateChanged=tt,this.excludesMetadataChanges=et,this.hasCachedResults=rt}static fromInitialDocuments(e,i,o,a,j){const _e=[];return i.forEach(tt=>{_e.push({type:0,doc:tt})}),new ViewSnapshot(e,i,DocumentSet.emptySet(i),_e,o,a,!0,!1,j)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const i=this.docChanges,o=e.docChanges;if(i.length!==o.length)return!1;for(let a=0;a<i.length;a++)if(i[a].type!==o[a].type||!i[a].doc.isEqual(o[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryListenersInfo{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(i,o){const a=__PRIVATE_debugCast(i),j=a.queries;a.queries=__PRIVATE_newQueriesObjectMap(),j.forEach((_e,tt)=>{for(const et of tt.wa)et.onError(o)})})(this,new FirestoreError(N.ABORTED,"Firestore shutting down"))}}function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(s=>__PRIVATE_canonifyQuery(s),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(s,e){const i=__PRIVATE_debugCast(s);let o=3;const a=e.query;let j=i.queries.get(a);j?!j.Sa()&&e.ba()&&(o=2):(j=new __PRIVATE_QueryListenersInfo,o=e.ba()?0:1);try{switch(o){case 0:j.ya=await i.onListen(a,!0);break;case 1:j.ya=await i.onListen(a,!1);break;case 2:await i.onFirstRemoteStoreListen(a)}}catch(_e){const tt=__PRIVATE_wrapInUserErrorIfRecoverable(_e,`Initialization of query '${__PRIVATE_stringifyQuery(e.query)}' failed`);return void e.onError(tt)}i.queries.set(a,j),j.wa.push(e),e.va(i.onlineState),j.ya&&e.Ca(j.ya)&&__PRIVATE_raiseSnapshotsInSyncEvent(i)}async function __PRIVATE_eventManagerUnlisten(s,e){const i=__PRIVATE_debugCast(s),o=e.query;let a=3;const j=i.queries.get(o);if(j){const _e=j.wa.indexOf(e);_e>=0&&(j.wa.splice(_e,1),j.wa.length===0?a=e.ba()?0:1:!j.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return i.queries.delete(o),i.onUnlisten(o,!0);case 1:return i.queries.delete(o),i.onUnlisten(o,!1);case 2:return i.onLastRemoteStoreUnlisten(o);default:return}}function __PRIVATE_eventManagerOnWatchChange(s,e){const i=__PRIVATE_debugCast(s);let o=!1;for(const a of e){const j=a.query,_e=i.queries.get(j);if(_e){for(const tt of _e.wa)tt.Ca(a)&&(o=!0);_e.ya=a}}o&&__PRIVATE_raiseSnapshotsInSyncEvent(i)}function __PRIVATE_eventManagerOnWatchError(s,e,i){const o=__PRIVATE_debugCast(s),a=o.queries.get(e);if(a)for(const j of a.wa)j.onError(i);o.queries.delete(e)}function __PRIVATE_raiseSnapshotsInSyncEvent(s){s.Da.forEach(e=>{e.next()})}var en,tn;(tn=en||(en={})).Fa="default",tn.Cache="cache";class __PRIVATE_QueryListener{constructor(e,i,o){this.query=e,this.Ma=i,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=o||{}}Ca(e){if(!this.options.includeMetadataChanges){const o=[];for(const a of e.docChanges)a.type!==3&&o.push(a);e=new ViewSnapshot(e.query,e.docs,e.oldDocs,o,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let i=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),i=!0):this.Ba(e,this.onlineState)&&(this.La(e),i=!0),this.Oa=e,i}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let i=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),i=!0),i}Ba(e,i){if(!e.fromCache||!this.ba())return!0;const o=i!=="Offline";return(!this.options.ka||!o)&&(!e.docs.isEmpty()||e.hasCachedResults||i==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const i=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!i)&&this.options.includeMetadataChanges===!0}La(e){e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==en.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_View{constructor(e,i){this.query=e,this.Ha=i,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.Xa=__PRIVATE_newQueryComparator(e),this.eu=new DocumentSet(this.Xa)}get tu(){return this.Ha}nu(e,i){const o=i?i.ru:new __PRIVATE_DocumentChangeSet,a=i?i.eu:this.eu;let j=i?i.mutatedKeys:this.mutatedKeys,_e=a,tt=!1;const et=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,rt=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((dt,vt)=>{const Ct=a.get(dt),Wt=__PRIVATE_queryMatches(this.query,vt)?vt:null,Bt=!!Ct&&this.mutatedKeys.has(Ct.key),qt=!!Wt&&(Wt.hasLocalMutations||this.mutatedKeys.has(Wt.key)&&Wt.hasCommittedMutations);let Ut=!1;Ct&&Wt?Ct.data.isEqual(Wt.data)?Bt!==qt&&(o.track({type:3,doc:Wt}),Ut=!0):this.iu(Ct,Wt)||(o.track({type:2,doc:Wt}),Ut=!0,(et&&this.Xa(Wt,et)>0||rt&&this.Xa(Wt,rt)<0)&&(tt=!0)):!Ct&&Wt?(o.track({type:0,doc:Wt}),Ut=!0):Ct&&!Wt&&(o.track({type:1,doc:Ct}),Ut=!0,(et||rt)&&(tt=!0)),Ut&&(Wt?(_e=_e.add(Wt),j=qt?j.add(dt):j.delete(dt)):(_e=_e.delete(dt),j=j.delete(dt)))}),this.query.limit!==null)for(;_e.size>this.query.limit;){const dt=this.query.limitType==="F"?_e.last():_e.first();_e=_e.delete(dt.key),j=j.delete(dt.key),o.track({type:1,doc:dt})}return{eu:_e,ru:o,Ds:tt,mutatedKeys:j}}iu(e,i){return e.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(e,i,o,a){const j=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const _e=e.ru.pa();_e.sort((dt,vt)=>function(Wt,Bt){const qt=Ut=>{switch(Ut){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail(20277,{At:Ut})}};return qt(Wt)-qt(Bt)}(dt.type,vt.type)||this.Xa(dt.doc,vt.doc)),this.su(o),a=a!=null&&a;const tt=i&&!a?this.ou():[],et=this.Za.size===0&&this.current&&!a?1:0,rt=et!==this.Ya;return this.Ya=et,_e.length!==0||rt?{snapshot:new ViewSnapshot(this.query,e.eu,j,_e,e.mutatedKeys,et===0,rt,!1,!!o&&o.resumeToken.approximateByteSize()>0),_u:tt}:{_u:tt}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(i=>this.Ha=this.Ha.add(i)),e.modifiedDocuments.forEach(i=>{}),e.removedDocuments.forEach(i=>this.Ha=this.Ha.delete(i)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=__PRIVATE_documentKeySet(),this.eu.forEach(o=>{this.au(o.key)&&(this.Za=this.Za.add(o.key))});const i=[];return e.forEach(o=>{this.Za.has(o)||i.push(new __PRIVATE_RemovedLimboDocument(o))}),this.Za.forEach(o=>{e.has(o)||i.push(new __PRIVATE_AddedLimboDocument(o))}),i}uu(e){this.Ha=e.qs,this.Za=__PRIVATE_documentKeySet();const i=this.nu(e.documents);return this.applyChanges(i,!0)}cu(){return ViewSnapshot.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const nn="SyncEngine";class __PRIVATE_QueryView{constructor(e,i,o){this.query=e,this.targetId=i,this.view=o}}class LimboResolution{constructor(e){this.key=e,this.lu=!1}}class __PRIVATE_SyncEngineImpl{constructor(e,i,o,a,j,_e){this.localStore=e,this.remoteStore=i,this.eventManager=o,this.sharedClientState=a,this.currentUser=j,this.maxConcurrentLimboResolutions=_e,this.hu={},this.Pu=new ObjectMap(tt=>__PRIVATE_canonifyQuery(tt),__PRIVATE_queryEquals),this.Tu=new Map,this.Iu=new Set,this.du=new SortedMap(DocumentKey.comparator),this.Eu=new Map,this.Au=new __PRIVATE_ReferenceSet,this.Ru={},this.Vu=new Map,this.mu=__PRIVATE_TargetIdGenerator.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function __PRIVATE_syncEngineListen(s,e,i=!0){const o=__PRIVATE_ensureWatchCallbacks(s);let a;const j=o.Pu.get(e);return j?(o.sharedClientState.addLocalQueryTarget(j.targetId),a=j.view.cu()):a=await __PRIVATE_allocateTargetAndMaybeListen(o,e,i,!0),a}async function __PRIVATE_triggerRemoteStoreListen(s,e){const i=__PRIVATE_ensureWatchCallbacks(s);await __PRIVATE_allocateTargetAndMaybeListen(i,e,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(s,e,i,o){const a=await __PRIVATE_localStoreAllocateTarget(s.localStore,__PRIVATE_queryToTarget(e)),j=a.targetId,_e=s.sharedClientState.addLocalQueryTarget(j,i);let tt;return o&&(tt=await __PRIVATE_initializeViewAndComputeSnapshot(s,e,j,_e==="current",a.resumeToken)),s.isPrimaryClient&&i&&__PRIVATE_remoteStoreListen(s.remoteStore,a),tt}async function __PRIVATE_initializeViewAndComputeSnapshot(s,e,i,o,a){s.gu=(vt,Ct,Wt)=>async function(qt,Ut,kt,Nt){let un=Ut.view.nu(kt);un.Ds&&(un=await __PRIVATE_localStoreExecuteQuery(qt.localStore,Ut.query,!1).then(({documents:It})=>Ut.view.nu(It,un)));const dn=Nt&&Nt.targetChanges.get(Ut.targetId),hn=Nt&&Nt.targetMismatches.get(Ut.targetId)!=null,gn=Ut.view.applyChanges(un,qt.isPrimaryClient,dn,hn);return __PRIVATE_updateTrackedLimbos(qt,Ut.targetId,gn._u),gn.snapshot}(s,vt,Ct,Wt);const j=await __PRIVATE_localStoreExecuteQuery(s.localStore,e,!0),_e=new __PRIVATE_View(e,j.qs),tt=_e.nu(j.documents),et=TargetChange.createSynthesizedTargetChangeForCurrentChange(i,o&&s.onlineState!=="Offline",a),rt=_e.applyChanges(tt,s.isPrimaryClient,et);__PRIVATE_updateTrackedLimbos(s,i,rt._u);const dt=new __PRIVATE_QueryView(e,i,_e);return s.Pu.set(e,dt),s.Tu.has(i)?s.Tu.get(i).push(e):s.Tu.set(i,[e]),rt.snapshot}async function __PRIVATE_syncEngineUnlisten(s,e,i){const o=__PRIVATE_debugCast(s),a=o.Pu.get(e),j=o.Tu.get(a.targetId);if(j.length>1)return o.Tu.set(a.targetId,j.filter(_e=>!__PRIVATE_queryEquals(_e,e))),void o.Pu.delete(e);o.isPrimaryClient?(o.sharedClientState.removeLocalQueryTarget(a.targetId),o.sharedClientState.isActiveQueryTarget(a.targetId)||await __PRIVATE_localStoreReleaseTarget(o.localStore,a.targetId,!1).then(()=>{o.sharedClientState.clearQueryState(a.targetId),i&&__PRIVATE_remoteStoreUnlisten(o.remoteStore,a.targetId),__PRIVATE_removeAndCleanupTarget(o,a.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(o,a.targetId),await __PRIVATE_localStoreReleaseTarget(o.localStore,a.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(s,e){const i=__PRIVATE_debugCast(s),o=i.Pu.get(e),a=i.Tu.get(o.targetId);i.isPrimaryClient&&a.length===1&&(i.sharedClientState.removeLocalQueryTarget(o.targetId),__PRIVATE_remoteStoreUnlisten(i.remoteStore,o.targetId))}async function __PRIVATE_syncEngineWrite(s,e,i){const o=__PRIVATE_syncEngineEnsureWriteCallbacks(s);try{const a=await function(_e,tt){const et=__PRIVATE_debugCast(_e),rt=Timestamp.now(),dt=tt.reduce((Wt,Bt)=>Wt.add(Bt.key),__PRIVATE_documentKeySet());let vt,Ct;return et.persistence.runTransaction("Locally write mutations","readwrite",Wt=>{let Bt=__PRIVATE_mutableDocumentMap(),qt=__PRIVATE_documentKeySet();return et.Os.getEntries(Wt,dt).next(Ut=>{Bt=Ut,Bt.forEach((kt,Nt)=>{Nt.isValidDocument()||(qt=qt.add(kt))})}).next(()=>et.localDocuments.getOverlayedDocuments(Wt,Bt)).next(Ut=>{vt=Ut;const kt=[];for(const Nt of tt){const un=__PRIVATE_mutationExtractBaseValue(Nt,vt.get(Nt.key).overlayedDocument);un!=null&&kt.push(new __PRIVATE_PatchMutation(Nt.key,un,__PRIVATE_extractFieldMask(un.value.mapValue),Precondition.exists(!0)))}return et.mutationQueue.addMutationBatch(Wt,rt,kt,tt)}).next(Ut=>{Ct=Ut;const kt=Ut.applyToLocalDocumentSet(vt,qt);return et.documentOverlayCache.saveOverlays(Wt,Ut.batchId,kt)})}).then(()=>({batchId:Ct.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(vt)}))}(o.localStore,e);o.sharedClientState.addPendingMutation(a.batchId),function(_e,tt,et){let rt=_e.Ru[_e.currentUser.toKey()];rt||(rt=new SortedMap(__PRIVATE_primitiveComparator)),rt=rt.insert(tt,et),_e.Ru[_e.currentUser.toKey()]=rt}(o,a.batchId,i),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(o,a.changes),await __PRIVATE_fillWritePipeline(o.remoteStore)}catch(a){const j=__PRIVATE_wrapInUserErrorIfRecoverable(a,"Failed to persist write");i.reject(j)}}async function __PRIVATE_syncEngineApplyRemoteEvent(s,e){const i=__PRIVATE_debugCast(s);try{const o=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(i.localStore,e);e.targetChanges.forEach((a,j)=>{const _e=i.Eu.get(j);_e&&(__PRIVATE_hardAssert(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?_e.lu=!0:a.modifiedDocuments.size>0?__PRIVATE_hardAssert(_e.lu,14607):a.removedDocuments.size>0&&(__PRIVATE_hardAssert(_e.lu,42227),_e.lu=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(i,o,e)}catch(o){await __PRIVATE_ignoreIfPrimaryLeaseLoss(o)}}function __PRIVATE_syncEngineApplyOnlineStateChange(s,e,i){const o=__PRIVATE_debugCast(s);if(o.isPrimaryClient&&i===0||!o.isPrimaryClient&&i===1){const a=[];o.Pu.forEach((j,_e)=>{const tt=_e.view.va(e);tt.snapshot&&a.push(tt.snapshot)}),function(_e,tt){const et=__PRIVATE_debugCast(_e);et.onlineState=tt;let rt=!1;et.queries.forEach((dt,vt)=>{for(const Ct of vt.wa)Ct.va(tt)&&(rt=!0)}),rt&&__PRIVATE_raiseSnapshotsInSyncEvent(et)}(o.eventManager,e),a.length&&o.hu.J_(a),o.onlineState=e,o.isPrimaryClient&&o.sharedClientState.setOnlineState(e)}}async function __PRIVATE_syncEngineRejectListen(s,e,i){const o=__PRIVATE_debugCast(s);o.sharedClientState.updateQueryState(e,"rejected",i);const a=o.Eu.get(e),j=a&&a.key;if(j){let _e=new SortedMap(DocumentKey.comparator);_e=_e.insert(j,MutableDocument.newNoDocument(j,SnapshotVersion.min()));const tt=__PRIVATE_documentKeySet().add(j),et=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),_e,tt);await __PRIVATE_syncEngineApplyRemoteEvent(o,et),o.du=o.du.remove(j),o.Eu.delete(e),__PRIVATE_pumpEnqueuedLimboResolutions(o)}else await __PRIVATE_localStoreReleaseTarget(o.localStore,e,!1).then(()=>__PRIVATE_removeAndCleanupTarget(o,e,i)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(s,e){const i=__PRIVATE_debugCast(s),o=e.batch.batchId;try{const a=await __PRIVATE_localStoreAcknowledgeBatch(i.localStore,e);__PRIVATE_processUserCallback(i,o,null),__PRIVATE_triggerPendingWritesCallbacks(i,o),i.sharedClientState.updateMutationState(o,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(i,a)}catch(a){await __PRIVATE_ignoreIfPrimaryLeaseLoss(a)}}async function __PRIVATE_syncEngineRejectFailedWrite(s,e,i){const o=__PRIVATE_debugCast(s);try{const a=await function(_e,tt){const et=__PRIVATE_debugCast(_e);return et.persistence.runTransaction("Reject batch","readwrite-primary",rt=>{let dt;return et.mutationQueue.lookupMutationBatch(rt,tt).next(vt=>(__PRIVATE_hardAssert(vt!==null,37113),dt=vt.keys(),et.mutationQueue.removeMutationBatch(rt,vt))).next(()=>et.mutationQueue.performConsistencyCheck(rt)).next(()=>et.documentOverlayCache.removeOverlaysForBatchId(rt,dt,tt)).next(()=>et.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(rt,dt)).next(()=>et.localDocuments.getDocuments(rt,dt))})}(o.localStore,e);__PRIVATE_processUserCallback(o,e,i),__PRIVATE_triggerPendingWritesCallbacks(o,e),o.sharedClientState.updateMutationState(e,"rejected",i),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(o,a)}catch(a){await __PRIVATE_ignoreIfPrimaryLeaseLoss(a)}}function __PRIVATE_triggerPendingWritesCallbacks(s,e){(s.Vu.get(e)||[]).forEach(i=>{i.resolve()}),s.Vu.delete(e)}function __PRIVATE_processUserCallback(s,e,i){const o=__PRIVATE_debugCast(s);let a=o.Ru[o.currentUser.toKey()];if(a){const j=a.get(e);j&&(i?j.reject(i):j.resolve(),a=a.remove(e)),o.Ru[o.currentUser.toKey()]=a}}function __PRIVATE_removeAndCleanupTarget(s,e,i=null){s.sharedClientState.removeLocalQueryTarget(e);for(const o of s.Tu.get(e))s.Pu.delete(o),i&&s.hu.pu(o,i);s.Tu.delete(e),s.isPrimaryClient&&s.Au.zr(e).forEach(o=>{s.Au.containsKey(o)||__PRIVATE_removeLimboTarget(s,o)})}function __PRIVATE_removeLimboTarget(s,e){s.Iu.delete(e.path.canonicalString());const i=s.du.get(e);i!==null&&(__PRIVATE_remoteStoreUnlisten(s.remoteStore,i),s.du=s.du.remove(e),s.Eu.delete(i),__PRIVATE_pumpEnqueuedLimboResolutions(s))}function __PRIVATE_updateTrackedLimbos(s,e,i){for(const o of i)o instanceof __PRIVATE_AddedLimboDocument?(s.Au.addReference(o.key,e),__PRIVATE_trackLimboChange(s,o)):o instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug(nn,"Document no longer in limbo: "+o.key),s.Au.removeReference(o.key,e),s.Au.containsKey(o.key)||__PRIVATE_removeLimboTarget(s,o.key)):fail(19791,{yu:o})}function __PRIVATE_trackLimboChange(s,e){const i=e.key,o=i.path.canonicalString();s.du.get(i)||s.Iu.has(o)||(__PRIVATE_logDebug(nn,"New document in limbo: "+i),s.Iu.add(o),__PRIVATE_pumpEnqueuedLimboResolutions(s))}function __PRIVATE_pumpEnqueuedLimboResolutions(s){for(;s.Iu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Iu.values().next().value;s.Iu.delete(e);const i=new DocumentKey(ResourcePath.fromString(e)),o=s.mu.next();s.Eu.set(o,new LimboResolution(i)),s.du=s.du.insert(i,o),__PRIVATE_remoteStoreListen(s.remoteStore,new TargetData(__PRIVATE_queryToTarget(__PRIVATE_newQueryForPath(i.path)),o,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.ue))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(s,e,i){const o=__PRIVATE_debugCast(s),a=[],j=[],_e=[];o.Pu.isEmpty()||(o.Pu.forEach((tt,et)=>{_e.push(o.gu(et,e,i).then(rt=>{var dt;if((rt||i)&&o.isPrimaryClient){const vt=rt?!rt.fromCache:(dt=i==null?void 0:i.targetChanges.get(et.targetId))===null||dt===void 0?void 0:dt.current;o.sharedClientState.updateQueryState(et.targetId,vt?"current":"not-current")}if(rt){a.push(rt);const vt=__PRIVATE_LocalViewChanges.Es(et.targetId,rt);j.push(vt)}}))}),await Promise.all(_e),o.hu.J_(a),await async function(et,rt){const dt=__PRIVATE_debugCast(et);try{await dt.persistence.runTransaction("notifyLocalViewChanges","readwrite",vt=>PersistencePromise.forEach(rt,Ct=>PersistencePromise.forEach(Ct.Is,Wt=>dt.persistence.referenceDelegate.addReference(vt,Ct.targetId,Wt)).next(()=>PersistencePromise.forEach(Ct.ds,Wt=>dt.persistence.referenceDelegate.removeReference(vt,Ct.targetId,Wt)))))}catch(vt){if(!__PRIVATE_isIndexedDbTransactionError(vt))throw vt;__PRIVATE_logDebug(Qt,"Failed to update sequence numbers: "+vt)}for(const vt of rt){const Ct=vt.targetId;if(!vt.fromCache){const Wt=dt.Fs.get(Ct),Bt=Wt.snapshotVersion,qt=Wt.withLastLimboFreeSnapshotVersion(Bt);dt.Fs=dt.Fs.insert(Ct,qt)}}}(o.localStore,j))}async function __PRIVATE_syncEngineHandleCredentialChange(s,e){const i=__PRIVATE_debugCast(s);if(!i.currentUser.isEqual(e)){__PRIVATE_logDebug(nn,"User change. New user:",e.toKey());const o=await __PRIVATE_localStoreHandleUserChange(i.localStore,e);i.currentUser=e,function(j,_e){j.Vu.forEach(tt=>{tt.forEach(et=>{et.reject(new FirestoreError(N.CANCELLED,_e))})}),j.Vu.clear()}(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(e,o.removedBatchIds,o.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(i,o.Bs)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(s,e){const i=__PRIVATE_debugCast(s),o=i.Eu.get(e);if(o&&o.lu)return __PRIVATE_documentKeySet().add(o.key);{let a=__PRIVATE_documentKeySet();const j=i.Tu.get(e);if(!j)return a;for(const _e of j){const tt=i.Pu.get(_e);a=a.unionWith(tt.view.tu)}return a}}function __PRIVATE_ensureWatchCallbacks(s){const e=__PRIVATE_debugCast(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.hu.J_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.hu.pu=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}function __PRIVATE_syncEngineEnsureWriteCallbacks(s){const e=__PRIVATE_debugCast(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e}class __PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=__PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,i){return null}Fu(e,i){return null}vu(e){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,e.initialUser,this.serializer)}Du(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.Vi,this.serializer)}bu(e){return new __PRIVATE_MemorySharedClientState}async terminate(){var e,i;(e=this.gcScheduler)===null||e===void 0||e.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}__PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new __PRIVATE_MemoryOfflineComponentProvider};class __PRIVATE_LruGcMemoryOfflineComponentProvider extends __PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,i){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate,46915);const o=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(o,e.asyncQueue,i)}Du(e){const i=this.cacheSizeBytes!==void 0?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(o=>__PRIVATE_MemoryLruDelegate.Vi(o,i),this.serializer)}}class OnlineComponentProvider{async initialize(e,i){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new __PRIVATE_EventManagerImpl}()}createDatastore(e){const i=__PRIVATE_newSerializer(e.databaseInfo.databaseId),o=function(j){return new __PRIVATE_WebChannelConnection(j)}(e.databaseInfo);return function(j,_e,tt,et){return new __PRIVATE_DatastoreImpl(j,_e,tt,et)}(e.authCredentials,e.appCheckCredentials,o,i)}createRemoteStore(e){return function(o,a,j,_e,tt){return new __PRIVATE_RemoteStoreImpl(o,a,j,_e,tt)}(this.localStore,this.datastore,e.asyncQueue,i=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,i,0),function(){return __PRIVATE_BrowserConnectivityMonitor.C()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor}())}createSyncEngine(e,i){return function(a,j,_e,tt,et,rt,dt){const vt=new __PRIVATE_SyncEngineImpl(a,j,_e,tt,et,rt);return dt&&(vt.fu=!0),vt}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,i)}async terminate(){var e,i;await async function(a){const j=__PRIVATE_debugCast(a);__PRIVATE_logDebug(Xt,"RemoteStore shutting down."),j.Ia.add(5),await __PRIVATE_disableNetworkInternal(j),j.Ea.shutdown(),j.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()}}OnlineComponentProvider.provider={build:()=>new OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,i){setTimeout(()=>{this.muted||e(i)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="FirestoreClient";class FirestoreClient{constructor(e,i,o,a,j){this.authCredentials=e,this.appCheckCredentials=i,this.asyncQueue=o,this.databaseInfo=a,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=j,this.authCredentials.start(o,async _e=>{__PRIVATE_logDebug(rn,"Received user=",_e.uid),await this.authCredentialListener(_e),this.user=_e}),this.appCheckCredentials.start(o,_e=>(__PRIVATE_logDebug(rn,"Received new app check token=",_e),this.appCheckCredentialListener(_e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(i){const o=__PRIVATE_wrapInUserErrorIfRecoverable(i,"Failed to shutdown persistence");e.reject(o)}}),e.promise}}async function __PRIVATE_setOfflineComponentProvider(s,e){s.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(rn,"Initializing OfflineComponentProvider");const i=s.configuration;await e.initialize(i);let o=i.initialUser;s.setCredentialChangeListener(async a=>{o.isEqual(a)||(await __PRIVATE_localStoreHandleUserChange(e.localStore,a),o=a)}),e.persistence.setDatabaseDeletedListener(()=>{__PRIVATE_logWarn("Terminating Firestore due to IndexedDb database deletion"),s.terminate().then(()=>{__PRIVATE_logDebug("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{__PRIVATE_logWarn("Terminating Firestore due to IndexedDb database deletion failed",a)})}),s._offlineComponents=e}async function __PRIVATE_setOnlineComponentProvider(s,e){s.asyncQueue.verifyOperationInProgress();const i=await __PRIVATE_ensureOfflineComponents(s);__PRIVATE_logDebug(rn,"Initializing OnlineComponentProvider"),await e.initialize(i,s.configuration),s.setCredentialChangeListener(o=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,o)),s.setAppCheckTokenChangeListener((o,a)=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,a)),s._onlineComponents=e}async function __PRIVATE_ensureOfflineComponents(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){__PRIVATE_logDebug(rn,"Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(s,s._uninitializedComponentsProvider._offline)}catch(e){const i=e;if(!function(a){return a.name==="FirebaseError"?a.code===N.FAILED_PRECONDITION||a.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(i))throw i;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+i),await __PRIVATE_setOfflineComponentProvider(s,new __PRIVATE_MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug(rn,"Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(s,new __PRIVATE_LruGcMemoryOfflineComponentProvider(void 0));return s._offlineComponents}async function __PRIVATE_ensureOnlineComponents(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(__PRIVATE_logDebug(rn,"Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(s,s._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug(rn,"Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(s,new OnlineComponentProvider))),s._onlineComponents}function __PRIVATE_getSyncEngine(s){return __PRIVATE_ensureOnlineComponents(s).then(e=>e.syncEngine)}async function __PRIVATE_getEventManager(s){const e=await __PRIVATE_ensureOnlineComponents(s),i=e.eventManager;return i.onListen=__PRIVATE_syncEngineListen.bind(null,e.syncEngine),i.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,e.syncEngine),i.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,e.syncEngine),i.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,e.syncEngine),i}function __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(s,e,i={}){const o=new __PRIVATE_Deferred;return s.asyncQueue.enqueueAndForget(async()=>function(j,_e,tt,et,rt){const dt=new __PRIVATE_AsyncObserver({next:Ct=>{dt.Ou(),_e.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(j,vt));const Wt=Ct.docs.has(tt);!Wt&&Ct.fromCache?rt.reject(new FirestoreError(N.UNAVAILABLE,"Failed to get document because the client is offline.")):Wt&&Ct.fromCache&&et&&et.source==="server"?rt.reject(new FirestoreError(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):rt.resolve(Ct)},error:Ct=>rt.reject(Ct)}),vt=new __PRIVATE_QueryListener(__PRIVATE_newQueryForPath(tt.path),dt,{includeMetadataChanges:!0,ka:!0});return __PRIVATE_eventManagerListen(j,vt)}(await __PRIVATE_getEventManager(s),s.asyncQueue,e,i,o)),o.promise}function __PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(s,e,i={}){const o=new __PRIVATE_Deferred;return s.asyncQueue.enqueueAndForget(async()=>function(j,_e,tt,et,rt){const dt=new __PRIVATE_AsyncObserver({next:Ct=>{dt.Ou(),_e.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(j,vt)),Ct.fromCache&&et.source==="server"?rt.reject(new FirestoreError(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):rt.resolve(Ct)},error:Ct=>rt.reject(Ct)}),vt=new __PRIVATE_QueryListener(tt,dt,{includeMetadataChanges:!0,ka:!0});return __PRIVATE_eventManagerListen(j,vt)}(await __PRIVATE_getEventManager(s),s.asyncQueue,e,i,o)),o.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="firestore.googleapis.com",_n=!0;class FirestoreSettingsImpl{constructor(e){var i,o;if(e.host===void 0){if(e.ssl!==void 0)throw new FirestoreError(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=on,this.ssl=_n}else this.host=e.host,this.ssl=(i=e.ssl)!==null&&i!==void 0?i:_n;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mt;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ot)throw new FirestoreError(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((o=e.experimentalLongPollingOptions)!==null&&o!==void 0?o:{}),function(j){if(j.timeoutSeconds!==void 0){if(isNaN(j.timeoutSeconds))throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${j.timeoutSeconds} (must not be NaN)`);if(j.timeoutSeconds<5)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${j.timeoutSeconds} (minimum allowed value is 5)`);if(j.timeoutSeconds>30)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${j.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(o,a){return o.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Firestore$1{constructor(e,i,o,a){this._authCredentials=e,this._appCheckCredentials=i,this._databaseId=o,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(o){if(!o)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(o.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new FirestoreError(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(i){const o=sn.get(i);o&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),sn.delete(i),o.terminate())}(this),Promise.resolve()}}function connectFirestoreEmulator(s,e,i,o={}){var a;s=__PRIVATE_cast(s,Firestore$1);const j=isCloudWorkstation(e),_e=s._getSettings(),tt=Object.assign(Object.assign({},_e),{emulatorOptions:s._getEmulatorOptions()}),et=`${e}:${i}`;j&&(pingServer(`https://${et}`),updateEmulatorBanner("Firestore",!0)),_e.host!==on&&_e.host!==et&&__PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const rt=Object.assign(Object.assign({},_e),{host:et,ssl:j,emulatorOptions:o});if(!deepEqual(rt,tt)&&(s._setSettings(rt),o.mockUserToken)){let dt,vt;if(typeof o.mockUserToken=="string")dt=o.mockUserToken,vt=User.MOCK_USER;else{dt=createMockUserToken(o.mockUserToken,(a=s._app)===null||a===void 0?void 0:a.options.projectId);const Ct=o.mockUserToken.sub||o.mockUserToken.user_id;if(!Ct)throw new FirestoreError(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");vt=new User(Ct)}s._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken(dt,vt))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Query{constructor(e,i,o){this.converter=i,this._query=o,this.type="query",this.firestore=e}withConverter(e){return new Query(this.firestore,e,this._query)}}class DocumentReference{constructor(e,i,o){this.converter=i,this._key=o,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new DocumentReference(this.firestore,e,this._key)}toJSON(){return{type:DocumentReference._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,i,o){if(__PRIVATE_validateJSON(i,DocumentReference._jsonSchema))return new DocumentReference(e,o||null,new DocumentKey(ResourcePath.fromString(i.referencePath)))}}DocumentReference._jsonSchemaVersion="firestore/documentReference/1.0",DocumentReference._jsonSchema={type:property("string",DocumentReference._jsonSchemaVersion),referencePath:property("string")};class CollectionReference extends Query{constructor(e,i,o){super(e,i,__PRIVATE_newQueryForPath(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}}function collection(s,e,...i){if(s=getModularInstance(s),__PRIVATE_validateNonEmptyArgument("collection","path",e),s instanceof Firestore$1){const o=ResourcePath.fromString(e,...i);return __PRIVATE_validateCollectionPath(o),new CollectionReference(s,null,o)}{if(!(s instanceof DocumentReference||s instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(ResourcePath.fromString(e,...i));return __PRIVATE_validateCollectionPath(o),new CollectionReference(s.firestore,null,o)}}function doc(s,e,...i){if(s=getModularInstance(s),arguments.length===1&&(e=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",e),s instanceof Firestore$1){const o=ResourcePath.fromString(e,...i);return __PRIVATE_validateDocumentPath(o),new DocumentReference(s,null,new DocumentKey(o))}{if(!(s instanceof DocumentReference||s instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(ResourcePath.fromString(e,...i));return __PRIVATE_validateDocumentPath(o),new DocumentReference(s.firestore,s instanceof CollectionReference?s.converter:null,new DocumentKey(o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="AsyncQueue";class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.oc=()=>{const o=getDocument();o&&__PRIVATE_logDebug(an,"Visibility state changed to "+o.visibilityState),this.F_.y_()},this._c=e;const i=getDocument();i&&typeof i.addEventListener=="function"&&i.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const i=getDocument();i&&typeof i.removeEventListener=="function"&&i.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const i=new __PRIVATE_Deferred;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(i.resolve,i.reject),i.promise)).then(()=>i.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(an,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const i=this._c.then(()=>(this.nc=!0,e().catch(o=>{throw this.tc=o,this.nc=!1,__PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",__PRIVATE_getMessageOrStack(o)),o}).then(o=>(this.nc=!1,o))));return this._c=i,i}enqueueAfterDelay(e,i,o){this.ac(),this.sc.indexOf(e)>-1&&(i=0);const a=DelayedOperation.createAndSchedule(this,e,i,o,j=>this.lc(j));return this.ec.push(a),a}ac(){this.tc&&fail(47125,{hc:__PRIVATE_getMessageOrStack(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const i of this.ec)if(i.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((i,o)=>i.targetTimeMs-o.targetTimeMs);for(const i of this.ec)if(i.skipDelay(),e!=="all"&&i.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const i=this.ec.indexOf(e);this.ec.splice(i,1)}}function __PRIVATE_getMessageOrStack(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Firestore extends Firestore$1{constructor(e,i,o,a){super(e,i,o,a),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}}function getFirestore(s,e){const i=typeof s=="object"?s:getApp(),o=typeof s=="string"?s:ut,a=_getProvider(i,"firestore").getImmediate({identifier:o});if(!a._initialized){const j=getDefaultEmulatorHostnameAndPort("firestore");j&&connectFirestoreEmulator(a,...j)}return a}function ensureFirestoreConfigured(s){if(s._terminated)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||__PRIVATE_configureFirestore(s),s._firestoreClient}function __PRIVATE_configureFirestore(s){var e,i,o;const a=s._freezeSettings(),j=function(tt,et,rt,dt){return new DatabaseInfo(tt,et,rt,dt.host,dt.ssl,dt.experimentalForceLongPolling,dt.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(dt.experimentalLongPollingOptions),dt.useFetchStreams,dt.isUsingEmulator)}(s._databaseId,((e=s._app)===null||e===void 0?void 0:e.options.appId)||"",s._persistenceKey,a);s._componentsProvider||!((i=a.localCache)===null||i===void 0)&&i._offlineComponentProvider&&(!((o=a.localCache)===null||o===void 0)&&o._onlineComponentProvider)&&(s._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),s._firestoreClient=new FirestoreClient(s._authCredentials,s._appCheckCredentials,s._queue,j,s._componentsProvider&&function(tt){const et=tt==null?void 0:tt._online.build();return{_offline:tt==null?void 0:tt._offline.build(et),_online:et}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bytes(ByteString.fromBase64String(e))}catch(i){throw new FirestoreError(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(e){return new Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bytes._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(__PRIVATE_validateJSON(e,Bytes._jsonSchema))return Bytes.fromBase64String(e.bytes)}}Bytes._jsonSchemaVersion="firestore/bytes/1.0",Bytes._jsonSchema={type:property("string",Bytes._jsonSchemaVersion),bytes:property("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...e){for(let i=0;i<e.length;++i)if(e[i].length===0)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GeoPoint{constructor(e,i){if(!isFinite(e)||e<-90||e>90)throw new FirestoreError(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(i)||i<-180||i>180)throw new FirestoreError(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=e,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:GeoPoint._jsonSchemaVersion}}static fromJSON(e){if(__PRIVATE_validateJSON(e,GeoPoint._jsonSchema))return new GeoPoint(e.latitude,e.longitude)}}GeoPoint._jsonSchemaVersion="firestore/geoPoint/1.0",GeoPoint._jsonSchema={type:property("string",GeoPoint._jsonSchemaVersion),latitude:property("number"),longitude:property("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VectorValue{constructor(e){this._values=(e||[]).map(i=>i)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(o,a){if(o.length!==a.length)return!1;for(let j=0;j<o.length;++j)if(o[j]!==a[j])return!1;return!0}(this._values,e._values)}toJSON(){return{type:VectorValue._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(__PRIVATE_validateJSON(e,VectorValue._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(i=>typeof i=="number"))return new VectorValue(e.vectorValues);throw new FirestoreError(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}VectorValue._jsonSchemaVersion="firestore/vectorValue/1.0",VectorValue._jsonSchema={type:property("string",VectorValue._jsonSchemaVersion),vectorValues:property("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=/^__.*__$/;class ParsedSetData{constructor(e,i,o){this.data=e,this.fieldMask=i,this.fieldTransforms=o}toMutation(e,i){return this.fieldMask!==null?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,i,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,i,this.fieldTransforms)}}class ParsedUpdateData{constructor(e,i,o){this.data=e,this.fieldMask=i,this.fieldTransforms=o}toMutation(e,i){return new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,i,this.fieldTransforms)}}function __PRIVATE_isWrite(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail(40011,{Ec:s})}}class __PRIVATE_ParseContextImpl{constructor(e,i,o,a,j,_e){this.settings=e,this.databaseId=i,this.serializer=o,this.ignoreUndefinedProperties=a,j===void 0&&this.Ac(),this.fieldTransforms=j||[],this.fieldMask=_e||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new __PRIVATE_ParseContextImpl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var i;const o=(i=this.path)===null||i===void 0?void 0:i.child(e),a=this.Rc({path:o,mc:!1});return a.fc(e),a}gc(e){var i;const o=(i=this.path)===null||i===void 0?void 0:i.child(e),a=this.Rc({path:o,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return __PRIVATE_createError(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(i=>e.isPrefixOf(i))!==void 0||this.fieldTransforms.find(i=>e.isPrefixOf(i.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(__PRIVATE_isWrite(this.Ec)&&cn.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class __PRIVATE_UserDataReader{constructor(e,i,o){this.databaseId=e,this.ignoreUndefinedProperties=i,this.serializer=o||__PRIVATE_newSerializer(e)}Dc(e,i,o,a=!1){return new __PRIVATE_ParseContextImpl({Ec:e,methodName:i,bc:o,path:FieldPath$1.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function __PRIVATE_newUserDataReader(s){const e=s._freezeSettings(),i=__PRIVATE_newSerializer(s._databaseId);return new __PRIVATE_UserDataReader(s._databaseId,!!e.ignoreUndefinedProperties,i)}function __PRIVATE_parseSetData(s,e,i,o,a,j={}){const _e=s.Dc(j.merge||j.mergeFields?2:0,e,i,a);__PRIVATE_validatePlainObject("Data must be an object, but it was:",_e,o);const tt=__PRIVATE_parseObject(o,_e);let et,rt;if(j.merge)et=new FieldMask(_e.fieldMask),rt=_e.fieldTransforms;else if(j.mergeFields){const dt=[];for(const vt of j.mergeFields){const Ct=__PRIVATE_fieldPathFromArgument$1(e,vt,i);if(!_e.contains(Ct))throw new FirestoreError(N.INVALID_ARGUMENT,`Field '${Ct}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(dt,Ct)||dt.push(Ct)}et=new FieldMask(dt),rt=_e.fieldTransforms.filter(vt=>et.covers(vt.field))}else et=null,rt=_e.fieldTransforms;return new ParsedSetData(new ObjectValue(tt),et,rt)}class __PRIVATE_DeleteFieldValueImpl extends FieldValue{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof __PRIVATE_DeleteFieldValueImpl}}class __PRIVATE_ServerTimestampFieldValueImpl extends FieldValue{_toFieldTransform(e){return new FieldTransform(e.path,new __PRIVATE_ServerTimestampTransform)}isEqual(e){return e instanceof __PRIVATE_ServerTimestampFieldValueImpl}}function __PRIVATE_parseUpdateData(s,e,i,o){const a=s.Dc(1,e,i);__PRIVATE_validatePlainObject("Data must be an object, but it was:",a,o);const j=[],_e=ObjectValue.empty();forEach(o,(et,rt)=>{const dt=__PRIVATE_fieldPathFromDotSeparatedString(e,et,i);rt=getModularInstance(rt);const vt=a.gc(dt);if(rt instanceof __PRIVATE_DeleteFieldValueImpl)j.push(dt);else{const Ct=__PRIVATE_parseData(rt,vt);Ct!=null&&(j.push(dt),_e.set(dt,Ct))}});const tt=new FieldMask(j);return new ParsedUpdateData(_e,tt,a.fieldTransforms)}function __PRIVATE_parseUpdateVarargs(s,e,i,o,a,j){const _e=s.Dc(1,e,i),tt=[__PRIVATE_fieldPathFromArgument$1(e,o,i)],et=[a];if(j.length%2!=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let Ct=0;Ct<j.length;Ct+=2)tt.push(__PRIVATE_fieldPathFromArgument$1(e,j[Ct])),et.push(j[Ct+1]);const rt=[],dt=ObjectValue.empty();for(let Ct=tt.length-1;Ct>=0;--Ct)if(!__PRIVATE_fieldMaskContains(rt,tt[Ct])){const Wt=tt[Ct];let Bt=et[Ct];Bt=getModularInstance(Bt);const qt=_e.gc(Wt);if(Bt instanceof __PRIVATE_DeleteFieldValueImpl)rt.push(Wt);else{const Ut=__PRIVATE_parseData(Bt,qt);Ut!=null&&(rt.push(Wt),dt.set(Wt,Ut))}}const vt=new FieldMask(rt);return new ParsedUpdateData(dt,vt,_e.fieldTransforms)}function __PRIVATE_parseQueryValue(s,e,i,o=!1){return __PRIVATE_parseData(i,s.Dc(o?4:3,e))}function __PRIVATE_parseData(s,e){if(__PRIVATE_looksLikeJsonObject(s=getModularInstance(s)))return __PRIVATE_validatePlainObject("Unsupported field value:",e,s),__PRIVATE_parseObject(s,e);if(s instanceof FieldValue)return function(o,a){if(!__PRIVATE_isWrite(a.Ec))throw a.wc(`${o._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${o._methodName}() is not currently supported inside arrays`);const j=o._toFieldTransform(a);j&&a.fieldTransforms.push(j)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(o,a){const j=[];let _e=0;for(const tt of o){let et=__PRIVATE_parseData(tt,a.yc(_e));et==null&&(et={nullValue:"NULL_VALUE"}),j.push(et),_e++}return{arrayValue:{values:j}}}(s,e)}return function(o,a){if((o=getModularInstance(o))===null)return{nullValue:"NULL_VALUE"};if(typeof o=="number")return toNumber(a.serializer,o);if(typeof o=="boolean")return{booleanValue:o};if(typeof o=="string")return{stringValue:o};if(o instanceof Date){const j=Timestamp.fromDate(o);return{timestampValue:toTimestamp(a.serializer,j)}}if(o instanceof Timestamp){const j=new Timestamp(o.seconds,1e3*Math.floor(o.nanoseconds/1e3));return{timestampValue:toTimestamp(a.serializer,j)}}if(o instanceof GeoPoint)return{geoPointValue:{latitude:o.latitude,longitude:o.longitude}};if(o instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(a.serializer,o._byteString)};if(o instanceof DocumentReference){const j=a.databaseId,_e=o.firestore._databaseId;if(!_e.isEqual(j))throw a.wc(`Document reference is for database ${_e.projectId}/${_e.database} but should be for database ${j.projectId}/${j.database}`);return{referenceValue:__PRIVATE_toResourceName(o.firestore._databaseId||a.databaseId,o._key.path)}}if(o instanceof VectorValue)return function(_e,tt){return{mapValue:{fields:{[ct]:{stringValue:Pt},[Tt]:{arrayValue:{values:_e.toArray().map(rt=>{if(typeof rt!="number")throw tt.wc("VectorValues must only contain numeric values.");return __PRIVATE_toDouble(tt.serializer,rt)})}}}}}}(o,a);throw a.wc(`Unsupported field value: ${__PRIVATE_valueDescription(o)}`)}(s,e)}function __PRIVATE_parseObject(s,e){const i={};return isEmpty(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):forEach(s,(o,a)=>{const j=__PRIVATE_parseData(a,e.Vc(o));j!=null&&(i[o]=j)}),{mapValue:{fields:i}}}function __PRIVATE_looksLikeJsonObject(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Timestamp||s instanceof GeoPoint||s instanceof Bytes||s instanceof DocumentReference||s instanceof FieldValue||s instanceof VectorValue)}function __PRIVATE_validatePlainObject(s,e,i){if(!__PRIVATE_looksLikeJsonObject(i)||!__PRIVATE_isPlainObject(i)){const o=__PRIVATE_valueDescription(i);throw o==="an object"?e.wc(s+" a custom object"):e.wc(s+" "+o)}}function __PRIVATE_fieldPathFromArgument$1(s,e,i){if((e=getModularInstance(e))instanceof FieldPath)return e._internalPath;if(typeof e=="string")return __PRIVATE_fieldPathFromDotSeparatedString(s,e);throw __PRIVATE_createError("Field path arguments must be of type string or ",s,!1,void 0,i)}const ln=new RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(s,e,i){if(e.search(ln)>=0)throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,i);try{return new FieldPath(...e.split("."))._internalPath}catch{throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,i)}}function __PRIVATE_createError(s,e,i,o,a){const j=o&&!o.isEmpty(),_e=a!==void 0;let tt=`Function ${e}() called with invalid data`;i&&(tt+=" (via `toFirestore()`)"),tt+=". ";let et="";return(j||_e)&&(et+=" (found",j&&(et+=` in field ${o}`),_e&&(et+=` in document ${a}`),et+=")"),new FirestoreError(N.INVALID_ARGUMENT,tt+s+et)}function __PRIVATE_fieldMaskContains(s,e){return s.some(i=>i.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSnapshot$1{constructor(e,i,o,a,j){this._firestore=e,this._userDataWriter=i,this._key=o,this._document=a,this._converter=j}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const i=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i)}}}class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}}function __PRIVATE_fieldPathFromArgument(s,e){return typeof e=="string"?__PRIVATE_fieldPathFromDotSeparatedString(s,e):e instanceof FieldPath?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateHasExplicitOrderByForLimitToLast(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new FirestoreError(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AppliableConstraint{}class QueryConstraint extends AppliableConstraint{}function query(s,e,...i){let o=[];e instanceof AppliableConstraint&&o.push(e),o=o.concat(i),function(j){const _e=j.filter(et=>et instanceof QueryCompositeFilterConstraint).length,tt=j.filter(et=>et instanceof QueryFieldFilterConstraint).length;if(_e>1||_e>0&&tt>0)throw new FirestoreError(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(o);for(const a of o)s=a._apply(s);return s}class QueryFieldFilterConstraint extends QueryConstraint{constructor(e,i,o){super(),this._field=e,this._op=i,this._value=o,this.type="where"}static _create(e,i,o){return new QueryFieldFilterConstraint(e,i,o)}_apply(e){const i=this._parse(e);return __PRIVATE_validateNewFieldFilter(e._query,i),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,i))}_parse(e){const i=__PRIVATE_newUserDataReader(e.firestore);return function(j,_e,tt,et,rt,dt,vt){let Ct;if(rt.isKeyField()){if(dt==="array-contains"||dt==="array-contains-any")throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${dt}' queries on documentId().`);if(dt==="in"||dt==="not-in"){__PRIVATE_validateDisjunctiveFilterElements(vt,dt);const Bt=[];for(const qt of vt)Bt.push(__PRIVATE_parseDocumentIdValue(et,j,qt));Ct={arrayValue:{values:Bt}}}else Ct=__PRIVATE_parseDocumentIdValue(et,j,vt)}else dt!=="in"&&dt!=="not-in"&&dt!=="array-contains-any"||__PRIVATE_validateDisjunctiveFilterElements(vt,dt),Ct=__PRIVATE_parseQueryValue(tt,_e,vt,dt==="in"||dt==="not-in");return FieldFilter.create(rt,dt,Ct)}(e._query,"where",i,e.firestore._databaseId,this._field,this._op,this._value)}}function where(s,e,i){const o=e,a=__PRIVATE_fieldPathFromArgument("where",s);return QueryFieldFilterConstraint._create(a,o,i)}class QueryCompositeFilterConstraint extends AppliableConstraint{constructor(e,i){super(),this.type=e,this._queryConstraints=i}static _create(e,i){return new QueryCompositeFilterConstraint(e,i)}_parse(e){const i=this._queryConstraints.map(o=>o._parse(e)).filter(o=>o.getFilters().length>0);return i.length===1?i[0]:CompositeFilter.create(i,this._getOperator())}_apply(e){const i=this._parse(e);return i.getFilters().length===0?e:(function(a,j){let _e=a;const tt=j.getFlattenedFilters();for(const et of tt)__PRIVATE_validateNewFieldFilter(_e,et),_e=__PRIVATE_queryWithAddedFilter(_e,et)}(e._query,i),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,i)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class QueryLimitConstraint extends QueryConstraint{constructor(e,i,o){super(),this.type=e,this._limit=i,this._limitType=o}static _create(e,i,o){return new QueryLimitConstraint(e,i,o)}_apply(e){return new Query(e.firestore,e.converter,__PRIVATE_queryWithLimit(e._query,this._limit,this._limitType))}}function limit(s){return QueryLimitConstraint._create("limit",s,"F")}function __PRIVATE_parseDocumentIdValue(s,e,i){if(typeof(i=getModularInstance(i))=="string"){if(i==="")throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!__PRIVATE_isCollectionGroupQuery(e)&&i.indexOf("/")!==-1)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${i}' contains a '/' character.`);const o=e.path.child(ResourcePath.fromString(i));if(!DocumentKey.isDocumentKey(o))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${o}' is not because it has an odd number of segments (${o.length}).`);return __PRIVATE_refValue(s,new DocumentKey(o))}if(i instanceof DocumentReference)return __PRIVATE_refValue(s,i._key);throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__PRIVATE_valueDescription(i)}.`)}function __PRIVATE_validateDisjunctiveFilterElements(s,e){if(!Array.isArray(s)||s.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function __PRIVATE_validateNewFieldFilter(s,e){const i=function(a,j){for(const _e of a)for(const tt of _e.getFlattenedFilters())if(j.indexOf(tt.op)>=0)return tt.op;return null}(s.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(i!==null)throw i===e.op?new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${i.toString()}' filters.`)}class AbstractUserDataWriter{convertValue(e,i="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,i);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,i);case 11:return this.convertObject(e.mapValue,i);case 10:return this.convertVectorValue(e.mapValue);default:throw fail(62114,{value:e})}}convertObject(e,i){return this.convertObjectMap(e.fields,i)}convertObjectMap(e,i="none"){const o={};return forEach(e,(a,j)=>{o[a]=this.convertValue(j,i)}),o}convertVectorValue(e){var i,o,a;const j=(a=(o=(i=e.fields)===null||i===void 0?void 0:i[Tt].arrayValue)===null||o===void 0?void 0:o.values)===null||a===void 0?void 0:a.map(_e=>__PRIVATE_normalizeNumber(_e.doubleValue));return new VectorValue(j)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,i){return(e.values||[]).map(o=>this.convertValue(o,i))}convertServerTimestamp(e,i){switch(i){case"previous":const o=__PRIVATE_getPreviousValue(e);return o==null?null:this.convertValue(o,i);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){const i=__PRIVATE_normalizeTimestamp(e);return new Timestamp(i.seconds,i.nanos)}convertDocumentKey(e,i){const o=ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(o),9688,{name:e});const a=new DatabaseId(o.get(1),o.get(3)),j=new DocumentKey(o.popFirst(5));return a.isEqual(i)||__PRIVATE_logError(`Document ${j} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),j}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(s,e,i){let o;return o=s?s.toFirestore(e):e,o}class SnapshotMetadata{constructor(e,i){this.hasPendingWrites=e,this.fromCache=i}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,i,o,a,j,_e){super(e,i,o,a,_e),this._firestore=e,this._firestoreImpl=e,this.metadata=j}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const i=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,i={}){if(this._document){const o=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o,i.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new FirestoreError(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,i={};return i.type=DocumentSnapshot._jsonSchemaVersion,i.bundle="",i.bundleSource="DocumentSnapshot",i.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?i:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),i.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),i)}}DocumentSnapshot._jsonSchemaVersion="firestore/documentSnapshot/1.0",DocumentSnapshot._jsonSchema={type:property("string",DocumentSnapshot._jsonSchemaVersion),bundleSource:property("string","DocumentSnapshot"),bundleName:property("string"),bundle:property("string")};class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}}class QuerySnapshot{constructor(e,i,o,a){this._firestore=e,this._userDataWriter=i,this._snapshot=a,this.metadata=new SnapshotMetadata(a.hasPendingWrites,a.fromCache),this.query=o}get docs(){const e=[];return this.forEach(i=>e.push(i)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,i){this._snapshot.docs.forEach(o=>{e.call(i,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,o.key,o,new SnapshotMetadata(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const i=!!e.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=function(a,j){if(a._snapshot.oldDocs.isEmpty()){let _e=0;return a._snapshot.docChanges.map(tt=>{const et=new QueryDocumentSnapshot(a._firestore,a._userDataWriter,tt.doc.key,tt.doc,new SnapshotMetadata(a._snapshot.mutatedKeys.has(tt.doc.key),a._snapshot.fromCache),a.query.converter);return tt.doc,{type:"added",doc:et,oldIndex:-1,newIndex:_e++}})}{let _e=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(tt=>j||tt.type!==3).map(tt=>{const et=new QueryDocumentSnapshot(a._firestore,a._userDataWriter,tt.doc.key,tt.doc,new SnapshotMetadata(a._snapshot.mutatedKeys.has(tt.doc.key),a._snapshot.fromCache),a.query.converter);let rt=-1,dt=-1;return tt.type!==0&&(rt=_e.indexOf(tt.doc.key),_e=_e.delete(tt.doc.key)),tt.type!==1&&(_e=_e.add(tt.doc),dt=_e.indexOf(tt.doc.key)),{type:__PRIVATE_resultChangeType(tt.type),doc:et,oldIndex:rt,newIndex:dt}})}}(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new FirestoreError(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=QuerySnapshot._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=__PRIVATE_AutoId.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const i=[],o=[],a=[];return this.docs.forEach(j=>{j._document!==null&&(i.push(j._document),o.push(this._userDataWriter.convertObjectMap(j._document.data.value.mapValue.fields,"previous")),a.push(j.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function __PRIVATE_resultChangeType(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getDoc(s){s=__PRIVATE_cast(s,DocumentReference);const e=__PRIVATE_cast(s.firestore,Firestore);return __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(ensureFirestoreConfigured(e),s._key).then(i=>__PRIVATE_convertToDocSnapshot(e,s,i))}QuerySnapshot._jsonSchemaVersion="firestore/querySnapshot/1.0",QuerySnapshot._jsonSchema={type:property("string",QuerySnapshot._jsonSchemaVersion),bundleSource:property("string","QuerySnapshot"),bundleName:property("string"),bundle:property("string")};class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bytes(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new DocumentReference(this.firestore,null,i)}}function getDocs(s){s=__PRIVATE_cast(s,Query);const e=__PRIVATE_cast(s.firestore,Firestore),i=ensureFirestoreConfigured(e),o=new __PRIVATE_ExpUserDataWriter(e);return __PRIVATE_validateHasExplicitOrderByForLimitToLast(s._query),__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(i,s._query).then(a=>new QuerySnapshot(e,o,s,a))}function updateDoc(s,e,i,...o){s=__PRIVATE_cast(s,DocumentReference);const a=__PRIVATE_cast(s.firestore,Firestore),j=__PRIVATE_newUserDataReader(a);let _e;return _e=typeof(e=getModularInstance(e))=="string"||e instanceof FieldPath?__PRIVATE_parseUpdateVarargs(j,"updateDoc",s._key,e,i,o):__PRIVATE_parseUpdateData(j,"updateDoc",s._key,e),executeWrite(a,[_e.toMutation(s._key,Precondition.exists(!0))])}function deleteDoc(s){return executeWrite(__PRIVATE_cast(s.firestore,Firestore),[new __PRIVATE_DeleteMutation(s._key,Precondition.none())])}function addDoc(s,e){const i=__PRIVATE_cast(s.firestore,Firestore),o=doc(s),a=__PRIVATE_applyFirestoreDataConverter(s.converter,e);return executeWrite(i,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(s.firestore),"addDoc",o._key,a,s.converter!==null,{}).toMutation(o._key,Precondition.exists(!1))]).then(()=>o)}function executeWrite(s,e){return function(o,a){const j=new __PRIVATE_Deferred;return o.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(o),a,j)),j.promise}(ensureFirestoreConfigured(s),e)}function __PRIVATE_convertToDocSnapshot(s,e,i){const o=i.docs.get(e._key),a=new __PRIVATE_ExpUserDataWriter(s);return new DocumentSnapshot(s,a,e._key,o,new SnapshotMetadata(i.hasPendingWrites,i.fromCache),e.converter)}function serverTimestamp(){return new __PRIVATE_ServerTimestampFieldValueImpl("serverTimestamp")}(function(e,i=!0){(function(a){x=a})(SDK_VERSION),_registerComponent(new Component("firestore",(o,{instanceIdentifier:a,options:j})=>{const _e=o.getProvider("app").getImmediate(),tt=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(o.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(_e,o.getProvider("app-check-internal")),function(rt,dt){if(!Object.prototype.hasOwnProperty.apply(rt.options,["projectId"]))throw new FirestoreError(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(rt.options.projectId,dt)}(_e,a),_e);return j=Object.assign({useFetchStreams:i},j),tt._setSettings(j),tt},"PUBLIC").setMultipleInstances(!0)),registerVersion(F,M,e),registerVersion(F,M,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_HOST="firebasestorage.googleapis.com",CONFIG_STORAGE_BUCKET_KEY="storageBucket",DEFAULT_MAX_OPERATION_RETRY_TIME=2*60*1e3,DEFAULT_MAX_UPLOAD_RETRY_TIME=10*60*1e3,DEFAULT_MIN_SLEEP_TIME_MILLIS=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageError extends FirebaseError{constructor(e,i,o=0){super(prependCode(e),`Firebase Storage: ${i} (${prependCode(e)})`),this.status_=o,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return prependCode(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var StorageErrorCode;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(StorageErrorCode||(StorageErrorCode={}));function prependCode(s){return"storage/"+s}function unknown(){const s="An unknown error occurred, please check the error payload for server response.";return new StorageError(StorageErrorCode.UNKNOWN,s)}function objectNotFound(s){return new StorageError(StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function quotaExceeded(s){return new StorageError(StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new StorageError(StorageErrorCode.UNAUTHENTICATED,s)}function unauthorizedApp(){return new StorageError(StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function unauthorized(s){return new StorageError(StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function retryLimitExceeded(){return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new StorageError(StorageErrorCode.CANCELED,"User canceled the upload/download.")}function invalidUrl(s){return new StorageError(StorageErrorCode.INVALID_URL,"Invalid URL '"+s+"'.")}function invalidDefaultBucket(s){return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function noDefaultBucket(){return new StorageError(StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+CONFIG_STORAGE_BUCKET_KEY+"' property when initializing the app?")}function cannotSliceBlob(){return new StorageError(StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function serverFileWrongSize(){return new StorageError(StorageErrorCode.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function noDownloadURL(){return new StorageError(StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function missingPolyFill(s){return new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function invalidArgument(s){return new StorageError(StorageErrorCode.INVALID_ARGUMENT,s)}function appDeleted(){return new StorageError(StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(s){return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(s,e){return new StorageError(StorageErrorCode.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function internalError(s){throw new StorageError(StorageErrorCode.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Location{constructor(e,i){this.bucket=e,this.path_=i}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,i){let o;try{o=Location.makeFromUrl(e,i)}catch{return new Location(e,"")}if(o.path==="")return o;throw invalidDefaultBucket(e)}static makeFromUrl(e,i){let o=null;const a="([A-Za-z0-9.\\-_]+)";function j(dn){dn.path.charAt(dn.path.length-1)==="/"&&(dn.path_=dn.path_.slice(0,-1))}const _e="(/(.*))?$",tt=new RegExp("^gs://"+a+_e,"i"),et={bucket:1,path:3};function rt(dn){dn.path_=decodeURIComponent(dn.path)}const dt="v[A-Za-z0-9_]+",vt=i.replace(/[.]/g,"\\."),Ct="(/([^?#]*).*)?$",Wt=new RegExp(`^https?://${vt}/${dt}/b/${a}/o${Ct}`,"i"),Bt={bucket:1,path:3},qt=i===DEFAULT_HOST?"(?:storage.googleapis.com|storage.cloud.google.com)":i,Ut="([^?#]*)",kt=new RegExp(`^https?://${qt}/${a}/${Ut}`,"i"),un=[{regex:tt,indices:et,postModify:j},{regex:Wt,indices:Bt,postModify:rt},{regex:kt,indices:{bucket:1,path:2},postModify:rt}];for(let dn=0;dn<un.length;dn++){const hn=un[dn],gn=hn.regex.exec(e);if(gn){const It=gn[hn.indices.bucket];let pt=gn[hn.indices.path];pt||(pt=""),o=new Location(It,pt),hn.postModify(o);break}}if(o==null)throw invalidUrl(e);return o}}class FailRequest{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function start(s,e,i){let o=1,a=null,j=null,_e=!1,tt=0;function et(){return tt===2}let rt=!1;function dt(...Ut){rt||(rt=!0,e.apply(null,Ut))}function vt(Ut){a=setTimeout(()=>{a=null,s(Wt,et())},Ut)}function Ct(){j&&clearTimeout(j)}function Wt(Ut,...kt){if(rt){Ct();return}if(Ut){Ct(),dt.call(null,Ut,...kt);return}if(et()||_e){Ct(),dt.call(null,Ut,...kt);return}o<64&&(o*=2);let un;tt===1?(tt=2,un=0):un=(o+Math.random())*1e3,vt(un)}let Bt=!1;function qt(Ut){Bt||(Bt=!0,Ct(),!rt&&(a!==null?(Ut||(tt=2),clearTimeout(a),vt(0)):Ut||(tt=1)))}return vt(0),j=setTimeout(()=>{_e=!0,qt(!0)},i),qt}function stop(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isJustDef(s){return s!==void 0}function isFunction(s){return typeof s=="function"}function isNonArrayObject(s){return typeof s=="object"&&!Array.isArray(s)}function isString$1(s){return typeof s=="string"||s instanceof String}function isNativeBlob(s){return isNativeBlobDefined()&&s instanceof Blob}function isNativeBlobDefined(){return typeof Blob<"u"}function validateNumber(s,e,i,o){if(o<e)throw invalidArgument(`Invalid value for '${s}'. Expected ${e} or greater.`);if(o>i)throw invalidArgument(`Invalid value for '${s}'. Expected ${i} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function makeUrl(s,e,i){let o=e;return i==null&&(o=`https://${e}`),`${i}://${o}/v0${s}`}function makeQueryString(s){const e=encodeURIComponent;let i="?";for(const o in s)if(s.hasOwnProperty(o)){const a=e(o)+"="+e(s[o]);i=i+a+"&"}return i=i.slice(0,-1),i}var ErrorCode;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(ErrorCode||(ErrorCode={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isRetryStatusCode(s,e){const i=s>=500&&s<600,a=[408,429].indexOf(s)!==-1,j=e.indexOf(s)!==-1;return i||a||j}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NetworkRequest{constructor(e,i,o,a,j,_e,tt,et,rt,dt,vt,Ct=!0,Wt=!1){this.url_=e,this.method_=i,this.headers_=o,this.body_=a,this.successCodes_=j,this.additionalRetryCodes_=_e,this.callback_=tt,this.errorCallback_=et,this.timeout_=rt,this.progressCallback_=dt,this.connectionFactory_=vt,this.retry=Ct,this.isUsingEmulator=Wt,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Bt,qt)=>{this.resolve_=Bt,this.reject_=qt,this.start_()})}start_(){const e=(o,a)=>{if(a){o(!1,new RequestEndStatus(!1,null,!0));return}const j=this.connectionFactory_();this.pendingConnection_=j;const _e=tt=>{const et=tt.loaded,rt=tt.lengthComputable?tt.total:-1;this.progressCallback_!==null&&this.progressCallback_(et,rt)};this.progressCallback_!==null&&j.addUploadProgressListener(_e),j.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&j.removeUploadProgressListener(_e),this.pendingConnection_=null;const tt=j.getErrorCode()===ErrorCode.NO_ERROR,et=j.getStatus();if(!tt||isRetryStatusCode(et,this.additionalRetryCodes_)&&this.retry){const dt=j.getErrorCode()===ErrorCode.ABORT;o(!1,new RequestEndStatus(!1,null,dt));return}const rt=this.successCodes_.indexOf(et)!==-1;o(!0,new RequestEndStatus(rt,j))})},i=(o,a)=>{const j=this.resolve_,_e=this.reject_,tt=a.connection;if(a.wasSuccessCode)try{const et=this.callback_(tt,tt.getResponse());isJustDef(et)?j(et):j()}catch(et){_e(et)}else if(tt!==null){const et=unknown();et.serverResponse=tt.getErrorText(),this.errorCallback_?_e(this.errorCallback_(tt,et)):_e(et)}else if(a.canceled){const et=this.appDelete_?appDeleted():canceled();_e(et)}else{const et=retryLimitExceeded();_e(et)}};this.canceled_?i(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=start(e,i,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&stop(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class RequestEndStatus{constructor(e,i,o){this.wasSuccessCode=e,this.connection=i,this.canceled=!!o}}function addAuthHeader_(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function addVersionHeader_(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function addGmpidHeader_(s,e){e&&(s["X-Firebase-GMPID"]=e)}function addAppCheckHeader_(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function makeRequest(s,e,i,o,a,j,_e=!0,tt=!1){const et=makeQueryString(s.urlParams),rt=s.url+et,dt=Object.assign({},s.headers);return addGmpidHeader_(dt,e),addAuthHeader_(dt,i),addVersionHeader_(dt,j),addAppCheckHeader_(dt,o),new NetworkRequest(rt,s.method,dt,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,a,_e,tt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getBlobBuilder(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function getBlob$1(...s){const e=getBlobBuilder();if(e!==void 0){const i=new e;for(let o=0;o<s.length;o++)i.append(s[o]);return i.getBlob()}else{if(isNativeBlobDefined())return new Blob(s);throw new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sliceBlob(s,e,i){return s.webkitSlice?s.webkitSlice(e,i):s.mozSlice?s.mozSlice(e,i):s.slice?s.slice(e,i):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodeBase64(s){if(typeof atob>"u")throw missingPolyFill("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class StringData{constructor(e,i){this.data=e,this.contentType=i||null}}function dataFromString(s,e){switch(s){case StringFormat.RAW:return new StringData(utf8Bytes_(e));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(s,e));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(e),dataURLContentType_(e))}throw unknown()}function utf8Bytes_(s){const e=[];for(let i=0;i<s.length;i++){let o=s.charCodeAt(i);if(o<=127)e.push(o);else if(o<=2047)e.push(192|o>>6,128|o&63);else if((o&64512)===55296)if(!(i<s.length-1&&(s.charCodeAt(i+1)&64512)===56320))e.push(239,191,189);else{const j=o,_e=s.charCodeAt(++i);o=65536|(j&1023)<<10|_e&1023,e.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63)}else(o&64512)===56320?e.push(239,191,189):e.push(224|o>>12,128|o>>6&63,128|o&63)}return new Uint8Array(e)}function percentEncodedBytes_(s){let e;try{e=decodeURIComponent(s)}catch{throw invalidFormat(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(e)}function base64Bytes_(s,e){switch(s){case StringFormat.BASE64:{const a=e.indexOf("-")!==-1,j=e.indexOf("_")!==-1;if(a||j)throw invalidFormat(s,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case StringFormat.BASE64URL:{const a=e.indexOf("+")!==-1,j=e.indexOf("/")!==-1;if(a||j)throw invalidFormat(s,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{i=decodeBase64(e)}catch(a){throw a.message.includes("polyfill")?a:invalidFormat(s,"Invalid character found")}const o=new Uint8Array(i.length);for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return o}class DataURLParts{constructor(e){this.base64=!1,this.contentType=null;const i=e.match(/^data:([^,]+)?,/);if(i===null)throw invalidFormat(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const o=i[1]||null;o!=null&&(this.base64=endsWith(o,";base64"),this.contentType=this.base64?o.substring(0,o.length-7):o),this.rest=e.substring(e.indexOf(",")+1)}}function dataURLBytes_(s){const e=new DataURLParts(s);return e.base64?base64Bytes_(StringFormat.BASE64,e.rest):percentEncodedBytes_(e.rest)}function dataURLContentType_(s){return new DataURLParts(s).contentType}function endsWith(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FbsBlob{constructor(e,i){let o=0,a="";isNativeBlob(e)?(this.data_=e,o=e.size,a=e.type):e instanceof ArrayBuffer?(i?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),o=this.data_.length):e instanceof Uint8Array&&(i?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),o=e.length),this.size_=o,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,i){if(isNativeBlob(this.data_)){const o=this.data_,a=sliceBlob(o,e,i);return a===null?null:new FbsBlob(a)}else{const o=new Uint8Array(this.data_.buffer,e,i-e);return new FbsBlob(o,!0)}}static getBlob(...e){if(isNativeBlobDefined()){const i=e.map(o=>o instanceof FbsBlob?o.data_:o);return new FbsBlob(getBlob$1.apply(null,i))}else{const i=e.map(_e=>isString$1(_e)?dataFromString(StringFormat.RAW,_e).data:_e.data_);let o=0;i.forEach(_e=>{o+=_e.byteLength});const a=new Uint8Array(o);let j=0;return i.forEach(_e=>{for(let tt=0;tt<_e.length;tt++)a[j++]=_e[tt]}),new FbsBlob(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonObjectOrNull(s){let e;try{e=JSON.parse(s)}catch{return null}return isNonArrayObject(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parent(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function child(s,e){const i=e.split("/").filter(o=>o.length>0).join("/");return s.length===0?i:s+"/"+i}function lastComponent(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function noXform_(s,e){return e}class Mapping{constructor(e,i,o,a){this.server=e,this.local=i||e,this.writable=!!o,this.xform=a||noXform_}}let mappings_=null;function xformPath(s){return!isString$1(s)||s.length<2?s:lastComponent(s)}function getMappings(){if(mappings_)return mappings_;const s=[];s.push(new Mapping("bucket")),s.push(new Mapping("generation")),s.push(new Mapping("metageneration")),s.push(new Mapping("name","fullPath",!0));function e(j,_e){return xformPath(_e)}const i=new Mapping("name");i.xform=e,s.push(i);function o(j,_e){return _e!==void 0?Number(_e):_e}const a=new Mapping("size");return a.xform=o,s.push(a),s.push(new Mapping("timeCreated")),s.push(new Mapping("updated")),s.push(new Mapping("md5Hash",null,!0)),s.push(new Mapping("cacheControl",null,!0)),s.push(new Mapping("contentDisposition",null,!0)),s.push(new Mapping("contentEncoding",null,!0)),s.push(new Mapping("contentLanguage",null,!0)),s.push(new Mapping("contentType",null,!0)),s.push(new Mapping("metadata","customMetadata",!0)),mappings_=s,mappings_}function addRef(s,e){function i(){const o=s.bucket,a=s.fullPath,j=new Location(o,a);return e._makeStorageReference(j)}Object.defineProperty(s,"ref",{get:i})}function fromResource(s,e,i){const o={};o.type="file";const a=i.length;for(let j=0;j<a;j++){const _e=i[j];o[_e.local]=_e.xform(o,e[_e.server])}return addRef(o,s),o}function fromResourceString(s,e,i){const o=jsonObjectOrNull(e);return o===null?null:fromResource(s,o,i)}function downloadUrlFromResourceString(s,e,i,o){const a=jsonObjectOrNull(e);if(a===null||!isString$1(a.downloadTokens))return null;const j=a.downloadTokens;if(j.length===0)return null;const _e=encodeURIComponent;return j.split(",").map(rt=>{const dt=s.bucket,vt=s.fullPath,Ct="/b/"+_e(dt)+"/o/"+_e(vt),Wt=makeUrl(Ct,i,o),Bt=makeQueryString({alt:"media",token:rt});return Wt+Bt})[0]}function toResourceString(s,e){const i={},o=e.length;for(let a=0;a<o;a++){const j=e[a];j.writable&&(i[j.server]=s[j.local])}return JSON.stringify(i)}class RequestInfo{constructor(e,i,o,a){this.url=e,this.method=i,this.handler=o,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function handlerCheck(s){if(!s)throw unknown()}function metadataHandler(s,e){function i(o,a){const j=fromResourceString(s,a,e);return handlerCheck(j!==null),j}return i}function downloadUrlHandler(s,e){function i(o,a){const j=fromResourceString(s,a,e);return handlerCheck(j!==null),downloadUrlFromResourceString(j,a,s.host,s._protocol)}return i}function sharedErrorHandler(s){function e(i,o){let a;return i.getStatus()===401?i.getErrorText().includes("Firebase App Check token is invalid")?a=unauthorizedApp():a=unauthenticated():i.getStatus()===402?a=quotaExceeded(s.bucket):i.getStatus()===403?a=unauthorized(s.path):a=o,a.status=i.getStatus(),a.serverResponse=o.serverResponse,a}return e}function objectErrorHandler(s){const e=sharedErrorHandler(s);function i(o,a){let j=e(o,a);return o.getStatus()===404&&(j=objectNotFound(s.path)),j.serverResponse=a.serverResponse,j}return i}function getMetadata$2(s,e,i){const o=e.fullServerUrl(),a=makeUrl(o,s.host,s._protocol),j="GET",_e=s.maxOperationRetryTime,tt=new RequestInfo(a,j,metadataHandler(s,i),_e);return tt.errorHandler=objectErrorHandler(e),tt}function getDownloadUrl(s,e,i){const o=e.fullServerUrl(),a=makeUrl(o,s.host,s._protocol),j="GET",_e=s.maxOperationRetryTime,tt=new RequestInfo(a,j,downloadUrlHandler(s,i),_e);return tt.errorHandler=objectErrorHandler(e),tt}function deleteObject$2(s,e){const i=e.fullServerUrl(),o=makeUrl(i,s.host,s._protocol),a="DELETE",j=s.maxOperationRetryTime;function _e(et,rt){}const tt=new RequestInfo(o,a,_e,j);return tt.successCodes=[200,204],tt.errorHandler=objectErrorHandler(e),tt}function determineContentType_(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function metadataForUpload_(s,e,i){const o=Object.assign({},i);return o.fullPath=s.path,o.size=e.size(),o.contentType||(o.contentType=determineContentType_(null,e)),o}function multipartUpload(s,e,i,o,a){const j=e.bucketOnlyServerUrl(),_e={"X-Goog-Upload-Protocol":"multipart"};function tt(){let un="";for(let dn=0;dn<2;dn++)un=un+Math.random().toString().slice(2);return un}const et=tt();_e["Content-Type"]="multipart/related; boundary="+et;const rt=metadataForUpload_(e,o,a),dt=toResourceString(rt,i),vt="--"+et+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+dt+`\r
--`+et+`\r
Content-Type: `+rt.contentType+`\r
\r
`,Ct=`\r
--`+et+"--",Wt=FbsBlob.getBlob(vt,o,Ct);if(Wt===null)throw cannotSliceBlob();const Bt={name:rt.fullPath},qt=makeUrl(j,s.host,s._protocol),Ut="POST",kt=s.maxUploadRetryTime,Nt=new RequestInfo(qt,Ut,metadataHandler(s,i),kt);return Nt.urlParams=Bt,Nt.headers=_e,Nt.body=Wt.uploadData(),Nt.errorHandler=sharedErrorHandler(e),Nt}class ResumableUploadStatus{constructor(e,i,o,a){this.current=e,this.total=i,this.finalized=!!o,this.metadata=a||null}}function checkResumeHeader_(s,e){let i=null;try{i=s.getResponseHeader("X-Goog-Upload-Status")}catch{handlerCheck(!1)}return handlerCheck(!!i&&(e||["active"]).indexOf(i)!==-1),i}function createResumableUpload(s,e,i,o,a){const j=e.bucketOnlyServerUrl(),_e=metadataForUpload_(e,o,a),tt={name:_e.fullPath},et=makeUrl(j,s.host,s._protocol),rt="POST",dt={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${o.size()}`,"X-Goog-Upload-Header-Content-Type":_e.contentType,"Content-Type":"application/json; charset=utf-8"},vt=toResourceString(_e,i),Ct=s.maxUploadRetryTime;function Wt(qt){checkResumeHeader_(qt);let Ut;try{Ut=qt.getResponseHeader("X-Goog-Upload-URL")}catch{handlerCheck(!1)}return handlerCheck(isString$1(Ut)),Ut}const Bt=new RequestInfo(et,rt,Wt,Ct);return Bt.urlParams=tt,Bt.headers=dt,Bt.body=vt,Bt.errorHandler=sharedErrorHandler(e),Bt}function getResumableUploadStatus(s,e,i,o){const a={"X-Goog-Upload-Command":"query"};function j(rt){const dt=checkResumeHeader_(rt,["active","final"]);let vt=null;try{vt=rt.getResponseHeader("X-Goog-Upload-Size-Received")}catch{handlerCheck(!1)}vt||handlerCheck(!1);const Ct=Number(vt);return handlerCheck(!isNaN(Ct)),new ResumableUploadStatus(Ct,o.size(),dt==="final")}const _e="POST",tt=s.maxUploadRetryTime,et=new RequestInfo(i,_e,j,tt);return et.headers=a,et.errorHandler=sharedErrorHandler(e),et}const RESUMABLE_UPLOAD_CHUNK_SIZE=256*1024;function continueResumableUpload(s,e,i,o,a,j,_e,tt){const et=new ResumableUploadStatus(0,0);if(_e?(et.current=_e.current,et.total=_e.total):(et.current=0,et.total=o.size()),o.size()!==et.total)throw serverFileWrongSize();const rt=et.total-et.current;let dt=rt;a>0&&(dt=Math.min(dt,a));const vt=et.current,Ct=vt+dt;let Wt="";dt===0?Wt="finalize":rt===dt?Wt="upload, finalize":Wt="upload";const Bt={"X-Goog-Upload-Command":Wt,"X-Goog-Upload-Offset":`${et.current}`},qt=o.slice(vt,Ct);if(qt===null)throw cannotSliceBlob();function Ut(dn,hn){const gn=checkResumeHeader_(dn,["active","final"]),It=et.current+dt,pt=o.size();let Dt;return gn==="final"?Dt=metadataHandler(e,j)(dn,hn):Dt=null,new ResumableUploadStatus(It,pt,gn==="final",Dt)}const kt="POST",Nt=e.maxUploadRetryTime,un=new RequestInfo(i,kt,Ut,Nt);return un.headers=Bt,un.body=qt.uploadData(),un.progressCallback=tt||null,un.errorHandler=sharedErrorHandler(s),un}const TaskState={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function taskStateFromInternalTaskState(s){switch(s){case"running":case"pausing":case"canceling":return TaskState.RUNNING;case"paused":return TaskState.PAUSED;case"success":return TaskState.SUCCESS;case"canceled":return TaskState.CANCELED;case"error":return TaskState.ERROR;default:return TaskState.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Observer{constructor(e,i,o){if(isFunction(e)||i!=null||o!=null)this.next=e,this.error=i??void 0,this.complete=o??void 0;else{const j=e;this.next=j.next,this.error=j.error,this.complete=j.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function async(s){return(...e)=>{Promise.resolve().then(()=>s(...e))}}class XhrConnection{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ErrorCode.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ErrorCode.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ErrorCode.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,i,o,a,j){if(this.sent_)throw internalError("cannot .send() more than once");if(isCloudWorkstation(e)&&o&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(i,e,!0),j!==void 0)for(const _e in j)j.hasOwnProperty(_e)&&this.xhr_.setRequestHeader(_e,j[_e].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw internalError("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw internalError("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw internalError("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw internalError("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XhrTextConnection extends XhrConnection{initXhr(){this.xhr_.responseType="text"}}function newTextConnection(){return new XhrTextConnection}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UploadTask{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,i,o=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=i,this._metadata=o,this._mappings=getMappings(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{if(this._request=void 0,this._chunkMultiplier=1,a._codeEquals(StorageErrorCode.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const j=this.isExponentialBackoffExpired();if(isRetryStatusCode(a.status,[]))if(j)a=retryLimitExceeded();else{this.sleepTime=Math.max(this.sleepTime*2,DEFAULT_MIN_SLEEP_TIME_MILLIS),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=a,this._transition("error")}},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals(StorageErrorCode.CANCELED)?this.completeTransitions_():(this._error=a,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((a,j)=>{this._resolve=a,this._reject=j,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return i=>this._updateProgress(e+i)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([i,o])=>{switch(this._state){case"running":e(i,o);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,i)=>{const o=createResumableUpload(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(o,newTextConnection,e,i);this._request=a,a.getPromise().then(j=>{this._request=void 0,this._uploadUrl=j,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((i,o)=>{const a=getResumableUploadStatus(this._ref.storage,this._ref._location,e,this._blob),j=this._ref.storage._makeRequest(a,newTextConnection,i,o);this._request=j,j.getPromise().then(_e=>{_e=_e,this._request=void 0,this._updateProgress(_e.current),this._needToFetchStatus=!1,_e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=RESUMABLE_UPLOAD_CHUNK_SIZE*this._chunkMultiplier,i=new ResumableUploadStatus(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken((a,j)=>{let _e;try{_e=continueResumableUpload(this._ref._location,this._ref.storage,o,this._blob,e,this._mappings,i,this._makeProgressCallback())}catch(et){this._error=et,this._transition("error");return}const tt=this._ref.storage._makeRequest(_e,newTextConnection,a,j,!1);this._request=tt,tt.getPromise().then(et=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(et.current),et.finalized?(this._metadata=et.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){RESUMABLE_UPLOAD_CHUNK_SIZE*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,i)=>{const o=getMetadata$2(this._ref.storage,this._ref._location,this._mappings),a=this._ref.storage._makeRequest(o,newTextConnection,e,i);this._request=a,a.getPromise().then(j=>{this._request=void 0,this._metadata=j,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,i)=>{const o=multipartUpload(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),a=this._ref.storage._makeRequest(o,newTextConnection,e,i);this._request=a,a.getPromise().then(j=>{this._request=void 0,this._metadata=j,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const i=this._transferred;this._transferred=e,this._transferred!==i&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const i=this._state==="paused";this._state=e,i&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=canceled(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=taskStateFromInternalTaskState(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,i,o,a){const j=new Observer(i||void 0,o||void 0,a||void 0);return this._addObserver(j),()=>{this._removeObserver(j)}}then(e,i){return this._promise.then(e,i)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const i=this._observers.indexOf(e);i!==-1&&this._observers.splice(i,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(i=>{this._notifyObserver(i)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(taskStateFromInternalTaskState(this._state)){case TaskState.SUCCESS:async(this._resolve.bind(null,this.snapshot))();break;case TaskState.CANCELED:case TaskState.ERROR:const i=this._reject;async(i.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(taskStateFromInternalTaskState(this._state)){case TaskState.RUNNING:case TaskState.PAUSED:e.next&&async(e.next.bind(e,this.snapshot))();break;case TaskState.SUCCESS:e.complete&&async(e.complete.bind(e))();break;case TaskState.CANCELED:case TaskState.ERROR:e.error&&async(e.error.bind(e,this._error))();break;default:e.error&&async(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Reference{constructor(e,i){this._service=e,i instanceof Location?this._location=i:this._location=Location.makeFromUrl(i,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,i){return new Reference(e,i)}get root(){const e=new Location(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lastComponent(this._location.path)}get storage(){return this._service}get parent(){const e=parent(this._location.path);if(e===null)return null;const i=new Location(this._location.bucket,e);return new Reference(this._service,i)}_throwIfRoot(e){if(this._location.path==="")throw invalidRootOperation(e)}}function uploadBytesResumable$1(s,e,i){return s._throwIfRoot("uploadBytesResumable"),new UploadTask(s,new FbsBlob(e),i)}function getDownloadURL$1(s){s._throwIfRoot("getDownloadURL");const e=getDownloadUrl(s.storage,s._location,getMappings());return s.storage.makeRequestWithTokens(e,newTextConnection).then(i=>{if(i===null)throw noDownloadURL();return i})}function deleteObject$1(s){s._throwIfRoot("deleteObject");const e=deleteObject$2(s.storage,s._location);return s.storage.makeRequestWithTokens(e,newTextConnection)}function _getChild$1(s,e){const i=child(s._location.path,e),o=new Location(s._location.bucket,i);return new Reference(s.storage,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isUrl(s){return/^[A-Za-z]+:\/\//.test(s)}function refFromURL(s,e){return new Reference(s,e)}function refFromPath(s,e){if(s instanceof FirebaseStorageImpl){const i=s;if(i._bucket==null)throw noDefaultBucket();const o=new Reference(i,i._bucket);return e!=null?refFromPath(o,e):o}else return e!==void 0?_getChild$1(s,e):s}function ref$1(s,e){if(e&&isUrl(e)){if(s instanceof FirebaseStorageImpl)return refFromURL(s,e);throw invalidArgument("To use ref(service, url), the first argument must be a Storage instance.")}else return refFromPath(s,e)}function extractBucket(s,e){const i=e==null?void 0:e[CONFIG_STORAGE_BUCKET_KEY];return i==null?null:Location.makeFromBucketSpec(i,s)}function connectStorageEmulator$1(s,e,i,o={}){s.host=`${e}:${i}`;const a=isCloudWorkstation(e);a&&(pingServer(`https://${s.host}/b`),updateEmulatorBanner("Storage",!0)),s._isUsingEmulator=!0,s._protocol=a?"https":"http";const{mockUserToken:j}=o;j&&(s._overrideAuthToken=typeof j=="string"?j:createMockUserToken(j,s.app.options.projectId))}class FirebaseStorageImpl{constructor(e,i,o,a,j,_e=!1){this.app=e,this._authProvider=i,this._appCheckProvider=o,this._url=a,this._firebaseVersion=j,this._isUsingEmulator=_e,this._bucket=null,this._host=DEFAULT_HOST,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DEFAULT_MAX_OPERATION_RETRY_TIME,this._maxUploadRetryTime=DEFAULT_MAX_UPLOAD_RETRY_TIME,this._requests=new Set,a!=null?this._bucket=Location.makeFromBucketSpec(a,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Location.makeFromBucketSpec(this._url,e):this._bucket=extractBucket(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const i=await e.getToken();if(i!==null)return i.accessToken}return null}async _getAppCheckToken(){if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Reference(this,e)}_makeRequest(e,i,o,a,j=!0){if(this._deleted)return new FailRequest(appDeleted());{const _e=makeRequest(e,this._appId,o,a,i,this._firebaseVersion,j,this._isUsingEmulator);return this._requests.add(_e),_e.getPromise().then(()=>this._requests.delete(_e),()=>this._requests.delete(_e)),_e}}async makeRequestWithTokens(e,i){const[o,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,i,o,a).getPromise()}}const name$1="@firebase/storage",version$1="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE="storage";function uploadBytesResumable(s,e,i){return s=getModularInstance(s),uploadBytesResumable$1(s,e,i)}function getDownloadURL(s){return s=getModularInstance(s),getDownloadURL$1(s)}function deleteObject(s){return s=getModularInstance(s),deleteObject$1(s)}function ref(s,e){return s=getModularInstance(s),ref$1(s,e)}function getStorage(s=getApp(),e){s=getModularInstance(s);const o=_getProvider(s,STORAGE_TYPE).getImmediate({identifier:e}),a=getDefaultEmulatorHostnameAndPort("storage");return a&&connectStorageEmulator(o,...a),o}function connectStorageEmulator(s,e,i,o={}){connectStorageEmulator$1(s,e,i,o)}function factory(s,{instanceIdentifier:e}){const i=s.getProvider("app").getImmediate(),o=s.getProvider("auth-internal"),a=s.getProvider("app-check-internal");return new FirebaseStorageImpl(i,o,a,e,SDK_VERSION)}function registerStorage(){_registerComponent(new Component(STORAGE_TYPE,factory,"PUBLIC").setMultipleInstances(!0)),registerVersion(name$1,version$1,""),registerVersion(name$1,version$1,"esm2017")}registerStorage();const firebaseConfig={apiKey:"AIzaSyBU8sLxq3mIXUvQ7VW10axwMTy8wfjmpLU",authDomain:"academic-paper-repo.firebaseapp.com",projectId:"academic-paper-repo",storageBucket:"academic-paper-repo.firebasestorage.app",messagingSenderId:"930522586819",appId:"1:930522586819:web:f10b7d021a19dcd3ad0c76"},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),storage=getStorage(app),collegeLogo="/assets/college-logo-BZu7YKZV.png",qprLogo="/assets/book-C_oePvWO.png";function Header(){const s=useNavigate(),[e,i]=reactExports.useState(null);reactExports.useEffect(()=>{const a=onAuthStateChanged(auth,j=>{i(j)});return()=>a()},[]);const o=async()=>{try{await signOut(auth),s("/")}catch(a){console.error("Logout error:",a)}};return jsxRuntimeExports.jsx("header",{className:"bg-navy text-white shadow-lg",children:jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center py-4",children:[jsxRuntimeExports.jsxs(Link,{to:"/",className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("img",{src:qprLogo,alt:"Question Paper Repo Logo",className:"h-10 w-auto"}),jsxRuntimeExports.jsx("span",{className:"text-xl font-bold tracking-wide",children:"QuestionPaperRepo"})]}),jsxRuntimeExports.jsx("nav",{className:"flex items-center space-x-6",children:e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("span",{className:"text-sm",children:["Welcome, ",e.email]}),jsxRuntimeExports.jsx("button",{onClick:o,className:"bg-teal hover:bg-teal-dark px-4 py-2 rounded-md transition duration-200",children:"Logout"}),jsxRuntimeExports.jsx("img",{src:collegeLogo,alt:"College Logo",className:"h-10 w-auto rounded-md shadow-md hover:scale-105 transition"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Link,{to:"/",className:"hover:text-teal transition duration-200",children:"Home"}),jsxRuntimeExports.jsx(Link,{to:"/login?role=student",className:"hover:text-teal transition duration-200",children:"Student Login"}),jsxRuntimeExports.jsx(Link,{to:"/login?role=admin",className:"hover:text-teal transition duration-200",children:"Admin Login"}),jsxRuntimeExports.jsx("img",{src:collegeLogo,alt:"College Logo",className:"h-10 w-auto rounded-md shadow-md hover:scale-105 transition"})]})})]})})})}function Footer(){return jsxRuntimeExports.jsx("footer",{className:"bg-gray-800 text-white py-8",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contact Us"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-400",children:["Email: examcell@college.edu",jsxRuntimeExports.jsx("br",{}),"Phone: +91-XXX-XXX-XXXX",jsxRuntimeExports.jsx("br",{}),"Address: College Campus, City, State"]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-2 text-gray-400",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"/",className:"hover:text-teal transition duration-200",children:"Home"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"/login?role=student",className:"hover:text-teal transition duration-200",children:"Student Portal"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"/login?role=admin",className:"hover:text-teal transition duration-200",children:"Admin Portal"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:"About"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:"Cloud-based academic question paper repository system for secure and organized access to previous year papers."})]})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-gray-700 mt-8 pt-8 text-center text-gray-400",children:jsxRuntimeExports.jsxs("p",{children:[" ",new Date().getFullYear()," Question Paper Repository. All rights reserved."]})})]})})}function Home(){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("main",{className:"flex-1",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-16",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold text-navy mb-6",children:"Academic Cloud Question Paper Repository for Fr. Conceicao Rodrigues of Engineering"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-700 max-w-3xl mx-auto mb-8",children:"A secure cloud-based platform for students to access and download previous year question papers, managed by your college exam cell. Experience the benefits of cloud computing with instant access, organized storage, and seamless availability from anywhere."}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[jsxRuntimeExports.jsx(Link,{to:"/login?role=student",className:"bg-navy text-white px-8 py-3 rounded-lg shadow-lg hover:bg-navy-dark transition duration-200 font-semibold text-lg",children:"Student Login"}),jsxRuntimeExports.jsx(Link,{to:"/login?role=admin",className:"bg-teal text-white px-8 py-3 rounded-lg shadow-lg hover:bg-teal-dark transition duration-200 font-semibold text-lg",children:"Admin Login"})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mb-16",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-4",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-navy mb-2",children:"Organized Access"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"All question papers are organized by branch, year, semester, and exam type for easy navigation."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-4",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-navy mb-2",children:"Cloud Benefits"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Access your papers from anywhere, anytime. No need to carry physical copies or worry about losing them."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-4",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-navy mb-2",children:"Secure & Reliable"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"PRN-based authentication ensures only authorized students can access the repository."})]})]})]})}),jsxRuntimeExports.jsx(Footer,{})]})}const EyeIcon$1=s=>jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",...s,children:[jsxRuntimeExports.jsx("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.18l.88-1.32.88-1.32A1.65 1.65 0 013.8 6.07l.88-1.32.88-1.32A1.65 1.65 0 017.6 2.07l.88-1.32.88-1.32A1.65 1.65 0 0110 0c1.29 0 2.51.56 3.346 1.48l.88 1.32.88 1.32a1.65 1.65 0 011.086 1.63l.88 1.32.88 1.32a1.65 1.65 0 010 1.18l-.88 1.32-.88 1.32a1.65 1.65 0 01-1.086 1.63l-.88 1.32-.88 1.32a1.65 1.65 0 01-1.214.73l-.88 1.32-.88 1.32A1.65 1.65 0 0110 20c-1.29 0-2.51-.56-3.346-1.48l-.88-1.32-.88-1.32a1.65 1.65 0 01-1.086-1.63l-.88-1.32-.88-1.32a1.65 1.65 0 010-1.18zM10 15a5 5 0 100-10 5 5 0 000 10z",clipRule:"evenodd"})]}),EyeSlashIcon$1=s=>jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",...s,children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M3.28 2.22a.75.75 0 00-1.06 1.06l14.5 14.5a.75.75 0 101.06-1.06l-1.72-1.72A8.969 8.969 0 0018.75 10c-1.524-4.572-5.592-7.778-9.75-7.778a9.01 9.01 0 00-2.34.36L3.28 2.22zM10 15a5 5 0 01-5-5c0-.99.284-1.92.78-2.678L7.33 8.87C7.126 9.22 7 9.605 7 10a3 3 0 003 3c.395 0 .78-.126 1.13-.33l1.547 1.547A4.982 4.982 0 0110 15z",clipRule:"evenodd"})});function Login(){const[s,e]=reactExports.useState(""),[i,o]=reactExports.useState(""),[a,j]=reactExports.useState(""),[_e,tt]=reactExports.useState(!1),[et]=useSearchParams(),rt=useNavigate(),dt=et.get("role")||"student",[vt,Ct]=reactExports.useState(!1),Wt=async Bt=>{Bt.preventDefault(),tt(!0);try{let qt=s;if(dt==="student"){if(!a){B$1.error("Please enter your PRN."),tt(!1);return}try{const un=query(collection(db,"users"),where("prn","==",a),limit(1)),dn=await getDocs(un);if(dn.empty){B$1.error("PRN not found. Please contact the exam cell."),tt(!1);return}const hn=dn.docs[0].data();if(!hn.email){B$1.error("Email not found for this PRN. Please contact the exam cell."),tt(!1);return}if(hn.active===!1){B$1.error("Your account has been disabled. Please contact the exam cell."),tt(!1);return}qt=hn.email,e(qt)}catch(un){console.error("Error looking up PRN:",un),B$1.error("Error looking up PRN. Please check your connection."),tt(!1);return}}if(!qt||!i){B$1.error("Please provide all required fields."),tt(!1);return}const Ut=await signInWithEmailAndPassword(auth,qt,i);await new Promise(un=>setTimeout(un,100));const kt=await getDoc(doc(db,"users",Ut.user.uid));if(!kt.exists()){await auth.signOut(),B$1.error("User data not found in database. Please contact support."),tt(!1);return}const Nt=kt.data();if(console.log("User data:",Nt),Nt.active===!1||Nt.active===void 0){await auth.signOut(),B$1.error("Your account has been disabled. Please contact the exam cell."),tt(!1);return}if(Nt.role!==dt){await auth.signOut(),B$1.error(`You are logged in as ${Nt.role}, but this section requires ${dt}.`),tt(!1);return}B$1.success("Login successful!"),setTimeout(()=>{rt(dt==="admin"?"/admin":"/student")},100)}catch(qt){console.error("Login error:",qt),B$1.error(qt.message||"Login failed. Please check your credentials.")}finally{tt(!1)}};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("main",{className:"flex-1 flex items-center justify-center bg-gray-50 py-12",children:jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 w-full max-w-md",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold text-navy mb-2 text-center",children:dt==="admin"?"Admin Login":"Student Login"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-center mb-6",children:dt==="student"?"Enter your PRN and password to access question papers":"Enter your credentials to manage the repository"}),jsxRuntimeExports.jsxs("form",{onSubmit:Wt,className:"space-y-4",children:[dt==="student"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PRN (Permanent Registration Number)"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter your PRN",value:a,onChange:Bt=>j(Bt.target.value),className:"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:dt==="student"?"Email (from student record)":"Email"}),jsxRuntimeExports.jsx("input",{type:"email",placeholder:dt==="student"?"Email (auto-filled)":"Enter your email",value:s,onChange:Bt=>e(Bt.target.value),className:"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",disabled:dt==="student",required:dt==="admin"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:vt?"text":"password",placeholder:"Enter your password",value:i,onChange:Bt=>o(Bt.target.value),className:"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent pr-10",required:!0}),jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 cursor-pointer",onClick:()=>Ct(!vt),children:vt?jsxRuntimeExports.jsx(EyeSlashIcon$1,{className:"h-5 w-5 text-gray-400"}):jsxRuntimeExports.jsx(EyeIcon$1,{className:"h-5 w-5 text-gray-400"})})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-100 p-4 rounded-lg text-sm text-gray-600 text-center",children:" CAPTCHA verification (reCAPTCHA v2 integration)"}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:_e,className:"w-full bg-navy text-white py-3 rounded-lg font-semibold hover:bg-navy-dark transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:_e?"Logging in...":"Login"})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600",children:["Forgot password?"," ",jsxRuntimeExports.jsx("a",{href:"#",className:"text-teal hover:underline",children:"Contact Exam Cell"})]})})]})}),jsxRuntimeExports.jsx(Footer,{})]})}function commonjsRequire(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,i){module.exports=e.pdfjsLib=i()})(globalThis,()=>(()=>{var __webpack_modules__=[,(s,e)=>{var jr;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=Rn,e.bytesToString=er,e.createValidAbsoluteUrl=Fn,e.getModificationDate=mr,e.getUuid=Rr,e.getVerbosityLevel=Ln,e.info=jn,e.isArrayBuffer=qn,e.isArrayEqual=gr,e.isNodeJS=void 0,e.normalizeUnicode=Tr,e.objectFromMap=lr,e.objectSize=or,e.setVerbosityLevel=$n,e.shadow=Tn,e.string32=ar,e.stringToBytes=nr,e.stringToPDFString=sr,e.stringToUTF8String=fr,e.unreachable=Vn,e.utf8StringToString=ur,e.warn=On;const i=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=i;const o=[1,0,0,1,0,0];e.IDENTITY_MATRIX=o;const a=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=a;const j=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=j;const _e=1.35;e.LINE_FACTOR=_e;const tt=.35;e.LINE_DESCENT_FACTOR=tt;const et=tt/_e;e.BASELINE_FACTOR=et;const rt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=rt;const dt={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=dt;const vt="pdfjs_internal_editor_";e.AnnotationEditorPrefix=vt;const Ct={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=Ct;const Wt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=Wt;const Bt={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=Bt;const qt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=qt;const Ut={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=Ut;const kt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=kt;const Nt={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=Nt;const un={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=un;const dn={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=dn;const hn={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=hn;const gn={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=gn;const It={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=It;const pt={O:"PageOpen",C:"PageClose"};e.PageActionEventType=pt;const Dt={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=Dt;const mn={NONE:0,BINARY:1};e.CMapCompressionType=mn;const Lt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=Lt;const yn={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=yn;let fn=Dt.WARNINGS;function $n(hr){Number.isInteger(hr)&&(fn=hr)}function Ln(){return fn}function jn(hr){fn>=Dt.INFOS&&console.log(`Info: ${hr}`)}function On(hr){fn>=Dt.WARNINGS&&console.log(`Warning: ${hr}`)}function Vn(hr){throw new Error(hr)}function Rn(hr,Xn){hr||Vn(Xn)}function Dn(hr){switch(hr==null?void 0:hr.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Fn(hr,Xn=null,Zn=null){if(!hr)return null;try{if(Zn&&typeof hr=="string"){if(Zn.addDefaultProtocol&&hr.startsWith("www.")){const Fr=hr.match(/\./g);(Fr==null?void 0:Fr.length)>=2&&(hr=`http://${hr}`)}if(Zn.tryConvertEncoding)try{hr=fr(hr)}catch{}}const vr=Xn?new URL(hr,Xn):new URL(hr);if(Dn(vr))return vr}catch{}return null}function Tn(hr,Xn,Zn,vr=!1){return Object.defineProperty(hr,Xn,{value:Zn,enumerable:!vr,configurable:!0,writable:!1}),Zn}const pn=function(){function Xn(Zn,vr){this.constructor===Xn&&Vn("Cannot initialize BaseException."),this.message=Zn,this.name=vr}return Xn.prototype=new Error,Xn.constructor=Xn,Xn}();e.BaseException=pn;class En extends pn{constructor(Xn,Zn){super(Xn,"PasswordException"),this.code=Zn}}e.PasswordException=En;class An extends pn{constructor(Xn,Zn){super(Xn,"UnknownErrorException"),this.details=Zn}}e.UnknownErrorException=An;class bn extends pn{constructor(Xn){super(Xn,"InvalidPDFException")}}e.InvalidPDFException=bn;class wn extends pn{constructor(Xn){super(Xn,"MissingPDFException")}}e.MissingPDFException=wn;class Cn extends pn{constructor(Xn,Zn){super(Xn,"UnexpectedResponseException"),this.status=Zn}}e.UnexpectedResponseException=Cn;class Un extends pn{constructor(Xn){super(Xn,"FormatError")}}e.FormatError=Un;class Gn extends pn{constructor(Xn){super(Xn,"AbortException")}}e.AbortException=Gn;function er(hr){(typeof hr!="object"||(hr==null?void 0:hr.length)===void 0)&&Vn("Invalid argument for bytesToString");const Xn=hr.length,Zn=8192;if(Xn<Zn)return String.fromCharCode.apply(null,hr);const vr=[];for(let Fr=0;Fr<Xn;Fr+=Zn){const Lr=Math.min(Fr+Zn,Xn),Nn=hr.subarray(Fr,Lr);vr.push(String.fromCharCode.apply(null,Nn))}return vr.join("")}function nr(hr){typeof hr!="string"&&Vn("Invalid argument for stringToBytes");const Xn=hr.length,Zn=new Uint8Array(Xn);for(let vr=0;vr<Xn;++vr)Zn[vr]=hr.charCodeAt(vr)&255;return Zn}function ar(hr){return String.fromCharCode(hr>>24&255,hr>>16&255,hr>>8&255,hr&255)}function or(hr){return Object.keys(hr).length}function lr(hr){const Xn=Object.create(null);for(const[Zn,vr]of hr)Xn[Zn]=vr;return Xn}function zn(){const hr=new Uint8Array(4);return hr[0]=1,new Uint32Array(hr.buffer,0,1)[0]===1}function Hn(){try{return new Function(""),!0}catch{return!1}}class Pn{static get isLittleEndian(){return Tn(this,"isLittleEndian",zn())}static get isEvalSupported(){return Tn(this,"isEvalSupported",Hn())}static get isOffscreenCanvasSupported(){return Tn(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Tn(this,"platform",{isWin:!1,isMac:!1}):Tn(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Xn,Zn;return Tn(this,"isCSSRoundSupported",(Zn=(Xn=globalThis.CSS)==null?void 0:Xn.supports)==null?void 0:Zn.call(Xn,"width: round(1.5px, 1px)"))}}e.FeatureTest=Pn;const kn=[...Array(256).keys()].map(hr=>hr.toString(16).padStart(2,"0"));class Bn{static makeHexColor(Xn,Zn,vr){return`#${kn[Xn]}${kn[Zn]}${kn[vr]}`}static scaleMinMax(Xn,Zn){let vr;Xn[0]?(Xn[0]<0&&(vr=Zn[0],Zn[0]=Zn[1],Zn[1]=vr),Zn[0]*=Xn[0],Zn[1]*=Xn[0],Xn[3]<0&&(vr=Zn[2],Zn[2]=Zn[3],Zn[3]=vr),Zn[2]*=Xn[3],Zn[3]*=Xn[3]):(vr=Zn[0],Zn[0]=Zn[2],Zn[2]=vr,vr=Zn[1],Zn[1]=Zn[3],Zn[3]=vr,Xn[1]<0&&(vr=Zn[2],Zn[2]=Zn[3],Zn[3]=vr),Zn[2]*=Xn[1],Zn[3]*=Xn[1],Xn[2]<0&&(vr=Zn[0],Zn[0]=Zn[1],Zn[1]=vr),Zn[0]*=Xn[2],Zn[1]*=Xn[2]),Zn[0]+=Xn[4],Zn[1]+=Xn[4],Zn[2]+=Xn[5],Zn[3]+=Xn[5]}static transform(Xn,Zn){return[Xn[0]*Zn[0]+Xn[2]*Zn[1],Xn[1]*Zn[0]+Xn[3]*Zn[1],Xn[0]*Zn[2]+Xn[2]*Zn[3],Xn[1]*Zn[2]+Xn[3]*Zn[3],Xn[0]*Zn[4]+Xn[2]*Zn[5]+Xn[4],Xn[1]*Zn[4]+Xn[3]*Zn[5]+Xn[5]]}static applyTransform(Xn,Zn){const vr=Xn[0]*Zn[0]+Xn[1]*Zn[2]+Zn[4],Fr=Xn[0]*Zn[1]+Xn[1]*Zn[3]+Zn[5];return[vr,Fr]}static applyInverseTransform(Xn,Zn){const vr=Zn[0]*Zn[3]-Zn[1]*Zn[2],Fr=(Xn[0]*Zn[3]-Xn[1]*Zn[2]+Zn[2]*Zn[5]-Zn[4]*Zn[3])/vr,Lr=(-Xn[0]*Zn[1]+Xn[1]*Zn[0]+Zn[4]*Zn[1]-Zn[5]*Zn[0])/vr;return[Fr,Lr]}static getAxialAlignedBoundingBox(Xn,Zn){const vr=this.applyTransform(Xn,Zn),Fr=this.applyTransform(Xn.slice(2,4),Zn),Lr=this.applyTransform([Xn[0],Xn[3]],Zn),Nn=this.applyTransform([Xn[2],Xn[1]],Zn);return[Math.min(vr[0],Fr[0],Lr[0],Nn[0]),Math.min(vr[1],Fr[1],Lr[1],Nn[1]),Math.max(vr[0],Fr[0],Lr[0],Nn[0]),Math.max(vr[1],Fr[1],Lr[1],Nn[1])]}static inverseTransform(Xn){const Zn=Xn[0]*Xn[3]-Xn[1]*Xn[2];return[Xn[3]/Zn,-Xn[1]/Zn,-Xn[2]/Zn,Xn[0]/Zn,(Xn[2]*Xn[5]-Xn[4]*Xn[3])/Zn,(Xn[4]*Xn[1]-Xn[5]*Xn[0])/Zn]}static singularValueDecompose2dScale(Xn){const Zn=[Xn[0],Xn[2],Xn[1],Xn[3]],vr=Xn[0]*Zn[0]+Xn[1]*Zn[2],Fr=Xn[0]*Zn[1]+Xn[1]*Zn[3],Lr=Xn[2]*Zn[0]+Xn[3]*Zn[2],Nn=Xn[2]*Zn[1]+Xn[3]*Zn[3],ir=(vr+Nn)/2,_r=Math.sqrt((vr+Nn)**2-4*(vr*Nn-Lr*Fr))/2,Ar=ir+_r||1,xr=ir-_r||1;return[Math.sqrt(Ar),Math.sqrt(xr)]}static normalizeRect(Xn){const Zn=Xn.slice(0);return Xn[0]>Xn[2]&&(Zn[0]=Xn[2],Zn[2]=Xn[0]),Xn[1]>Xn[3]&&(Zn[1]=Xn[3],Zn[3]=Xn[1]),Zn}static intersect(Xn,Zn){const vr=Math.max(Math.min(Xn[0],Xn[2]),Math.min(Zn[0],Zn[2])),Fr=Math.min(Math.max(Xn[0],Xn[2]),Math.max(Zn[0],Zn[2]));if(vr>Fr)return null;const Lr=Math.max(Math.min(Xn[1],Xn[3]),Math.min(Zn[1],Zn[3])),Nn=Math.min(Math.max(Xn[1],Xn[3]),Math.max(Zn[1],Zn[3]));return Lr>Nn?null:[vr,Lr,Fr,Nn]}static bezierBoundingBox(Xn,Zn,vr,Fr,Lr,Nn,ir,_r){const Ar=[],xr=[[],[]];let Er,xn,Sn,Mn,Qn,rr,cr,pr;for(let Nr=0;Nr<2;++Nr){if(Nr===0?(xn=6*Xn-12*vr+6*Lr,Er=-3*Xn+9*vr-9*Lr+3*ir,Sn=3*vr-3*Xn):(xn=6*Zn-12*Fr+6*Nn,Er=-3*Zn+9*Fr-9*Nn+3*_r,Sn=3*Fr-3*Zn),Math.abs(Er)<1e-12){if(Math.abs(xn)<1e-12)continue;Mn=-Sn/xn,0<Mn&&Mn<1&&Ar.push(Mn);continue}cr=xn*xn-4*Sn*Er,pr=Math.sqrt(cr),!(cr<0)&&(Qn=(-xn+pr)/(2*Er),0<Qn&&Qn<1&&Ar.push(Qn),rr=(-xn-pr)/(2*Er),0<rr&&rr<1&&Ar.push(rr))}let br=Ar.length,Sr;const yr=br;for(;br--;)Mn=Ar[br],Sr=1-Mn,xr[0][br]=Sr*Sr*Sr*Xn+3*Sr*Sr*Mn*vr+3*Sr*Mn*Mn*Lr+Mn*Mn*Mn*ir,xr[1][br]=Sr*Sr*Sr*Zn+3*Sr*Sr*Mn*Fr+3*Sr*Mn*Mn*Nn+Mn*Mn*Mn*_r;return xr[0][yr]=Xn,xr[1][yr]=Zn,xr[0][yr+1]=ir,xr[1][yr+1]=_r,xr[0].length=xr[1].length=yr+2,[Math.min(...xr[0]),Math.min(...xr[1]),Math.max(...xr[0]),Math.max(...xr[1])]}}e.Util=Bn;const Kn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function sr(hr){if(hr[0]>=""){let Zn;if(hr[0]===""&&hr[1]===""?Zn="utf-16be":hr[0]===""&&hr[1]===""?Zn="utf-16le":hr[0]===""&&hr[1]===""&&hr[2]===""&&(Zn="utf-8"),Zn)try{const vr=new TextDecoder(Zn,{fatal:!0}),Fr=nr(hr);return vr.decode(Fr)}catch(vr){On(`stringToPDFString: "${vr}".`)}}const Xn=[];for(let Zn=0,vr=hr.length;Zn<vr;Zn++){const Fr=Kn[hr.charCodeAt(Zn)];Xn.push(Fr?String.fromCharCode(Fr):hr.charAt(Zn))}return Xn.join("")}function fr(hr){return decodeURIComponent(escape(hr))}function ur(hr){return unescape(encodeURIComponent(hr))}function qn(hr){return typeof hr=="object"&&(hr==null?void 0:hr.byteLength)!==void 0}function gr(hr,Xn){if(hr.length!==Xn.length)return!1;for(let Zn=0,vr=hr.length;Zn<vr;Zn++)if(hr[Zn]!==Xn[Zn])return!1;return!0}function mr(hr=new Date){return[hr.getUTCFullYear().toString(),(hr.getUTCMonth()+1).toString().padStart(2,"0"),hr.getUTCDate().toString().padStart(2,"0"),hr.getUTCHours().toString().padStart(2,"0"),hr.getUTCMinutes().toString().padStart(2,"0"),hr.getUTCSeconds().toString().padStart(2,"0")].join("")}class Dr{constructor(){Yn(this,jr,!1);this.promise=new Promise((Xn,Zn)=>{this.resolve=vr=>{Jn(this,jr,!0),Xn(vr)},this.reject=vr=>{Jn(this,jr,!0),Zn(vr)}})}get settled(){return Kt(this,jr)}}jr=new WeakMap,e.PromiseCapability=Dr;let Cr=null,Mr=null;function Tr(hr){return Cr||(Cr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Mr=new Map([["","t"]])),hr.replaceAll(Cr,(Xn,Zn,vr)=>Zn?Zn.normalize("NFKC"):Mr.get(vr))}function Rr(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const hr=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(hr);else for(let Xn=0;Xn<32;Xn++)hr[Xn]=Math.floor(Math.random()*255);return er(hr)}const Or="pdfjs_internal_id_";e.AnnotationPrefix=Or},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var s,i,o,a,gs,Ys,tt,et,rt,dt,vt,Ct,Wt,Bt,qt,Qs,kt,Nt,vo,dn,hn;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(It){if(typeof It=="string"||It instanceof URL?It={url:It}:(0,_util.isArrayBuffer)(It)&&(It={data:It}),typeof It!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!It.url&&!It.data&&!It.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const pt=new PDFDocumentLoadingTask,{docId:Dt}=pt,mn=It.url?getUrlProp(It.url):null,Lt=It.data?getDataProp(It.data):null,yn=It.httpHeaders||null,fn=It.withCredentials===!0,$n=It.password??null,Ln=It.range instanceof PDFDataRangeTransport?It.range:null,jn=Number.isInteger(It.rangeChunkSize)&&It.rangeChunkSize>0?It.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let On=It.worker instanceof PDFWorker?It.worker:null;const Vn=It.verbosity,Rn=typeof It.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(It.docBaseUrl)?It.docBaseUrl:null,Dn=typeof It.cMapUrl=="string"?It.cMapUrl:null,Fn=It.cMapPacked!==!1,Tn=It.CMapReaderFactory||DefaultCMapReaderFactory,pn=typeof It.standardFontDataUrl=="string"?It.standardFontDataUrl:null,En=It.StandardFontDataFactory||DefaultStandardFontDataFactory,An=It.stopAtErrors!==!0,bn=Number.isInteger(It.maxImageSize)&&It.maxImageSize>-1?It.maxImageSize:-1,wn=It.isEvalSupported!==!1,Cn=typeof It.isOffscreenCanvasSupported=="boolean"?It.isOffscreenCanvasSupported:!_util.isNodeJS,Un=Number.isInteger(It.canvasMaxAreaInBytes)?It.canvasMaxAreaInBytes:-1,Gn=typeof It.disableFontFace=="boolean"?It.disableFontFace:_util.isNodeJS,er=It.fontExtraProperties===!0,nr=It.enableXfa===!0,ar=It.ownerDocument||globalThis.document,or=It.disableRange===!0,lr=It.disableStream===!0,zn=It.disableAutoFetch===!0,Hn=It.pdfBug===!0,Pn=Ln?Ln.length:It.length??NaN,kn=typeof It.useSystemFonts=="boolean"?It.useSystemFonts:!_util.isNodeJS&&!Gn,Bn=typeof It.useWorkerFetch=="boolean"?It.useWorkerFetch:Tn===_display_utils.DOMCMapReaderFactory&&En===_display_utils.DOMStandardFontDataFactory&&Dn&&pn&&(0,_display_utils.isValidFetchUrl)(Dn,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(pn,document.baseURI),Kn=It.canvasFactory||new DefaultCanvasFactory({ownerDocument:ar}),sr=It.filterFactory||new DefaultFilterFactory({docId:Dt,ownerDocument:ar}),fr=null;(0,_util.setVerbosityLevel)(Vn);const ur={canvasFactory:Kn,filterFactory:sr};if(Bn||(ur.cMapReaderFactory=new Tn({baseUrl:Dn,isCompressed:Fn}),ur.standardFontDataFactory=new En({baseUrl:pn})),!On){const mr={verbosity:Vn,port:_worker_options.GlobalWorkerOptions.workerPort};On=mr.port?PDFWorker.fromPort(mr):new PDFWorker(mr),pt._worker=On}const qn={docId:Dt,apiVersion:"3.11.174",data:Lt,password:$n,disableAutoFetch:zn,rangeChunkSize:jn,length:Pn,docBaseUrl:Rn,enableXfa:nr,evaluatorOptions:{maxImageSize:bn,disableFontFace:Gn,ignoreErrors:An,isEvalSupported:wn,isOffscreenCanvasSupported:Cn,canvasMaxAreaInBytes:Un,fontExtraProperties:er,useSystemFonts:kn,cMapUrl:Bn?Dn:null,standardFontDataUrl:Bn?pn:null}},gr={ignoreErrors:An,isEvalSupported:wn,disableFontFace:Gn,fontExtraProperties:er,enableXfa:nr,ownerDocument:ar,disableAutoFetch:zn,pdfBug:Hn,styleElement:fr};return On.promise.then(function(){if(pt.destroyed)throw new Error("Loading aborted");const mr=_fetchDocument(On,qn),Dr=new Promise(function(Cr){let Mr;Ln?Mr=new _transport_stream.PDFDataTransportStream({length:Pn,initialData:Ln.initialData,progressiveDone:Ln.progressiveDone,contentDispositionFilename:Ln.contentDispositionFilename,disableRange:or,disableStream:lr},Ln):Lt||(Mr=(Rr=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Rr):(0,_display_utils.isValidFetchUrl)(Rr.url)?new _displayFetch_stream.PDFFetchStream(Rr):new _displayNetwork.PDFNetworkStream(Rr))({url:mn,length:Pn,httpHeaders:yn,withCredentials:fn,rangeChunkSize:jn,disableRange:or,disableStream:lr})),Cr(Mr)});return Promise.all([mr,Dr]).then(function([Cr,Mr]){if(pt.destroyed)throw new Error("Loading aborted");const Tr=new _message_handler.MessageHandler(Dt,Cr,On.port),Rr=new WorkerTransport(Tr,pt,Mr,gr,ur);pt._transport=Rr,Tr.send("Ready",null)})}).catch(pt._capability.reject),pt}async function _fetchDocument(It,pt){if(It.destroyed)throw new Error("Worker was destroyed");const Dt=await It.messageHandler.sendWithPromise("GetDocRequest",pt,pt.data?[pt.data.buffer]:null);if(It.destroyed)throw new Error("Worker was destroyed");return Dt}function getUrlProp(It){if(It instanceof URL)return It.href;try{return new URL(It,window.location).href}catch{if(_util.isNodeJS&&typeof It=="string")return It}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(It){if(_util.isNodeJS&&typeof Buffer<"u"&&It instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(It instanceof Uint8Array&&It.byteLength===It.buffer.byteLength)return It;if(typeof It=="string")return(0,_util.stringToBytes)(It);if(typeof It=="object"&&!isNaN(It==null?void 0:It.length)||(0,_util.isArrayBuffer)(It))return new Uint8Array(It);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Cs(e,s)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var pt,Dt,mn;this.destroyed=!0;try{(pt=this._worker)!=null&&pt.port&&(this._worker._pendingDestroy=!0),await((Dt=this._transport)==null?void 0:Dt.destroy())}catch(Lt){throw(mn=this._worker)!=null&&mn.port&&delete this._worker._pendingDestroy,Lt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};s=new WeakMap,Yn(e,s,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(pt,Dt,mn=!1,Lt=null){this.length=pt,this.initialData=Dt,this.progressiveDone=mn,this.contentDispositionFilename=Lt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(pt){this._rangeListeners.push(pt)}addProgressListener(pt){this._progressListeners.push(pt)}addProgressiveReadListener(pt){this._progressiveReadListeners.push(pt)}addProgressiveDoneListener(pt){this._progressiveDoneListeners.push(pt)}onDataRange(pt,Dt){for(const mn of this._rangeListeners)mn(pt,Dt)}onDataProgress(pt,Dt){this._readyCapability.promise.then(()=>{for(const mn of this._progressListeners)mn(pt,Dt)})}onDataProgressiveRead(pt){this._readyCapability.promise.then(()=>{for(const Dt of this._progressiveReadListeners)Dt(pt)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const pt of this._progressiveDoneListeners)pt()})}transportReady(){this._readyCapability.resolve()}requestDataRange(pt,Dt){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(pt,Dt){this._pdfInfo=pt,this._transport=Dt,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(mn=>{if(!mn)return mn;const Lt=[];for(const yn in mn)Lt.push(...mn[yn]);return Lt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(pt){return this._transport.getPage(pt)}getPageIndex(pt){return this._transport.getPageIndex(pt)}getDestinations(){return this._transport.getDestinations()}getDestination(pt){return this._transport.getDestination(pt)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(pt=!1){return this._transport.startCleanup(pt||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(pt,Dt,mn,Lt=!1){Yn(this,a);Yn(this,i,null);Yn(this,o,!1);this._pageIndex=pt,this._pageInfo=Dt,this._transport=mn,this._stats=Lt?new _display_utils.StatTimer:null,this._pdfBug=Lt,this.commonObjs=mn.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:pt,rotation:Dt=this.rotate,offsetX:mn=0,offsetY:Lt=0,dontFlip:yn=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:pt,rotation:Dt,offsetX:mn,offsetY:Lt,dontFlip:yn})}getAnnotations({intent:pt="display"}={}){const Dt=this._transport.getRenderingIntent(pt);return this._transport.getAnnotations(this._pageIndex,Dt.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var pt;return((pt=this._transport._htmlForXfa)==null?void 0:pt.children[this._pageIndex])||null}render({canvasContext:pt,viewport:Dt,intent:mn="display",annotationMode:Lt=_util.AnnotationMode.ENABLE,transform:yn=null,background:fn=null,optionalContentConfigPromise:$n=null,annotationCanvasMap:Ln=null,pageColors:jn=null,printAnnotationStorage:On=null}){var En,An;(En=this._stats)==null||En.time("Overall");const Vn=this._transport.getRenderingIntent(mn,Lt,On);Jn(this,o,!1),Wn(this,a,Ys).call(this),$n||($n=this._transport.getOptionalContentConfig());let Rn=this._intentStates.get(Vn.cacheKey);Rn||(Rn=Object.create(null),this._intentStates.set(Vn.cacheKey,Rn)),Rn.streamReaderCancelTimeout&&(clearTimeout(Rn.streamReaderCancelTimeout),Rn.streamReaderCancelTimeout=null);const Dn=!!(Vn.renderingIntent&_util.RenderingIntentFlag.PRINT);Rn.displayReadyCapability||(Rn.displayReadyCapability=new _util.PromiseCapability,Rn.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(An=this._stats)==null||An.time("Page Request"),this._pumpOperatorList(Vn));const Fn=bn=>{var wn,Cn;Rn.renderTasks.delete(Tn),(this._maybeCleanupAfterRender||Dn)&&Jn(this,o,!0),Wn(this,a,gs).call(this,!Dn),bn?(Tn.capability.reject(bn),this._abortOperatorList({intentState:Rn,reason:bn instanceof Error?bn:new Error(bn)})):Tn.capability.resolve(),(wn=this._stats)==null||wn.timeEnd("Rendering"),(Cn=this._stats)==null||Cn.timeEnd("Overall")},Tn=new InternalRenderTask({callback:Fn,params:{canvasContext:pt,viewport:Dt,transform:yn,background:fn},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Ln,operatorList:Rn.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Dn,pdfBug:this._pdfBug,pageColors:jn});(Rn.renderTasks||(Rn.renderTasks=new Set)).add(Tn);const pn=Tn.task;return Promise.all([Rn.displayReadyCapability.promise,$n]).then(([bn,wn])=>{var Cn;if(this.destroyed){Fn();return}(Cn=this._stats)==null||Cn.time("Rendering"),Tn.initializeGraphics({transparency:bn,optionalContentConfig:wn}),Tn.operatorListChanged()}).catch(Fn),pn}getOperatorList({intent:pt="display",annotationMode:Dt=_util.AnnotationMode.ENABLE,printAnnotationStorage:mn=null}={}){var Ln;function Lt(){fn.operatorList.lastChunk&&(fn.opListReadCapability.resolve(fn.operatorList),fn.renderTasks.delete($n))}const yn=this._transport.getRenderingIntent(pt,Dt,mn,!0);let fn=this._intentStates.get(yn.cacheKey);fn||(fn=Object.create(null),this._intentStates.set(yn.cacheKey,fn));let $n;return fn.opListReadCapability||($n=Object.create(null),$n.operatorListChanged=Lt,fn.opListReadCapability=new _util.PromiseCapability,(fn.renderTasks||(fn.renderTasks=new Set)).add($n),fn.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Ln=this._stats)==null||Ln.time("Page Request"),this._pumpOperatorList(yn)),fn.opListReadCapability.promise}streamTextContent({includeMarkedContent:pt=!1,disableNormalization:Dt=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:pt===!0,disableNormalization:Dt===!0},{highWaterMark:100,size(Lt){return Lt.items.length}})}getTextContent(pt={}){if(this._transport._htmlForXfa)return this.getXfa().then(mn=>_xfa_text.XfaText.textContent(mn));const Dt=this.streamTextContent(pt);return new Promise(function(mn,Lt){function yn(){fn.read().then(function({value:Ln,done:jn}){if(jn){mn($n);return}Object.assign($n.styles,Ln.styles),$n.items.push(...Ln.items),yn()},Lt)}const fn=Dt.getReader(),$n={items:[],styles:Object.create(null)};yn()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const pt=[];for(const Dt of this._intentStates.values())if(this._abortOperatorList({intentState:Dt,reason:new Error("Page was destroyed."),force:!0}),!Dt.opListReadCapability)for(const mn of Dt.renderTasks)pt.push(mn.completed),mn.cancel();return this.objs.clear(),Jn(this,o,!1),Wn(this,a,Ys).call(this),Promise.all(pt)}cleanup(pt=!1){Jn(this,o,!0);const Dt=Wn(this,a,gs).call(this,!1);return pt&&Dt&&this._stats&&(this._stats=new _display_utils.StatTimer),Dt}_startRenderPage(pt,Dt){var Lt,yn;const mn=this._intentStates.get(Dt);mn&&((Lt=this._stats)==null||Lt.timeEnd("Page Request"),(yn=mn.displayReadyCapability)==null||yn.resolve(pt))}_renderPageChunk(pt,Dt){for(let mn=0,Lt=pt.length;mn<Lt;mn++)Dt.operatorList.fnArray.push(pt.fnArray[mn]),Dt.operatorList.argsArray.push(pt.argsArray[mn]);Dt.operatorList.lastChunk=pt.lastChunk,Dt.operatorList.separateAnnots=pt.separateAnnots;for(const mn of Dt.renderTasks)mn.operatorListChanged();pt.lastChunk&&Wn(this,a,gs).call(this,!0)}_pumpOperatorList({renderingIntent:pt,cacheKey:Dt,annotationStorageSerializable:mn}){const{map:Lt,transfers:yn}=mn,$n=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:pt,cacheKey:Dt,annotationStorage:Lt},yn).getReader(),Ln=this._intentStates.get(Dt);Ln.streamReader=$n;const jn=()=>{$n.read().then(({value:On,done:Vn})=>{if(Vn){Ln.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(On,Ln),jn())},On=>{if(Ln.streamReader=null,!this._transport.destroyed){if(Ln.operatorList){Ln.operatorList.lastChunk=!0;for(const Vn of Ln.renderTasks)Vn.operatorListChanged();Wn(this,a,gs).call(this,!0)}if(Ln.displayReadyCapability)Ln.displayReadyCapability.reject(On);else if(Ln.opListReadCapability)Ln.opListReadCapability.reject(On);else throw On}})};jn()}_abortOperatorList({intentState:pt,reason:Dt,force:mn=!1}){if(pt.streamReader){if(pt.streamReaderCancelTimeout&&(clearTimeout(pt.streamReaderCancelTimeout),pt.streamReaderCancelTimeout=null),!mn){if(pt.renderTasks.size>0)return;if(Dt instanceof _display_utils.RenderingCancelledException){let Lt=RENDERING_CANCELLED_TIMEOUT;Dt.extraDelay>0&&Dt.extraDelay<1e3&&(Lt+=Dt.extraDelay),pt.streamReaderCancelTimeout=setTimeout(()=>{pt.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:pt,reason:Dt,force:!0})},Lt);return}}if(pt.streamReader.cancel(new _util.AbortException(Dt.message)).catch(()=>{}),pt.streamReader=null,!this._transport.destroyed){for(const[Lt,yn]of this._intentStates)if(yn===pt){this._intentStates.delete(Lt);break}this.cleanup()}}}get stats(){return this._stats}}i=new WeakMap,o=new WeakMap,a=new WeakSet,gs=function(pt=!1){if(Wn(this,a,Ys).call(this),!Kt(this,o)||this.destroyed)return!1;if(pt)return Jn(this,i,setTimeout(()=>{Jn(this,i,null),Wn(this,a,gs).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:Dt,operatorList:mn}of this._intentStates.values())if(Dt.size>0||!mn.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Jn(this,o,!1),!0},Ys=function(){Kt(this,i)&&(clearTimeout(Kt(this,i)),Jn(this,i,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Yn(this,tt,new Set);Yn(this,et,Promise.resolve())}postMessage(pt,Dt){const mn={data:structuredClone(pt,Dt?{transfer:Dt}:null)};Kt(this,et).then(()=>{for(const Lt of Kt(this,tt))Lt.call(this,mn)})}addEventListener(pt,Dt){Kt(this,tt).add(Dt)}removeEventListener(pt,Dt){Kt(this,tt).delete(Dt)}terminate(){Kt(this,tt).clear()}}tt=new WeakMap,et=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const It=(rt=document==null?void 0:document.currentScript)==null?void 0:rt.src;It&&(PDFWorkerUtil.fallbackWorkerSrc=It.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(It,pt){let Dt;try{if(Dt=new URL(It),!Dt.origin||Dt.origin==="null")return!1}catch{return!1}const mn=new URL(pt,Dt);return Dt.origin===mn.origin},PDFWorkerUtil.createCDNWrapper=function(It){const pt=`importScripts("${It}");`;return URL.createObjectURL(new Blob([pt]))}}const _PDFWorker=class _PDFWorker{constructor({name:It=null,port:pt=null,verbosity:Dt=(0,_util.getVerbosityLevel)()}={}){var mn;if(this.name=It,this.destroyed=!1,this.verbosity=Dt,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,pt){if((mn=Kt(_PDFWorker,dt))!=null&&mn.has(pt))throw new Error("Cannot use more than one PDFWorker per port.");(Kt(_PDFWorker,dt)||Jn(_PDFWorker,dt,new WeakMap)).set(pt,this),this._initializeFromPort(pt);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(It){this._port=It,this._messageHandler=new _message_handler.MessageHandler("main","worker",It),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:It}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,It)||(It=PDFWorkerUtil.createCDNWrapper(new URL(It,window.location).href));const pt=new Worker(It),Dt=new _message_handler.MessageHandler("main","worker",pt),mn=()=>{pt.removeEventListener("error",Lt),Dt.destroy(),pt.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Lt=()=>{this._webWorker||mn()};pt.addEventListener("error",Lt),Dt.on("test",fn=>{if(pt.removeEventListener("error",Lt),this.destroyed){mn();return}fn?(this._messageHandler=Dt,this._port=pt,this._webWorker=pt,this._readyCapability.resolve(),Dt.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),Dt.destroy(),pt.terminate())}),Dt.on("ready",fn=>{if(pt.removeEventListener("error",Lt),this.destroyed){mn();return}try{yn()}catch{this._setupFakeWorker()}});const yn=()=>{const fn=new Uint8Array;Dt.send("test",fn,[fn.buffer])};yn();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(It=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const pt=new LoopbackPort;this._port=pt;const Dt=`fake${PDFWorkerUtil.fakeWorkerId++}`,mn=new _message_handler.MessageHandler(Dt+"_worker",Dt,pt);It.setup(mn,pt);const Lt=new _message_handler.MessageHandler(Dt,Dt+"_worker",pt);this._messageHandler=Lt,this._readyCapability.resolve(),Lt.send("configure",{verbosity:this.verbosity})}).catch(It=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${It.message}".`))})}destroy(){var It;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(It=Kt(_PDFWorker,dt))==null||It.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(It){var Dt;if(!(It!=null&&It.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const pt=(Dt=Kt(this,dt))==null?void 0:Dt.get(It.port);if(pt){if(pt._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return pt}return new _PDFWorker(It)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var It;try{return((It=globalThis.pdfjsWorker)==null?void 0:It.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};dt=new WeakMap,Yn(_PDFWorker,dt);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(pt,Dt,mn,Lt,yn){Yn(this,qt);Yn(this,vt,new Map);Yn(this,Ct,new Map);Yn(this,Wt,new Map);Yn(this,Bt,null);this.messageHandler=pt,this.loadingTask=Dt,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Lt.ownerDocument,styleElement:Lt.styleElement}),this._params=Lt,this.canvasFactory=yn.canvasFactory,this.filterFactory=yn.filterFactory,this.cMapReaderFactory=yn.cMapReaderFactory,this.standardFontDataFactory=yn.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=mn,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(pt,Dt=_util.AnnotationMode.ENABLE,mn=null,Lt=!1){let yn=_util.RenderingIntentFlag.DISPLAY,fn=_annotation_storage.SerializableEmpty;switch(pt){case"any":yn=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":yn=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${pt}`)}switch(Dt){case _util.AnnotationMode.DISABLE:yn+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:yn+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:yn+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,fn=(yn&_util.RenderingIntentFlag.PRINT&&mn instanceof _annotation_storage.PrintAnnotationStorage?mn:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${Dt}`)}return Lt&&(yn+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:yn,cacheKey:`${yn}_${fn.hash}`,annotationStorageSerializable:fn}}destroy(){var mn;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(mn=Kt(this,Bt))==null||mn.reject(new Error("Worker was destroyed during onPassword callback"));const pt=[];for(const Lt of Kt(this,Ct).values())pt.push(Lt._destroy());Kt(this,Ct).clear(),Kt(this,Wt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const Dt=this.messageHandler.sendWithPromise("Terminate",null);return pt.push(Dt),Promise.all(pt).then(()=>{var Lt;this.commonObjs.clear(),this.fontLoader.clear(),Kt(this,vt).clear(),this.filterFactory.destroy(),(Lt=this._networkStream)==null||Lt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:pt,loadingTask:Dt}=this;pt.on("GetReader",(mn,Lt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=yn=>{this._lastProgress={loaded:yn.loaded,total:yn.total}},Lt.onPull=()=>{this._fullReader.read().then(function({value:yn,done:fn}){if(fn){Lt.close();return}(0,_util.assert)(yn instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Lt.enqueue(new Uint8Array(yn),1,[yn])}).catch(yn=>{Lt.error(yn)})},Lt.onCancel=yn=>{this._fullReader.cancel(yn),Lt.ready.catch(fn=>{if(!this.destroyed)throw fn})}}),pt.on("ReaderHeadersReady",mn=>{const Lt=new _util.PromiseCapability,yn=this._fullReader;return yn.headersReady.then(()=>{var fn;(!yn.isStreamingSupported||!yn.isRangeSupported)&&(this._lastProgress&&((fn=Dt.onProgress)==null||fn.call(Dt,this._lastProgress)),yn.onProgress=$n=>{var Ln;(Ln=Dt.onProgress)==null||Ln.call(Dt,{loaded:$n.loaded,total:$n.total})}),Lt.resolve({isStreamingSupported:yn.isStreamingSupported,isRangeSupported:yn.isRangeSupported,contentLength:yn.contentLength})},Lt.reject),Lt.promise}),pt.on("GetRangeReader",(mn,Lt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const yn=this._networkStream.getRangeReader(mn.begin,mn.end);if(!yn){Lt.close();return}Lt.onPull=()=>{yn.read().then(function({value:fn,done:$n}){if($n){Lt.close();return}(0,_util.assert)(fn instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Lt.enqueue(new Uint8Array(fn),1,[fn])}).catch(fn=>{Lt.error(fn)})},Lt.onCancel=fn=>{yn.cancel(fn),Lt.ready.catch($n=>{if(!this.destroyed)throw $n})}}),pt.on("GetDoc",({pdfInfo:mn})=>{this._numPages=mn.numPages,this._htmlForXfa=mn.htmlForXfa,delete mn.htmlForXfa,Dt._capability.resolve(new PDFDocumentProxy(mn,this))}),pt.on("DocException",function(mn){let Lt;switch(mn.name){case"PasswordException":Lt=new _util.PasswordException(mn.message,mn.code);break;case"InvalidPDFException":Lt=new _util.InvalidPDFException(mn.message);break;case"MissingPDFException":Lt=new _util.MissingPDFException(mn.message);break;case"UnexpectedResponseException":Lt=new _util.UnexpectedResponseException(mn.message,mn.status);break;case"UnknownErrorException":Lt=new _util.UnknownErrorException(mn.message,mn.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}Dt._capability.reject(Lt)}),pt.on("PasswordRequest",mn=>{if(Jn(this,Bt,new _util.PromiseCapability),Dt.onPassword){const Lt=yn=>{yn instanceof Error?Kt(this,Bt).reject(yn):Kt(this,Bt).resolve({password:yn})};try{Dt.onPassword(Lt,mn.code)}catch(yn){Kt(this,Bt).reject(yn)}}else Kt(this,Bt).reject(new _util.PasswordException(mn.message,mn.code));return Kt(this,Bt).promise}),pt.on("DataLoaded",mn=>{var Lt;(Lt=Dt.onProgress)==null||Lt.call(Dt,{loaded:mn.length,total:mn.length}),this.downloadInfoCapability.resolve(mn)}),pt.on("StartRenderPage",mn=>{if(this.destroyed)return;Kt(this,Ct).get(mn.pageIndex)._startRenderPage(mn.transparency,mn.cacheKey)}),pt.on("commonobj",([mn,Lt,yn])=>{var fn;if(!this.destroyed&&!this.commonObjs.has(mn))switch(Lt){case"Font":const $n=this._params;if("error"in yn){const On=yn.error;(0,_util.warn)(`Error during font loading: ${On}`),this.commonObjs.resolve(mn,On);break}const Ln=$n.pdfBug&&((fn=globalThis.FontInspector)!=null&&fn.enabled)?(On,Vn)=>globalThis.FontInspector.fontAdded(On,Vn):null,jn=new _font_loader.FontFaceObject(yn,{isEvalSupported:$n.isEvalSupported,disableFontFace:$n.disableFontFace,ignoreErrors:$n.ignoreErrors,inspectFont:Ln});this.fontLoader.bind(jn).catch(On=>pt.sendWithPromise("FontFallback",{id:mn})).finally(()=>{!$n.fontExtraProperties&&jn.data&&(jn.data=null),this.commonObjs.resolve(mn,jn)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(mn,yn);break;default:throw new Error(`Got unknown common object type ${Lt}`)}}),pt.on("obj",([mn,Lt,yn,fn])=>{var Ln;if(this.destroyed)return;const $n=Kt(this,Ct).get(Lt);if(!$n.objs.has(mn))switch(yn){case"Image":if($n.objs.resolve(mn,fn),fn){let jn;if(fn.bitmap){const{width:On,height:Vn}=fn;jn=On*Vn*4}else jn=((Ln=fn.data)==null?void 0:Ln.length)||0;jn>_util.MAX_IMAGE_SIZE_TO_CACHE&&($n._maybeCleanupAfterRender=!0)}break;case"Pattern":$n.objs.resolve(mn,fn);break;default:throw new Error(`Got unknown object type ${yn}`)}}),pt.on("DocProgress",mn=>{var Lt;this.destroyed||(Lt=Dt.onProgress)==null||Lt.call(Dt,{loaded:mn.loaded,total:mn.total})}),pt.on("FetchBuiltInCMap",mn=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(mn):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),pt.on("FetchStandardFontData",mn=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(mn):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var mn;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:pt,transfers:Dt}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:pt,filename:((mn=this._fullReader)==null?void 0:mn.filename)??null},Dt).finally(()=>{this.annotationStorage.resetModified()})}getPage(pt){if(!Number.isInteger(pt)||pt<=0||pt>this._numPages)return Promise.reject(new Error("Invalid page request."));const Dt=pt-1,mn=Kt(this,Wt).get(Dt);if(mn)return mn;const Lt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:Dt}).then(yn=>{if(this.destroyed)throw new Error("Transport destroyed");const fn=new PDFPageProxy(Dt,yn,this,this._params.pdfBug);return Kt(this,Ct).set(Dt,fn),fn});return Kt(this,Wt).set(Dt,Lt),Lt}getPageIndex(pt){return typeof pt!="object"||pt===null||!Number.isInteger(pt.num)||pt.num<0||!Number.isInteger(pt.gen)||pt.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:pt.num,gen:pt.gen})}getAnnotations(pt,Dt){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:pt,intent:Dt})}getFieldObjects(){return Wn(this,qt,Qs).call(this,"GetFieldObjects")}hasJSActions(){return Wn(this,qt,Qs).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(pt){return typeof pt!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:pt})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Wn(this,qt,Qs).call(this,"GetDocJSActions")}getPageJSActions(pt){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:pt})}getStructTree(pt){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:pt})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(pt=>new _optional_content_config.OptionalContentConfig(pt))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const pt="GetMetadata",Dt=Kt(this,vt).get(pt);if(Dt)return Dt;const mn=this.messageHandler.sendWithPromise(pt,null).then(Lt=>{var yn,fn;return{info:Lt[0],metadata:Lt[1]?new _metadata.Metadata(Lt[1]):null,contentDispositionFilename:((yn=this._fullReader)==null?void 0:yn.filename)??null,contentLength:((fn=this._fullReader)==null?void 0:fn.contentLength)??null}});return Kt(this,vt).set(pt,mn),mn}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(pt=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const Dt of Kt(this,Ct).values())if(!Dt.cleanup())throw new Error(`startCleanup: Page ${Dt.pageNumber} is currently rendering.`);this.commonObjs.clear(),pt||this.fontLoader.clear(),Kt(this,vt).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:pt,enableXfa:Dt}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:pt,enableXfa:Dt})}}vt=new WeakMap,Ct=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,qt=new WeakSet,Qs=function(pt,Dt=null){const mn=Kt(this,vt).get(pt);if(mn)return mn;const Lt=this.messageHandler.sendWithPromise(pt,Dt);return Kt(this,vt).set(pt,Lt),Lt};class PDFObjects{constructor(){Yn(this,Nt);Yn(this,kt,Object.create(null))}get(pt,Dt=null){if(Dt){const Lt=Wn(this,Nt,vo).call(this,pt);return Lt.capability.promise.then(()=>Dt(Lt.data)),null}const mn=Kt(this,kt)[pt];if(!(mn!=null&&mn.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${pt}.`);return mn.data}has(pt){const Dt=Kt(this,kt)[pt];return(Dt==null?void 0:Dt.capability.settled)||!1}resolve(pt,Dt=null){const mn=Wn(this,Nt,vo).call(this,pt);mn.data=Dt,mn.capability.resolve()}clear(){var pt;for(const Dt in Kt(this,kt)){const{data:mn}=Kt(this,kt)[Dt];(pt=mn==null?void 0:mn.bitmap)==null||pt.close()}Jn(this,kt,Object.create(null))}}kt=new WeakMap,Nt=new WeakSet,vo=function(pt){var Dt;return(Dt=Kt(this,kt))[pt]||(Dt[pt]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(pt){Yn(this,dn,null);Jn(this,dn,pt),this.onContinue=null}get promise(){return Kt(this,dn).capability.promise}cancel(pt=0){Kt(this,dn).cancel(null,pt)}get separateAnnots(){const{separateAnnots:pt}=Kt(this,dn).operatorList;if(!pt)return!1;const{annotationCanvasMap:Dt}=Kt(this,dn);return pt.form||pt.canvas&&(Dt==null?void 0:Dt.size)>0}}dn=new WeakMap,exports.RenderTask=RenderTask;const gn=class gn{constructor({callback:pt,params:Dt,objs:mn,commonObjs:Lt,annotationCanvasMap:yn,operatorList:fn,pageIndex:$n,canvasFactory:Ln,filterFactory:jn,useRequestAnimationFrame:On=!1,pdfBug:Vn=!1,pageColors:Rn=null}){this.callback=pt,this.params=Dt,this.objs=mn,this.commonObjs=Lt,this.annotationCanvasMap=yn,this.operatorListIdx=null,this.operatorList=fn,this._pageIndex=$n,this.canvasFactory=Ln,this.filterFactory=jn,this._pdfBug=Vn,this.pageColors=Rn,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=On===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=Dt.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:pt=!1,optionalContentConfig:Dt}){var $n,Ln;if(this.cancelled)return;if(this._canvas){if(Kt(gn,hn).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Kt(gn,hn).add(this._canvas)}this._pdfBug&&(($n=globalThis.StepperManager)!=null&&$n.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:mn,viewport:Lt,transform:yn,background:fn}=this.params;this.gfx=new _canvas.CanvasGraphics(mn,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:Dt},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:yn,viewport:Lt,transparency:pt,background:fn}),this.operatorListIdx=0,this.graphicsReady=!0,(Ln=this.graphicsReadyCallback)==null||Ln.call(this)}cancel(pt=null,Dt=0){var mn;this.running=!1,this.cancelled=!0,(mn=this.gfx)==null||mn.endDrawing(),Kt(gn,hn).delete(this._canvas),this.callback(pt||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,Dt))}operatorListChanged(){var pt;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(pt=this.stepper)==null||pt.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Kt(gn,hn).delete(this._canvas),this.callback())))}};hn=new WeakMap,Yn(gn,hn,new WeakSet);let InternalRenderTask=gn;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(s,e,i)=>{var rt,dt,vt,Ql,Wt;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var o=i(1),a=i(4),j=i(8);const _e=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=_e;class tt{constructor(){Yn(this,vt);Yn(this,rt,!1);Yn(this,dt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(qt,Ut){const kt=Kt(this,dt).get(qt);return kt===void 0?Ut:Object.assign(Ut,kt)}getRawValue(qt){return Kt(this,dt).get(qt)}remove(qt){if(Kt(this,dt).delete(qt),Kt(this,dt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Ut of Kt(this,dt).values())if(Ut instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(qt,Ut){const kt=Kt(this,dt).get(qt);let Nt=!1;if(kt!==void 0)for(const[un,dn]of Object.entries(Ut))kt[un]!==dn&&(Nt=!0,kt[un]=dn);else Nt=!0,Kt(this,dt).set(qt,Ut);Nt&&Wn(this,vt,Ql).call(this),Ut instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Ut.constructor._type)}has(qt){return Kt(this,dt).has(qt)}getAll(){return Kt(this,dt).size>0?(0,o.objectFromMap)(Kt(this,dt)):null}setAll(qt){for(const[Ut,kt]of Object.entries(qt))this.setValue(Ut,kt)}get size(){return Kt(this,dt).size}resetModified(){Kt(this,rt)&&(Jn(this,rt,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new et(this)}get serializable(){if(Kt(this,dt).size===0)return _e;const qt=new Map,Ut=new j.MurmurHash3_64,kt=[],Nt=Object.create(null);let un=!1;for(const[dn,hn]of Kt(this,dt)){const gn=hn instanceof a.AnnotationEditor?hn.serialize(!1,Nt):hn;gn&&(qt.set(dn,gn),Ut.update(`${dn}:${JSON.stringify(gn)}`),un||(un=!!gn.bitmap))}if(un)for(const dn of qt.values())dn.bitmap&&kt.push(dn.bitmap);return qt.size>0?{map:qt,hash:Ut.hexdigest(),transfers:kt}:_e}}rt=new WeakMap,dt=new WeakMap,vt=new WeakSet,Ql=function(){Kt(this,rt)||(Jn(this,rt,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=tt;class et extends tt{constructor(Ut){super();Yn(this,Wt);const{map:kt,hash:Nt,transfers:un}=Ut.serializable,dn=structuredClone(kt,un?{transfer:un}:null);Jn(this,Wt,{map:dn,hash:Nt,transfers:un})}get print(){(0,o.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return Kt(this,Wt)}}Wt=new WeakMap,e.PrintAnnotationStorage=et},(s,e,i)=>{var et,rt,dt,vt,Ct,Wt,Bt,qt,Ut,kt,Nt,un,dn,hn,gn,Ao,To,Dt,Ro,Po,Jl,Zl,_c,So,eu;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var o=i(5),a=i(1),j=i(6);const On=class On{constructor(Rn){Yn(this,gn);Yn(this,et,"");Yn(this,rt,!1);Yn(this,dt,null);Yn(this,vt,null);Yn(this,Ct,null);Yn(this,Wt,!1);Yn(this,Bt,null);Yn(this,qt,this.focusin.bind(this));Yn(this,Ut,this.focusout.bind(this));Yn(this,kt,!1);Yn(this,Nt,!1);Yn(this,un,!1);zr(this,"_initialOptions",Object.create(null));zr(this,"_uiManager",null);zr(this,"_focusEventsAllowed",!0);zr(this,"_l10nPromise",null);Yn(this,dn,!1);Yn(this,hn,On._zIndex++);this.constructor===On&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Rn.parent,this.id=Rn.id,this.width=this.height=null,this.pageIndex=Rn.parent.pageIndex,this.name=Rn.name,this.div=null,this._uiManager=Rn.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Rn.isCentered,this._structTreeParentId=null;const{rotation:Dn,rawDims:{pageWidth:Fn,pageHeight:Tn,pageX:pn,pageY:En}}=this.parent.viewport;this.rotation=Dn,this.pageRotation=(360+Dn-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Fn,Tn],this.pageTranslation=[pn,En];const[An,bn]=this.parentDimensions;this.x=Rn.x/An,this.y=Rn.y/bn,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Rn){const Dn=new tt({id:Rn.parent.getNextId(),parent:Rn.parent,uiManager:Rn._uiManager});Dn.annotationElementId=Rn.annotationElementId,Dn.deleted=!0,Dn._uiManager.addToAnnotationStorage(Dn)}static initialize(Rn,Dn=null){if(On._l10nPromise||(On._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Tn=>[Tn,Rn.get(Tn)]))),Dn!=null&&Dn.strings)for(const Tn of Dn.strings)On._l10nPromise.set(Tn,Rn.get(Tn));if(On._borderLineWidth!==-1)return;const Fn=getComputedStyle(document.documentElement);On._borderLineWidth=parseFloat(Fn.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Rn,Dn){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Rn){return!1}static paste(Rn,Dn){(0,a.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return Kt(this,dn)}set _isDraggable(Rn){var Dn;Jn(this,dn,Rn),(Dn=this.div)==null||Dn.classList.toggle("draggable",Rn)}center(){const[Rn,Dn]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Dn/(Rn*2),this.y+=this.width*Rn/(Dn*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Dn/(Rn*2),this.y-=this.width*Rn/(Dn*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Rn){this._uiManager.addCommands(Rn)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Kt(this,hn)}setParent(Rn){Rn!==null&&(this.pageIndex=Rn.pageIndex,this.pageDimensions=Rn.pageDimensions),this.parent=Rn}focusin(Rn){this._focusEventsAllowed&&(Kt(this,kt)?Jn(this,kt,!1):this.parent.setSelected(this))}focusout(Rn){var Fn;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Dn=Rn.relatedTarget;Dn!=null&&Dn.closest(`#${this.id}`)||(Rn.preventDefault(),(Fn=this.parent)!=null&&Fn.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Rn,Dn,Fn,Tn){const[pn,En]=this.parentDimensions;[Fn,Tn]=this.screenToPageTranslation(Fn,Tn),this.x=(Rn+Fn)/pn,this.y=(Dn+Tn)/En,this.fixAndSetPosition()}translate(Rn,Dn){Wn(this,gn,Ao).call(this,this.parentDimensions,Rn,Dn)}translateInPage(Rn,Dn){Wn(this,gn,Ao).call(this,this.pageDimensions,Rn,Dn),this.div.scrollIntoView({block:"nearest"})}drag(Rn,Dn){const[Fn,Tn]=this.parentDimensions;if(this.x+=Rn/Fn,this.y+=Dn/Tn,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:wn,y:Cn}=this.div.getBoundingClientRect();this.parent.findNewParent(this,wn,Cn)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:pn,y:En}=this;const[An,bn]=Wn(this,gn,To).call(this);pn+=An,En+=bn,this.div.style.left=`${(100*pn).toFixed(2)}%`,this.div.style.top=`${(100*En).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[Rn,Dn]=this.pageDimensions;let{x:Fn,y:Tn,width:pn,height:En}=this;switch(pn*=Rn,En*=Dn,Fn*=Rn,Tn*=Dn,this.rotation){case 0:Fn=Math.max(0,Math.min(Rn-pn,Fn)),Tn=Math.max(0,Math.min(Dn-En,Tn));break;case 90:Fn=Math.max(0,Math.min(Rn-En,Fn)),Tn=Math.min(Dn,Math.max(pn,Tn));break;case 180:Fn=Math.min(Rn,Math.max(pn,Fn)),Tn=Math.min(Dn,Math.max(En,Tn));break;case 270:Fn=Math.min(Rn,Math.max(En,Fn)),Tn=Math.max(0,Math.min(Dn-pn,Tn));break}this.x=Fn/=Rn,this.y=Tn/=Dn;const[An,bn]=Wn(this,gn,To).call(this);Fn+=An,Tn+=bn;const{style:wn}=this.div;wn.left=`${(100*Fn).toFixed(2)}%`,wn.top=`${(100*Tn).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Rn,Dn){var Fn;return Wn(Fn=On,Dt,Ro).call(Fn,Rn,Dn,this.parentRotation)}pageTranslationToScreen(Rn,Dn){var Fn;return Wn(Fn=On,Dt,Ro).call(Fn,Rn,Dn,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Rn,pageDimensions:[Dn,Fn]}=this,Tn=Dn*Rn,pn=Fn*Rn;return a.FeatureTest.isCSSRoundSupported?[Math.round(Tn),Math.round(pn)]:[Tn,pn]}setDims(Rn,Dn){var pn;const[Fn,Tn]=this.parentDimensions;this.div.style.width=`${(100*Rn/Fn).toFixed(2)}%`,Kt(this,Wt)||(this.div.style.height=`${(100*Dn/Tn).toFixed(2)}%`),(pn=Kt(this,dt))==null||pn.classList.toggle("small",Rn<On.SMALL_EDITOR_SIZE||Dn<On.SMALL_EDITOR_SIZE)}fixDims(){const{style:Rn}=this.div,{height:Dn,width:Fn}=Rn,Tn=Fn.endsWith("%"),pn=!Kt(this,Wt)&&Dn.endsWith("%");if(Tn&&pn)return;const[En,An]=this.parentDimensions;Tn||(Rn.width=`${(100*parseFloat(Fn)/En).toFixed(2)}%`),!Kt(this,Wt)&&!pn&&(Rn.height=`${(100*parseFloat(Dn)/An).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(Kt(this,dt))return;const Rn=Jn(this,dt,document.createElement("button"));Rn.className="altText";const Dn=await On._l10nPromise.get("editor_alt_text_button_label");Rn.textContent=Dn,Rn.setAttribute("aria-label",Dn),Rn.tabIndex="0",Rn.addEventListener("contextmenu",j.noContextMenu),Rn.addEventListener("pointerdown",Fn=>Fn.stopPropagation()),Rn.addEventListener("click",Fn=>{Fn.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Rn.addEventListener("keydown",Fn=>{Fn.target===Rn&&Fn.key==="Enter"&&(Fn.preventDefault(),this._uiManager.editAltText(this))}),Wn(this,gn,So).call(this),this.div.append(Rn),On.SMALL_EDITOR_SIZE||(On.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Rn.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:Kt(this,et),decorative:Kt(this,rt)}}set altTextData({altText:Rn,decorative:Dn}){Kt(this,et)===Rn&&Kt(this,rt)===Dn||(Jn(this,et,Rn),Jn(this,rt,Dn),Wn(this,gn,So).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",Kt(this,qt)),this.div.addEventListener("focusout",Kt(this,Ut));const[Rn,Dn]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Dn/Rn).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Rn/Dn).toFixed(2)}%`);const[Fn,Tn]=this.getInitialTranslation();return this.translate(Fn,Tn),(0,o.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Rn){const{isMac:Dn}=a.FeatureTest.platform;if(Rn.button!==0||Rn.ctrlKey&&Dn){Rn.preventDefault();return}Jn(this,kt,!0),Wn(this,gn,eu).call(this,Rn)}moveInDOM(){var Rn;(Rn=this.parent)==null||Rn.moveEditorInDOM(this)}_setParentAndPosition(Rn,Dn,Fn){Rn.changeParent(this),this.x=Dn,this.y=Fn,this.fixAndSetPosition()}getRect(Rn,Dn){const Fn=this.parentScale,[Tn,pn]=this.pageDimensions,[En,An]=this.pageTranslation,bn=Rn/Fn,wn=Dn/Fn,Cn=this.x*Tn,Un=this.y*pn,Gn=this.width*Tn,er=this.height*pn;switch(this.rotation){case 0:return[Cn+bn+En,pn-Un-wn-er+An,Cn+bn+Gn+En,pn-Un-wn+An];case 90:return[Cn+wn+En,pn-Un+bn+An,Cn+wn+er+En,pn-Un+bn+Gn+An];case 180:return[Cn-bn-Gn+En,pn-Un+wn+An,Cn-bn+En,pn-Un+wn+er+An];case 270:return[Cn-wn-er+En,pn-Un-bn-Gn+An,Cn-wn+En,pn-Un-bn+An];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Rn,Dn){const[Fn,Tn,pn,En]=Rn,An=pn-Fn,bn=En-Tn;switch(this.rotation){case 0:return[Fn,Dn-En,An,bn];case 90:return[Fn,Dn-Tn,bn,An];case 180:return[pn,Dn-Tn,An,bn];case 270:return[pn,Dn-En,bn,An];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Jn(this,un,!0)}disableEditMode(){Jn(this,un,!1)}isInEditMode(){return Kt(this,un)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Rn,Dn;(Rn=this.div)==null||Rn.addEventListener("focusin",Kt(this,qt)),(Dn=this.div)==null||Dn.addEventListener("focusout",Kt(this,Ut))}serialize(Rn=!1,Dn=null){(0,a.unreachable)("An editor must be serializable")}static deserialize(Rn,Dn,Fn){const Tn=new this.prototype.constructor({parent:Dn,id:Dn.getNextId(),uiManager:Fn});Tn.rotation=Rn.rotation;const[pn,En]=Tn.pageDimensions,[An,bn,wn,Cn]=Tn.getRectInCurrentCoords(Rn.rect,En);return Tn.x=An/pn,Tn.y=bn/En,Tn.width=wn/pn,Tn.height=Cn/En,Tn}remove(){var Rn;this.div.removeEventListener("focusin",Kt(this,qt)),this.div.removeEventListener("focusout",Kt(this,Ut)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(Rn=Kt(this,dt))==null||Rn.remove(),Jn(this,dt,null),Jn(this,vt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Wn(this,gn,Jl).call(this),Kt(this,Bt).classList.remove("hidden"))}select(){var Rn;this.makeResizable(),(Rn=this.div)==null||Rn.classList.add("selectedEditor")}unselect(){var Rn,Dn,Fn;(Rn=Kt(this,Bt))==null||Rn.classList.add("hidden"),(Dn=this.div)==null||Dn.classList.remove("selectedEditor"),(Fn=this.div)!=null&&Fn.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Rn,Dn){}disableEditing(){Kt(this,dt)&&(Kt(this,dt).hidden=!0)}enableEditing(){Kt(this,dt)&&(Kt(this,dt).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return Kt(this,Nt)}set isEditing(Rn){Jn(this,Nt,Rn),this.parent&&(Rn?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Rn,Dn){Jn(this,Wt,!0);const Fn=Rn/Dn,{style:Tn}=this.div;Tn.aspectRatio=Fn,Tn.height="auto"}static get MIN_SIZE(){return 16}};et=new WeakMap,rt=new WeakMap,dt=new WeakMap,vt=new WeakMap,Ct=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,qt=new WeakMap,Ut=new WeakMap,kt=new WeakMap,Nt=new WeakMap,un=new WeakMap,dn=new WeakMap,hn=new WeakMap,gn=new WeakSet,Ao=function([Rn,Dn],Fn,Tn){[Fn,Tn]=this.screenToPageTranslation(Fn,Tn),this.x+=Fn/Rn,this.y+=Tn/Dn,this.fixAndSetPosition()},To=function(){const[Rn,Dn]=this.parentDimensions,{_borderLineWidth:Fn}=On,Tn=Fn/Rn,pn=Fn/Dn;switch(this.rotation){case 90:return[-Tn,pn];case 180:return[Tn,pn];case 270:return[Tn,-pn];default:return[-Tn,-pn]}},Dt=new WeakSet,Ro=function(Rn,Dn,Fn){switch(Fn){case 90:return[Dn,-Rn];case 180:return[-Rn,-Dn];case 270:return[-Dn,Rn];default:return[Rn,Dn]}},Po=function(Rn){switch(Rn){case 90:{const[Dn,Fn]=this.pageDimensions;return[0,-Dn/Fn,Fn/Dn,0]}case 180:return[-1,0,0,-1];case 270:{const[Dn,Fn]=this.pageDimensions;return[0,Dn/Fn,-Fn/Dn,0]}default:return[1,0,0,1]}},Jl=function(){if(Kt(this,Bt))return;Jn(this,Bt,document.createElement("div")),Kt(this,Bt).classList.add("resizers");const Rn=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Rn.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Dn of Rn){const Fn=document.createElement("div");Kt(this,Bt).append(Fn),Fn.classList.add("resizer",Dn),Fn.addEventListener("pointerdown",Wn(this,gn,Zl).bind(this,Dn)),Fn.addEventListener("contextmenu",j.noContextMenu)}this.div.prepend(Kt(this,Bt))},Zl=function(Rn,Dn){Dn.preventDefault();const{isMac:Fn}=a.FeatureTest.platform;if(Dn.button!==0||Dn.ctrlKey&&Fn)return;const Tn=Wn(this,gn,_c).bind(this,Rn),pn=this._isDraggable;this._isDraggable=!1;const En={passive:!0,capture:!0};window.addEventListener("pointermove",Tn,En);const An=this.x,bn=this.y,wn=this.width,Cn=this.height,Un=this.parent.div.style.cursor,Gn=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Dn.target).cursor;const er=()=>{this._isDraggable=pn,window.removeEventListener("pointerup",er),window.removeEventListener("blur",er),window.removeEventListener("pointermove",Tn,En),this.parent.div.style.cursor=Un,this.div.style.cursor=Gn;const nr=this.x,ar=this.y,or=this.width,lr=this.height;nr===An&&ar===bn&&or===wn&&lr===Cn||this.addCommands({cmd:()=>{this.width=or,this.height=lr,this.x=nr,this.y=ar;const[zn,Hn]=this.parentDimensions;this.setDims(zn*or,Hn*lr),this.fixAndSetPosition()},undo:()=>{this.width=wn,this.height=Cn,this.x=An,this.y=bn;const[zn,Hn]=this.parentDimensions;this.setDims(zn*wn,Hn*Cn),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",er),window.addEventListener("blur",er)},_c=function(Rn,Dn){const[Fn,Tn]=this.parentDimensions,pn=this.x,En=this.y,An=this.width,bn=this.height,wn=On.MIN_SIZE/Fn,Cn=On.MIN_SIZE/Tn,Un=Tr=>Math.round(Tr*1e4)/1e4,Gn=Wn(this,gn,Po).call(this,this.rotation),er=(Tr,Rr)=>[Gn[0]*Tr+Gn[2]*Rr,Gn[1]*Tr+Gn[3]*Rr],nr=Wn(this,gn,Po).call(this,360-this.rotation),ar=(Tr,Rr)=>[nr[0]*Tr+nr[2]*Rr,nr[1]*Tr+nr[3]*Rr];let or,lr,zn=!1,Hn=!1;switch(Rn){case"topLeft":zn=!0,or=(Tr,Rr)=>[0,0],lr=(Tr,Rr)=>[Tr,Rr];break;case"topMiddle":or=(Tr,Rr)=>[Tr/2,0],lr=(Tr,Rr)=>[Tr/2,Rr];break;case"topRight":zn=!0,or=(Tr,Rr)=>[Tr,0],lr=(Tr,Rr)=>[0,Rr];break;case"middleRight":Hn=!0,or=(Tr,Rr)=>[Tr,Rr/2],lr=(Tr,Rr)=>[0,Rr/2];break;case"bottomRight":zn=!0,or=(Tr,Rr)=>[Tr,Rr],lr=(Tr,Rr)=>[0,0];break;case"bottomMiddle":or=(Tr,Rr)=>[Tr/2,Rr],lr=(Tr,Rr)=>[Tr/2,0];break;case"bottomLeft":zn=!0,or=(Tr,Rr)=>[0,Rr],lr=(Tr,Rr)=>[Tr,0];break;case"middleLeft":Hn=!0,or=(Tr,Rr)=>[0,Rr/2],lr=(Tr,Rr)=>[Tr,Rr/2];break}const Pn=or(An,bn),kn=lr(An,bn);let Bn=er(...kn);const Kn=Un(pn+Bn[0]),sr=Un(En+Bn[1]);let fr=1,ur=1,[qn,gr]=this.screenToPageTranslation(Dn.movementX,Dn.movementY);if([qn,gr]=ar(qn/Fn,gr/Tn),zn){const Tr=Math.hypot(An,bn);fr=ur=Math.max(Math.min(Math.hypot(kn[0]-Pn[0]-qn,kn[1]-Pn[1]-gr)/Tr,1/An,1/bn),wn/An,Cn/bn)}else Hn?fr=Math.max(wn,Math.min(1,Math.abs(kn[0]-Pn[0]-qn)))/An:ur=Math.max(Cn,Math.min(1,Math.abs(kn[1]-Pn[1]-gr)))/bn;const mr=Un(An*fr),Dr=Un(bn*ur);Bn=er(...lr(mr,Dr));const Cr=Kn-Bn[0],Mr=sr-Bn[1];this.width=mr,this.height=Dr,this.x=Cr,this.y=Mr,this.setDims(Fn*mr,Tn*Dr),this.fixAndSetPosition()},So=async function(){var Fn;const Rn=Kt(this,dt);if(!Rn)return;if(!Kt(this,et)&&!Kt(this,rt)){Rn.classList.remove("done"),(Fn=Kt(this,vt))==null||Fn.remove();return}On._l10nPromise.get("editor_alt_text_edit_button_label").then(Tn=>{Rn.setAttribute("aria-label",Tn)});let Dn=Kt(this,vt);if(!Dn){Jn(this,vt,Dn=document.createElement("span")),Dn.className="tooltip",Dn.setAttribute("role","tooltip");const Tn=Dn.id=`alt-text-tooltip-${this.id}`;Rn.setAttribute("aria-describedby",Tn);const pn=100;Rn.addEventListener("mouseenter",()=>{Jn(this,Ct,setTimeout(()=>{Jn(this,Ct,null),Kt(this,vt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},pn))}),Rn.addEventListener("mouseleave",()=>{var En;clearTimeout(Kt(this,Ct)),Jn(this,Ct,null),(En=Kt(this,vt))==null||En.classList.remove("show")})}Rn.classList.add("done"),Dn.innerText=Kt(this,rt)?await On._l10nPromise.get("editor_alt_text_decorative_tooltip"):Kt(this,et),Dn.parentNode||Rn.append(Dn)},eu=function(Rn){if(!this._isDraggable)return;const Dn=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Fn,Tn;Dn&&(Fn={passive:!0,capture:!0},Tn=En=>{const[An,bn]=this.screenToPageTranslation(En.movementX,En.movementY);this._uiManager.dragSelectedEditors(An,bn)},window.addEventListener("pointermove",Tn,Fn));const pn=()=>{if(window.removeEventListener("pointerup",pn),window.removeEventListener("blur",pn),Dn&&window.removeEventListener("pointermove",Tn,Fn),Jn(this,kt,!1),!this._uiManager.endDragSession()){const{isMac:En}=a.FeatureTest.platform;Rn.ctrlKey&&!En||Rn.shiftKey||Rn.metaKey&&En?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",pn),window.addEventListener("blur",pn)},Yn(On,Dt),zr(On,"_borderLineWidth",-1),zr(On,"_colorManager",new o.ColorManager),zr(On,"_zIndex",1),zr(On,"SMALL_EDITOR_SIZE",0);let _e=On;e.AnnotationEditor=_e;class tt extends _e{constructor(Rn){super(Rn),this.annotationElementId=Rn.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(s,e,i)=>{var Wt,Bt,qt,Ut,kt,Io,dn,hn,gn,It,pt,tu,Lt,yn,fn,$n,Ln,jn,On,Vn,Rn,Dn,Fn,Tn,pn,En,An,bn,wn,Cn,Un,Gn,er,nr,ar,or,lr,zn,Hn,Pn,kn,Bn,Kn,sr,fr,ur,qn,nu,bo,wo,Js,xo,Co,ts,ks,ru,su,ko,Ds,Do;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=j,e.opacityToHex=_e;var o=i(1),a=i(6);function j(Lr,Nn,ir){for(const _r of ir)Nn.addEventListener(_r,Lr[_r].bind(Lr))}function _e(Lr){return Math.round(Math.min(255,Math.max(1,255*Lr))).toString(16).padStart(2,"0")}class tt{constructor(){Yn(this,Wt,0)}getId(){return`${o.AnnotationEditorPrefix}${Cs(this,Wt)._++}`}}Wt=new WeakMap;const un=class un{constructor(){Yn(this,kt);Yn(this,Bt,(0,o.getUuid)());Yn(this,qt,0);Yn(this,Ut,null)}static get _isSVGFittingCanvas(){const Nn='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',_r=new OffscreenCanvas(1,3).getContext("2d"),Ar=new Image;Ar.src=Nn;const xr=Ar.decode().then(()=>(_r.drawImage(Ar,0,0,1,1,0,0,1,3),new Uint32Array(_r.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,o.shadow)(this,"_isSVGFittingCanvas",xr)}async getFromFile(Nn){const{lastModified:ir,name:_r,size:Ar,type:xr}=Nn;return Wn(this,kt,Io).call(this,`${ir}_${_r}_${Ar}_${xr}`,Nn)}async getFromUrl(Nn){return Wn(this,kt,Io).call(this,Nn,Nn)}async getFromId(Nn){Kt(this,Ut)||Jn(this,Ut,new Map);const ir=Kt(this,Ut).get(Nn);return ir?ir.bitmap?(ir.refCounter+=1,ir):ir.file?this.getFromFile(ir.file):this.getFromUrl(ir.url):null}getSvgUrl(Nn){const ir=Kt(this,Ut).get(Nn);return ir!=null&&ir.isSvg?ir.svgUrl:null}deleteId(Nn){Kt(this,Ut)||Jn(this,Ut,new Map);const ir=Kt(this,Ut).get(Nn);ir&&(ir.refCounter-=1,ir.refCounter===0&&(ir.bitmap=null))}isValidId(Nn){return Nn.startsWith(`image_${Kt(this,Bt)}_`)}};Bt=new WeakMap,qt=new WeakMap,Ut=new WeakMap,kt=new WeakSet,Io=async function(Nn,ir){Kt(this,Ut)||Jn(this,Ut,new Map);let _r=Kt(this,Ut).get(Nn);if(_r===null)return null;if(_r!=null&&_r.bitmap)return _r.refCounter+=1,_r;try{_r||(_r={bitmap:null,id:`image_${Kt(this,Bt)}_${Cs(this,qt)._++}`,refCounter:0,isSvg:!1});let Ar;if(typeof ir=="string"){_r.url=ir;const xr=await fetch(ir);if(!xr.ok)throw new Error(xr.statusText);Ar=await xr.blob()}else Ar=_r.file=ir;if(Ar.type==="image/svg+xml"){const xr=un._isSVGFittingCanvas,Er=new FileReader,xn=new Image,Sn=new Promise((Mn,Qn)=>{xn.onload=()=>{_r.bitmap=xn,_r.isSvg=!0,Mn()},Er.onload=async()=>{const rr=_r.svgUrl=Er.result;xn.src=await xr?`${rr}#svgView(preserveAspectRatio(none))`:rr},xn.onerror=Er.onerror=Qn});Er.readAsDataURL(Ar),await Sn}else _r.bitmap=await createImageBitmap(Ar);_r.refCounter=1}catch(Ar){console.error(Ar),_r=null}return Kt(this,Ut).set(Nn,_r),_r&&Kt(this,Ut).set(_r.id,_r),_r};let et=un;class rt{constructor(Nn=128){Yn(this,dn,[]);Yn(this,hn,!1);Yn(this,gn);Yn(this,It,-1);Jn(this,gn,Nn)}add({cmd:Nn,undo:ir,mustExec:_r,type:Ar=NaN,overwriteIfSameType:xr=!1,keepUndo:Er=!1}){if(_r&&Nn(),Kt(this,hn))return;const xn={cmd:Nn,undo:ir,type:Ar};if(Kt(this,It)===-1){Kt(this,dn).length>0&&(Kt(this,dn).length=0),Jn(this,It,0),Kt(this,dn).push(xn);return}if(xr&&Kt(this,dn)[Kt(this,It)].type===Ar){Er&&(xn.undo=Kt(this,dn)[Kt(this,It)].undo),Kt(this,dn)[Kt(this,It)]=xn;return}const Sn=Kt(this,It)+1;Sn===Kt(this,gn)?Kt(this,dn).splice(0,1):(Jn(this,It,Sn),Sn<Kt(this,dn).length&&Kt(this,dn).splice(Sn)),Kt(this,dn).push(xn)}undo(){Kt(this,It)!==-1&&(Jn(this,hn,!0),Kt(this,dn)[Kt(this,It)].undo(),Jn(this,hn,!1),Jn(this,It,Kt(this,It)-1))}redo(){Kt(this,It)<Kt(this,dn).length-1&&(Jn(this,It,Kt(this,It)+1),Jn(this,hn,!0),Kt(this,dn)[Kt(this,It)].cmd(),Jn(this,hn,!1))}hasSomethingToUndo(){return Kt(this,It)!==-1}hasSomethingToRedo(){return Kt(this,It)<Kt(this,dn).length-1}destroy(){Jn(this,dn,null)}}dn=new WeakMap,hn=new WeakMap,gn=new WeakMap,It=new WeakMap,e.CommandManager=rt;class dt{constructor(Nn){Yn(this,pt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ir}=o.FeatureTest.platform;for(const[_r,Ar,xr={}]of Nn)for(const Er of _r){const xn=Er.startsWith("mac+");ir&&xn?(this.callbacks.set(Er.slice(4),{callback:Ar,options:xr}),this.allKeys.add(Er.split("+").at(-1))):!ir&&!xn&&(this.callbacks.set(Er,{callback:Ar,options:xr}),this.allKeys.add(Er.split("+").at(-1)))}}exec(Nn,ir){if(!this.allKeys.has(ir.key))return;const _r=this.callbacks.get(Wn(this,pt,tu).call(this,ir));if(!_r)return;const{callback:Ar,options:{bubbles:xr=!1,args:Er=[],checker:xn=null}}=_r;xn&&!xn(Nn,ir)||(Ar.bind(Nn,...Er)(),xr||(ir.stopPropagation(),ir.preventDefault()))}}pt=new WeakSet,tu=function(Nn){Nn.altKey&&this.buffer.push("alt"),Nn.ctrlKey&&this.buffer.push("ctrl"),Nn.metaKey&&this.buffer.push("meta"),Nn.shiftKey&&this.buffer.push("shift"),this.buffer.push(Nn.key);const ir=this.buffer.join("+");return this.buffer.length=0,ir},e.KeyboardManager=dt;const mn=class mn{get _colors(){const Nn=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)(Nn),(0,o.shadow)(this,"_colors",Nn)}convert(Nn){const ir=(0,a.getRGB)(Nn);if(!window.matchMedia("(forced-colors: active)").matches)return ir;for(const[_r,Ar]of this._colors)if(Ar.every((xr,Er)=>xr===ir[Er]))return mn._colorsMapping.get(_r);return ir}getHexCode(Nn){const ir=this._colors.get(Nn);return ir?o.Util.makeHexColor(...ir):Nn}};zr(mn,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let vt=mn;e.ColorManager=vt;const Fr=class Fr{constructor(Nn,ir,_r,Ar,xr,Er){Yn(this,qn);Yn(this,Lt,null);Yn(this,yn,new Map);Yn(this,fn,new Map);Yn(this,$n,null);Yn(this,Ln,null);Yn(this,jn,new rt);Yn(this,On,0);Yn(this,Vn,new Set);Yn(this,Rn,null);Yn(this,Dn,null);Yn(this,Fn,new Set);Yn(this,Tn,null);Yn(this,pn,new tt);Yn(this,En,!1);Yn(this,An,!1);Yn(this,bn,null);Yn(this,wn,o.AnnotationEditorType.NONE);Yn(this,Cn,new Set);Yn(this,Un,null);Yn(this,Gn,this.blur.bind(this));Yn(this,er,this.focus.bind(this));Yn(this,nr,this.copy.bind(this));Yn(this,ar,this.cut.bind(this));Yn(this,or,this.paste.bind(this));Yn(this,lr,this.keydown.bind(this));Yn(this,zn,this.onEditingAction.bind(this));Yn(this,Hn,this.onPageChanging.bind(this));Yn(this,Pn,this.onScaleChanging.bind(this));Yn(this,kn,this.onRotationChanging.bind(this));Yn(this,Bn,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Yn(this,Kn,[0,0]);Yn(this,sr,null);Yn(this,fr,null);Yn(this,ur,null);Jn(this,fr,Nn),Jn(this,ur,ir),Jn(this,$n,_r),this._eventBus=Ar,this._eventBus._on("editingaction",Kt(this,zn)),this._eventBus._on("pagechanging",Kt(this,Hn)),this._eventBus._on("scalechanging",Kt(this,Pn)),this._eventBus._on("rotationchanging",Kt(this,kn)),Jn(this,Ln,xr.annotationStorage),Jn(this,Tn,xr.filterFactory),Jn(this,Un,Er),this.viewParameters={realScale:a.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const Nn=Fr.prototype,ir=xr=>{const{activeElement:Er}=document;return Er&&Kt(xr,fr).contains(Er)&&xr.hasSomethingToControl()},_r=this.TRANSLATE_SMALL,Ar=this.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new dt([[["ctrl+a","mac+meta+a"],Nn.selectAll],[["ctrl+z","mac+meta+z"],Nn.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],Nn.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],Nn.delete],[["Escape","mac+Escape"],Nn.unselectAll],[["ArrowLeft","mac+ArrowLeft"],Nn.translateSelectedEditors,{args:[-_r,0],checker:ir}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Nn.translateSelectedEditors,{args:[-Ar,0],checker:ir}],[["ArrowRight","mac+ArrowRight"],Nn.translateSelectedEditors,{args:[_r,0],checker:ir}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Nn.translateSelectedEditors,{args:[Ar,0],checker:ir}],[["ArrowUp","mac+ArrowUp"],Nn.translateSelectedEditors,{args:[0,-_r],checker:ir}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Nn.translateSelectedEditors,{args:[0,-Ar],checker:ir}],[["ArrowDown","mac+ArrowDown"],Nn.translateSelectedEditors,{args:[0,_r],checker:ir}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Nn.translateSelectedEditors,{args:[0,Ar],checker:ir}]]))}destroy(){Wn(this,qn,Js).call(this),Wn(this,qn,bo).call(this),this._eventBus._off("editingaction",Kt(this,zn)),this._eventBus._off("pagechanging",Kt(this,Hn)),this._eventBus._off("scalechanging",Kt(this,Pn)),this._eventBus._off("rotationchanging",Kt(this,kn));for(const Nn of Kt(this,fn).values())Nn.destroy();Kt(this,fn).clear(),Kt(this,yn).clear(),Kt(this,Fn).clear(),Jn(this,Lt,null),Kt(this,Cn).clear(),Kt(this,jn).destroy(),Kt(this,$n).destroy()}get hcmFilter(){return(0,o.shadow)(this,"hcmFilter",Kt(this,Un)?Kt(this,Tn).addHCMFilter(Kt(this,Un).foreground,Kt(this,Un).background):"none")}get direction(){return(0,o.shadow)(this,"direction",getComputedStyle(Kt(this,fr)).direction)}editAltText(Nn){var ir;(ir=Kt(this,$n))==null||ir.editAltText(this,Nn)}onPageChanging({pageNumber:Nn}){Jn(this,On,Nn-1)}focusMainContainer(){Kt(this,fr).focus()}findParent(Nn,ir){for(const _r of Kt(this,fn).values()){const{x:Ar,y:xr,width:Er,height:xn}=_r.div.getBoundingClientRect();if(Nn>=Ar&&Nn<=Ar+Er&&ir>=xr&&ir<=xr+xn)return _r}return null}disableUserSelect(Nn=!1){Kt(this,ur).classList.toggle("noUserSelect",Nn)}addShouldRescale(Nn){Kt(this,Fn).add(Nn)}removeShouldRescale(Nn){Kt(this,Fn).delete(Nn)}onScaleChanging({scale:Nn}){this.commitOrRemove(),this.viewParameters.realScale=Nn*a.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ir of Kt(this,Fn))ir.onScaleChanging()}onRotationChanging({pagesRotation:Nn}){this.commitOrRemove(),this.viewParameters.rotation=Nn}addToAnnotationStorage(Nn){!Nn.isEmpty()&&Kt(this,Ln)&&!Kt(this,Ln).has(Nn.id)&&Kt(this,Ln).setValue(Nn.id,Nn)}blur(){if(!this.hasSelection)return;const{activeElement:Nn}=document;for(const ir of Kt(this,Cn))if(ir.div.contains(Nn)){Jn(this,bn,[ir,Nn]),ir._focusEventsAllowed=!1;break}}focus(){if(!Kt(this,bn))return;const[Nn,ir]=Kt(this,bn);Jn(this,bn,null),ir.addEventListener("focusin",()=>{Nn._focusEventsAllowed=!0},{once:!0}),ir.focus()}addEditListeners(){Wn(this,qn,wo).call(this),Wn(this,qn,xo).call(this)}removeEditListeners(){Wn(this,qn,Js).call(this),Wn(this,qn,Co).call(this)}copy(Nn){var _r;if(Nn.preventDefault(),(_r=Kt(this,Lt))==null||_r.commitOrRemove(),!this.hasSelection)return;const ir=[];for(const Ar of Kt(this,Cn)){const xr=Ar.serialize(!0);xr&&ir.push(xr)}ir.length!==0&&Nn.clipboardData.setData("application/pdfjs",JSON.stringify(ir))}cut(Nn){this.copy(Nn),this.delete()}paste(Nn){Nn.preventDefault();const{clipboardData:ir}=Nn;for(const xr of ir.items)for(const Er of Kt(this,Dn))if(Er.isHandlingMimeForPasting(xr.type)){Er.paste(xr,this.currentLayer);return}let _r=ir.getData("application/pdfjs");if(!_r)return;try{_r=JSON.parse(_r)}catch(xr){(0,o.warn)(`paste: "${xr.message}".`);return}if(!Array.isArray(_r))return;this.unselectAll();const Ar=this.currentLayer;try{const xr=[];for(const Sn of _r){const Mn=Ar.deserialize(Sn);if(!Mn)return;xr.push(Mn)}const Er=()=>{for(const Sn of xr)Wn(this,qn,ko).call(this,Sn);Wn(this,qn,Do).call(this,xr)},xn=()=>{for(const Sn of xr)Sn.remove()};this.addCommands({cmd:Er,undo:xn,mustExec:!0})}catch(xr){(0,o.warn)(`paste: "${xr.message}".`)}}keydown(Nn){var ir;(ir=this.getActive())!=null&&ir.shouldGetKeyboardEvents()||Fr._keyboardManager.exec(this,Nn)}onEditingAction(Nn){["undo","redo","delete","selectAll"].includes(Nn.name)&&this[Nn.name]()}setEditingState(Nn){Nn?(Wn(this,qn,nu).call(this),Wn(this,qn,wo).call(this),Wn(this,qn,xo).call(this),Wn(this,qn,ts).call(this,{isEditing:Kt(this,wn)!==o.AnnotationEditorType.NONE,isEmpty:Wn(this,qn,Ds).call(this),hasSomethingToUndo:Kt(this,jn).hasSomethingToUndo(),hasSomethingToRedo:Kt(this,jn).hasSomethingToRedo(),hasSelectedEditor:!1})):(Wn(this,qn,bo).call(this),Wn(this,qn,Js).call(this),Wn(this,qn,Co).call(this),Wn(this,qn,ts).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(Nn){if(!Kt(this,Dn)){Jn(this,Dn,Nn);for(const ir of Kt(this,Dn))Wn(this,qn,ks).call(this,ir.defaultPropertiesToUpdate)}}getId(){return Kt(this,pn).getId()}get currentLayer(){return Kt(this,fn).get(Kt(this,On))}getLayer(Nn){return Kt(this,fn).get(Nn)}get currentPageIndex(){return Kt(this,On)}addLayer(Nn){Kt(this,fn).set(Nn.pageIndex,Nn),Kt(this,En)?Nn.enable():Nn.disable()}removeLayer(Nn){Kt(this,fn).delete(Nn.pageIndex)}updateMode(Nn,ir=null){if(Kt(this,wn)!==Nn){if(Jn(this,wn,Nn),Nn===o.AnnotationEditorType.NONE){this.setEditingState(!1),Wn(this,qn,su).call(this);return}this.setEditingState(!0),Wn(this,qn,ru).call(this),this.unselectAll();for(const _r of Kt(this,fn).values())_r.updateMode(Nn);if(ir){for(const _r of Kt(this,yn).values())if(_r.annotationElementId===ir){this.setSelected(_r),_r.enterInEditMode();break}}}}updateToolbar(Nn){Nn!==Kt(this,wn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:Nn})}updateParams(Nn,ir){if(Kt(this,Dn)){if(Nn===o.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(Nn);return}for(const _r of Kt(this,Cn))_r.updateParams(Nn,ir);for(const _r of Kt(this,Dn))_r.updateDefaultParams(Nn,ir)}}enableWaiting(Nn=!1){if(Kt(this,An)!==Nn){Jn(this,An,Nn);for(const ir of Kt(this,fn).values())Nn?ir.disableClick():ir.enableClick(),ir.div.classList.toggle("waiting",Nn)}}getEditors(Nn){const ir=[];for(const _r of Kt(this,yn).values())_r.pageIndex===Nn&&ir.push(_r);return ir}getEditor(Nn){return Kt(this,yn).get(Nn)}addEditor(Nn){Kt(this,yn).set(Nn.id,Nn)}removeEditor(Nn){var ir;Kt(this,yn).delete(Nn.id),this.unselect(Nn),(!Nn.annotationElementId||!Kt(this,Vn).has(Nn.annotationElementId))&&((ir=Kt(this,Ln))==null||ir.remove(Nn.id))}addDeletedAnnotationElement(Nn){Kt(this,Vn).add(Nn.annotationElementId),Nn.deleted=!0}isDeletedAnnotationElement(Nn){return Kt(this,Vn).has(Nn)}removeDeletedAnnotationElement(Nn){Kt(this,Vn).delete(Nn.annotationElementId),Nn.deleted=!1}setActiveEditor(Nn){Kt(this,Lt)!==Nn&&(Jn(this,Lt,Nn),Nn&&Wn(this,qn,ks).call(this,Nn.propertiesToUpdate))}toggleSelected(Nn){if(Kt(this,Cn).has(Nn)){Kt(this,Cn).delete(Nn),Nn.unselect(),Wn(this,qn,ts).call(this,{hasSelectedEditor:this.hasSelection});return}Kt(this,Cn).add(Nn),Nn.select(),Wn(this,qn,ks).call(this,Nn.propertiesToUpdate),Wn(this,qn,ts).call(this,{hasSelectedEditor:!0})}setSelected(Nn){for(const ir of Kt(this,Cn))ir!==Nn&&ir.unselect();Kt(this,Cn).clear(),Kt(this,Cn).add(Nn),Nn.select(),Wn(this,qn,ks).call(this,Nn.propertiesToUpdate),Wn(this,qn,ts).call(this,{hasSelectedEditor:!0})}isSelected(Nn){return Kt(this,Cn).has(Nn)}unselect(Nn){Nn.unselect(),Kt(this,Cn).delete(Nn),Wn(this,qn,ts).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return Kt(this,Cn).size!==0}undo(){Kt(this,jn).undo(),Wn(this,qn,ts).call(this,{hasSomethingToUndo:Kt(this,jn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Wn(this,qn,Ds).call(this)})}redo(){Kt(this,jn).redo(),Wn(this,qn,ts).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Kt(this,jn).hasSomethingToRedo(),isEmpty:Wn(this,qn,Ds).call(this)})}addCommands(Nn){Kt(this,jn).add(Nn),Wn(this,qn,ts).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Wn(this,qn,Ds).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const Nn=[...Kt(this,Cn)],ir=()=>{for(const Ar of Nn)Ar.remove()},_r=()=>{for(const Ar of Nn)Wn(this,qn,ko).call(this,Ar)};this.addCommands({cmd:ir,undo:_r,mustExec:!0})}commitOrRemove(){var Nn;(Nn=Kt(this,Lt))==null||Nn.commitOrRemove()}hasSomethingToControl(){return Kt(this,Lt)||this.hasSelection}selectAll(){for(const Nn of Kt(this,Cn))Nn.commit();Wn(this,qn,Do).call(this,Kt(this,yn).values())}unselectAll(){if(Kt(this,Lt)){Kt(this,Lt).commitOrRemove();return}if(this.hasSelection){for(const Nn of Kt(this,Cn))Nn.unselect();Kt(this,Cn).clear(),Wn(this,qn,ts).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(Nn,ir,_r=!1){if(_r||this.commitOrRemove(),!this.hasSelection)return;Kt(this,Kn)[0]+=Nn,Kt(this,Kn)[1]+=ir;const[Ar,xr]=Kt(this,Kn),Er=[...Kt(this,Cn)],xn=1e3;Kt(this,sr)&&clearTimeout(Kt(this,sr)),Jn(this,sr,setTimeout(()=>{Jn(this,sr,null),Kt(this,Kn)[0]=Kt(this,Kn)[1]=0,this.addCommands({cmd:()=>{for(const Sn of Er)Kt(this,yn).has(Sn.id)&&Sn.translateInPage(Ar,xr)},undo:()=>{for(const Sn of Er)Kt(this,yn).has(Sn.id)&&Sn.translateInPage(-Ar,-xr)},mustExec:!1})},xn));for(const Sn of Er)Sn.translateInPage(Nn,ir)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Jn(this,Rn,new Map);for(const Nn of Kt(this,Cn))Kt(this,Rn).set(Nn,{savedX:Nn.x,savedY:Nn.y,savedPageIndex:Nn.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!Kt(this,Rn))return!1;this.disableUserSelect(!1);const Nn=Kt(this,Rn);Jn(this,Rn,null);let ir=!1;for(const[{x:Ar,y:xr,pageIndex:Er},xn]of Nn)xn.newX=Ar,xn.newY=xr,xn.newPageIndex=Er,ir||(ir=Ar!==xn.savedX||xr!==xn.savedY||Er!==xn.savedPageIndex);if(!ir)return!1;const _r=(Ar,xr,Er,xn)=>{if(Kt(this,yn).has(Ar.id)){const Sn=Kt(this,fn).get(xn);Sn?Ar._setParentAndPosition(Sn,xr,Er):(Ar.pageIndex=xn,Ar.x=xr,Ar.y=Er)}};return this.addCommands({cmd:()=>{for(const[Ar,{newX:xr,newY:Er,newPageIndex:xn}]of Nn)_r(Ar,xr,Er,xn)},undo:()=>{for(const[Ar,{savedX:xr,savedY:Er,savedPageIndex:xn}]of Nn)_r(Ar,xr,Er,xn)},mustExec:!0}),!0}dragSelectedEditors(Nn,ir){if(Kt(this,Rn))for(const _r of Kt(this,Rn).keys())_r.drag(Nn,ir)}rebuild(Nn){if(Nn.parent===null){const ir=this.getLayer(Nn.pageIndex);ir?(ir.changeParent(Nn),ir.addOrRebuild(Nn)):(this.addEditor(Nn),this.addToAnnotationStorage(Nn),Nn.rebuild())}else Nn.parent.addOrRebuild(Nn)}isActive(Nn){return Kt(this,Lt)===Nn}getActive(){return Kt(this,Lt)}getMode(){return Kt(this,wn)}get imageManager(){return(0,o.shadow)(this,"imageManager",new et)}};Lt=new WeakMap,yn=new WeakMap,fn=new WeakMap,$n=new WeakMap,Ln=new WeakMap,jn=new WeakMap,On=new WeakMap,Vn=new WeakMap,Rn=new WeakMap,Dn=new WeakMap,Fn=new WeakMap,Tn=new WeakMap,pn=new WeakMap,En=new WeakMap,An=new WeakMap,bn=new WeakMap,wn=new WeakMap,Cn=new WeakMap,Un=new WeakMap,Gn=new WeakMap,er=new WeakMap,nr=new WeakMap,ar=new WeakMap,or=new WeakMap,lr=new WeakMap,zn=new WeakMap,Hn=new WeakMap,Pn=new WeakMap,kn=new WeakMap,Bn=new WeakMap,Kn=new WeakMap,sr=new WeakMap,fr=new WeakMap,ur=new WeakMap,qn=new WeakSet,nu=function(){window.addEventListener("focus",Kt(this,er)),window.addEventListener("blur",Kt(this,Gn))},bo=function(){window.removeEventListener("focus",Kt(this,er)),window.removeEventListener("blur",Kt(this,Gn))},wo=function(){window.addEventListener("keydown",Kt(this,lr),{capture:!0})},Js=function(){window.removeEventListener("keydown",Kt(this,lr),{capture:!0})},xo=function(){document.addEventListener("copy",Kt(this,nr)),document.addEventListener("cut",Kt(this,ar)),document.addEventListener("paste",Kt(this,or))},Co=function(){document.removeEventListener("copy",Kt(this,nr)),document.removeEventListener("cut",Kt(this,ar)),document.removeEventListener("paste",Kt(this,or))},ts=function(Nn){Object.entries(Nn).some(([_r,Ar])=>Kt(this,Bn)[_r]!==Ar)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Kt(this,Bn),Nn)})},ks=function(Nn){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:Nn})},ru=function(){if(!Kt(this,En)){Jn(this,En,!0);for(const Nn of Kt(this,fn).values())Nn.enable()}},su=function(){if(this.unselectAll(),Kt(this,En)){Jn(this,En,!1);for(const Nn of Kt(this,fn).values())Nn.disable()}},ko=function(Nn){const ir=Kt(this,fn).get(Nn.pageIndex);ir?ir.addOrRebuild(Nn):this.addEditor(Nn)},Ds=function(){if(Kt(this,yn).size===0)return!0;if(Kt(this,yn).size===1)for(const Nn of Kt(this,yn).values())return Nn.isEmpty();return!1},Do=function(Nn){Kt(this,Cn).clear();for(const ir of Nn)ir.isEmpty()||(Kt(this,Cn).add(ir),ir.select());Wn(this,qn,ts).call(this,{hasSelectedEditor:!0})},zr(Fr,"TRANSLATE_SMALL",1),zr(Fr,"TRANSLATE_BIG",10);let Ct=Fr;e.AnnotationEditorUIManager=Ct},(s,e,i)=>{var On,Vn,Rn,Dn,Fn,Tn,pn,En,An,bn,wn,Cn,_s,ys,No,Zs,_i,Ns,Vs;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=It,e.getColorValues=yn,e.getCurrentTransform=fn,e.getCurrentTransformInverse=$n,e.getFilenameFromUrl=kt,e.getPdfFilenameFromUrl=Nt,e.getRGB=Lt,e.getXfaPageViewport=mn,e.isDataScheme=qt,e.isPdfFile=Ut,e.isValidFetchUrl=dn,e.loadScript=gn,e.noContextMenu=hn,e.setLayerDimensions=Ln;var o=i(7),a=i(1);const j="http://www.w3.org/2000/svg",jn=class jn{};zr(jn,"CSS",96),zr(jn,"PDF",72),zr(jn,"PDF_TO_CSS_UNITS",jn.CSS/jn.PDF);let _e=jn;e.PixelsPerInch=_e;class tt extends o.BaseFilterFactory{constructor({docId:Pn,ownerDocument:kn=globalThis.document}={}){super();Yn(this,Cn);Yn(this,On);Yn(this,Vn);Yn(this,Rn);Yn(this,Dn);Yn(this,Fn);Yn(this,Tn);Yn(this,pn);Yn(this,En);Yn(this,An);Yn(this,bn);Yn(this,wn,0);Jn(this,Rn,Pn),Jn(this,Dn,kn)}addFilter(Pn){if(!Pn)return"none";let kn=Kt(this,Cn,_s).get(Pn);if(kn)return kn;let Bn,Kn,sr,fr;if(Pn.length===1){const mr=Pn[0],Dr=new Array(256);for(let Cr=0;Cr<256;Cr++)Dr[Cr]=mr[Cr]/255;fr=Bn=Kn=sr=Dr.join(",")}else{const[mr,Dr,Cr]=Pn,Mr=new Array(256),Tr=new Array(256),Rr=new Array(256);for(let Or=0;Or<256;Or++)Mr[Or]=mr[Or]/255,Tr[Or]=Dr[Or]/255,Rr[Or]=Cr[Or]/255;Bn=Mr.join(","),Kn=Tr.join(","),sr=Rr.join(","),fr=`${Bn}${Kn}${sr}`}if(kn=Kt(this,Cn,_s).get(fr),kn)return Kt(this,Cn,_s).set(Pn,kn),kn;const ur=`g_${Kt(this,Rn)}_transfer_map_${Cs(this,wn)._++}`,qn=`url(#${ur})`;Kt(this,Cn,_s).set(Pn,qn),Kt(this,Cn,_s).set(fr,qn);const gr=Wn(this,Cn,Zs).call(this,ur);return Wn(this,Cn,Ns).call(this,Bn,Kn,sr,gr),qn}addHCMFilter(Pn,kn){var Dr;const Bn=`${Pn}-${kn}`;if(Kt(this,Tn)===Bn)return Kt(this,pn);if(Jn(this,Tn,Bn),Jn(this,pn,"none"),(Dr=Kt(this,Fn))==null||Dr.remove(),!Pn||!kn)return Kt(this,pn);const Kn=Wn(this,Cn,Vs).call(this,Pn);Pn=a.Util.makeHexColor(...Kn);const sr=Wn(this,Cn,Vs).call(this,kn);if(kn=a.Util.makeHexColor(...sr),Kt(this,Cn,ys).style.color="",Pn==="#000000"&&kn==="#ffffff"||Pn===kn)return Kt(this,pn);const fr=new Array(256);for(let Cr=0;Cr<=255;Cr++){const Mr=Cr/255;fr[Cr]=Mr<=.03928?Mr/12.92:((Mr+.055)/1.055)**2.4}const ur=fr.join(","),qn=`g_${Kt(this,Rn)}_hcm_filter`,gr=Jn(this,En,Wn(this,Cn,Zs).call(this,qn));Wn(this,Cn,Ns).call(this,ur,ur,ur,gr),Wn(this,Cn,No).call(this,gr);const mr=(Cr,Mr)=>{const Tr=Kn[Cr]/255,Rr=sr[Cr]/255,Or=new Array(Mr+1);for(let jr=0;jr<=Mr;jr++)Or[jr]=Tr+jr/Mr*(Rr-Tr);return Or.join(",")};return Wn(this,Cn,Ns).call(this,mr(0,5),mr(1,5),mr(2,5),gr),Jn(this,pn,`url(#${qn})`),Kt(this,pn)}addHighlightHCMFilter(Pn,kn,Bn,Kn){var Rr;const sr=`${Pn}-${kn}-${Bn}-${Kn}`;if(Kt(this,An)===sr)return Kt(this,bn);if(Jn(this,An,sr),Jn(this,bn,"none"),(Rr=Kt(this,En))==null||Rr.remove(),!Pn||!kn)return Kt(this,bn);const[fr,ur]=[Pn,kn].map(Wn(this,Cn,Vs).bind(this));let qn=Math.round(.2126*fr[0]+.7152*fr[1]+.0722*fr[2]),gr=Math.round(.2126*ur[0]+.7152*ur[1]+.0722*ur[2]),[mr,Dr]=[Bn,Kn].map(Wn(this,Cn,Vs).bind(this));gr<qn&&([qn,gr,mr,Dr]=[gr,qn,Dr,mr]),Kt(this,Cn,ys).style.color="";const Cr=(Or,jr,hr)=>{const Xn=new Array(256),Zn=(gr-qn)/hr,vr=Or/255,Fr=(jr-Or)/(255*hr);let Lr=0;for(let Nn=0;Nn<=hr;Nn++){const ir=Math.round(qn+Nn*Zn),_r=vr+Nn*Fr;for(let Ar=Lr;Ar<=ir;Ar++)Xn[Ar]=_r;Lr=ir+1}for(let Nn=Lr;Nn<256;Nn++)Xn[Nn]=Xn[Lr-1];return Xn.join(",")},Mr=`g_${Kt(this,Rn)}_hcm_highlight_filter`,Tr=Jn(this,En,Wn(this,Cn,Zs).call(this,Mr));return Wn(this,Cn,No).call(this,Tr),Wn(this,Cn,Ns).call(this,Cr(mr[0],Dr[0],5),Cr(mr[1],Dr[1],5),Cr(mr[2],Dr[2],5),Tr),Jn(this,bn,`url(#${Mr})`),Kt(this,bn)}destroy(Pn=!1){Pn&&(Kt(this,pn)||Kt(this,bn))||(Kt(this,Vn)&&(Kt(this,Vn).parentNode.parentNode.remove(),Jn(this,Vn,null)),Kt(this,On)&&(Kt(this,On).clear(),Jn(this,On,null)),Jn(this,wn,0))}}On=new WeakMap,Vn=new WeakMap,Rn=new WeakMap,Dn=new WeakMap,Fn=new WeakMap,Tn=new WeakMap,pn=new WeakMap,En=new WeakMap,An=new WeakMap,bn=new WeakMap,wn=new WeakMap,Cn=new WeakSet,_s=function(){return Kt(this,On)||Jn(this,On,new Map)},ys=function(){if(!Kt(this,Vn)){const Pn=Kt(this,Dn).createElement("div"),{style:kn}=Pn;kn.visibility="hidden",kn.contain="strict",kn.width=kn.height=0,kn.position="absolute",kn.top=kn.left=0,kn.zIndex=-1;const Bn=Kt(this,Dn).createElementNS(j,"svg");Bn.setAttribute("width",0),Bn.setAttribute("height",0),Jn(this,Vn,Kt(this,Dn).createElementNS(j,"defs")),Pn.append(Bn),Bn.append(Kt(this,Vn)),Kt(this,Dn).body.append(Pn)}return Kt(this,Vn)},No=function(Pn){const kn=Kt(this,Dn).createElementNS(j,"feColorMatrix");kn.setAttribute("type","matrix"),kn.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Pn.append(kn)},Zs=function(Pn){const kn=Kt(this,Dn).createElementNS(j,"filter");return kn.setAttribute("color-interpolation-filters","sRGB"),kn.setAttribute("id",Pn),Kt(this,Cn,ys).append(kn),kn},_i=function(Pn,kn,Bn){const Kn=Kt(this,Dn).createElementNS(j,kn);Kn.setAttribute("type","discrete"),Kn.setAttribute("tableValues",Bn),Pn.append(Kn)},Ns=function(Pn,kn,Bn,Kn){const sr=Kt(this,Dn).createElementNS(j,"feComponentTransfer");Kn.append(sr),Wn(this,Cn,_i).call(this,sr,"feFuncR",Pn),Wn(this,Cn,_i).call(this,sr,"feFuncG",kn),Wn(this,Cn,_i).call(this,sr,"feFuncB",Bn)},Vs=function(Pn){return Kt(this,Cn,ys).style.color=Pn,Lt(getComputedStyle(Kt(this,Cn,ys)).getPropertyValue("color"))},e.DOMFilterFactory=tt;class et extends o.BaseCanvasFactory{constructor({ownerDocument:Hn=globalThis.document}={}){super(),this._document=Hn}_createCanvas(Hn,Pn){const kn=this._document.createElement("canvas");return kn.width=Hn,kn.height=Pn,kn}}e.DOMCanvasFactory=et;async function rt(zn,Hn=!1){if(dn(zn,document.baseURI)){const Pn=await fetch(zn);if(!Pn.ok)throw new Error(Pn.statusText);return Hn?new Uint8Array(await Pn.arrayBuffer()):(0,a.stringToBytes)(await Pn.text())}return new Promise((Pn,kn)=>{const Bn=new XMLHttpRequest;Bn.open("GET",zn,!0),Hn&&(Bn.responseType="arraybuffer"),Bn.onreadystatechange=()=>{if(Bn.readyState===XMLHttpRequest.DONE){if(Bn.status===200||Bn.status===0){let Kn;if(Hn&&Bn.response?Kn=new Uint8Array(Bn.response):!Hn&&Bn.responseText&&(Kn=(0,a.stringToBytes)(Bn.responseText)),Kn){Pn(Kn);return}}kn(new Error(Bn.statusText))}},Bn.send(null)})}class dt extends o.BaseCMapReaderFactory{_fetchData(Hn,Pn){return rt(Hn,this.isCompressed).then(kn=>({cMapData:kn,compressionType:Pn}))}}e.DOMCMapReaderFactory=dt;class vt extends o.BaseStandardFontDataFactory{_fetchData(Hn){return rt(Hn,!0)}}e.DOMStandardFontDataFactory=vt;class Ct extends o.BaseSVGFactory{_createSVG(Hn){return document.createElementNS(j,Hn)}}e.DOMSVGFactory=Ct;class Wt{constructor({viewBox:Hn,scale:Pn,rotation:kn,offsetX:Bn=0,offsetY:Kn=0,dontFlip:sr=!1}){this.viewBox=Hn,this.scale=Pn,this.rotation=kn,this.offsetX=Bn,this.offsetY=Kn;const fr=(Hn[2]+Hn[0])/2,ur=(Hn[3]+Hn[1])/2;let qn,gr,mr,Dr;switch(kn%=360,kn<0&&(kn+=360),kn){case 180:qn=-1,gr=0,mr=0,Dr=1;break;case 90:qn=0,gr=1,mr=1,Dr=0;break;case 270:qn=0,gr=-1,mr=-1,Dr=0;break;case 0:qn=1,gr=0,mr=0,Dr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}sr&&(mr=-mr,Dr=-Dr);let Cr,Mr,Tr,Rr;qn===0?(Cr=Math.abs(ur-Hn[1])*Pn+Bn,Mr=Math.abs(fr-Hn[0])*Pn+Kn,Tr=(Hn[3]-Hn[1])*Pn,Rr=(Hn[2]-Hn[0])*Pn):(Cr=Math.abs(fr-Hn[0])*Pn+Bn,Mr=Math.abs(ur-Hn[1])*Pn+Kn,Tr=(Hn[2]-Hn[0])*Pn,Rr=(Hn[3]-Hn[1])*Pn),this.transform=[qn*Pn,gr*Pn,mr*Pn,Dr*Pn,Cr-qn*Pn*fr-mr*Pn*ur,Mr-gr*Pn*fr-Dr*Pn*ur],this.width=Tr,this.height=Rr}get rawDims(){const{viewBox:Hn}=this;return(0,a.shadow)(this,"rawDims",{pageWidth:Hn[2]-Hn[0],pageHeight:Hn[3]-Hn[1],pageX:Hn[0],pageY:Hn[1]})}clone({scale:Hn=this.scale,rotation:Pn=this.rotation,offsetX:kn=this.offsetX,offsetY:Bn=this.offsetY,dontFlip:Kn=!1}={}){return new Wt({viewBox:this.viewBox.slice(),scale:Hn,rotation:Pn,offsetX:kn,offsetY:Bn,dontFlip:Kn})}convertToViewportPoint(Hn,Pn){return a.Util.applyTransform([Hn,Pn],this.transform)}convertToViewportRectangle(Hn){const Pn=a.Util.applyTransform([Hn[0],Hn[1]],this.transform),kn=a.Util.applyTransform([Hn[2],Hn[3]],this.transform);return[Pn[0],Pn[1],kn[0],kn[1]]}convertToPdfPoint(Hn,Pn){return a.Util.applyInverseTransform([Hn,Pn],this.transform)}}e.PageViewport=Wt;class Bt extends a.BaseException{constructor(Hn,Pn=0){super(Hn,"RenderingCancelledException"),this.extraDelay=Pn}}e.RenderingCancelledException=Bt;function qt(zn){const Hn=zn.length;let Pn=0;for(;Pn<Hn&&zn[Pn].trim()==="";)Pn++;return zn.substring(Pn,Pn+5).toLowerCase()==="data:"}function Ut(zn){return typeof zn=="string"&&/\.pdf$/i.test(zn)}function kt(zn,Hn=!1){return Hn||([zn]=zn.split(/[#?]/,1)),zn.substring(zn.lastIndexOf("/")+1)}function Nt(zn,Hn="document.pdf"){if(typeof zn!="string")return Hn;if(qt(zn))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Hn;const Pn=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,kn=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Bn=Pn.exec(zn);let Kn=kn.exec(Bn[1])||kn.exec(Bn[2])||kn.exec(Bn[3]);if(Kn&&(Kn=Kn[0],Kn.includes("%")))try{Kn=kn.exec(decodeURIComponent(Kn))[0]}catch{}return Kn||Hn}class un{constructor(){zr(this,"started",Object.create(null));zr(this,"times",[])}time(Hn){Hn in this.started&&(0,a.warn)(`Timer is already running for ${Hn}`),this.started[Hn]=Date.now()}timeEnd(Hn){Hn in this.started||(0,a.warn)(`Timer has not been started for ${Hn}`),this.times.push({name:Hn,start:this.started[Hn],end:Date.now()}),delete this.started[Hn]}toString(){const Hn=[];let Pn=0;for(const{name:kn}of this.times)Pn=Math.max(kn.length,Pn);for(const{name:kn,start:Bn,end:Kn}of this.times)Hn.push(`${kn.padEnd(Pn)} ${Kn-Bn}ms
`);return Hn.join("")}}e.StatTimer=un;function dn(zn,Hn){try{const{protocol:Pn}=Hn?new URL(zn,Hn):new URL(zn);return Pn==="http:"||Pn==="https:"}catch{return!1}}function hn(zn){zn.preventDefault()}function gn(zn,Hn=!1){return new Promise((Pn,kn)=>{const Bn=document.createElement("script");Bn.src=zn,Bn.onload=function(Kn){Hn&&Bn.remove(),Pn(Kn)},Bn.onerror=function(){kn(new Error(`Cannot load script at: ${Bn.src}`))},(document.head||document.documentElement).append(Bn)})}function It(zn){console.log("Deprecated API usage: "+zn)}let pt;class Dt{static toDateObject(Hn){if(!Hn||typeof Hn!="string")return null;pt||(pt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Pn=pt.exec(Hn);if(!Pn)return null;const kn=parseInt(Pn[1],10);let Bn=parseInt(Pn[2],10);Bn=Bn>=1&&Bn<=12?Bn-1:0;let Kn=parseInt(Pn[3],10);Kn=Kn>=1&&Kn<=31?Kn:1;let sr=parseInt(Pn[4],10);sr=sr>=0&&sr<=23?sr:0;let fr=parseInt(Pn[5],10);fr=fr>=0&&fr<=59?fr:0;let ur=parseInt(Pn[6],10);ur=ur>=0&&ur<=59?ur:0;const qn=Pn[7]||"Z";let gr=parseInt(Pn[8],10);gr=gr>=0&&gr<=23?gr:0;let mr=parseInt(Pn[9],10)||0;return mr=mr>=0&&mr<=59?mr:0,qn==="-"?(sr+=gr,fr+=mr):qn==="+"&&(sr-=gr,fr-=mr),new Date(Date.UTC(kn,Bn,Kn,sr,fr,ur))}}e.PDFDateString=Dt;function mn(zn,{scale:Hn=1,rotation:Pn=0}){const{width:kn,height:Bn}=zn.attributes.style,Kn=[0,0,parseInt(kn),parseInt(Bn)];return new Wt({viewBox:Kn,scale:Hn,rotation:Pn})}function Lt(zn){if(zn.startsWith("#")){const Hn=parseInt(zn.slice(1),16);return[(Hn&16711680)>>16,(Hn&65280)>>8,Hn&255]}return zn.startsWith("rgb(")?zn.slice(4,-1).split(",").map(Hn=>parseInt(Hn)):zn.startsWith("rgba(")?zn.slice(5,-1).split(",").map(Hn=>parseInt(Hn)).slice(0,3):((0,a.warn)(`Not a valid color format: "${zn}"`),[0,0,0])}function yn(zn){const Hn=document.createElement("span");Hn.style.visibility="hidden",document.body.append(Hn);for(const Pn of zn.keys()){Hn.style.color=Pn;const kn=window.getComputedStyle(Hn).color;zn.set(Pn,Lt(kn))}Hn.remove()}function fn(zn){const{a:Hn,b:Pn,c:kn,d:Bn,e:Kn,f:sr}=zn.getTransform();return[Hn,Pn,kn,Bn,Kn,sr]}function $n(zn){const{a:Hn,b:Pn,c:kn,d:Bn,e:Kn,f:sr}=zn.getTransform().invertSelf();return[Hn,Pn,kn,Bn,Kn,sr]}function Ln(zn,Hn,Pn=!1,kn=!0){if(Hn instanceof Wt){const{pageWidth:Bn,pageHeight:Kn}=Hn.rawDims,{style:sr}=zn,fr=a.FeatureTest.isCSSRoundSupported,ur=`var(--scale-factor) * ${Bn}px`,qn=`var(--scale-factor) * ${Kn}px`,gr=fr?`round(${ur}, 1px)`:`calc(${ur})`,mr=fr?`round(${qn}, 1px)`:`calc(${qn})`;!Pn||Hn.rotation%180===0?(sr.width=gr,sr.height=mr):(sr.width=mr,sr.height=gr)}kn&&zn.setAttribute("data-main-rotation",Hn.rotation)}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var o=i(1);class a{constructor(){this.constructor===a&&(0,o.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(dt){return"none"}addHCMFilter(dt,vt){return"none"}addHighlightHCMFilter(dt,vt,Ct,Wt){return"none"}destroy(dt=!1){}}e.BaseFilterFactory=a;class j{constructor(){this.constructor===j&&(0,o.unreachable)("Cannot initialize BaseCanvasFactory.")}create(dt,vt){if(dt<=0||vt<=0)throw new Error("Invalid canvas size");const Ct=this._createCanvas(dt,vt);return{canvas:Ct,context:Ct.getContext("2d")}}reset(dt,vt,Ct){if(!dt.canvas)throw new Error("Canvas is not specified");if(vt<=0||Ct<=0)throw new Error("Invalid canvas size");dt.canvas.width=vt,dt.canvas.height=Ct}destroy(dt){if(!dt.canvas)throw new Error("Canvas is not specified");dt.canvas.width=0,dt.canvas.height=0,dt.canvas=null,dt.context=null}_createCanvas(dt,vt){(0,o.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=j;class _e{constructor({baseUrl:dt=null,isCompressed:vt=!0}){this.constructor===_e&&(0,o.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=dt,this.isCompressed=vt}async fetch({name:dt}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!dt)throw new Error("CMap name must be specified.");const vt=this.baseUrl+dt+(this.isCompressed?".bcmap":""),Ct=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE;return this._fetchData(vt,Ct).catch(Wt=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${vt}`)})}_fetchData(dt,vt){(0,o.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=_e;class tt{constructor({baseUrl:dt=null}){this.constructor===tt&&(0,o.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=dt}async fetch({filename:dt}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!dt)throw new Error("Font filename must be specified.");const vt=`${this.baseUrl}${dt}`;return this._fetchData(vt).catch(Ct=>{throw new Error(`Unable to load font data at: ${vt}`)})}_fetchData(dt){(0,o.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=tt;class et{constructor(){this.constructor===et&&(0,o.unreachable)("Cannot initialize BaseSVGFactory.")}create(dt,vt,Ct=!1){if(dt<=0||vt<=0)throw new Error("Invalid SVG dimensions");const Wt=this._createSVG("svg:svg");return Wt.setAttribute("version","1.1"),Ct||(Wt.setAttribute("width",`${dt}px`),Wt.setAttribute("height",`${vt}px`)),Wt.setAttribute("preserveAspectRatio","none"),Wt.setAttribute("viewBox",`0 0 ${dt} ${vt}`),Wt}createElement(dt){if(typeof dt!="string")throw new Error("Invalid SVG element type");return this._createSVG(dt)}_createSVG(dt){(0,o.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=et},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var o=i(1);const a=3285377520,j=4294901760,_e=65535;class tt{constructor(rt){this.h1=rt?rt&4294967295:a,this.h2=rt?rt&4294967295:a}update(rt){let dt,vt;if(typeof rt=="string"){dt=new Uint8Array(rt.length*2),vt=0;for(let It=0,pt=rt.length;It<pt;It++){const Dt=rt.charCodeAt(It);Dt<=255?dt[vt++]=Dt:(dt[vt++]=Dt>>>8,dt[vt++]=Dt&255)}}else if((0,o.isArrayBuffer)(rt))dt=rt.slice(),vt=dt.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const Ct=vt>>2,Wt=vt-Ct*4,Bt=new Uint32Array(dt.buffer,0,Ct);let qt=0,Ut=0,kt=this.h1,Nt=this.h2;const un=3432918353,dn=461845907,hn=un&_e,gn=dn&_e;for(let It=0;It<Ct;It++)It&1?(qt=Bt[It],qt=qt*un&j|qt*hn&_e,qt=qt<<15|qt>>>17,qt=qt*dn&j|qt*gn&_e,kt^=qt,kt=kt<<13|kt>>>19,kt=kt*5+3864292196):(Ut=Bt[It],Ut=Ut*un&j|Ut*hn&_e,Ut=Ut<<15|Ut>>>17,Ut=Ut*dn&j|Ut*gn&_e,Nt^=Ut,Nt=Nt<<13|Nt>>>19,Nt=Nt*5+3864292196);switch(qt=0,Wt){case 3:qt^=dt[Ct*4+2]<<16;case 2:qt^=dt[Ct*4+1]<<8;case 1:qt^=dt[Ct*4],qt=qt*un&j|qt*hn&_e,qt=qt<<15|qt>>>17,qt=qt*dn&j|qt*gn&_e,Ct&1?kt^=qt:Nt^=qt}this.h1=kt,this.h2=Nt}hexdigest(){let rt=this.h1,dt=this.h2;return rt^=dt>>>1,rt=rt*3981806797&j|rt*36045&_e,dt=dt*4283543511&j|((dt<<16|rt>>>16)*2950163797&j)>>>16,rt^=dt>>>1,rt=rt*444984403&j|rt*60499&_e,dt=dt*3301882366&j|((dt<<16|rt>>>16)*3120437893&j)>>>16,rt^=dt>>>1,(rt>>>0).toString(16).padStart(8,"0")+(dt>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=tt},(s,e,i)=>{var _e;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var o=i(1);class a{constructor({ownerDocument:et=globalThis.document,styleElement:rt=null}){Yn(this,_e,new Set);this._document=et,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(et){this.nativeFontFaces.add(et),this._document.fonts.add(et)}removeNativeFontFace(et){this.nativeFontFaces.delete(et),this._document.fonts.delete(et)}insertRule(et){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const rt=this.styleElement.sheet;rt.insertRule(et,rt.cssRules.length)}clear(){for(const et of this.nativeFontFaces)this._document.fonts.delete(et);this.nativeFontFaces.clear(),Kt(this,_e).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(et){if(!(!et||Kt(this,_e).has(et.loadedName))){if((0,o.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:rt,src:dt,style:vt}=et,Ct=new FontFace(rt,dt,vt);this.addNativeFontFace(Ct);try{await Ct.load(),Kt(this,_e).add(rt)}catch{(0,o.warn)(`Cannot load system font: ${et.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(Ct)}return}(0,o.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(et){if(et.attached||et.missingFile&&!et.systemFontInfo)return;if(et.attached=!0,et.systemFontInfo){await this.loadSystemFont(et.systemFontInfo);return}if(this.isFontLoadingAPISupported){const dt=et.createNativeFontFace();if(dt){this.addNativeFontFace(dt);try{await dt.loaded}catch(vt){throw(0,o.warn)(`Failed to load font '${dt.family}': '${vt}'.`),et.disableFontFace=!0,vt}}return}const rt=et.createFontFaceRule();if(rt){if(this.insertRule(rt),this.isSyncFontLoadingSupported)return;await new Promise(dt=>{const vt=this._queueLoadingCallback(dt);this._prepareFontLoadEvent(et,vt)})}}get isFontLoadingAPISupported(){var rt;const et=!!((rt=this._document)!=null&&rt.fonts);return(0,o.shadow)(this,"isFontLoadingAPISupported",et)}get isSyncFontLoadingSupported(){let et=!1;return(o.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(et=!0),(0,o.shadow)(this,"isSyncFontLoadingSupported",et)}_queueLoadingCallback(et){function rt(){for((0,o.assert)(!vt.done,"completeRequest() cannot be called twice."),vt.done=!0;dt.length>0&&dt[0].done;){const Ct=dt.shift();setTimeout(Ct.callback,0)}}const{loadingRequests:dt}=this,vt={done:!1,complete:rt,callback:et};return dt.push(vt),vt}get _loadTestFont(){const et=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,o.shadow)(this,"_loadTestFont",et)}_prepareFontLoadEvent(et,rt){function dt(Lt,yn){return Lt.charCodeAt(yn)<<24|Lt.charCodeAt(yn+1)<<16|Lt.charCodeAt(yn+2)<<8|Lt.charCodeAt(yn+3)&255}function vt(Lt,yn,fn,$n){const Ln=Lt.substring(0,yn),jn=Lt.substring(yn+fn);return Ln+$n+jn}let Ct,Wt;const Bt=this._document.createElement("canvas");Bt.width=1,Bt.height=1;const qt=Bt.getContext("2d");let Ut=0;function kt(Lt,yn){if(++Ut>30){(0,o.warn)("Load test font never loaded."),yn();return}if(qt.font="30px "+Lt,qt.fillText(".",0,20),qt.getImageData(0,0,1,1).data[3]>0){yn();return}setTimeout(kt.bind(null,Lt,yn))}const Nt=`lt${Date.now()}${this.loadTestFontId++}`;let un=this._loadTestFont;un=vt(un,976,Nt.length,Nt);const hn=16,gn=1482184792;let It=dt(un,hn);for(Ct=0,Wt=Nt.length-3;Ct<Wt;Ct+=4)It=It-gn+dt(Nt,Ct)|0;Ct<Nt.length&&(It=It-gn+dt(Nt+"XXX",Ct)|0),un=vt(un,hn,4,(0,o.string32)(It));const pt=`url(data:font/opentype;base64,${btoa(un)});`,Dt=`@font-face {font-family:"${Nt}";src:${pt}}`;this.insertRule(Dt);const mn=this._document.createElement("div");mn.style.visibility="hidden",mn.style.width=mn.style.height="10px",mn.style.position="absolute",mn.style.top=mn.style.left="0px";for(const Lt of[et.loadedName,Nt]){const yn=this._document.createElement("span");yn.textContent="Hi",yn.style.fontFamily=Lt,mn.append(yn)}this._document.body.append(mn),kt(Nt,()=>{mn.remove(),rt.complete()})}}_e=new WeakMap,e.FontLoader=a;class j{constructor(et,{isEvalSupported:rt=!0,disableFontFace:dt=!1,ignoreErrors:vt=!1,inspectFont:Ct=null}){this.compiledGlyphs=Object.create(null);for(const Wt in et)this[Wt]=et[Wt];this.isEvalSupported=rt!==!1,this.disableFontFace=dt===!0,this.ignoreErrors=vt===!0,this._inspectFont=Ct}createNativeFontFace(){var rt;if(!this.data||this.disableFontFace)return null;let et;if(!this.cssFontInfo)et=new FontFace(this.loadedName,this.data,{});else{const dt={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(dt.style=`oblique ${this.cssFontInfo.italicAngle}deg`),et=new FontFace(this.cssFontInfo.fontFamily,this.data,dt)}return(rt=this._inspectFont)==null||rt.call(this,this),et}createFontFaceRule(){var vt;if(!this.data||this.disableFontFace)return null;const et=(0,o.bytesToString)(this.data),rt=`url(data:${this.mimetype};base64,${btoa(et)});`;let dt;if(!this.cssFontInfo)dt=`@font-face {font-family:"${this.loadedName}";src:${rt}}`;else{let Ct=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(Ct+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),dt=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${Ct}src:${rt}}`}return(vt=this._inspectFont)==null||vt.call(this,this,rt),dt}getPathGenerator(et,rt){if(this.compiledGlyphs[rt]!==void 0)return this.compiledGlyphs[rt];let dt;try{dt=et.get(this.loadedName+"_path_"+rt)}catch(vt){if(!this.ignoreErrors)throw vt;return(0,o.warn)(`getPathGenerator - ignoring character: "${vt}".`),this.compiledGlyphs[rt]=function(Ct,Wt){}}if(this.isEvalSupported&&o.FeatureTest.isEvalSupported){const vt=[];for(const Ct of dt){const Wt=Ct.args!==void 0?Ct.args.join(","):"";vt.push("c.",Ct.cmd,"(",Wt,`);
`)}return this.compiledGlyphs[rt]=new Function("c","size",vt.join(""))}return this.compiledGlyphs[rt]=function(vt,Ct){for(const Wt of dt)Wt.cmd==="scale"&&(Wt.args=[Ct,-Ct]),vt[Wt.cmd].apply(vt,Wt.args)}}}e.FontFaceObject=j},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var o=i(7);i(1);const a=function(rt){return new Promise((dt,vt)=>{require$$5.readFile(rt,(Wt,Bt)=>{if(Wt||!Bt){vt(new Error(Wt));return}dt(new Uint8Array(Bt))})})};class j extends o.BaseFilterFactory{}e.NodeFilterFactory=j;class _e extends o.BaseCanvasFactory{_createCanvas(dt,vt){return require$$5.createCanvas(dt,vt)}}e.NodeCanvasFactory=_e;class tt extends o.BaseCMapReaderFactory{_fetchData(dt,vt){return a(dt).then(Ct=>({cMapData:Ct,compressionType:vt}))}}e.NodeCMapReaderFactory=tt;class et extends o.BaseStandardFontDataFactory{_fetchData(dt){return a(dt)}}e.NodeStandardFontDataFactory=et},(s,e,i)=>{var Vn,Vo,Oo;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var o=i(1),a=i(6),j=i(12),_e=i(13);const tt=16,et=100,rt=4096,dt=15,vt=10,Ct=1e3,Wt=16;function Bt(Tn,pn){if(Tn._removeMirroring)throw new Error("Context is already forwarding operations.");Tn.__originalSave=Tn.save,Tn.__originalRestore=Tn.restore,Tn.__originalRotate=Tn.rotate,Tn.__originalScale=Tn.scale,Tn.__originalTranslate=Tn.translate,Tn.__originalTransform=Tn.transform,Tn.__originalSetTransform=Tn.setTransform,Tn.__originalResetTransform=Tn.resetTransform,Tn.__originalClip=Tn.clip,Tn.__originalMoveTo=Tn.moveTo,Tn.__originalLineTo=Tn.lineTo,Tn.__originalBezierCurveTo=Tn.bezierCurveTo,Tn.__originalRect=Tn.rect,Tn.__originalClosePath=Tn.closePath,Tn.__originalBeginPath=Tn.beginPath,Tn._removeMirroring=()=>{Tn.save=Tn.__originalSave,Tn.restore=Tn.__originalRestore,Tn.rotate=Tn.__originalRotate,Tn.scale=Tn.__originalScale,Tn.translate=Tn.__originalTranslate,Tn.transform=Tn.__originalTransform,Tn.setTransform=Tn.__originalSetTransform,Tn.resetTransform=Tn.__originalResetTransform,Tn.clip=Tn.__originalClip,Tn.moveTo=Tn.__originalMoveTo,Tn.lineTo=Tn.__originalLineTo,Tn.bezierCurveTo=Tn.__originalBezierCurveTo,Tn.rect=Tn.__originalRect,Tn.closePath=Tn.__originalClosePath,Tn.beginPath=Tn.__originalBeginPath,delete Tn._removeMirroring},Tn.save=function(){pn.save(),this.__originalSave()},Tn.restore=function(){pn.restore(),this.__originalRestore()},Tn.translate=function(An,bn){pn.translate(An,bn),this.__originalTranslate(An,bn)},Tn.scale=function(An,bn){pn.scale(An,bn),this.__originalScale(An,bn)},Tn.transform=function(An,bn,wn,Cn,Un,Gn){pn.transform(An,bn,wn,Cn,Un,Gn),this.__originalTransform(An,bn,wn,Cn,Un,Gn)},Tn.setTransform=function(An,bn,wn,Cn,Un,Gn){pn.setTransform(An,bn,wn,Cn,Un,Gn),this.__originalSetTransform(An,bn,wn,Cn,Un,Gn)},Tn.resetTransform=function(){pn.resetTransform(),this.__originalResetTransform()},Tn.rotate=function(An){pn.rotate(An),this.__originalRotate(An)},Tn.clip=function(An){pn.clip(An),this.__originalClip(An)},Tn.moveTo=function(En,An){pn.moveTo(En,An),this.__originalMoveTo(En,An)},Tn.lineTo=function(En,An){pn.lineTo(En,An),this.__originalLineTo(En,An)},Tn.bezierCurveTo=function(En,An,bn,wn,Cn,Un){pn.bezierCurveTo(En,An,bn,wn,Cn,Un),this.__originalBezierCurveTo(En,An,bn,wn,Cn,Un)},Tn.rect=function(En,An,bn,wn){pn.rect(En,An,bn,wn),this.__originalRect(En,An,bn,wn)},Tn.closePath=function(){pn.closePath(),this.__originalClosePath()},Tn.beginPath=function(){pn.beginPath(),this.__originalBeginPath()}}class qt{constructor(pn){this.canvasFactory=pn,this.cache=Object.create(null)}getCanvas(pn,En,An){let bn;return this.cache[pn]!==void 0?(bn=this.cache[pn],this.canvasFactory.reset(bn,En,An)):(bn=this.canvasFactory.create(En,An),this.cache[pn]=bn),bn}delete(pn){delete this.cache[pn]}clear(){for(const pn in this.cache){const En=this.cache[pn];this.canvasFactory.destroy(En),delete this.cache[pn]}}}function Ut(Tn,pn,En,An,bn,wn,Cn,Un,Gn,er){const[nr,ar,or,lr,zn,Hn]=(0,a.getCurrentTransform)(Tn);if(ar===0&&or===0){const Bn=Cn*nr+zn,Kn=Math.round(Bn),sr=Un*lr+Hn,fr=Math.round(sr),ur=(Cn+Gn)*nr+zn,qn=Math.abs(Math.round(ur)-Kn)||1,gr=(Un+er)*lr+Hn,mr=Math.abs(Math.round(gr)-fr)||1;return Tn.setTransform(Math.sign(nr),0,0,Math.sign(lr),Kn,fr),Tn.drawImage(pn,En,An,bn,wn,0,0,qn,mr),Tn.setTransform(nr,ar,or,lr,zn,Hn),[qn,mr]}if(nr===0&&lr===0){const Bn=Un*or+zn,Kn=Math.round(Bn),sr=Cn*ar+Hn,fr=Math.round(sr),ur=(Un+er)*or+zn,qn=Math.abs(Math.round(ur)-Kn)||1,gr=(Cn+Gn)*ar+Hn,mr=Math.abs(Math.round(gr)-fr)||1;return Tn.setTransform(0,Math.sign(ar),Math.sign(or),0,Kn,fr),Tn.drawImage(pn,En,An,bn,wn,0,0,mr,qn),Tn.setTransform(nr,ar,or,lr,zn,Hn),[mr,qn]}Tn.drawImage(pn,En,An,bn,wn,Cn,Un,Gn,er);const Pn=Math.hypot(nr,ar),kn=Math.hypot(or,lr);return[Pn*Gn,kn*er]}function kt(Tn){const{width:pn,height:En}=Tn;if(pn>Ct||En>Ct)return null;const An=1e3,bn=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),wn=pn+1;let Cn=new Uint8Array(wn*(En+1)),Un,Gn,er;const nr=pn+7&-8;let ar=new Uint8Array(nr*En),or=0;for(const kn of Tn.data){let Bn=128;for(;Bn>0;)ar[or++]=kn&Bn?0:255,Bn>>=1}let lr=0;for(or=0,ar[or]!==0&&(Cn[0]=1,++lr),Gn=1;Gn<pn;Gn++)ar[or]!==ar[or+1]&&(Cn[Gn]=ar[or]?2:1,++lr),or++;for(ar[or]!==0&&(Cn[Gn]=2,++lr),Un=1;Un<En;Un++){or=Un*nr,er=Un*wn,ar[or-nr]!==ar[or]&&(Cn[er]=ar[or]?1:8,++lr);let kn=(ar[or]?4:0)+(ar[or-nr]?8:0);for(Gn=1;Gn<pn;Gn++)kn=(kn>>2)+(ar[or+1]?4:0)+(ar[or-nr+1]?8:0),bn[kn]&&(Cn[er+Gn]=bn[kn],++lr),or++;if(ar[or-nr]!==ar[or]&&(Cn[er+Gn]=ar[or]?2:4,++lr),lr>An)return null}for(or=nr*(En-1),er=Un*wn,ar[or]!==0&&(Cn[er]=8,++lr),Gn=1;Gn<pn;Gn++)ar[or]!==ar[or+1]&&(Cn[er+Gn]=ar[or]?4:8,++lr),or++;if(ar[or]!==0&&(Cn[er+Gn]=4,++lr),lr>An)return null;const zn=new Int32Array([0,wn,-1,0,-wn,0,0,0,1]),Hn=new Path2D;for(Un=0;lr&&Un<=En;Un++){let kn=Un*wn;const Bn=kn+pn;for(;kn<Bn&&!Cn[kn];)kn++;if(kn===Bn)continue;Hn.moveTo(kn%wn,Un);const Kn=kn;let sr=Cn[kn];do{const fr=zn[sr];do kn+=fr;while(!Cn[kn]);const ur=Cn[kn];ur!==5&&ur!==10?(sr=ur,Cn[kn]=0):(sr=ur&51*sr>>4,Cn[kn]&=sr>>2|sr<<2),Hn.lineTo(kn%wn,kn/wn|0),Cn[kn]||--lr}while(Kn!==kn);--Un}return ar=null,Cn=null,function(kn){kn.save(),kn.scale(1/pn,-1/En),kn.translate(0,-En),kn.fill(Hn),kn.beginPath(),kn.restore()}}class Nt{constructor(pn,En){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=o.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=o.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,pn,En])}clone(){const pn=Object.create(this);return pn.clipBox=this.clipBox.slice(),pn}setCurrentPoint(pn,En){this.x=pn,this.y=En}updatePathMinMax(pn,En,An){[En,An]=o.Util.applyTransform([En,An],pn),this.minX=Math.min(this.minX,En),this.minY=Math.min(this.minY,An),this.maxX=Math.max(this.maxX,En),this.maxY=Math.max(this.maxY,An)}updateRectMinMax(pn,En){const An=o.Util.applyTransform(En,pn),bn=o.Util.applyTransform(En.slice(2),pn);this.minX=Math.min(this.minX,An[0],bn[0]),this.minY=Math.min(this.minY,An[1],bn[1]),this.maxX=Math.max(this.maxX,An[0],bn[0]),this.maxY=Math.max(this.maxY,An[1],bn[1])}updateScalingPathMinMax(pn,En){o.Util.scaleMinMax(pn,En),this.minX=Math.min(this.minX,En[0]),this.maxX=Math.max(this.maxX,En[1]),this.minY=Math.min(this.minY,En[2]),this.maxY=Math.max(this.maxY,En[3])}updateCurvePathMinMax(pn,En,An,bn,wn,Cn,Un,Gn,er,nr){const ar=o.Util.bezierBoundingBox(En,An,bn,wn,Cn,Un,Gn,er);if(nr){nr[0]=Math.min(nr[0],ar[0],ar[2]),nr[1]=Math.max(nr[1],ar[0],ar[2]),nr[2]=Math.min(nr[2],ar[1],ar[3]),nr[3]=Math.max(nr[3],ar[1],ar[3]);return}this.updateRectMinMax(pn,ar)}getPathBoundingBox(pn=j.PathType.FILL,En=null){const An=[this.minX,this.minY,this.maxX,this.maxY];if(pn===j.PathType.STROKE){En||(0,o.unreachable)("Stroke bounding box must include transform.");const bn=o.Util.singularValueDecompose2dScale(En),wn=bn[0]*this.lineWidth/2,Cn=bn[1]*this.lineWidth/2;An[0]-=wn,An[1]-=Cn,An[2]+=wn,An[3]+=Cn}return An}updateClipFromPath(){const pn=o.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(pn||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(pn){this.clipBox=pn,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(pn=j.PathType.FILL,En=null){return o.Util.intersect(this.clipBox,this.getPathBoundingBox(pn,En))}}function un(Tn,pn){if(typeof ImageData<"u"&&pn instanceof ImageData){Tn.putImageData(pn,0,0);return}const En=pn.height,An=pn.width,bn=En%Wt,wn=(En-bn)/Wt,Cn=bn===0?wn:wn+1,Un=Tn.createImageData(An,Wt);let Gn=0,er;const nr=pn.data,ar=Un.data;let or,lr,zn,Hn;if(pn.kind===o.ImageKind.GRAYSCALE_1BPP){const Pn=nr.byteLength,kn=new Uint32Array(ar.buffer,0,ar.byteLength>>2),Bn=kn.length,Kn=An+7>>3,sr=4294967295,fr=o.FeatureTest.isLittleEndian?4278190080:255;for(or=0;or<Cn;or++){for(zn=or<wn?Wt:bn,er=0,lr=0;lr<zn;lr++){const ur=Pn-Gn;let qn=0;const gr=ur>Kn?An:ur*8-7,mr=gr&-8;let Dr=0,Cr=0;for(;qn<mr;qn+=8)Cr=nr[Gn++],kn[er++]=Cr&128?sr:fr,kn[er++]=Cr&64?sr:fr,kn[er++]=Cr&32?sr:fr,kn[er++]=Cr&16?sr:fr,kn[er++]=Cr&8?sr:fr,kn[er++]=Cr&4?sr:fr,kn[er++]=Cr&2?sr:fr,kn[er++]=Cr&1?sr:fr;for(;qn<gr;qn++)Dr===0&&(Cr=nr[Gn++],Dr=128),kn[er++]=Cr&Dr?sr:fr,Dr>>=1}for(;er<Bn;)kn[er++]=0;Tn.putImageData(Un,0,or*Wt)}}else if(pn.kind===o.ImageKind.RGBA_32BPP){for(lr=0,Hn=An*Wt*4,or=0;or<wn;or++)ar.set(nr.subarray(Gn,Gn+Hn)),Gn+=Hn,Tn.putImageData(Un,0,lr),lr+=Wt;or<Cn&&(Hn=An*bn*4,ar.set(nr.subarray(Gn,Gn+Hn)),Tn.putImageData(Un,0,lr))}else if(pn.kind===o.ImageKind.RGB_24BPP)for(zn=Wt,Hn=An*zn,or=0;or<Cn;or++){for(or>=wn&&(zn=bn,Hn=An*zn),er=0,lr=Hn;lr--;)ar[er++]=nr[Gn++],ar[er++]=nr[Gn++],ar[er++]=nr[Gn++],ar[er++]=255;Tn.putImageData(Un,0,or*Wt)}else throw new Error(`bad image kind: ${pn.kind}`)}function dn(Tn,pn){if(pn.bitmap){Tn.drawImage(pn.bitmap,0,0);return}const En=pn.height,An=pn.width,bn=En%Wt,wn=(En-bn)/Wt,Cn=bn===0?wn:wn+1,Un=Tn.createImageData(An,Wt);let Gn=0;const er=pn.data,nr=Un.data;for(let ar=0;ar<Cn;ar++){const or=ar<wn?Wt:bn;({srcPos:Gn}=(0,_e.convertBlackAndWhiteToRGBA)({src:er,srcPos:Gn,dest:nr,width:An,height:or,nonBlackColor:0})),Tn.putImageData(Un,0,ar*Wt)}}function hn(Tn,pn){const En=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const An of En)Tn[An]!==void 0&&(pn[An]=Tn[An]);Tn.setLineDash!==void 0&&(pn.setLineDash(Tn.getLineDash()),pn.lineDashOffset=Tn.lineDashOffset)}function gn(Tn){if(Tn.strokeStyle=Tn.fillStyle="#000000",Tn.fillRule="nonzero",Tn.globalAlpha=1,Tn.lineWidth=1,Tn.lineCap="butt",Tn.lineJoin="miter",Tn.miterLimit=10,Tn.globalCompositeOperation="source-over",Tn.font="10px sans-serif",Tn.setLineDash!==void 0&&(Tn.setLineDash([]),Tn.lineDashOffset=0),!o.isNodeJS){const{filter:pn}=Tn;pn!=="none"&&pn!==""&&(Tn.filter="none")}}function It(Tn,pn,En,An){const bn=Tn.length;for(let wn=3;wn<bn;wn+=4){const Cn=Tn[wn];if(Cn===0)Tn[wn-3]=pn,Tn[wn-2]=En,Tn[wn-1]=An;else if(Cn<255){const Un=255-Cn;Tn[wn-3]=Tn[wn-3]*Cn+pn*Un>>8,Tn[wn-2]=Tn[wn-2]*Cn+En*Un>>8,Tn[wn-1]=Tn[wn-1]*Cn+An*Un>>8}}}function pt(Tn,pn,En){const An=Tn.length,bn=1/255;for(let wn=3;wn<An;wn+=4){const Cn=En?En[Tn[wn]]:Tn[wn];pn[wn]=pn[wn]*Cn*bn|0}}function Dt(Tn,pn,En){const An=Tn.length;for(let bn=3;bn<An;bn+=4){const wn=Tn[bn-3]*77+Tn[bn-2]*152+Tn[bn-1]*28;pn[bn]=En?pn[bn]*En[wn>>8]>>8:pn[bn]*wn>>16}}function mn(Tn,pn,En,An,bn,wn,Cn,Un,Gn,er,nr){const ar=!!wn,or=ar?wn[0]:0,lr=ar?wn[1]:0,zn=ar?wn[2]:0,Hn=bn==="Luminosity"?Dt:pt,kn=Math.min(An,Math.ceil(1048576/En));for(let Bn=0;Bn<An;Bn+=kn){const Kn=Math.min(kn,An-Bn),sr=Tn.getImageData(Un-er,Bn+(Gn-nr),En,Kn),fr=pn.getImageData(Un,Bn+Gn,En,Kn);ar&&It(sr.data,or,lr,zn),Hn(sr.data,fr.data,Cn),pn.putImageData(fr,Un,Bn+Gn)}}function Lt(Tn,pn,En,An){const bn=An[0],wn=An[1],Cn=An[2]-bn,Un=An[3]-wn;Cn===0||Un===0||(mn(pn.context,En,Cn,Un,pn.subtype,pn.backdrop,pn.transferMap,bn,wn,pn.offsetX,pn.offsetY),Tn.save(),Tn.globalAlpha=1,Tn.globalCompositeOperation="source-over",Tn.setTransform(1,0,0,1,0,0),Tn.drawImage(En.canvas,0,0),Tn.restore())}function yn(Tn,pn){const En=o.Util.singularValueDecompose2dScale(Tn);En[0]=Math.fround(En[0]),En[1]=Math.fround(En[1]);const An=Math.fround((globalThis.devicePixelRatio||1)*a.PixelsPerInch.PDF_TO_CSS_UNITS);return pn!==void 0?pn:En[0]<=An||En[1]<=An}const fn=["butt","round","square"],$n=["miter","round","bevel"],Ln={},jn={},Fn=class Fn{constructor(pn,En,An,bn,wn,{optionalContentConfig:Cn,markedContentStack:Un=null},Gn,er){Yn(this,Vn);this.ctx=pn,this.current=new Nt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=En,this.objs=An,this.canvasFactory=bn,this.filterFactory=wn,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Un||[],this.optionalContentConfig=Cn,this.cachedCanvases=new qt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Gn,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=er,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(pn,En=null){return typeof pn=="string"?pn.startsWith("g_")?this.commonObjs.get(pn):this.objs.get(pn):En}beginDrawing({transform:pn,viewport:En,transparency:An=!1,background:bn=null}){const wn=this.ctx.canvas.width,Cn=this.ctx.canvas.height,Un=this.ctx.fillStyle;if(this.ctx.fillStyle=bn||"#ffffff",this.ctx.fillRect(0,0,wn,Cn),this.ctx.fillStyle=Un,An){const Gn=this.cachedCanvases.getCanvas("transparent",wn,Cn);this.compositeCtx=this.ctx,this.transparentCanvas=Gn.canvas,this.ctx=Gn.context,this.ctx.save(),this.ctx.transform(...(0,a.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),gn(this.ctx),pn&&(this.ctx.transform(...pn),this.outputScaleX=pn[0],this.outputScaleY=pn[0]),this.ctx.transform(...En.transform),this.viewportScale=En.scale,this.baseTransform=(0,a.getCurrentTransform)(this.ctx)}executeOperatorList(pn,En,An,bn){const wn=pn.argsArray,Cn=pn.fnArray;let Un=En||0;const Gn=wn.length;if(Gn===Un)return Un;const er=Gn-Un>vt&&typeof An=="function",nr=er?Date.now()+dt:0;let ar=0;const or=this.commonObjs,lr=this.objs;let zn;for(;;){if(bn!==void 0&&Un===bn.nextBreakPoint)return bn.breakIt(Un,An),Un;if(zn=Cn[Un],zn!==o.OPS.dependency)this[zn].apply(this,wn[Un]);else for(const Hn of wn[Un]){const Pn=Hn.startsWith("g_")?or:lr;if(!Pn.has(Hn))return Pn.get(Hn,An),Un}if(Un++,Un===Gn)return Un;if(er&&++ar>vt){if(Date.now()>nr)return An(),Un;ar=0}}}endDrawing(){Wn(this,Vn,Vo).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const pn of this._cachedBitmapsMap.values()){for(const En of pn.values())typeof HTMLCanvasElement<"u"&&En instanceof HTMLCanvasElement&&(En.width=En.height=0);pn.clear()}this._cachedBitmapsMap.clear(),Wn(this,Vn,Oo).call(this)}_scaleImage(pn,En){const An=pn.width,bn=pn.height;let wn=Math.max(Math.hypot(En[0],En[1]),1),Cn=Math.max(Math.hypot(En[2],En[3]),1),Un=An,Gn=bn,er="prescale1",nr,ar;for(;wn>2&&Un>1||Cn>2&&Gn>1;){let or=Un,lr=Gn;wn>2&&Un>1&&(or=Un>=16384?Math.floor(Un/2)-1||1:Math.ceil(Un/2),wn/=Un/or),Cn>2&&Gn>1&&(lr=Gn>=16384?Math.floor(Gn/2)-1||1:Math.ceil(Gn)/2,Cn/=Gn/lr),nr=this.cachedCanvases.getCanvas(er,or,lr),ar=nr.context,ar.clearRect(0,0,or,lr),ar.drawImage(pn,0,0,Un,Gn,0,0,or,lr),pn=nr.canvas,Un=or,Gn=lr,er=er==="prescale1"?"prescale2":"prescale1"}return{img:pn,paintWidth:Un,paintHeight:Gn}}_createMaskCanvas(pn){const En=this.ctx,{width:An,height:bn}=pn,wn=this.current.fillColor,Cn=this.current.patternFill,Un=(0,a.getCurrentTransform)(En);let Gn,er,nr,ar;if((pn.bitmap||pn.data)&&pn.count>1){const qn=pn.bitmap||pn.data.buffer;er=JSON.stringify(Cn?Un:[Un.slice(0,4),wn]),Gn=this._cachedBitmapsMap.get(qn),Gn||(Gn=new Map,this._cachedBitmapsMap.set(qn,Gn));const gr=Gn.get(er);if(gr&&!Cn){const mr=Math.round(Math.min(Un[0],Un[2])+Un[4]),Dr=Math.round(Math.min(Un[1],Un[3])+Un[5]);return{canvas:gr,offsetX:mr,offsetY:Dr}}nr=gr}nr||(ar=this.cachedCanvases.getCanvas("maskCanvas",An,bn),dn(ar.context,pn));let or=o.Util.transform(Un,[1/An,0,0,-1/bn,0,0]);or=o.Util.transform(or,[1,0,0,1,0,-bn]);const lr=o.Util.applyTransform([0,0],or),zn=o.Util.applyTransform([An,bn],or),Hn=o.Util.normalizeRect([lr[0],lr[1],zn[0],zn[1]]),Pn=Math.round(Hn[2]-Hn[0])||1,kn=Math.round(Hn[3]-Hn[1])||1,Bn=this.cachedCanvases.getCanvas("fillCanvas",Pn,kn),Kn=Bn.context,sr=Math.min(lr[0],zn[0]),fr=Math.min(lr[1],zn[1]);Kn.translate(-sr,-fr),Kn.transform(...or),nr||(nr=this._scaleImage(ar.canvas,(0,a.getCurrentTransformInverse)(Kn)),nr=nr.img,Gn&&Cn&&Gn.set(er,nr)),Kn.imageSmoothingEnabled=yn((0,a.getCurrentTransform)(Kn),pn.interpolate),Ut(Kn,nr,0,0,nr.width,nr.height,0,0,An,bn),Kn.globalCompositeOperation="source-in";const ur=o.Util.transform((0,a.getCurrentTransformInverse)(Kn),[1,0,0,1,-sr,-fr]);return Kn.fillStyle=Cn?wn.getPattern(En,this,ur,j.PathType.FILL):wn,Kn.fillRect(0,0,An,bn),Gn&&!Cn&&(this.cachedCanvases.delete("fillCanvas"),Gn.set(er,Bn.canvas)),{canvas:Bn.canvas,offsetX:Math.round(sr),offsetY:Math.round(fr)}}setLineWidth(pn){pn!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=pn,this.ctx.lineWidth=pn}setLineCap(pn){this.ctx.lineCap=fn[pn]}setLineJoin(pn){this.ctx.lineJoin=$n[pn]}setMiterLimit(pn){this.ctx.miterLimit=pn}setDash(pn,En){const An=this.ctx;An.setLineDash!==void 0&&(An.setLineDash(pn),An.lineDashOffset=En)}setRenderingIntent(pn){}setFlatness(pn){}setGState(pn){for(const[En,An]of pn)switch(En){case"LW":this.setLineWidth(An);break;case"LC":this.setLineCap(An);break;case"LJ":this.setLineJoin(An);break;case"ML":this.setMiterLimit(An);break;case"D":this.setDash(An[0],An[1]);break;case"RI":this.setRenderingIntent(An);break;case"FL":this.setFlatness(An);break;case"Font":this.setFont(An[0],An[1]);break;case"CA":this.current.strokeAlpha=An;break;case"ca":this.current.fillAlpha=An,this.ctx.globalAlpha=An;break;case"BM":this.ctx.globalCompositeOperation=An;break;case"SMask":this.current.activeSMask=An?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(An);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const pn=this.inSMaskMode;this.current.activeSMask&&!pn?this.beginSMaskMode():!this.current.activeSMask&&pn&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const pn=this.ctx.canvas.width,En=this.ctx.canvas.height,An="smaskGroupAt"+this.groupLevel,bn=this.cachedCanvases.getCanvas(An,pn,En);this.suspendedCtx=this.ctx,this.ctx=bn.context;const wn=this.ctx;wn.setTransform(...(0,a.getCurrentTransform)(this.suspendedCtx)),hn(this.suspendedCtx,wn),Bt(wn,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),hn(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(pn){if(!this.current.activeSMask)return;pn?(pn[0]=Math.floor(pn[0]),pn[1]=Math.floor(pn[1]),pn[2]=Math.ceil(pn[2]),pn[3]=Math.ceil(pn[3])):pn=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const En=this.current.activeSMask,An=this.suspendedCtx;Lt(An,En,this.ctx,pn),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(hn(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const pn=this.current;this.stateStack.push(pn),this.current=pn.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),hn(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(pn,En,An,bn,wn,Cn){this.ctx.transform(pn,En,An,bn,wn,Cn),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(pn,En,An){const bn=this.ctx,wn=this.current;let Cn=wn.x,Un=wn.y,Gn,er;const nr=(0,a.getCurrentTransform)(bn),ar=nr[0]===0&&nr[3]===0||nr[1]===0&&nr[2]===0,or=ar?An.slice(0):null;for(let lr=0,zn=0,Hn=pn.length;lr<Hn;lr++)switch(pn[lr]|0){case o.OPS.rectangle:Cn=En[zn++],Un=En[zn++];const Pn=En[zn++],kn=En[zn++],Bn=Cn+Pn,Kn=Un+kn;bn.moveTo(Cn,Un),Pn===0||kn===0?bn.lineTo(Bn,Kn):(bn.lineTo(Bn,Un),bn.lineTo(Bn,Kn),bn.lineTo(Cn,Kn)),ar||wn.updateRectMinMax(nr,[Cn,Un,Bn,Kn]),bn.closePath();break;case o.OPS.moveTo:Cn=En[zn++],Un=En[zn++],bn.moveTo(Cn,Un),ar||wn.updatePathMinMax(nr,Cn,Un);break;case o.OPS.lineTo:Cn=En[zn++],Un=En[zn++],bn.lineTo(Cn,Un),ar||wn.updatePathMinMax(nr,Cn,Un);break;case o.OPS.curveTo:Gn=Cn,er=Un,Cn=En[zn+4],Un=En[zn+5],bn.bezierCurveTo(En[zn],En[zn+1],En[zn+2],En[zn+3],Cn,Un),wn.updateCurvePathMinMax(nr,Gn,er,En[zn],En[zn+1],En[zn+2],En[zn+3],Cn,Un,or),zn+=6;break;case o.OPS.curveTo2:Gn=Cn,er=Un,bn.bezierCurveTo(Cn,Un,En[zn],En[zn+1],En[zn+2],En[zn+3]),wn.updateCurvePathMinMax(nr,Gn,er,Cn,Un,En[zn],En[zn+1],En[zn+2],En[zn+3],or),Cn=En[zn+2],Un=En[zn+3],zn+=4;break;case o.OPS.curveTo3:Gn=Cn,er=Un,Cn=En[zn+2],Un=En[zn+3],bn.bezierCurveTo(En[zn],En[zn+1],Cn,Un,Cn,Un),wn.updateCurvePathMinMax(nr,Gn,er,En[zn],En[zn+1],Cn,Un,Cn,Un,or),zn+=4;break;case o.OPS.closePath:bn.closePath();break}ar&&wn.updateScalingPathMinMax(nr,or),wn.setCurrentPoint(Cn,Un)}closePath(){this.ctx.closePath()}stroke(pn=!0){const En=this.ctx,An=this.current.strokeColor;En.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof An=="object"&&(An!=null&&An.getPattern)?(En.save(),En.strokeStyle=An.getPattern(En,this,(0,a.getCurrentTransformInverse)(En),j.PathType.STROKE),this.rescaleAndStroke(!1),En.restore()):this.rescaleAndStroke(!0)),pn&&this.consumePath(this.current.getClippedPathBoundingBox()),En.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(pn=!0){const En=this.ctx,An=this.current.fillColor,bn=this.current.patternFill;let wn=!1;bn&&(En.save(),En.fillStyle=An.getPattern(En,this,(0,a.getCurrentTransformInverse)(En),j.PathType.FILL),wn=!0);const Cn=this.current.getClippedPathBoundingBox();this.contentVisible&&Cn!==null&&(this.pendingEOFill?(En.fill("evenodd"),this.pendingEOFill=!1):En.fill()),wn&&En.restore(),pn&&this.consumePath(Cn)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Ln}eoClip(){this.pendingClip=jn}beginText(){this.current.textMatrix=o.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const pn=this.pendingTextPaths,En=this.ctx;if(pn===void 0){En.beginPath();return}En.save(),En.beginPath();for(const An of pn)En.setTransform(...An.transform),En.translate(An.x,An.y),An.addToPath(En,An.fontSize);En.restore(),En.clip(),En.beginPath(),delete this.pendingTextPaths}setCharSpacing(pn){this.current.charSpacing=pn}setWordSpacing(pn){this.current.wordSpacing=pn}setHScale(pn){this.current.textHScale=pn/100}setLeading(pn){this.current.leading=-pn}setFont(pn,En){var nr;const An=this.commonObjs.get(pn),bn=this.current;if(!An)throw new Error(`Can't find font for ${pn}`);if(bn.fontMatrix=An.fontMatrix||o.FONT_IDENTITY_MATRIX,(bn.fontMatrix[0]===0||bn.fontMatrix[3]===0)&&(0,o.warn)("Invalid font matrix for font "+pn),En<0?(En=-En,bn.fontDirection=-1):bn.fontDirection=1,this.current.font=An,this.current.fontSize=En,An.isType3Font)return;const wn=An.loadedName||"sans-serif",Cn=((nr=An.systemFontInfo)==null?void 0:nr.css)||`"${wn}", ${An.fallbackName}`;let Un="normal";An.black?Un="900":An.bold&&(Un="bold");const Gn=An.italic?"italic":"normal";let er=En;En<tt?er=tt:En>et&&(er=et),this.current.fontSizeScale=En/er,this.ctx.font=`${Gn} ${Un} ${er}px ${Cn}`}setTextRenderingMode(pn){this.current.textRenderingMode=pn}setTextRise(pn){this.current.textRise=pn}moveText(pn,En){this.current.x=this.current.lineX+=pn,this.current.y=this.current.lineY+=En}setLeadingMoveText(pn,En){this.setLeading(-En),this.moveText(pn,En)}setTextMatrix(pn,En,An,bn,wn,Cn){this.current.textMatrix=[pn,En,An,bn,wn,Cn],this.current.textMatrixScale=Math.hypot(pn,En),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(pn,En,An,bn){const wn=this.ctx,Cn=this.current,Un=Cn.font,Gn=Cn.textRenderingMode,er=Cn.fontSize/Cn.fontSizeScale,nr=Gn&o.TextRenderingMode.FILL_STROKE_MASK,ar=!!(Gn&o.TextRenderingMode.ADD_TO_PATH_FLAG),or=Cn.patternFill&&!Un.missingFile;let lr;(Un.disableFontFace||ar||or)&&(lr=Un.getPathGenerator(this.commonObjs,pn)),Un.disableFontFace||or?(wn.save(),wn.translate(En,An),wn.beginPath(),lr(wn,er),bn&&wn.setTransform(...bn),(nr===o.TextRenderingMode.FILL||nr===o.TextRenderingMode.FILL_STROKE)&&wn.fill(),(nr===o.TextRenderingMode.STROKE||nr===o.TextRenderingMode.FILL_STROKE)&&wn.stroke(),wn.restore()):((nr===o.TextRenderingMode.FILL||nr===o.TextRenderingMode.FILL_STROKE)&&wn.fillText(pn,En,An),(nr===o.TextRenderingMode.STROKE||nr===o.TextRenderingMode.FILL_STROKE)&&wn.strokeText(pn,En,An)),ar&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,a.getCurrentTransform)(wn),x:En,y:An,fontSize:er,addToPath:lr})}get isFontSubpixelAAEnabled(){const{context:pn}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);pn.scale(1.5,1),pn.fillText("I",0,10);const En=pn.getImageData(0,0,10,10).data;let An=!1;for(let bn=3;bn<En.length;bn+=4)if(En[bn]>0&&En[bn]<255){An=!0;break}return(0,o.shadow)(this,"isFontSubpixelAAEnabled",An)}showText(pn){const En=this.current,An=En.font;if(An.isType3Font)return this.showType3Text(pn);const bn=En.fontSize;if(bn===0)return;const wn=this.ctx,Cn=En.fontSizeScale,Un=En.charSpacing,Gn=En.wordSpacing,er=En.fontDirection,nr=En.textHScale*er,ar=pn.length,or=An.vertical,lr=or?1:-1,zn=An.defaultVMetrics,Hn=bn*En.fontMatrix[0],Pn=En.textRenderingMode===o.TextRenderingMode.FILL&&!An.disableFontFace&&!En.patternFill;wn.save(),wn.transform(...En.textMatrix),wn.translate(En.x,En.y+En.textRise),er>0?wn.scale(nr,-1):wn.scale(nr,1);let kn;if(En.patternFill){wn.save();const ur=En.fillColor.getPattern(wn,this,(0,a.getCurrentTransformInverse)(wn),j.PathType.FILL);kn=(0,a.getCurrentTransform)(wn),wn.restore(),wn.fillStyle=ur}let Bn=En.lineWidth;const Kn=En.textMatrixScale;if(Kn===0||Bn===0){const ur=En.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;(ur===o.TextRenderingMode.STROKE||ur===o.TextRenderingMode.FILL_STROKE)&&(Bn=this.getSinglePixelWidth())}else Bn/=Kn;if(Cn!==1&&(wn.scale(Cn,Cn),Bn/=Cn),wn.lineWidth=Bn,An.isInvalidPDFjsFont){const ur=[];let qn=0;for(const gr of pn)ur.push(gr.unicode),qn+=gr.width;wn.fillText(ur.join(""),0,0),En.x+=qn*Hn*nr,wn.restore(),this.compose();return}let sr=0,fr;for(fr=0;fr<ar;++fr){const ur=pn[fr];if(typeof ur=="number"){sr+=lr*ur*bn/1e3;continue}let qn=!1;const gr=(ur.isSpace?Gn:0)+Un,mr=ur.fontChar,Dr=ur.accent;let Cr,Mr,Tr=ur.width;if(or){const Or=ur.vmetric||zn,jr=-(ur.vmetric?Or[1]:Tr*.5)*Hn,hr=Or[2]*Hn;Tr=Or?-Or[0]:Tr,Cr=jr/Cn,Mr=(sr+hr)/Cn}else Cr=sr/Cn,Mr=0;if(An.remeasure&&Tr>0){const Or=wn.measureText(mr).width*1e3/bn*Cn;if(Tr<Or&&this.isFontSubpixelAAEnabled){const jr=Tr/Or;qn=!0,wn.save(),wn.scale(jr,1),Cr/=jr}else Tr!==Or&&(Cr+=(Tr-Or)/2e3*bn/Cn)}if(this.contentVisible&&(ur.isInFont||An.missingFile)){if(Pn&&!Dr)wn.fillText(mr,Cr,Mr);else if(this.paintChar(mr,Cr,Mr,kn),Dr){const Or=Cr+bn*Dr.offset.x/Cn,jr=Mr-bn*Dr.offset.y/Cn;this.paintChar(Dr.fontChar,Or,jr,kn)}}const Rr=or?Tr*Hn-gr*er:Tr*Hn+gr*er;sr+=Rr,qn&&wn.restore()}or?En.y-=sr:En.x+=sr*nr,wn.restore(),this.compose()}showType3Text(pn){const En=this.ctx,An=this.current,bn=An.font,wn=An.fontSize,Cn=An.fontDirection,Un=bn.vertical?1:-1,Gn=An.charSpacing,er=An.wordSpacing,nr=An.textHScale*Cn,ar=An.fontMatrix||o.FONT_IDENTITY_MATRIX,or=pn.length,lr=An.textRenderingMode===o.TextRenderingMode.INVISIBLE;let zn,Hn,Pn,kn;if(!(lr||wn===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,En.save(),En.transform(...An.textMatrix),En.translate(An.x,An.y),En.scale(nr,Cn),zn=0;zn<or;++zn){if(Hn=pn[zn],typeof Hn=="number"){kn=Un*Hn*wn/1e3,this.ctx.translate(kn,0),An.x+=kn*nr;continue}const Bn=(Hn.isSpace?er:0)+Gn,Kn=bn.charProcOperatorList[Hn.operatorListId];if(!Kn){(0,o.warn)(`Type3 character "${Hn.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Hn,this.save(),En.scale(wn,wn),En.transform(...ar),this.executeOperatorList(Kn),this.restore()),Pn=o.Util.applyTransform([Hn.width,0],ar)[0]*wn+Bn,En.translate(Pn,0),An.x+=Pn*nr}En.restore(),this.processingType3=null}}setCharWidth(pn,En){}setCharWidthAndBounds(pn,En,An,bn,wn,Cn){this.ctx.rect(An,bn,wn-An,Cn-bn),this.ctx.clip(),this.endPath()}getColorN_Pattern(pn){let En;if(pn[0]==="TilingPattern"){const An=pn[1],bn=this.baseTransform||(0,a.getCurrentTransform)(this.ctx),wn={createCanvasGraphics:Cn=>new Fn(Cn,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};En=new j.TilingPattern(pn,An,this.ctx,wn,bn)}else En=this._getPattern(pn[1],pn[2]);return En}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(pn,En,An){const bn=o.Util.makeHexColor(pn,En,An);this.ctx.strokeStyle=bn,this.current.strokeColor=bn}setFillRGBColor(pn,En,An){const bn=o.Util.makeHexColor(pn,En,An);this.ctx.fillStyle=bn,this.current.fillColor=bn,this.current.patternFill=!1}_getPattern(pn,En=null){let An;return this.cachedPatterns.has(pn)?An=this.cachedPatterns.get(pn):(An=(0,j.getShadingPattern)(this.getObject(pn)),this.cachedPatterns.set(pn,An)),En&&(An.matrix=En),An}shadingFill(pn){if(!this.contentVisible)return;const En=this.ctx;this.save();const An=this._getPattern(pn);En.fillStyle=An.getPattern(En,this,(0,a.getCurrentTransformInverse)(En),j.PathType.SHADING);const bn=(0,a.getCurrentTransformInverse)(En);if(bn){const{width:wn,height:Cn}=En.canvas,[Un,Gn,er,nr]=o.Util.getAxialAlignedBoundingBox([0,0,wn,Cn],bn);this.ctx.fillRect(Un,Gn,er-Un,nr-Gn)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,o.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,o.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(pn,En){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(pn)&&pn.length===6&&this.transform(...pn),this.baseTransform=(0,a.getCurrentTransform)(this.ctx),En)){const An=En[2]-En[0],bn=En[3]-En[1];this.ctx.rect(En[0],En[1],An,bn),this.current.updateRectMinMax((0,a.getCurrentTransform)(this.ctx),En),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(pn){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const En=this.ctx;pn.isolated||(0,o.info)("TODO: Support non-isolated groups."),pn.knockout&&(0,o.warn)("Knockout groups not supported.");const An=(0,a.getCurrentTransform)(En);if(pn.matrix&&En.transform(...pn.matrix),!pn.bbox)throw new Error("Bounding box is required.");let bn=o.Util.getAxialAlignedBoundingBox(pn.bbox,(0,a.getCurrentTransform)(En));const wn=[0,0,En.canvas.width,En.canvas.height];bn=o.Util.intersect(bn,wn)||[0,0,0,0];const Cn=Math.floor(bn[0]),Un=Math.floor(bn[1]);let Gn=Math.max(Math.ceil(bn[2])-Cn,1),er=Math.max(Math.ceil(bn[3])-Un,1),nr=1,ar=1;Gn>rt&&(nr=Gn/rt,Gn=rt),er>rt&&(ar=er/rt,er=rt),this.current.startNewPathAndClipBox([0,0,Gn,er]);let or="groupAt"+this.groupLevel;pn.smask&&(or+="_smask_"+this.smaskCounter++%2);const lr=this.cachedCanvases.getCanvas(or,Gn,er),zn=lr.context;zn.scale(1/nr,1/ar),zn.translate(-Cn,-Un),zn.transform(...An),pn.smask?this.smaskStack.push({canvas:lr.canvas,context:zn,offsetX:Cn,offsetY:Un,scaleX:nr,scaleY:ar,subtype:pn.smask.subtype,backdrop:pn.smask.backdrop,transferMap:pn.smask.transferMap||null,startTransformInverse:null}):(En.setTransform(1,0,0,1,0,0),En.translate(Cn,Un),En.scale(nr,ar),En.save()),hn(En,zn),this.ctx=zn,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(En),this.groupLevel++}endGroup(pn){if(!this.contentVisible)return;this.groupLevel--;const En=this.ctx,An=this.groupStack.pop();if(this.ctx=An,this.ctx.imageSmoothingEnabled=!1,pn.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const bn=(0,a.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...bn);const wn=o.Util.getAxialAlignedBoundingBox([0,0,En.canvas.width,En.canvas.height],bn);this.ctx.drawImage(En.canvas,0,0),this.ctx.restore(),this.compose(wn)}}beginAnnotation(pn,En,An,bn,wn){if(Wn(this,Vn,Vo).call(this),gn(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(En)&&En.length===4){const Cn=En[2]-En[0],Un=En[3]-En[1];if(wn&&this.annotationCanvasMap){An=An.slice(),An[4]-=En[0],An[5]-=En[1],En=En.slice(),En[0]=En[1]=0,En[2]=Cn,En[3]=Un;const[Gn,er]=o.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(this.ctx)),{viewportScale:nr}=this,ar=Math.ceil(Cn*this.outputScaleX*nr),or=Math.ceil(Un*this.outputScaleY*nr);this.annotationCanvas=this.canvasFactory.create(ar,or);const{canvas:lr,context:zn}=this.annotationCanvas;this.annotationCanvasMap.set(pn,lr),this.annotationCanvas.savedCtx=this.ctx,this.ctx=zn,this.ctx.save(),this.ctx.setTransform(Gn,0,0,-er,0,Un*er),gn(this.ctx)}else gn(this.ctx),this.ctx.rect(En[0],En[1],Cn,Un),this.ctx.clip(),this.endPath()}this.current=new Nt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...An),this.transform(...bn)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Wn(this,Vn,Oo).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(pn){if(!this.contentVisible)return;const En=pn.count;pn=this.getObject(pn.data,pn),pn.count=En;const An=this.ctx,bn=this.processingType3;if(bn&&(bn.compiled===void 0&&(bn.compiled=kt(pn)),bn.compiled)){bn.compiled(An);return}const wn=this._createMaskCanvas(pn),Cn=wn.canvas;An.save(),An.setTransform(1,0,0,1,0,0),An.drawImage(Cn,wn.offsetX,wn.offsetY),An.restore(),this.compose()}paintImageMaskXObjectRepeat(pn,En,An=0,bn=0,wn,Cn){if(!this.contentVisible)return;pn=this.getObject(pn.data,pn);const Un=this.ctx;Un.save();const Gn=(0,a.getCurrentTransform)(Un);Un.transform(En,An,bn,wn,0,0);const er=this._createMaskCanvas(pn);Un.setTransform(1,0,0,1,er.offsetX-Gn[4],er.offsetY-Gn[5]);for(let nr=0,ar=Cn.length;nr<ar;nr+=2){const or=o.Util.transform(Gn,[En,An,bn,wn,Cn[nr],Cn[nr+1]]),[lr,zn]=o.Util.applyTransform([0,0],or);Un.drawImage(er.canvas,lr,zn)}Un.restore(),this.compose()}paintImageMaskXObjectGroup(pn){if(!this.contentVisible)return;const En=this.ctx,An=this.current.fillColor,bn=this.current.patternFill;for(const wn of pn){const{data:Cn,width:Un,height:Gn,transform:er}=wn,nr=this.cachedCanvases.getCanvas("maskCanvas",Un,Gn),ar=nr.context;ar.save();const or=this.getObject(Cn,wn);dn(ar,or),ar.globalCompositeOperation="source-in",ar.fillStyle=bn?An.getPattern(ar,this,(0,a.getCurrentTransformInverse)(En),j.PathType.FILL):An,ar.fillRect(0,0,Un,Gn),ar.restore(),En.save(),En.transform(...er),En.scale(1,-1),Ut(En,nr.canvas,0,0,Un,Gn,0,-1,1,1),En.restore()}this.compose()}paintImageXObject(pn){if(!this.contentVisible)return;const En=this.getObject(pn);if(!En){(0,o.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(En)}paintImageXObjectRepeat(pn,En,An,bn){if(!this.contentVisible)return;const wn=this.getObject(pn);if(!wn){(0,o.warn)("Dependent image isn't ready yet");return}const Cn=wn.width,Un=wn.height,Gn=[];for(let er=0,nr=bn.length;er<nr;er+=2)Gn.push({transform:[En,0,0,An,bn[er],bn[er+1]],x:0,y:0,w:Cn,h:Un});this.paintInlineImageXObjectGroup(wn,Gn)}applyTransferMapsToCanvas(pn){return this.current.transferMaps!=="none"&&(pn.filter=this.current.transferMaps,pn.drawImage(pn.canvas,0,0),pn.filter="none"),pn.canvas}applyTransferMapsToBitmap(pn){if(this.current.transferMaps==="none")return pn.bitmap;const{bitmap:En,width:An,height:bn}=pn,wn=this.cachedCanvases.getCanvas("inlineImage",An,bn),Cn=wn.context;return Cn.filter=this.current.transferMaps,Cn.drawImage(En,0,0),Cn.filter="none",wn.canvas}paintInlineImageXObject(pn){if(!this.contentVisible)return;const En=pn.width,An=pn.height,bn=this.ctx;if(this.save(),!o.isNodeJS){const{filter:Un}=bn;Un!=="none"&&Un!==""&&(bn.filter="none")}bn.scale(1/En,-1/An);let wn;if(pn.bitmap)wn=this.applyTransferMapsToBitmap(pn);else if(typeof HTMLElement=="function"&&pn instanceof HTMLElement||!pn.data)wn=pn;else{const Gn=this.cachedCanvases.getCanvas("inlineImage",En,An).context;un(Gn,pn),wn=this.applyTransferMapsToCanvas(Gn)}const Cn=this._scaleImage(wn,(0,a.getCurrentTransformInverse)(bn));bn.imageSmoothingEnabled=yn((0,a.getCurrentTransform)(bn),pn.interpolate),Ut(bn,Cn.img,0,0,Cn.paintWidth,Cn.paintHeight,0,-An,En,An),this.compose(),this.restore()}paintInlineImageXObjectGroup(pn,En){if(!this.contentVisible)return;const An=this.ctx;let bn;if(pn.bitmap)bn=pn.bitmap;else{const wn=pn.width,Cn=pn.height,Gn=this.cachedCanvases.getCanvas("inlineImage",wn,Cn).context;un(Gn,pn),bn=this.applyTransferMapsToCanvas(Gn)}for(const wn of En)An.save(),An.transform(...wn.transform),An.scale(1,-1),Ut(An,bn,wn.x,wn.y,wn.w,wn.h,0,-1,1,1),An.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(pn){}markPointProps(pn,En){}beginMarkedContent(pn){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(pn,En){pn==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(En)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(pn){const En=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(pn);const An=this.ctx;this.pendingClip&&(En||(this.pendingClip===jn?An.clip("evenodd"):An.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),An.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const pn=(0,a.getCurrentTransform)(this.ctx);if(pn[1]===0&&pn[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(pn[0]),Math.abs(pn[3]));else{const En=Math.abs(pn[0]*pn[3]-pn[2]*pn[1]),An=Math.hypot(pn[0],pn[2]),bn=Math.hypot(pn[1],pn[3]);this._cachedGetSinglePixelWidth=Math.max(An,bn)/En}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:pn}=this.current,{a:En,b:An,c:bn,d:wn}=this.ctx.getTransform();let Cn,Un;if(An===0&&bn===0){const Gn=Math.abs(En),er=Math.abs(wn);if(Gn===er)if(pn===0)Cn=Un=1/Gn;else{const nr=Gn*pn;Cn=Un=nr<1?1/nr:1}else if(pn===0)Cn=1/Gn,Un=1/er;else{const nr=Gn*pn,ar=er*pn;Cn=nr<1?1/nr:1,Un=ar<1?1/ar:1}}else{const Gn=Math.abs(En*wn-An*bn),er=Math.hypot(En,An),nr=Math.hypot(bn,wn);if(pn===0)Cn=nr/Gn,Un=er/Gn;else{const ar=pn*Gn;Cn=nr>ar?nr/ar:1,Un=er>ar?er/ar:1}}this._cachedScaleForStroking[0]=Cn,this._cachedScaleForStroking[1]=Un}return this._cachedScaleForStroking}rescaleAndStroke(pn){const{ctx:En}=this,{lineWidth:An}=this.current,[bn,wn]=this.getScaleForStroking();if(En.lineWidth=An||1,bn===1&&wn===1){En.stroke();return}const Cn=En.getLineDash();if(pn&&En.save(),En.scale(bn,wn),Cn.length>0){const Un=Math.max(bn,wn);En.setLineDash(Cn.map(Gn=>Gn/Un)),En.lineDashOffset/=Un}En.stroke(),pn&&En.restore()}isContentVisible(){for(let pn=this.markedContentStack.length-1;pn>=0;pn--)if(!this.markedContentStack[pn].visible)return!1;return!0}};Vn=new WeakSet,Vo=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Oo=function(){if(this.pageColors){const pn=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(pn!=="none"){const En=this.ctx.filter;this.ctx.filter=pn,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=En}}};let On=Fn;e.CanvasGraphics=On;for(const Tn in o.OPS)On.prototype[Tn]!==void 0&&(On.prototype[o.OPS[Tn]]=On.prototype[Tn])},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=Wt;var o=i(1),a=i(6);const j={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=j;function _e(kt,Nt){if(!Nt)return;const un=Nt[2]-Nt[0],dn=Nt[3]-Nt[1],hn=new Path2D;hn.rect(Nt[0],Nt[1],un,dn),kt.clip(hn)}class tt{constructor(){this.constructor===tt&&(0,o.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,o.unreachable)("Abstract method `getPattern` called.")}}class et extends tt{constructor(Nt){super(),this._type=Nt[1],this._bbox=Nt[2],this._colorStops=Nt[3],this._p0=Nt[4],this._p1=Nt[5],this._r0=Nt[6],this._r1=Nt[7],this.matrix=null}_createGradient(Nt){let un;this._type==="axial"?un=Nt.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(un=Nt.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const dn of this._colorStops)un.addColorStop(dn[0],dn[1]);return un}getPattern(Nt,un,dn,hn){let gn;if(hn===j.STROKE||hn===j.FILL){const It=un.current.getClippedPathBoundingBox(hn,(0,a.getCurrentTransform)(Nt))||[0,0,0,0],pt=Math.ceil(It[2]-It[0])||1,Dt=Math.ceil(It[3]-It[1])||1,mn=un.cachedCanvases.getCanvas("pattern",pt,Dt,!0),Lt=mn.context;Lt.clearRect(0,0,Lt.canvas.width,Lt.canvas.height),Lt.beginPath(),Lt.rect(0,0,Lt.canvas.width,Lt.canvas.height),Lt.translate(-It[0],-It[1]),dn=o.Util.transform(dn,[1,0,0,1,It[0],It[1]]),Lt.transform(...un.baseTransform),this.matrix&&Lt.transform(...this.matrix),_e(Lt,this._bbox),Lt.fillStyle=this._createGradient(Lt),Lt.fill(),gn=Nt.createPattern(mn.canvas,"no-repeat");const yn=new DOMMatrix(dn);gn.setTransform(yn)}else _e(Nt,this._bbox),gn=this._createGradient(Nt);return gn}}function rt(kt,Nt,un,dn,hn,gn,It,pt){const Dt=Nt.coords,mn=Nt.colors,Lt=kt.data,yn=kt.width*4;let fn;Dt[un+1]>Dt[dn+1]&&(fn=un,un=dn,dn=fn,fn=gn,gn=It,It=fn),Dt[dn+1]>Dt[hn+1]&&(fn=dn,dn=hn,hn=fn,fn=It,It=pt,pt=fn),Dt[un+1]>Dt[dn+1]&&(fn=un,un=dn,dn=fn,fn=gn,gn=It,It=fn);const $n=(Dt[un]+Nt.offsetX)*Nt.scaleX,Ln=(Dt[un+1]+Nt.offsetY)*Nt.scaleY,jn=(Dt[dn]+Nt.offsetX)*Nt.scaleX,On=(Dt[dn+1]+Nt.offsetY)*Nt.scaleY,Vn=(Dt[hn]+Nt.offsetX)*Nt.scaleX,Rn=(Dt[hn+1]+Nt.offsetY)*Nt.scaleY;if(Ln>=Rn)return;const Dn=mn[gn],Fn=mn[gn+1],Tn=mn[gn+2],pn=mn[It],En=mn[It+1],An=mn[It+2],bn=mn[pt],wn=mn[pt+1],Cn=mn[pt+2],Un=Math.round(Ln),Gn=Math.round(Rn);let er,nr,ar,or,lr,zn,Hn,Pn;for(let kn=Un;kn<=Gn;kn++){if(kn<On){const ur=kn<Ln?0:(Ln-kn)/(Ln-On);er=$n-($n-jn)*ur,nr=Dn-(Dn-pn)*ur,ar=Fn-(Fn-En)*ur,or=Tn-(Tn-An)*ur}else{let ur;kn>Rn?ur=1:On===Rn?ur=0:ur=(On-kn)/(On-Rn),er=jn-(jn-Vn)*ur,nr=pn-(pn-bn)*ur,ar=En-(En-wn)*ur,or=An-(An-Cn)*ur}let Bn;kn<Ln?Bn=0:kn>Rn?Bn=1:Bn=(Ln-kn)/(Ln-Rn),lr=$n-($n-Vn)*Bn,zn=Dn-(Dn-bn)*Bn,Hn=Fn-(Fn-wn)*Bn,Pn=Tn-(Tn-Cn)*Bn;const Kn=Math.round(Math.min(er,lr)),sr=Math.round(Math.max(er,lr));let fr=yn*kn+Kn*4;for(let ur=Kn;ur<=sr;ur++)Bn=(er-ur)/(er-lr),Bn<0?Bn=0:Bn>1&&(Bn=1),Lt[fr++]=nr-(nr-zn)*Bn|0,Lt[fr++]=ar-(ar-Hn)*Bn|0,Lt[fr++]=or-(or-Pn)*Bn|0,Lt[fr++]=255}}function dt(kt,Nt,un){const dn=Nt.coords,hn=Nt.colors;let gn,It;switch(Nt.type){case"lattice":const pt=Nt.verticesPerRow,Dt=Math.floor(dn.length/pt)-1,mn=pt-1;for(gn=0;gn<Dt;gn++){let Lt=gn*pt;for(let yn=0;yn<mn;yn++,Lt++)rt(kt,un,dn[Lt],dn[Lt+1],dn[Lt+pt],hn[Lt],hn[Lt+1],hn[Lt+pt]),rt(kt,un,dn[Lt+pt+1],dn[Lt+1],dn[Lt+pt],hn[Lt+pt+1],hn[Lt+1],hn[Lt+pt])}break;case"triangles":for(gn=0,It=dn.length;gn<It;gn+=3)rt(kt,un,dn[gn],dn[gn+1],dn[gn+2],hn[gn],hn[gn+1],hn[gn+2]);break;default:throw new Error("illegal figure")}}class vt extends tt{constructor(Nt){super(),this._coords=Nt[2],this._colors=Nt[3],this._figures=Nt[4],this._bounds=Nt[5],this._bbox=Nt[7],this._background=Nt[8],this.matrix=null}_createMeshCanvas(Nt,un,dn){const pt=Math.floor(this._bounds[0]),Dt=Math.floor(this._bounds[1]),mn=Math.ceil(this._bounds[2])-pt,Lt=Math.ceil(this._bounds[3])-Dt,yn=Math.min(Math.ceil(Math.abs(mn*Nt[0]*1.1)),3e3),fn=Math.min(Math.ceil(Math.abs(Lt*Nt[1]*1.1)),3e3),$n=mn/yn,Ln=Lt/fn,jn={coords:this._coords,colors:this._colors,offsetX:-pt,offsetY:-Dt,scaleX:1/$n,scaleY:1/Ln},On=yn+2*2,Vn=fn+2*2,Rn=dn.getCanvas("mesh",On,Vn,!1),Dn=Rn.context,Fn=Dn.createImageData(yn,fn);if(un){const pn=Fn.data;for(let En=0,An=pn.length;En<An;En+=4)pn[En]=un[0],pn[En+1]=un[1],pn[En+2]=un[2],pn[En+3]=255}for(const pn of this._figures)dt(Fn,pn,jn);return Dn.putImageData(Fn,2,2),{canvas:Rn.canvas,offsetX:pt-2*$n,offsetY:Dt-2*Ln,scaleX:$n,scaleY:Ln}}getPattern(Nt,un,dn,hn){_e(Nt,this._bbox);let gn;if(hn===j.SHADING)gn=o.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(Nt));else if(gn=o.Util.singularValueDecompose2dScale(un.baseTransform),this.matrix){const pt=o.Util.singularValueDecompose2dScale(this.matrix);gn=[gn[0]*pt[0],gn[1]*pt[1]]}const It=this._createMeshCanvas(gn,hn===j.SHADING?null:this._background,un.cachedCanvases);return hn!==j.SHADING&&(Nt.setTransform(...un.baseTransform),this.matrix&&Nt.transform(...this.matrix)),Nt.translate(It.offsetX,It.offsetY),Nt.scale(It.scaleX,It.scaleY),Nt.createPattern(It.canvas,"no-repeat")}}class Ct extends tt{getPattern(){return"hotpink"}}function Wt(kt){switch(kt[0]){case"RadialAxial":return new et(kt);case"Mesh":return new vt(kt);case"Dummy":return new Ct}throw new Error(`Unknown IR type: ${kt[0]}`)}const Bt={COLORED:1,UNCOLORED:2},Ut=class Ut{constructor(Nt,un,dn,hn,gn){this.operatorList=Nt[2],this.matrix=Nt[3]||[1,0,0,1,0,0],this.bbox=Nt[4],this.xstep=Nt[5],this.ystep=Nt[6],this.paintType=Nt[7],this.tilingType=Nt[8],this.color=un,this.ctx=dn,this.canvasGraphicsFactory=hn,this.baseTransform=gn}createPatternCanvas(Nt){const un=this.operatorList,dn=this.bbox,hn=this.xstep,gn=this.ystep,It=this.paintType,pt=this.tilingType,Dt=this.color,mn=this.canvasGraphicsFactory;(0,o.info)("TilingType: "+pt);const Lt=dn[0],yn=dn[1],fn=dn[2],$n=dn[3],Ln=o.Util.singularValueDecompose2dScale(this.matrix),jn=o.Util.singularValueDecompose2dScale(this.baseTransform),On=[Ln[0]*jn[0],Ln[1]*jn[1]],Vn=this.getSizeAndScale(hn,this.ctx.canvas.width,On[0]),Rn=this.getSizeAndScale(gn,this.ctx.canvas.height,On[1]),Dn=Nt.cachedCanvases.getCanvas("pattern",Vn.size,Rn.size,!0),Fn=Dn.context,Tn=mn.createCanvasGraphics(Fn);Tn.groupLevel=Nt.groupLevel,this.setFillAndStrokeStyleToContext(Tn,It,Dt);let pn=Lt,En=yn,An=fn,bn=$n;return Lt<0&&(pn=0,An+=Math.abs(Lt)),yn<0&&(En=0,bn+=Math.abs(yn)),Fn.translate(-(Vn.scale*pn),-(Rn.scale*En)),Tn.transform(Vn.scale,0,0,Rn.scale,0,0),Fn.save(),this.clipBbox(Tn,pn,En,An,bn),Tn.baseTransform=(0,a.getCurrentTransform)(Tn.ctx),Tn.executeOperatorList(un),Tn.endDrawing(),{canvas:Dn.canvas,scaleX:Vn.scale,scaleY:Rn.scale,offsetX:pn,offsetY:En}}getSizeAndScale(Nt,un,dn){Nt=Math.abs(Nt);const hn=Math.max(Ut.MAX_PATTERN_SIZE,un);let gn=Math.ceil(Nt*dn);return gn>=hn?gn=hn:dn=gn/Nt,{scale:dn,size:gn}}clipBbox(Nt,un,dn,hn,gn){const It=hn-un,pt=gn-dn;Nt.ctx.rect(un,dn,It,pt),Nt.current.updateRectMinMax((0,a.getCurrentTransform)(Nt.ctx),[un,dn,hn,gn]),Nt.clip(),Nt.endPath()}setFillAndStrokeStyleToContext(Nt,un,dn){const hn=Nt.ctx,gn=Nt.current;switch(un){case Bt.COLORED:const It=this.ctx;hn.fillStyle=It.fillStyle,hn.strokeStyle=It.strokeStyle,gn.fillColor=It.fillStyle,gn.strokeColor=It.strokeStyle;break;case Bt.UNCOLORED:const pt=o.Util.makeHexColor(dn[0],dn[1],dn[2]);hn.fillStyle=pt,hn.strokeStyle=pt,gn.fillColor=pt,gn.strokeColor=pt;break;default:throw new o.FormatError(`Unsupported paint type: ${un}`)}}getPattern(Nt,un,dn,hn){let gn=dn;hn!==j.SHADING&&(gn=o.Util.transform(gn,un.baseTransform),this.matrix&&(gn=o.Util.transform(gn,this.matrix)));const It=this.createPatternCanvas(un);let pt=new DOMMatrix(gn);pt=pt.translate(It.offsetX,It.offsetY),pt=pt.scale(1/It.scaleX,1/It.scaleY);const Dt=Nt.createPattern(It.canvas,"repeat");return Dt.setTransform(pt),Dt}};zr(Ut,"MAX_PATTERN_SIZE",3e3);let qt=Ut;e.TilingPattern=qt},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=j,e.convertToRGBA=a,e.grayToRGBA=tt;var o=i(1);function a(et){switch(et.kind){case o.ImageKind.GRAYSCALE_1BPP:return j(et);case o.ImageKind.RGB_24BPP:return _e(et)}return null}function j({src:et,srcPos:rt=0,dest:dt,width:vt,height:Ct,nonBlackColor:Wt=4294967295,inverseDecode:Bt=!1}){const qt=o.FeatureTest.isLittleEndian?4278190080:255,[Ut,kt]=Bt?[Wt,qt]:[qt,Wt],Nt=vt>>3,un=vt&7,dn=et.length;dt=new Uint32Array(dt.buffer);let hn=0;for(let gn=0;gn<Ct;gn++){for(const pt=rt+Nt;rt<pt;rt++){const Dt=rt<dn?et[rt]:255;dt[hn++]=Dt&128?kt:Ut,dt[hn++]=Dt&64?kt:Ut,dt[hn++]=Dt&32?kt:Ut,dt[hn++]=Dt&16?kt:Ut,dt[hn++]=Dt&8?kt:Ut,dt[hn++]=Dt&4?kt:Ut,dt[hn++]=Dt&2?kt:Ut,dt[hn++]=Dt&1?kt:Ut}if(un===0)continue;const It=rt<dn?et[rt++]:255;for(let pt=0;pt<un;pt++)dt[hn++]=It&1<<7-pt?kt:Ut}return{srcPos:rt,destPos:hn}}function _e({src:et,srcPos:rt=0,dest:dt,destPos:vt=0,width:Ct,height:Wt}){let Bt=0;const qt=et.length>>2,Ut=new Uint32Array(et.buffer,rt,qt);if(o.FeatureTest.isLittleEndian){for(;Bt<qt-2;Bt+=3,vt+=4){const kt=Ut[Bt],Nt=Ut[Bt+1],un=Ut[Bt+2];dt[vt]=kt|4278190080,dt[vt+1]=kt>>>24|Nt<<8|4278190080,dt[vt+2]=Nt>>>16|un<<16|4278190080,dt[vt+3]=un>>>8|4278190080}for(let kt=Bt*4,Nt=et.length;kt<Nt;kt+=3)dt[vt++]=et[kt]|et[kt+1]<<8|et[kt+2]<<16|4278190080}else{for(;Bt<qt-2;Bt+=3,vt+=4){const kt=Ut[Bt],Nt=Ut[Bt+1],un=Ut[Bt+2];dt[vt]=kt|255,dt[vt+1]=kt<<24|Nt>>>8|255,dt[vt+2]=Nt<<16|un>>>16|255,dt[vt+3]=un<<8|255}for(let kt=Bt*4,Nt=et.length;kt<Nt;kt+=3)dt[vt++]=et[kt]<<24|et[kt+1]<<16|et[kt+2]<<8|255}return{srcPos:rt,destPos:vt}}function tt(et,rt){if(o.FeatureTest.isLittleEndian)for(let dt=0,vt=et.length;dt<vt;dt++)rt[dt]=et[dt]*65793|4278190080;else for(let dt=0,vt=et.length;dt<vt;dt++)rt[dt]=et[dt]*16843008|255}},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const i=Object.create(null);e.GlobalWorkerOptions=i,i.workerPort=null,i.workerSrc=""},(s,e,i)=>{var et,iu,ou,eo;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var o=i(1);const a={DATA:1,ERROR:2},j={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function _e(Ct){switch(Ct instanceof Error||typeof Ct=="object"&&Ct!==null||(0,o.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),Ct.name){case"AbortException":return new o.AbortException(Ct.message);case"MissingPDFException":return new o.MissingPDFException(Ct.message);case"PasswordException":return new o.PasswordException(Ct.message,Ct.code);case"UnexpectedResponseException":return new o.UnexpectedResponseException(Ct.message,Ct.status);case"UnknownErrorException":return new o.UnknownErrorException(Ct.message,Ct.details);default:return new o.UnknownErrorException(Ct.message,Ct.toString())}}class tt{constructor(Wt,Bt,qt){Yn(this,et);this.sourceName=Wt,this.targetName=Bt,this.comObj=qt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Ut=>{const kt=Ut.data;if(kt.targetName!==this.sourceName)return;if(kt.stream){Wn(this,et,ou).call(this,kt);return}if(kt.callback){const un=kt.callbackId,dn=this.callbackCapabilities[un];if(!dn)throw new Error(`Cannot resolve callback ${un}`);if(delete this.callbackCapabilities[un],kt.callback===a.DATA)dn.resolve(kt.data);else if(kt.callback===a.ERROR)dn.reject(_e(kt.reason));else throw new Error("Unexpected callback case");return}const Nt=this.actionHandler[kt.action];if(!Nt)throw new Error(`Unknown action from worker: ${kt.action}`);if(kt.callbackId){const un=this.sourceName,dn=kt.sourceName;new Promise(function(hn){hn(Nt(kt.data))}).then(function(hn){qt.postMessage({sourceName:un,targetName:dn,callback:a.DATA,callbackId:kt.callbackId,data:hn})},function(hn){qt.postMessage({sourceName:un,targetName:dn,callback:a.ERROR,callbackId:kt.callbackId,reason:_e(hn)})});return}if(kt.streamId){Wn(this,et,iu).call(this,kt);return}Nt(kt.data)},qt.addEventListener("message",this._onComObjOnMessage)}on(Wt,Bt){const qt=this.actionHandler;if(qt[Wt])throw new Error(`There is already an actionName called "${Wt}"`);qt[Wt]=Bt}send(Wt,Bt,qt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Wt,data:Bt},qt)}sendWithPromise(Wt,Bt,qt){const Ut=this.callbackId++,kt=new o.PromiseCapability;this.callbackCapabilities[Ut]=kt;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Wt,callbackId:Ut,data:Bt},qt)}catch(Nt){kt.reject(Nt)}return kt.promise}sendWithStream(Wt,Bt,qt,Ut){const kt=this.streamId++,Nt=this.sourceName,un=this.targetName,dn=this.comObj;return new ReadableStream({start:hn=>{const gn=new o.PromiseCapability;return this.streamControllers[kt]={controller:hn,startCall:gn,pullCall:null,cancelCall:null,isClosed:!1},dn.postMessage({sourceName:Nt,targetName:un,action:Wt,streamId:kt,data:Bt,desiredSize:hn.desiredSize},Ut),gn.promise},pull:hn=>{const gn=new o.PromiseCapability;return this.streamControllers[kt].pullCall=gn,dn.postMessage({sourceName:Nt,targetName:un,stream:j.PULL,streamId:kt,desiredSize:hn.desiredSize}),gn.promise},cancel:hn=>{(0,o.assert)(hn instanceof Error,"cancel must have a valid reason");const gn=new o.PromiseCapability;return this.streamControllers[kt].cancelCall=gn,this.streamControllers[kt].isClosed=!0,dn.postMessage({sourceName:Nt,targetName:un,stream:j.CANCEL,streamId:kt,reason:_e(hn)}),gn.promise}},qt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}et=new WeakSet,iu=function(Wt){const Bt=Wt.streamId,qt=this.sourceName,Ut=Wt.sourceName,kt=this.comObj,Nt=this,un=this.actionHandler[Wt.action],dn={enqueue(hn,gn=1,It){if(this.isCancelled)return;const pt=this.desiredSize;this.desiredSize-=gn,pt>0&&this.desiredSize<=0&&(this.sinkCapability=new o.PromiseCapability,this.ready=this.sinkCapability.promise),kt.postMessage({sourceName:qt,targetName:Ut,stream:j.ENQUEUE,streamId:Bt,chunk:hn},It)},close(){this.isCancelled||(this.isCancelled=!0,kt.postMessage({sourceName:qt,targetName:Ut,stream:j.CLOSE,streamId:Bt}),delete Nt.streamSinks[Bt])},error(hn){(0,o.assert)(hn instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,kt.postMessage({sourceName:qt,targetName:Ut,stream:j.ERROR,streamId:Bt,reason:_e(hn)}))},sinkCapability:new o.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:Wt.desiredSize,ready:null};dn.sinkCapability.resolve(),dn.ready=dn.sinkCapability.promise,this.streamSinks[Bt]=dn,new Promise(function(hn){hn(un(Wt.data,dn))}).then(function(){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.START_COMPLETE,streamId:Bt,success:!0})},function(hn){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.START_COMPLETE,streamId:Bt,reason:_e(hn)})})},ou=function(Wt){const Bt=Wt.streamId,qt=this.sourceName,Ut=Wt.sourceName,kt=this.comObj,Nt=this.streamControllers[Bt],un=this.streamSinks[Bt];switch(Wt.stream){case j.START_COMPLETE:Wt.success?Nt.startCall.resolve():Nt.startCall.reject(_e(Wt.reason));break;case j.PULL_COMPLETE:Wt.success?Nt.pullCall.resolve():Nt.pullCall.reject(_e(Wt.reason));break;case j.PULL:if(!un){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.PULL_COMPLETE,streamId:Bt,success:!0});break}un.desiredSize<=0&&Wt.desiredSize>0&&un.sinkCapability.resolve(),un.desiredSize=Wt.desiredSize,new Promise(function(dn){var hn;dn((hn=un.onPull)==null?void 0:hn.call(un))}).then(function(){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.PULL_COMPLETE,streamId:Bt,success:!0})},function(dn){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.PULL_COMPLETE,streamId:Bt,reason:_e(dn)})});break;case j.ENQUEUE:if((0,o.assert)(Nt,"enqueue should have stream controller"),Nt.isClosed)break;Nt.controller.enqueue(Wt.chunk);break;case j.CLOSE:if((0,o.assert)(Nt,"close should have stream controller"),Nt.isClosed)break;Nt.isClosed=!0,Nt.controller.close(),Wn(this,et,eo).call(this,Nt,Bt);break;case j.ERROR:(0,o.assert)(Nt,"error should have stream controller"),Nt.controller.error(_e(Wt.reason)),Wn(this,et,eo).call(this,Nt,Bt);break;case j.CANCEL_COMPLETE:Wt.success?Nt.cancelCall.resolve():Nt.cancelCall.reject(_e(Wt.reason)),Wn(this,et,eo).call(this,Nt,Bt);break;case j.CANCEL:if(!un)break;new Promise(function(dn){var hn;dn((hn=un.onCancel)==null?void 0:hn.call(un,_e(Wt.reason)))}).then(function(){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.CANCEL_COMPLETE,streamId:Bt,success:!0})},function(dn){kt.postMessage({sourceName:qt,targetName:Ut,stream:j.CANCEL_COMPLETE,streamId:Bt,reason:_e(dn)})}),un.sinkCapability.reject(_e(Wt.reason)),un.isCancelled=!0,delete this.streamSinks[Bt];break;default:throw new Error("Unexpected stream case")}},eo=async function(Wt,Bt){var qt,Ut,kt;await Promise.allSettled([(qt=Wt.startCall)==null?void 0:qt.promise,(Ut=Wt.pullCall)==null?void 0:Ut.promise,(kt=Wt.cancelCall)==null?void 0:kt.promise]),delete this.streamControllers[Bt]},e.MessageHandler=tt},(s,e,i)=>{var j,_e;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var o=i(1);class a{constructor({parsedData:et,rawData:rt}){Yn(this,j);Yn(this,_e);Jn(this,j,et),Jn(this,_e,rt)}getRaw(){return Kt(this,_e)}get(et){return Kt(this,j).get(et)??null}getAll(){return(0,o.objectFromMap)(Kt(this,j))}has(et){return Kt(this,j).has(et)}}j=new WeakMap,_e=new WeakMap,e.Metadata=a},(s,e,i)=>{var et,rt,dt,vt,Ct,Wt,Lo;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var o=i(1),a=i(8);const j=Symbol("INTERNAL");class _e{constructor(Ut,kt){Yn(this,et,!0);this.name=Ut,this.intent=kt}get visible(){return Kt(this,et)}_setVisible(Ut,kt){Ut!==j&&(0,o.unreachable)("Internal method `_setVisible` called."),Jn(this,et,kt)}}et=new WeakMap;class tt{constructor(Ut){Yn(this,Wt);Yn(this,rt,null);Yn(this,dt,new Map);Yn(this,vt,null);Yn(this,Ct,null);if(this.name=null,this.creator=null,Ut!==null){this.name=Ut.name,this.creator=Ut.creator,Jn(this,Ct,Ut.order);for(const kt of Ut.groups)Kt(this,dt).set(kt.id,new _e(kt.name,kt.intent));if(Ut.baseState==="OFF")for(const kt of Kt(this,dt).values())kt._setVisible(j,!1);for(const kt of Ut.on)Kt(this,dt).get(kt)._setVisible(j,!0);for(const kt of Ut.off)Kt(this,dt).get(kt)._setVisible(j,!1);Jn(this,vt,this.getHash())}}isVisible(Ut){if(Kt(this,dt).size===0)return!0;if(!Ut)return(0,o.warn)("Optional content group not defined."),!0;if(Ut.type==="OCG")return Kt(this,dt).has(Ut.id)?Kt(this,dt).get(Ut.id).visible:((0,o.warn)(`Optional content group not found: ${Ut.id}`),!0);if(Ut.type==="OCMD"){if(Ut.expression)return Wn(this,Wt,Lo).call(this,Ut.expression);if(!Ut.policy||Ut.policy==="AnyOn"){for(const kt of Ut.ids){if(!Kt(this,dt).has(kt))return(0,o.warn)(`Optional content group not found: ${kt}`),!0;if(Kt(this,dt).get(kt).visible)return!0}return!1}else if(Ut.policy==="AllOn"){for(const kt of Ut.ids){if(!Kt(this,dt).has(kt))return(0,o.warn)(`Optional content group not found: ${kt}`),!0;if(!Kt(this,dt).get(kt).visible)return!1}return!0}else if(Ut.policy==="AnyOff"){for(const kt of Ut.ids){if(!Kt(this,dt).has(kt))return(0,o.warn)(`Optional content group not found: ${kt}`),!0;if(!Kt(this,dt).get(kt).visible)return!0}return!1}else if(Ut.policy==="AllOff"){for(const kt of Ut.ids){if(!Kt(this,dt).has(kt))return(0,o.warn)(`Optional content group not found: ${kt}`),!0;if(Kt(this,dt).get(kt).visible)return!1}return!0}return(0,o.warn)(`Unknown optional content policy ${Ut.policy}.`),!0}return(0,o.warn)(`Unknown group type ${Ut.type}.`),!0}setVisibility(Ut,kt=!0){if(!Kt(this,dt).has(Ut)){(0,o.warn)(`Optional content group not found: ${Ut}`);return}Kt(this,dt).get(Ut)._setVisible(j,!!kt),Jn(this,rt,null)}get hasInitialVisibility(){return Kt(this,vt)===null||this.getHash()===Kt(this,vt)}getOrder(){return Kt(this,dt).size?Kt(this,Ct)?Kt(this,Ct).slice():[...Kt(this,dt).keys()]:null}getGroups(){return Kt(this,dt).size>0?(0,o.objectFromMap)(Kt(this,dt)):null}getGroup(Ut){return Kt(this,dt).get(Ut)||null}getHash(){if(Kt(this,rt)!==null)return Kt(this,rt);const Ut=new a.MurmurHash3_64;for(const[kt,Nt]of Kt(this,dt))Ut.update(`${kt}:${Nt.visible}`);return Jn(this,rt,Ut.hexdigest())}}rt=new WeakMap,dt=new WeakMap,vt=new WeakMap,Ct=new WeakMap,Wt=new WeakSet,Lo=function(Ut){const kt=Ut.length;if(kt<2)return!0;const Nt=Ut[0];for(let un=1;un<kt;un++){const dn=Ut[un];let hn;if(Array.isArray(dn))hn=Wn(this,Wt,Lo).call(this,dn);else if(Kt(this,dt).has(dn))hn=Kt(this,dt).get(dn).visible;else return(0,o.warn)(`Optional content group not found: ${dn}`),!0;switch(Nt){case"And":if(!hn)return!1;break;case"Or":if(hn)return!0;break;case"Not":return!hn;default:return!0}}return Nt==="And"},e.OptionalContentConfig=tt},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var o=i(1),a=i(6);class j{constructor({length:rt,initialData:dt,progressiveDone:vt=!1,contentDispositionFilename:Ct=null,disableRange:Wt=!1,disableStream:Bt=!1},qt){if((0,o.assert)(qt,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=vt,this._contentDispositionFilename=Ct,(dt==null?void 0:dt.length)>0){const Ut=dt instanceof Uint8Array&&dt.byteLength===dt.buffer.byteLength?dt.buffer:new Uint8Array(dt).buffer;this._queuedChunks.push(Ut)}this._pdfDataRangeTransport=qt,this._isStreamingSupported=!Bt,this._isRangeSupported=!Wt,this._contentLength=rt,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((Ut,kt)=>{this._onReceiveData({begin:Ut,chunk:kt})}),this._pdfDataRangeTransport.addProgressListener((Ut,kt)=>{this._onProgress({loaded:Ut,total:kt})}),this._pdfDataRangeTransport.addProgressiveReadListener(Ut=>{this._onReceiveData({chunk:Ut})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:rt,chunk:dt}){const vt=dt instanceof Uint8Array&&dt.byteLength===dt.buffer.byteLength?dt.buffer:new Uint8Array(dt).buffer;if(rt===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(vt):this._queuedChunks.push(vt);else{const Ct=this._rangeReaders.some(function(Wt){return Wt._begin!==rt?!1:(Wt._enqueue(vt),!0)});(0,o.assert)(Ct,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var rt;return((rt=this._fullRequestReader)==null?void 0:rt._loaded)??0}_onProgress(rt){var dt,vt,Ct,Wt;rt.total===void 0?(vt=(dt=this._rangeReaders[0])==null?void 0:dt.onProgress)==null||vt.call(dt,{loaded:rt.loaded}):(Wt=(Ct=this._fullRequestReader)==null?void 0:Ct.onProgress)==null||Wt.call(Ct,{loaded:rt.loaded,total:rt.total})}_onProgressiveDone(){var rt;(rt=this._fullRequestReader)==null||rt.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(rt){const dt=this._rangeReaders.indexOf(rt);dt>=0&&this._rangeReaders.splice(dt,1)}getFullReader(){(0,o.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const rt=this._queuedChunks;return this._queuedChunks=null,new _e(this,rt,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(rt,dt){if(dt<=this._progressiveDataLength)return null;const vt=new tt(this,rt,dt);return this._pdfDataRangeTransport.requestDataRange(rt,dt),this._rangeReaders.push(vt),vt}cancelAllRequests(rt){var dt;(dt=this._fullRequestReader)==null||dt.cancel(rt);for(const vt of this._rangeReaders.slice(0))vt.cancel(rt);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=j;class _e{constructor(rt,dt,vt=!1,Ct=null){this._stream=rt,this._done=vt||!1,this._filename=(0,a.isPdfFile)(Ct)?Ct:null,this._queuedChunks=dt||[],this._loaded=0;for(const Wt of this._queuedChunks)this._loaded+=Wt.byteLength;this._requests=[],this._headersReady=Promise.resolve(),rt._fullRequestReader=this,this.onProgress=null}_enqueue(rt){this._done||(this._requests.length>0?this._requests.shift().resolve({value:rt,done:!1}):this._queuedChunks.push(rt),this._loaded+=rt.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const rt=new o.PromiseCapability;return this._requests.push(rt),rt.promise}cancel(rt){this._done=!0;for(const dt of this._requests)dt.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(rt,dt,vt){this._stream=rt,this._begin=dt,this._end=vt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(rt){if(!this._done){if(this._requests.length===0)this._queuedChunk=rt;else{this._requests.shift().resolve({value:rt,done:!1});for(const vt of this._requests)vt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const dt=this._queuedChunk;return this._queuedChunk=null,{value:dt,done:!1}}if(this._done)return{value:void 0,done:!0};const rt=new o.PromiseCapability;return this._requests.push(rt),rt.promise}cancel(rt){this._done=!0;for(const dt of this._requests)dt.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var o=i(1),a=i(20);function j(vt,Ct,Wt){return{method:"GET",headers:vt,signal:Wt.signal,mode:"cors",credentials:Ct?"include":"same-origin",redirect:"follow"}}function _e(vt){const Ct=new Headers;for(const Wt in vt){const Bt=vt[Wt];Bt!==void 0&&Ct.append(Wt,Bt)}return Ct}function tt(vt){return vt instanceof Uint8Array?vt.buffer:vt instanceof ArrayBuffer?vt:((0,o.warn)(`getArrayBuffer - unexpected data format: ${vt}`),new Uint8Array(vt).buffer)}class et{constructor(Ct){this.source=Ct,this.isHttp=/^https?:/i.test(Ct.url),this.httpHeaders=this.isHttp&&Ct.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var Ct;return((Ct=this._fullRequestReader)==null?void 0:Ct._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new rt(this),this._fullRequestReader}getRangeReader(Ct,Wt){if(Wt<=this._progressiveDataLength)return null;const Bt=new dt(this,Ct,Wt);return this._rangeRequestReaders.push(Bt),Bt}cancelAllRequests(Ct){var Wt;(Wt=this._fullRequestReader)==null||Wt.cancel(Ct);for(const Bt of this._rangeRequestReaders.slice(0))Bt.cancel(Ct)}}e.PDFFetchStream=et;class rt{constructor(Ct){this._stream=Ct,this._reader=null,this._loaded=0,this._filename=null;const Wt=Ct.source;this._withCredentials=Wt.withCredentials||!1,this._contentLength=Wt.length,this._headersCapability=new o.PromiseCapability,this._disableRange=Wt.disableRange||!1,this._rangeChunkSize=Wt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!Wt.disableStream,this._isRangeSupported=!Wt.disableRange,this._headers=_e(this._stream.httpHeaders);const Bt=Wt.url;fetch(Bt,j(this._headers,this._withCredentials,this._abortController)).then(qt=>{if(!(0,a.validateResponseStatus)(qt.status))throw(0,a.createResponseStatusError)(qt.status,Bt);this._reader=qt.body.getReader(),this._headersCapability.resolve();const Ut=un=>qt.headers.get(un),{allowRangeRequests:kt,suggestedLength:Nt}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:Ut,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=kt,this._contentLength=Nt||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(Ut),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new o.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Bt;await this._headersCapability.promise;const{value:Ct,done:Wt}=await this._reader.read();return Wt?{value:Ct,done:Wt}:(this._loaded+=Ct.byteLength,(Bt=this.onProgress)==null||Bt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tt(Ct),done:!1})}cancel(Ct){var Wt;(Wt=this._reader)==null||Wt.cancel(Ct),this._abortController.abort()}}class dt{constructor(Ct,Wt,Bt){this._stream=Ct,this._reader=null,this._loaded=0;const qt=Ct.source;this._withCredentials=qt.withCredentials||!1,this._readCapability=new o.PromiseCapability,this._isStreamingSupported=!qt.disableStream,this._abortController=new AbortController,this._headers=_e(this._stream.httpHeaders),this._headers.append("Range",`bytes=${Wt}-${Bt-1}`);const Ut=qt.url;fetch(Ut,j(this._headers,this._withCredentials,this._abortController)).then(kt=>{if(!(0,a.validateResponseStatus)(kt.status))throw(0,a.createResponseStatusError)(kt.status,Ut);this._readCapability.resolve(),this._reader=kt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Bt;await this._readCapability.promise;const{value:Ct,done:Wt}=await this._reader.read();return Wt?{value:Ct,done:Wt}:(this._loaded+=Ct.byteLength,(Bt=this.onProgress)==null||Bt.call(this,{loaded:this._loaded}),{value:tt(Ct),done:!1})}cancel(Ct){var Wt;(Wt=this._reader)==null||Wt.cancel(Ct),this._abortController.abort()}}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=et,e.extractFilenameFromHeader=tt,e.validateRangeRequestCapabilities=_e,e.validateResponseStatus=rt;var o=i(1),a=i(21),j=i(6);function _e({getResponseHeader:dt,isHttp:vt,rangeChunkSize:Ct,disableRange:Wt}){const Bt={allowRangeRequests:!1,suggestedLength:void 0},qt=parseInt(dt("Content-Length"),10);return!Number.isInteger(qt)||(Bt.suggestedLength=qt,qt<=2*Ct)||Wt||!vt||dt("Accept-Ranges")!=="bytes"||(dt("Content-Encoding")||"identity")!=="identity"||(Bt.allowRangeRequests=!0),Bt}function tt(dt){const vt=dt("Content-Disposition");if(vt){let Ct=(0,a.getFilenameFromContentDispositionHeader)(vt);if(Ct.includes("%"))try{Ct=decodeURIComponent(Ct)}catch{}if((0,j.isPdfFile)(Ct))return Ct}return null}function et(dt,vt){return dt===404||dt===0&&vt.startsWith("file:")?new o.MissingPDFException('Missing PDF "'+vt+'".'):new o.UnexpectedResponseException(`Unexpected server response (${dt}) while retrieving PDF "${vt}".`,dt)}function rt(dt){return dt===200||dt===206}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=a;var o=i(1);function a(j){let _e=!0,tt=et("filename\\*","i").exec(j);if(tt){tt=tt[1];let qt=Ct(tt);return qt=unescape(qt),qt=Wt(qt),qt=Bt(qt),dt(qt)}if(tt=vt(j),tt){const qt=Bt(tt);return dt(qt)}if(tt=et("filename","i").exec(j),tt){tt=tt[1];let qt=Ct(tt);return qt=Bt(qt),dt(qt)}function et(qt,Ut){return new RegExp("(?:^|;)\\s*"+qt+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',Ut)}function rt(qt,Ut){if(qt){if(!/^[\x00-\xFF]+$/.test(Ut))return Ut;try{const kt=new TextDecoder(qt,{fatal:!0}),Nt=(0,o.stringToBytes)(Ut);Ut=kt.decode(Nt),_e=!1}catch{}}return Ut}function dt(qt){return _e&&/[\x80-\xff]/.test(qt)&&(qt=rt("utf-8",qt),_e&&(qt=rt("iso-8859-1",qt))),qt}function vt(qt){const Ut=[];let kt;const Nt=et("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(kt=Nt.exec(qt))!==null;){let[,dn,hn,gn]=kt;if(dn=parseInt(dn,10),dn in Ut){if(dn===0)break;continue}Ut[dn]=[hn,gn]}const un=[];for(let dn=0;dn<Ut.length&&dn in Ut;++dn){let[hn,gn]=Ut[dn];gn=Ct(gn),hn&&(gn=unescape(gn),dn===0&&(gn=Wt(gn))),un.push(gn)}return un.join("")}function Ct(qt){if(qt.startsWith('"')){const Ut=qt.slice(1).split('\\"');for(let kt=0;kt<Ut.length;++kt){const Nt=Ut[kt].indexOf('"');Nt!==-1&&(Ut[kt]=Ut[kt].slice(0,Nt),Ut.length=kt+1),Ut[kt]=Ut[kt].replaceAll(/\\(.)/g,"$1")}qt=Ut.join('"')}return qt}function Wt(qt){const Ut=qt.indexOf("'");if(Ut===-1)return qt;const kt=qt.slice(0,Ut),un=qt.slice(Ut+1).replace(/^[^']*'/,"");return rt(kt,un)}function Bt(qt){return!qt.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(qt)?qt:qt.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(Ut,kt,Nt,un){if(Nt==="q"||Nt==="Q")return un=un.replaceAll("_"," "),un=un.replaceAll(/=([0-9a-fA-F]{2})/g,function(dn,hn){return String.fromCharCode(parseInt(hn,16))}),rt(kt,un);try{un=atob(un)}catch{}return rt(kt,un)})}return""}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var o=i(1),a=i(20);const j=200,_e=206;function tt(Ct){const Wt=Ct.response;return typeof Wt!="string"?Wt:(0,o.stringToBytes)(Wt).buffer}class et{constructor(Wt,Bt={}){this.url=Wt,this.isHttp=/^https?:/i.test(Wt),this.httpHeaders=this.isHttp&&Bt.httpHeaders||Object.create(null),this.withCredentials=Bt.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(Wt,Bt,qt){const Ut={begin:Wt,end:Bt};for(const kt in qt)Ut[kt]=qt[kt];return this.request(Ut)}requestFull(Wt){return this.request(Wt)}request(Wt){const Bt=new XMLHttpRequest,qt=this.currXhrId++,Ut=this.pendingRequests[qt]={xhr:Bt};Bt.open("GET",this.url),Bt.withCredentials=this.withCredentials;for(const kt in this.httpHeaders){const Nt=this.httpHeaders[kt];Nt!==void 0&&Bt.setRequestHeader(kt,Nt)}return this.isHttp&&"begin"in Wt&&"end"in Wt?(Bt.setRequestHeader("Range",`bytes=${Wt.begin}-${Wt.end-1}`),Ut.expectedStatus=_e):Ut.expectedStatus=j,Bt.responseType="arraybuffer",Wt.onError&&(Bt.onerror=function(kt){Wt.onError(Bt.status)}),Bt.onreadystatechange=this.onStateChange.bind(this,qt),Bt.onprogress=this.onProgress.bind(this,qt),Ut.onHeadersReceived=Wt.onHeadersReceived,Ut.onDone=Wt.onDone,Ut.onError=Wt.onError,Ut.onProgress=Wt.onProgress,Bt.send(null),qt}onProgress(Wt,Bt){var Ut;const qt=this.pendingRequests[Wt];qt&&((Ut=qt.onProgress)==null||Ut.call(qt,Bt))}onStateChange(Wt,Bt){var dn,hn,gn;const qt=this.pendingRequests[Wt];if(!qt)return;const Ut=qt.xhr;if(Ut.readyState>=2&&qt.onHeadersReceived&&(qt.onHeadersReceived(),delete qt.onHeadersReceived),Ut.readyState!==4||!(Wt in this.pendingRequests))return;if(delete this.pendingRequests[Wt],Ut.status===0&&this.isHttp){(dn=qt.onError)==null||dn.call(qt,Ut.status);return}const kt=Ut.status||j;if(!(kt===j&&qt.expectedStatus===_e)&&kt!==qt.expectedStatus){(hn=qt.onError)==null||hn.call(qt,Ut.status);return}const un=tt(Ut);if(kt===_e){const It=Ut.getResponseHeader("Content-Range"),pt=/bytes (\d+)-(\d+)\/(\d+)/.exec(It);qt.onDone({begin:parseInt(pt[1],10),chunk:un})}else un?qt.onDone({begin:0,chunk:un}):(gn=qt.onError)==null||gn.call(qt,Ut.status)}getRequestXhr(Wt){return this.pendingRequests[Wt].xhr}isPendingRequest(Wt){return Wt in this.pendingRequests}abortRequest(Wt){const Bt=this.pendingRequests[Wt].xhr;delete this.pendingRequests[Wt],Bt.abort()}}class rt{constructor(Wt){this._source=Wt,this._manager=new et(Wt.url,{httpHeaders:Wt.httpHeaders,withCredentials:Wt.withCredentials}),this._rangeChunkSize=Wt.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(Wt){const Bt=this._rangeRequestReaders.indexOf(Wt);Bt>=0&&this._rangeRequestReaders.splice(Bt,1)}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new dt(this._manager,this._source),this._fullRequestReader}getRangeReader(Wt,Bt){const qt=new vt(this._manager,Wt,Bt);return qt.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(qt),qt}cancelAllRequests(Wt){var Bt;(Bt=this._fullRequestReader)==null||Bt.cancel(Wt);for(const qt of this._rangeRequestReaders.slice(0))qt.cancel(Wt)}}e.PDFNetworkStream=rt;class dt{constructor(Wt,Bt){this._manager=Wt;const qt={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Bt.url,this._fullRequestId=Wt.requestFull(qt),this._headersReceivedCapability=new o.PromiseCapability,this._disableRange=Bt.disableRange||!1,this._contentLength=Bt.length,this._rangeChunkSize=Bt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const Wt=this._fullRequestId,Bt=this._manager.getRequestXhr(Wt),qt=Nt=>Bt.getResponseHeader(Nt),{allowRangeRequests:Ut,suggestedLength:kt}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:qt,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Ut&&(this._isRangeSupported=!0),this._contentLength=kt||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(qt),this._isRangeSupported&&this._manager.abortRequest(Wt),this._headersReceivedCapability.resolve()}_onDone(Wt){if(Wt&&(this._requests.length>0?this._requests.shift().resolve({value:Wt.chunk,done:!1}):this._cachedChunks.push(Wt.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const Bt of this._requests)Bt.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(Wt){this._storedError=(0,a.createResponseStatusError)(Wt,this._url),this._headersReceivedCapability.reject(this._storedError);for(const Bt of this._requests)Bt.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(Wt){var Bt;(Bt=this.onProgress)==null||Bt.call(this,{loaded:Wt.loaded,total:Wt.lengthComputable?Wt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Wt=new o.PromiseCapability;return this._requests.push(Wt),Wt.promise}cancel(Wt){this._done=!0,this._headersReceivedCapability.reject(Wt);for(const Bt of this._requests)Bt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class vt{constructor(Wt,Bt,qt){this._manager=Wt;const Ut={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Wt.url,this._requestId=Wt.requestRange(Bt,qt,Ut),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var Wt;(Wt=this.onClosed)==null||Wt.call(this,this)}_onDone(Wt){const Bt=Wt.chunk;this._requests.length>0?this._requests.shift().resolve({value:Bt,done:!1}):this._queuedChunk=Bt,this._done=!0;for(const qt of this._requests)qt.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(Wt){this._storedError=(0,a.createResponseStatusError)(Wt,this._url);for(const Bt of this._requests)Bt.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(Wt){var Bt;this.isStreamingSupported||(Bt=this.onProgress)==null||Bt.call(this,{loaded:Wt.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const Bt=this._queuedChunk;return this._queuedChunk=null,{value:Bt,done:!1}}if(this._done)return{value:void 0,done:!0};const Wt=new o.PromiseCapability;return this._requests.push(Wt),Wt.promise}cancel(Wt){this._done=!0;for(const Bt of this._requests)Bt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var o=i(1),a=i(20);const j=/^file:\/\/\/[a-zA-Z]:\//;function _e(qt){const Ut=require$$5,kt=Ut.parse(qt);return kt.protocol==="file:"||kt.host?kt:/^[a-z]:[/\\]/i.test(qt)?Ut.parse(`file:///${qt}`):(kt.host||(kt.protocol="file:"),kt)}class tt{constructor(Ut){this.source=Ut,this.url=_e(Ut.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&Ut.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var Ut;return((Ut=this._fullRequestReader)==null?void 0:Ut._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Wt(this):new vt(this),this._fullRequestReader}getRangeReader(Ut,kt){if(kt<=this._progressiveDataLength)return null;const Nt=this.isFsUrl?new Bt(this,Ut,kt):new Ct(this,Ut,kt);return this._rangeRequestReaders.push(Nt),Nt}cancelAllRequests(Ut){var kt;(kt=this._fullRequestReader)==null||kt.cancel(Ut);for(const Nt of this._rangeRequestReaders.slice(0))Nt.cancel(Ut)}}e.PDFNodeStream=tt;class et{constructor(Ut){this._url=Ut.url,this._done=!1,this._storedError=null,this.onProgress=null;const kt=Ut.source;this._contentLength=kt.length,this._loaded=0,this._filename=null,this._disableRange=kt.disableRange||!1,this._rangeChunkSize=kt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!kt.disableStream,this._isRangeSupported=!kt.disableRange,this._readableStream=null,this._readCapability=new o.PromiseCapability,this._headersCapability=new o.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Nt;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Ut=this._readableStream.read();return Ut===null?(this._readCapability=new o.PromiseCapability,this.read()):(this._loaded+=Ut.length,(Nt=this.onProgress)==null||Nt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(Ut).buffer,done:!1})}cancel(Ut){if(!this._readableStream){this._error(Ut);return}this._readableStream.destroy(Ut)}_error(Ut){this._storedError=Ut,this._readCapability.resolve()}_setReadableStream(Ut){this._readableStream=Ut,Ut.on("readable",()=>{this._readCapability.resolve()}),Ut.on("end",()=>{Ut.destroy(),this._done=!0,this._readCapability.resolve()}),Ut.on("error",kt=>{this._error(kt)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class rt{constructor(Ut){this._url=Ut.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new o.PromiseCapability;const kt=Ut.source;this._isStreamingSupported=!kt.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Nt;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Ut=this._readableStream.read();return Ut===null?(this._readCapability=new o.PromiseCapability,this.read()):(this._loaded+=Ut.length,(Nt=this.onProgress)==null||Nt.call(this,{loaded:this._loaded}),{value:new Uint8Array(Ut).buffer,done:!1})}cancel(Ut){if(!this._readableStream){this._error(Ut);return}this._readableStream.destroy(Ut)}_error(Ut){this._storedError=Ut,this._readCapability.resolve()}_setReadableStream(Ut){this._readableStream=Ut,Ut.on("readable",()=>{this._readCapability.resolve()}),Ut.on("end",()=>{Ut.destroy(),this._done=!0,this._readCapability.resolve()}),Ut.on("error",kt=>{this._error(kt)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function dt(qt,Ut){return{protocol:qt.protocol,auth:qt.auth,host:qt.hostname,port:qt.port,path:qt.path,method:"GET",headers:Ut}}class vt extends et{constructor(Ut){super(Ut);const kt=Nt=>{if(Nt.statusCode===404){const gn=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=gn,this._headersCapability.reject(gn);return}this._headersCapability.resolve(),this._setReadableStream(Nt);const un=gn=>this._readableStream.headers[gn.toLowerCase()],{allowRangeRequests:dn,suggestedLength:hn}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:un,isHttp:Ut.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=dn,this._contentLength=hn||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(un)};if(this._request=null,this._url.protocol==="http:"){const Nt=require$$5;this._request=Nt.request(dt(this._url,Ut.httpHeaders),kt)}else{const Nt=require$$5;this._request=Nt.request(dt(this._url,Ut.httpHeaders),kt)}this._request.on("error",Nt=>{this._storedError=Nt,this._headersCapability.reject(Nt)}),this._request.end()}}class Ct extends rt{constructor(Ut,kt,Nt){super(Ut),this._httpHeaders={};for(const dn in Ut.httpHeaders){const hn=Ut.httpHeaders[dn];hn!==void 0&&(this._httpHeaders[dn]=hn)}this._httpHeaders.Range=`bytes=${kt}-${Nt-1}`;const un=dn=>{if(dn.statusCode===404){const hn=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=hn;return}this._setReadableStream(dn)};if(this._request=null,this._url.protocol==="http:"){const dn=require$$5;this._request=dn.request(dt(this._url,this._httpHeaders),un)}else{const dn=require$$5;this._request=dn.request(dt(this._url,this._httpHeaders),un)}this._request.on("error",dn=>{this._storedError=dn}),this._request.end()}}class Wt extends et{constructor(Ut){super(Ut);let kt=decodeURIComponent(this._url.path);j.test(this._url.href)&&(kt=kt.replace(/^\//,""));const Nt=require$$5;Nt.lstat(kt,(un,dn)=>{if(un){un.code==="ENOENT"&&(un=new o.MissingPDFException(`Missing PDF "${kt}".`)),this._storedError=un,this._headersCapability.reject(un);return}this._contentLength=dn.size,this._setReadableStream(Nt.createReadStream(kt)),this._headersCapability.resolve()})}}class Bt extends rt{constructor(Ut,kt,Nt){super(Ut);let un=decodeURIComponent(this._url.path);j.test(this._url.href)&&(un=un.replace(/^\//,""));const dn=require$$5;this._setReadableStream(dn.createReadStream(un,{start:kt,end:Nt-1}))}}},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var o=i(6),a=i(1);const j={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},_e="http://www.w3.org/XML/1998/namespace",tt="http://www.w3.org/1999/xlink",et=["butt","round","square"],rt=["miter","round","bevel"],dt=function(dn,hn="",gn=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!gn)return URL.createObjectURL(new Blob([dn],{type:hn}));const It="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let pt=`data:${hn};base64,`;for(let Dt=0,mn=dn.length;Dt<mn;Dt+=3){const Lt=dn[Dt]&255,yn=dn[Dt+1]&255,fn=dn[Dt+2]&255,$n=Lt>>2,Ln=(Lt&3)<<4|yn>>4,jn=Dt+1<mn?(yn&15)<<2|fn>>6:64,On=Dt+2<mn?fn&63:64;pt+=It[$n]+It[Ln]+It[jn]+It[On]}return pt},vt=function(){const dn=new Uint8Array([137,80,78,71,13,10,26,10]),hn=12,gn=new Int32Array(256);for(let fn=0;fn<256;fn++){let $n=fn;for(let Ln=0;Ln<8;Ln++)$n=$n&1?3988292384^$n>>1&2147483647:$n>>1&2147483647;gn[fn]=$n}function It(fn,$n,Ln){let jn=-1;for(let On=$n;On<Ln;On++){const Vn=(jn^fn[On])&255,Rn=gn[Vn];jn=jn>>>8^Rn}return jn^-1}function pt(fn,$n,Ln,jn){let On=jn;const Vn=$n.length;Ln[On]=Vn>>24&255,Ln[On+1]=Vn>>16&255,Ln[On+2]=Vn>>8&255,Ln[On+3]=Vn&255,On+=4,Ln[On]=fn.charCodeAt(0)&255,Ln[On+1]=fn.charCodeAt(1)&255,Ln[On+2]=fn.charCodeAt(2)&255,Ln[On+3]=fn.charCodeAt(3)&255,On+=4,Ln.set($n,On),On+=$n.length;const Rn=It(Ln,jn+4,On);Ln[On]=Rn>>24&255,Ln[On+1]=Rn>>16&255,Ln[On+2]=Rn>>8&255,Ln[On+3]=Rn&255}function Dt(fn,$n,Ln){let jn=1,On=0;for(let Vn=$n;Vn<Ln;++Vn)jn=(jn+(fn[Vn]&255))%65521,On=(On+jn)%65521;return On<<16|jn}function mn(fn){if(!a.isNodeJS)return Lt(fn);try{const $n=parseInt(process.versions.node)>=8?fn:Buffer.from(fn),Ln=require$$5.deflateSync($n,{level:9});return Ln instanceof Uint8Array?Ln:new Uint8Array(Ln)}catch($n){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+$n)}return Lt(fn)}function Lt(fn){let $n=fn.length;const Ln=65535,jn=Math.ceil($n/Ln),On=new Uint8Array(2+$n+jn*5+4);let Vn=0;On[Vn++]=120,On[Vn++]=156;let Rn=0;for(;$n>Ln;)On[Vn++]=0,On[Vn++]=255,On[Vn++]=255,On[Vn++]=0,On[Vn++]=0,On.set(fn.subarray(Rn,Rn+Ln),Vn),Vn+=Ln,Rn+=Ln,$n-=Ln;On[Vn++]=1,On[Vn++]=$n&255,On[Vn++]=$n>>8&255,On[Vn++]=~$n&65535&255,On[Vn++]=(~$n&65535)>>8&255,On.set(fn.subarray(Rn),Vn),Vn+=fn.length-Rn;const Dn=Dt(fn,0,fn.length);return On[Vn++]=Dn>>24&255,On[Vn++]=Dn>>16&255,On[Vn++]=Dn>>8&255,On[Vn++]=Dn&255,On}function yn(fn,$n,Ln,jn){const On=fn.width,Vn=fn.height;let Rn,Dn,Fn;const Tn=fn.data;switch($n){case a.ImageKind.GRAYSCALE_1BPP:Dn=0,Rn=1,Fn=On+7>>3;break;case a.ImageKind.RGB_24BPP:Dn=2,Rn=8,Fn=On*3;break;case a.ImageKind.RGBA_32BPP:Dn=6,Rn=8,Fn=On*4;break;default:throw new Error("invalid format")}const pn=new Uint8Array((1+Fn)*Vn);let En=0,An=0;for(let er=0;er<Vn;++er)pn[En++]=0,pn.set(Tn.subarray(An,An+Fn),En),An+=Fn,En+=Fn;if($n===a.ImageKind.GRAYSCALE_1BPP&&jn){En=0;for(let er=0;er<Vn;er++){En++;for(let nr=0;nr<Fn;nr++)pn[En++]^=255}}const bn=new Uint8Array([On>>24&255,On>>16&255,On>>8&255,On&255,Vn>>24&255,Vn>>16&255,Vn>>8&255,Vn&255,Rn,Dn,0,0,0]),wn=mn(pn),Cn=dn.length+hn*3+bn.length+wn.length,Un=new Uint8Array(Cn);let Gn=0;return Un.set(dn,Gn),Gn+=dn.length,pt("IHDR",bn,Un,Gn),Gn+=hn+bn.length,pt("IDATA",wn,Un,Gn),Gn+=hn+wn.length,pt("IEND",new Uint8Array(0),Un,Gn),dt(Un,"image/png",Ln)}return function($n,Ln,jn){const On=$n.kind===void 0?a.ImageKind.GRAYSCALE_1BPP:$n.kind;return yn($n,On,Ln,jn)}}();class Ct{constructor(){this.fontSizeScale=1,this.fontWeight=j.fontWeight,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=j.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(hn,gn){this.x=hn,this.y=gn}}function Wt(dn){let hn=[];const gn=[];for(const It of dn){if(It.fn==="save"){hn.push({fnId:92,fn:"group",items:[]}),gn.push(hn),hn=hn.at(-1).items;continue}It.fn==="restore"?hn=gn.pop():hn.push(It)}return hn}function Bt(dn){if(Number.isInteger(dn))return dn.toString();const hn=dn.toFixed(10);let gn=hn.length-1;if(hn[gn]!=="0")return hn;do gn--;while(hn[gn]==="0");return hn.substring(0,hn[gn]==="."?gn:gn+1)}function qt(dn){if(dn[4]===0&&dn[5]===0){if(dn[1]===0&&dn[2]===0)return dn[0]===1&&dn[3]===1?"":`scale(${Bt(dn[0])} ${Bt(dn[3])})`;if(dn[0]===dn[3]&&dn[1]===-dn[2]){const hn=Math.acos(dn[0])*180/Math.PI;return`rotate(${Bt(hn)})`}}else if(dn[0]===1&&dn[1]===0&&dn[2]===0&&dn[3]===1)return`translate(${Bt(dn[4])} ${Bt(dn[5])})`;return`matrix(${Bt(dn[0])} ${Bt(dn[1])} ${Bt(dn[2])} ${Bt(dn[3])} ${Bt(dn[4])} ${Bt(dn[5])})`}let Ut=0,kt=0,Nt=0;class un{constructor(hn,gn,It=!1){(0,o.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new o.DOMSVGFactory,this.current=new Ct,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=hn,this.objs=gn,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!It,this._operatorIdMapping=[];for(const pt in a.OPS)this._operatorIdMapping[a.OPS[pt]]=pt}getObject(hn,gn=null){return typeof hn=="string"?hn.startsWith("g_")?this.commonObjs.get(hn):this.objs.get(hn):gn}save(){this.transformStack.push(this.transformMatrix);const hn=this.current;this.extraStack.push(hn),this.current=hn.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(hn){this.save(),this.executeOpTree(hn),this.restore()}loadDependencies(hn){const gn=hn.fnArray,It=hn.argsArray;for(let pt=0,Dt=gn.length;pt<Dt;pt++)if(gn[pt]===a.OPS.dependency)for(const mn of It[pt]){const Lt=mn.startsWith("g_")?this.commonObjs:this.objs,yn=new Promise(fn=>{Lt.get(mn,fn)});this.current.dependencies.push(yn)}return Promise.all(this.current.dependencies)}transform(hn,gn,It,pt,Dt,mn){const Lt=[hn,gn,It,pt,Dt,mn];this.transformMatrix=a.Util.transform(this.transformMatrix,Lt),this.tgrp=null}getSVG(hn,gn){this.viewport=gn;const It=this._initialize(gn);return this.loadDependencies(hn).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(hn)),It))}convertOpList(hn){const gn=this._operatorIdMapping,It=hn.argsArray,pt=hn.fnArray,Dt=[];for(let mn=0,Lt=pt.length;mn<Lt;mn++){const yn=pt[mn];Dt.push({fnId:yn,fn:gn[yn],args:It[mn]})}return Wt(Dt)}executeOpTree(hn){for(const gn of hn){const It=gn.fn,pt=gn.fnId,Dt=gn.args;switch(pt|0){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(Dt);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(Dt[0],Dt[1]);break;case a.OPS.setFont:this.setFont(Dt);break;case a.OPS.showText:this.showText(Dt[0]);break;case a.OPS.showSpacedText:this.showText(Dt[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(Dt[0],Dt[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(Dt[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(Dt[0]);break;case a.OPS.setHScale:this.setHScale(Dt[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(Dt[0],Dt[1],Dt[2],Dt[3],Dt[4],Dt[5]);break;case a.OPS.setTextRise:this.setTextRise(Dt[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(Dt[0]);break;case a.OPS.setLineWidth:this.setLineWidth(Dt[0]);break;case a.OPS.setLineJoin:this.setLineJoin(Dt[0]);break;case a.OPS.setLineCap:this.setLineCap(Dt[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(Dt[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(Dt[0],Dt[1],Dt[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(Dt[0],Dt[1],Dt[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(Dt);break;case a.OPS.setFillColorN:this.setFillColorN(Dt);break;case a.OPS.shadingFill:this.shadingFill(Dt[0]);break;case a.OPS.setDash:this.setDash(Dt[0],Dt[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(Dt[0]);break;case a.OPS.setFlatness:this.setFlatness(Dt[0]);break;case a.OPS.setGState:this.setGState(Dt[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(Dt[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(Dt[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(Dt[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(Dt[0],Dt[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(Dt[0],Dt[1],Dt[2],Dt[3],Dt[4],Dt[5]);break;case a.OPS.constructPath:this.constructPath(Dt[0],Dt[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(gn.items);break;default:(0,a.warn)(`Unimplemented operator ${It}`);break}}}setWordSpacing(hn){this.current.wordSpacing=hn}setCharSpacing(hn){this.current.charSpacing=hn}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(hn,gn,It,pt,Dt,mn){const Lt=this.current;Lt.textMatrix=Lt.lineMatrix=[hn,gn,It,pt,Dt,mn],Lt.textMatrixScale=Math.hypot(hn,gn),Lt.x=Lt.lineX=0,Lt.y=Lt.lineY=0,Lt.xcoords=[],Lt.ycoords=[],Lt.tspan=this.svgFactory.createElement("svg:tspan"),Lt.tspan.setAttributeNS(null,"font-family",Lt.fontFamily),Lt.tspan.setAttributeNS(null,"font-size",`${Bt(Lt.fontSize)}px`),Lt.tspan.setAttributeNS(null,"y",Bt(-Lt.y)),Lt.txtElement=this.svgFactory.createElement("svg:text"),Lt.txtElement.append(Lt.tspan)}beginText(){const hn=this.current;hn.x=hn.lineX=0,hn.y=hn.lineY=0,hn.textMatrix=a.IDENTITY_MATRIX,hn.lineMatrix=a.IDENTITY_MATRIX,hn.textMatrixScale=1,hn.tspan=this.svgFactory.createElement("svg:tspan"),hn.txtElement=this.svgFactory.createElement("svg:text"),hn.txtgrp=this.svgFactory.createElement("svg:g"),hn.xcoords=[],hn.ycoords=[]}moveText(hn,gn){const It=this.current;It.x=It.lineX+=hn,It.y=It.lineY+=gn,It.xcoords=[],It.ycoords=[],It.tspan=this.svgFactory.createElement("svg:tspan"),It.tspan.setAttributeNS(null,"font-family",It.fontFamily),It.tspan.setAttributeNS(null,"font-size",`${Bt(It.fontSize)}px`),It.tspan.setAttributeNS(null,"y",Bt(-It.y))}showText(hn){const gn=this.current,It=gn.font,pt=gn.fontSize;if(pt===0)return;const Dt=gn.fontSizeScale,mn=gn.charSpacing,Lt=gn.wordSpacing,yn=gn.fontDirection,fn=gn.textHScale*yn,$n=It.vertical,Ln=$n?1:-1,jn=It.defaultVMetrics,On=pt*gn.fontMatrix[0];let Vn=0;for(const Fn of hn){if(Fn===null){Vn+=yn*Lt;continue}else if(typeof Fn=="number"){Vn+=Ln*Fn*pt/1e3;continue}const Tn=(Fn.isSpace?Lt:0)+mn,pn=Fn.fontChar;let En,An,bn=Fn.width;if($n){let Cn;const Un=Fn.vmetric||jn;Cn=Fn.vmetric?Un[1]:bn*.5,Cn=-Cn*On;const Gn=Un[2]*On;bn=Un?-Un[0]:bn,En=Cn/Dt,An=(Vn+Gn)/Dt}else En=Vn/Dt,An=0;(Fn.isInFont||It.missingFile)&&(gn.xcoords.push(gn.x+En),$n&&gn.ycoords.push(-gn.y+An),gn.tspan.textContent+=pn);const wn=$n?bn*On-Tn*yn:bn*On+Tn*yn;Vn+=wn}gn.tspan.setAttributeNS(null,"x",gn.xcoords.map(Bt).join(" ")),$n?gn.tspan.setAttributeNS(null,"y",gn.ycoords.map(Bt).join(" ")):gn.tspan.setAttributeNS(null,"y",Bt(-gn.y)),$n?gn.y-=Vn:gn.x+=Vn*fn,gn.tspan.setAttributeNS(null,"font-family",gn.fontFamily),gn.tspan.setAttributeNS(null,"font-size",`${Bt(gn.fontSize)}px`),gn.fontStyle!==j.fontStyle&&gn.tspan.setAttributeNS(null,"font-style",gn.fontStyle),gn.fontWeight!==j.fontWeight&&gn.tspan.setAttributeNS(null,"font-weight",gn.fontWeight);const Rn=gn.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(Rn===a.TextRenderingMode.FILL||Rn===a.TextRenderingMode.FILL_STROKE?(gn.fillColor!==j.fillColor&&gn.tspan.setAttributeNS(null,"fill",gn.fillColor),gn.fillAlpha<1&&gn.tspan.setAttributeNS(null,"fill-opacity",gn.fillAlpha)):gn.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?gn.tspan.setAttributeNS(null,"fill","transparent"):gn.tspan.setAttributeNS(null,"fill","none"),Rn===a.TextRenderingMode.STROKE||Rn===a.TextRenderingMode.FILL_STROKE){const Fn=1/(gn.textMatrixScale||1);this._setStrokeAttributes(gn.tspan,Fn)}let Dn=gn.textMatrix;gn.textRise!==0&&(Dn=Dn.slice(),Dn[5]+=gn.textRise),gn.txtElement.setAttributeNS(null,"transform",`${qt(Dn)} scale(${Bt(fn)}, -1)`),gn.txtElement.setAttributeNS(_e,"xml:space","preserve"),gn.txtElement.append(gn.tspan),gn.txtgrp.append(gn.txtElement),this._ensureTransformGroup().append(gn.txtElement)}setLeadingMoveText(hn,gn){this.setLeading(-gn),this.moveText(hn,gn)}addFontStyle(hn){if(!hn.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const gn=dt(hn.data,hn.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${hn.loadedName}"; src: url(${gn}); }
`}setFont(hn){const gn=this.current,It=this.commonObjs.get(hn[0]);let pt=hn[1];gn.font=It,this.embedFonts&&!It.missingFile&&!this.embeddedFonts[It.loadedName]&&(this.addFontStyle(It),this.embeddedFonts[It.loadedName]=It),gn.fontMatrix=It.fontMatrix||a.FONT_IDENTITY_MATRIX;let Dt="normal";It.black?Dt="900":It.bold&&(Dt="bold");const mn=It.italic?"italic":"normal";pt<0?(pt=-pt,gn.fontDirection=-1):gn.fontDirection=1,gn.fontSize=pt,gn.fontFamily=It.loadedName,gn.fontWeight=Dt,gn.fontStyle=mn,gn.tspan=this.svgFactory.createElement("svg:tspan"),gn.tspan.setAttributeNS(null,"y",Bt(-gn.y)),gn.xcoords=[],gn.ycoords=[]}endText(){var gn;const hn=this.current;hn.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&((gn=hn.txtElement)!=null&&gn.hasChildNodes())&&(hn.element=hn.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(hn){hn>0&&(this.current.lineWidth=hn)}setLineCap(hn){this.current.lineCap=et[hn]}setLineJoin(hn){this.current.lineJoin=rt[hn]}setMiterLimit(hn){this.current.miterLimit=hn}setStrokeAlpha(hn){this.current.strokeAlpha=hn}setStrokeRGBColor(hn,gn,It){this.current.strokeColor=a.Util.makeHexColor(hn,gn,It)}setFillAlpha(hn){this.current.fillAlpha=hn}setFillRGBColor(hn,gn,It){this.current.fillColor=a.Util.makeHexColor(hn,gn,It),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(hn){this.current.strokeColor=this._makeColorN_Pattern(hn)}setFillColorN(hn){this.current.fillColor=this._makeColorN_Pattern(hn)}shadingFill(hn){const{width:gn,height:It}=this.viewport,pt=a.Util.inverseTransform(this.transformMatrix),[Dt,mn,Lt,yn]=a.Util.getAxialAlignedBoundingBox([0,0,gn,It],pt),fn=this.svgFactory.createElement("svg:rect");fn.setAttributeNS(null,"x",Dt),fn.setAttributeNS(null,"y",mn),fn.setAttributeNS(null,"width",Lt-Dt),fn.setAttributeNS(null,"height",yn-mn),fn.setAttributeNS(null,"fill",this._makeShadingPattern(hn)),this.current.fillAlpha<1&&fn.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(fn)}_makeColorN_Pattern(hn){return hn[0]==="TilingPattern"?this._makeTilingPattern(hn):this._makeShadingPattern(hn)}_makeTilingPattern(hn){const gn=hn[1],It=hn[2],pt=hn[3]||a.IDENTITY_MATRIX,[Dt,mn,Lt,yn]=hn[4],fn=hn[5],$n=hn[6],Ln=hn[7],jn=`shading${Nt++}`,[On,Vn,Rn,Dn]=a.Util.normalizeRect([...a.Util.applyTransform([Dt,mn],pt),...a.Util.applyTransform([Lt,yn],pt)]),[Fn,Tn]=a.Util.singularValueDecompose2dScale(pt),pn=fn*Fn,En=$n*Tn,An=this.svgFactory.createElement("svg:pattern");An.setAttributeNS(null,"id",jn),An.setAttributeNS(null,"patternUnits","userSpaceOnUse"),An.setAttributeNS(null,"width",pn),An.setAttributeNS(null,"height",En),An.setAttributeNS(null,"x",`${On}`),An.setAttributeNS(null,"y",`${Vn}`);const bn=this.svg,wn=this.transformMatrix,Cn=this.current.fillColor,Un=this.current.strokeColor,Gn=this.svgFactory.create(Rn-On,Dn-Vn);if(this.svg=Gn,this.transformMatrix=pt,Ln===2){const er=a.Util.makeHexColor(...gn);this.current.fillColor=er,this.current.strokeColor=er}return this.executeOpTree(this.convertOpList(It)),this.svg=bn,this.transformMatrix=wn,this.current.fillColor=Cn,this.current.strokeColor=Un,An.append(Gn.childNodes[0]),this.defs.append(An),`url(#${jn})`}_makeShadingPattern(hn){switch(typeof hn=="string"&&(hn=this.objs.get(hn)),hn[0]){case"RadialAxial":const gn=`shading${Nt++}`,It=hn[3];let pt;switch(hn[1]){case"axial":const Dt=hn[4],mn=hn[5];pt=this.svgFactory.createElement("svg:linearGradient"),pt.setAttributeNS(null,"id",gn),pt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),pt.setAttributeNS(null,"x1",Dt[0]),pt.setAttributeNS(null,"y1",Dt[1]),pt.setAttributeNS(null,"x2",mn[0]),pt.setAttributeNS(null,"y2",mn[1]);break;case"radial":const Lt=hn[4],yn=hn[5],fn=hn[6],$n=hn[7];pt=this.svgFactory.createElement("svg:radialGradient"),pt.setAttributeNS(null,"id",gn),pt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),pt.setAttributeNS(null,"cx",yn[0]),pt.setAttributeNS(null,"cy",yn[1]),pt.setAttributeNS(null,"r",$n),pt.setAttributeNS(null,"fx",Lt[0]),pt.setAttributeNS(null,"fy",Lt[1]),pt.setAttributeNS(null,"fr",fn);break;default:throw new Error(`Unknown RadialAxial type: ${hn[1]}`)}for(const Dt of It){const mn=this.svgFactory.createElement("svg:stop");mn.setAttributeNS(null,"offset",Dt[0]),mn.setAttributeNS(null,"stop-color",Dt[1]),pt.append(mn)}return this.defs.append(pt),`url(#${gn})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${hn[0]}`)}}setDash(hn,gn){this.current.dashArray=hn,this.current.dashPhase=gn}constructPath(hn,gn){const It=this.current;let pt=It.x,Dt=It.y,mn=[],Lt=0;for(const yn of hn)switch(yn|0){case a.OPS.rectangle:pt=gn[Lt++],Dt=gn[Lt++];const fn=gn[Lt++],$n=gn[Lt++],Ln=pt+fn,jn=Dt+$n;mn.push("M",Bt(pt),Bt(Dt),"L",Bt(Ln),Bt(Dt),"L",Bt(Ln),Bt(jn),"L",Bt(pt),Bt(jn),"Z");break;case a.OPS.moveTo:pt=gn[Lt++],Dt=gn[Lt++],mn.push("M",Bt(pt),Bt(Dt));break;case a.OPS.lineTo:pt=gn[Lt++],Dt=gn[Lt++],mn.push("L",Bt(pt),Bt(Dt));break;case a.OPS.curveTo:pt=gn[Lt+4],Dt=gn[Lt+5],mn.push("C",Bt(gn[Lt]),Bt(gn[Lt+1]),Bt(gn[Lt+2]),Bt(gn[Lt+3]),Bt(pt),Bt(Dt)),Lt+=6;break;case a.OPS.curveTo2:mn.push("C",Bt(pt),Bt(Dt),Bt(gn[Lt]),Bt(gn[Lt+1]),Bt(gn[Lt+2]),Bt(gn[Lt+3])),pt=gn[Lt+2],Dt=gn[Lt+3],Lt+=4;break;case a.OPS.curveTo3:pt=gn[Lt+2],Dt=gn[Lt+3],mn.push("C",Bt(gn[Lt]),Bt(gn[Lt+1]),Bt(pt),Bt(Dt),Bt(pt),Bt(Dt)),Lt+=4;break;case a.OPS.closePath:mn.push("Z");break}mn=mn.join(" "),It.path&&hn.length>0&&hn[0]!==a.OPS.rectangle&&hn[0]!==a.OPS.moveTo?mn=It.path.getAttributeNS(null,"d")+mn:(It.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(It.path)),It.path.setAttributeNS(null,"d",mn),It.path.setAttributeNS(null,"fill","none"),It.element=It.path,It.setCurrentPoint(pt,Dt)}endPath(){const hn=this.current;if(hn.path=null,!this.pendingClip)return;if(!hn.element){this.pendingClip=null;return}const gn=`clippath${Ut++}`,It=this.svgFactory.createElement("svg:clipPath");It.setAttributeNS(null,"id",gn),It.setAttributeNS(null,"transform",qt(this.transformMatrix));const pt=hn.element.cloneNode(!0);if(this.pendingClip==="evenodd"?pt.setAttributeNS(null,"clip-rule","evenodd"):pt.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,It.append(pt),this.defs.append(It),hn.activeClipUrl){hn.clipGroup=null;for(const Dt of this.extraStack)Dt.clipGroup=null;It.setAttributeNS(null,"clip-path",hn.activeClipUrl)}hn.activeClipUrl=`url(#${gn})`,this.tgrp=null}clip(hn){this.pendingClip=hn}closePath(){const hn=this.current;if(hn.path){const gn=`${hn.path.getAttributeNS(null,"d")}Z`;hn.path.setAttributeNS(null,"d",gn)}}setLeading(hn){this.current.leading=-hn}setTextRise(hn){this.current.textRise=hn}setTextRenderingMode(hn){this.current.textRenderingMode=hn}setHScale(hn){this.current.textHScale=hn/100}setRenderingIntent(hn){}setFlatness(hn){}setGState(hn){for(const[gn,It]of hn)switch(gn){case"LW":this.setLineWidth(It);break;case"LC":this.setLineCap(It);break;case"LJ":this.setLineJoin(It);break;case"ML":this.setMiterLimit(It);break;case"D":this.setDash(It[0],It[1]);break;case"RI":this.setRenderingIntent(It);break;case"FL":this.setFlatness(It);break;case"Font":this.setFont(It);break;case"CA":this.setStrokeAlpha(It);break;case"ca":this.setFillAlpha(It);break;default:(0,a.warn)(`Unimplemented graphic state operator ${gn}`);break}}fill(){const hn=this.current;hn.element&&(hn.element.setAttributeNS(null,"fill",hn.fillColor),hn.element.setAttributeNS(null,"fill-opacity",hn.fillAlpha),this.endPath())}stroke(){const hn=this.current;hn.element&&(this._setStrokeAttributes(hn.element),hn.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(hn,gn=1){const It=this.current;let pt=It.dashArray;gn!==1&&pt.length>0&&(pt=pt.map(function(Dt){return gn*Dt})),hn.setAttributeNS(null,"stroke",It.strokeColor),hn.setAttributeNS(null,"stroke-opacity",It.strokeAlpha),hn.setAttributeNS(null,"stroke-miterlimit",Bt(It.miterLimit)),hn.setAttributeNS(null,"stroke-linecap",It.lineCap),hn.setAttributeNS(null,"stroke-linejoin",It.lineJoin),hn.setAttributeNS(null,"stroke-width",Bt(gn*It.lineWidth)+"px"),hn.setAttributeNS(null,"stroke-dasharray",pt.map(Bt).join(" ")),hn.setAttributeNS(null,"stroke-dashoffset",Bt(gn*It.dashPhase)+"px")}eoFill(){var hn;(hn=this.current.element)==null||hn.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var hn;(hn=this.current.element)==null||hn.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const hn=this.svgFactory.createElement("svg:rect");hn.setAttributeNS(null,"x","0"),hn.setAttributeNS(null,"y","0"),hn.setAttributeNS(null,"width","1px"),hn.setAttributeNS(null,"height","1px"),hn.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(hn)}paintImageXObject(hn){const gn=this.getObject(hn);if(!gn){(0,a.warn)(`Dependent image with object ID ${hn} is not ready yet`);return}this.paintInlineImageXObject(gn)}paintInlineImageXObject(hn,gn){const It=hn.width,pt=hn.height,Dt=vt(hn,this.forceDataSchema,!!gn),mn=this.svgFactory.createElement("svg:rect");mn.setAttributeNS(null,"x","0"),mn.setAttributeNS(null,"y","0"),mn.setAttributeNS(null,"width",Bt(It)),mn.setAttributeNS(null,"height",Bt(pt)),this.current.element=mn,this.clip("nonzero");const Lt=this.svgFactory.createElement("svg:image");Lt.setAttributeNS(tt,"xlink:href",Dt),Lt.setAttributeNS(null,"x","0"),Lt.setAttributeNS(null,"y",Bt(-pt)),Lt.setAttributeNS(null,"width",Bt(It)+"px"),Lt.setAttributeNS(null,"height",Bt(pt)+"px"),Lt.setAttributeNS(null,"transform",`scale(${Bt(1/It)} ${Bt(-1/pt)})`),gn?gn.append(Lt):this._ensureTransformGroup().append(Lt)}paintImageMaskXObject(hn){const gn=this.getObject(hn.data,hn);if(gn.bitmap){(0,a.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const It=this.current,pt=gn.width,Dt=gn.height,mn=It.fillColor;It.maskId=`mask${kt++}`;const Lt=this.svgFactory.createElement("svg:mask");Lt.setAttributeNS(null,"id",It.maskId);const yn=this.svgFactory.createElement("svg:rect");yn.setAttributeNS(null,"x","0"),yn.setAttributeNS(null,"y","0"),yn.setAttributeNS(null,"width",Bt(pt)),yn.setAttributeNS(null,"height",Bt(Dt)),yn.setAttributeNS(null,"fill",mn),yn.setAttributeNS(null,"mask",`url(#${It.maskId})`),this.defs.append(Lt),this._ensureTransformGroup().append(yn),this.paintInlineImageXObject(gn,Lt)}paintFormXObjectBegin(hn,gn){if(Array.isArray(hn)&&hn.length===6&&this.transform(hn[0],hn[1],hn[2],hn[3],hn[4],hn[5]),gn){const It=gn[2]-gn[0],pt=gn[3]-gn[1],Dt=this.svgFactory.createElement("svg:rect");Dt.setAttributeNS(null,"x",gn[0]),Dt.setAttributeNS(null,"y",gn[1]),Dt.setAttributeNS(null,"width",Bt(It)),Dt.setAttributeNS(null,"height",Bt(pt)),this.current.element=Dt,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(hn){const gn=this.svgFactory.create(hn.width,hn.height),It=this.svgFactory.createElement("svg:defs");gn.append(It),this.defs=It;const pt=this.svgFactory.createElement("svg:g");return pt.setAttributeNS(null,"transform",qt(hn.transform)),gn.append(pt),this.svg=pt,gn}_ensureClipGroup(){if(!this.current.clipGroup){const hn=this.svgFactory.createElement("svg:g");hn.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(hn),this.current.clipGroup=hn}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",qt(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=un},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class i{static textContent(a){const j=[],_e={items:j,styles:Object.create(null)};function tt(et){var vt;if(!et)return;let rt=null;const dt=et.name;if(dt==="#text")rt=et.value;else if(i.shouldBuildText(dt))(vt=et==null?void 0:et.attributes)!=null&&vt.textContent?rt=et.attributes.textContent:et.value&&(rt=et.value);else return;if(rt!==null&&j.push({str:rt}),!!et.children)for(const Ct of et.children)tt(Ct)}return tt(a),_e}static shouldBuildText(a){return!(a==="textarea"||a==="input"||a==="option"||a==="select")}}e.XfaText=i},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=qt,e.updateTextLayer=Ut;var o=i(1),a=i(6);const j=1e5,_e=30,tt=.8,et=new Map;function rt(kt,Nt){let un;if(Nt&&o.FeatureTest.isOffscreenCanvasSupported)un=new OffscreenCanvas(kt,kt).getContext("2d",{alpha:!1});else{const dn=document.createElement("canvas");dn.width=dn.height=kt,un=dn.getContext("2d",{alpha:!1})}return un}function dt(kt,Nt){const un=et.get(kt);if(un)return un;const dn=rt(_e,Nt);dn.font=`${_e}px ${kt}`;const hn=dn.measureText("");let gn=hn.fontBoundingBoxAscent,It=Math.abs(hn.fontBoundingBoxDescent);if(gn){const Dt=gn/(gn+It);return et.set(kt,Dt),dn.canvas.width=dn.canvas.height=0,Dt}dn.strokeStyle="red",dn.clearRect(0,0,_e,_e),dn.strokeText("g",0,0);let pt=dn.getImageData(0,0,_e,_e).data;It=0;for(let Dt=pt.length-1-3;Dt>=0;Dt-=4)if(pt[Dt]>0){It=Math.ceil(Dt/4/_e);break}dn.clearRect(0,0,_e,_e),dn.strokeText("A",0,_e),pt=dn.getImageData(0,0,_e,_e).data,gn=0;for(let Dt=0,mn=pt.length;Dt<mn;Dt+=4)if(pt[Dt]>0){gn=_e-Math.floor(Dt/4/_e);break}if(dn.canvas.width=dn.canvas.height=0,gn){const Dt=gn/(gn+It);return et.set(kt,Dt),Dt}return et.set(kt,tt),tt}function vt(kt,Nt,un){const dn=document.createElement("span"),hn={angle:0,canvasWidth:0,hasText:Nt.str!=="",hasEOL:Nt.hasEOL,fontSize:0};kt._textDivs.push(dn);const gn=o.Util.transform(kt._transform,Nt.transform);let It=Math.atan2(gn[1],gn[0]);const pt=un[Nt.fontName];pt.vertical&&(It+=Math.PI/2);const Dt=Math.hypot(gn[2],gn[3]),mn=Dt*dt(pt.fontFamily,kt._isOffscreenCanvasSupported);let Lt,yn;It===0?(Lt=gn[4],yn=gn[5]-mn):(Lt=gn[4]+mn*Math.sin(It),yn=gn[5]-mn*Math.cos(It));const fn="calc(var(--scale-factor)*",$n=dn.style;kt._container===kt._rootContainer?($n.left=`${(100*Lt/kt._pageWidth).toFixed(2)}%`,$n.top=`${(100*yn/kt._pageHeight).toFixed(2)}%`):($n.left=`${fn}${Lt.toFixed(2)}px)`,$n.top=`${fn}${yn.toFixed(2)}px)`),$n.fontSize=`${fn}${Dt.toFixed(2)}px)`,$n.fontFamily=pt.fontFamily,hn.fontSize=Dt,dn.setAttribute("role","presentation"),dn.textContent=Nt.str,dn.dir=Nt.dir,kt._fontInspectorEnabled&&(dn.dataset.fontName=Nt.fontName),It!==0&&(hn.angle=It*(180/Math.PI));let Ln=!1;if(Nt.str.length>1)Ln=!0;else if(Nt.str!==" "&&Nt.transform[0]!==Nt.transform[3]){const jn=Math.abs(Nt.transform[0]),On=Math.abs(Nt.transform[3]);jn!==On&&Math.max(jn,On)/Math.min(jn,On)>1.5&&(Ln=!0)}Ln&&(hn.canvasWidth=pt.vertical?Nt.height:Nt.width),kt._textDivProperties.set(dn,hn),kt._isReadableStream&&kt._layoutText(dn)}function Ct(kt){const{div:Nt,scale:un,properties:dn,ctx:hn,prevFontSize:gn,prevFontFamily:It}=kt,{style:pt}=Nt;let Dt="";if(dn.canvasWidth!==0&&dn.hasText){const{fontFamily:mn}=pt,{canvasWidth:Lt,fontSize:yn}=dn;(gn!==yn||It!==mn)&&(hn.font=`${yn*un}px ${mn}`,kt.prevFontSize=yn,kt.prevFontFamily=mn);const{width:fn}=hn.measureText(Nt.textContent);fn>0&&(Dt=`scaleX(${Lt*un/fn})`)}dn.angle!==0&&(Dt=`rotate(${dn.angle}deg) ${Dt}`),Dt.length>0&&(pt.transform=Dt)}function Wt(kt){if(kt._canceled)return;const Nt=kt._textDivs,un=kt._capability;if(Nt.length>j){un.resolve();return}if(!kt._isReadableStream)for(const hn of Nt)kt._layoutText(hn);un.resolve()}class Bt{constructor({textContentSource:Nt,container:un,viewport:dn,textDivs:hn,textDivProperties:gn,textContentItemsStr:It,isOffscreenCanvasSupported:pt}){var fn;this._textContentSource=Nt,this._isReadableStream=Nt instanceof ReadableStream,this._container=this._rootContainer=un,this._textDivs=hn||[],this._textContentItemsStr=It||[],this._isOffscreenCanvasSupported=pt,this._fontInspectorEnabled=!!((fn=globalThis.FontInspector)!=null&&fn.enabled),this._reader=null,this._textDivProperties=gn||new WeakMap,this._canceled=!1,this._capability=new o.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:dn.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:rt(0,pt)};const{pageWidth:Dt,pageHeight:mn,pageX:Lt,pageY:yn}=dn.rawDims;this._transform=[1,0,0,-1,-Lt,yn+mn],this._pageWidth=Dt,this._pageHeight=mn,(0,a.setLayerDimensions)(un,dn),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new o.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new o.AbortException("TextLayer task cancelled."))}_processItems(Nt,un){for(const dn of Nt){if(dn.str===void 0){if(dn.type==="beginMarkedContentProps"||dn.type==="beginMarkedContent"){const hn=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),dn.id!==null&&this._container.setAttribute("id",`${dn.id}`),hn.append(this._container)}else dn.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(dn.str),vt(this,dn,un)}}_layoutText(Nt){const un=this._layoutTextParams.properties=this._textDivProperties.get(Nt);if(this._layoutTextParams.div=Nt,Ct(this._layoutTextParams),un.hasText&&this._container.append(Nt),un.hasEOL){const dn=document.createElement("br");dn.setAttribute("role","presentation"),this._container.append(dn)}}_render(){const Nt=new o.PromiseCapability;let un=Object.create(null);if(this._isReadableStream){const dn=()=>{this._reader.read().then(({value:hn,done:gn})=>{if(gn){Nt.resolve();return}Object.assign(un,hn.styles),this._processItems(hn.items,un),dn()},Nt.reject)};this._reader=this._textContentSource.getReader(),dn()}else if(this._textContentSource){const{items:dn,styles:hn}=this._textContentSource;this._processItems(dn,hn),Nt.resolve()}else throw new Error('No "textContentSource" parameter specified.');Nt.promise.then(()=>{un=null,Wt(this)},this._capability.reject)}}e.TextLayerRenderTask=Bt;function qt(kt){!kt.textContentSource&&(kt.textContent||kt.textContentStream)&&((0,a.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),kt.textContentSource=kt.textContent||kt.textContentStream);const{container:Nt,viewport:un}=kt,dn=getComputedStyle(Nt),hn=dn.getPropertyValue("visibility"),gn=parseFloat(dn.getPropertyValue("--scale-factor"));hn==="visible"&&(!gn||Math.abs(gn-un.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const It=new Bt(kt);return It._render(),It}function Ut({container:kt,viewport:Nt,textDivs:un,textDivProperties:dn,isOffscreenCanvasSupported:hn,mustRotate:gn=!0,mustRescale:It=!0}){if(gn&&(0,a.setLayerDimensions)(kt,{rotation:Nt.rotation}),It){const pt=rt(0,hn),mn={prevFontSize:null,prevFontFamily:null,div:null,scale:Nt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:pt};for(const Lt of un)mn.properties=dn.get(Lt),mn.div=Lt,Ct(mn)}}},(s,e,i)=>{var dt,vt,Ct,Wt,Bt,qt,Ut,kt,Nt,un,dn,Mo,to,Fo,jo;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var o=i(1),a=i(4),j=i(28),_e=i(33),tt=i(6),et=i(34);const Dt=class Dt{constructor({uiManager:Lt,pageIndex:yn,div:fn,accessibilityManager:$n,annotationLayer:Ln,viewport:jn,l10n:On}){Yn(this,dn);Yn(this,dt);Yn(this,vt,!1);Yn(this,Ct,null);Yn(this,Wt,this.pointerup.bind(this));Yn(this,Bt,this.pointerdown.bind(this));Yn(this,qt,new Map);Yn(this,Ut,!1);Yn(this,kt,!1);Yn(this,Nt,!1);Yn(this,un);const Vn=[j.FreeTextEditor,_e.InkEditor,et.StampEditor];if(!Dt._initialized){Dt._initialized=!0;for(const Rn of Vn)Rn.initialize(On)}Lt.registerEditorTypes(Vn),Jn(this,un,Lt),this.pageIndex=yn,this.div=fn,Jn(this,dt,$n),Jn(this,Ct,Ln),this.viewport=jn,Kt(this,un).addLayer(this)}get isEmpty(){return Kt(this,qt).size===0}updateToolbar(Lt){Kt(this,un).updateToolbar(Lt)}updateMode(Lt=Kt(this,un).getMode()){Wn(this,dn,jo).call(this),Lt===o.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),Lt!==o.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",Lt===o.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",Lt===o.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",Lt===o.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(Lt){if(!Lt&&Kt(this,un).getMode()!==o.AnnotationEditorType.INK)return;if(!Lt){for(const fn of Kt(this,qt).values())if(fn.isEmpty()){fn.setInBackground();return}}Wn(this,dn,to).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(Lt){Kt(this,un).setEditingState(Lt)}addCommands(Lt){Kt(this,un).addCommands(Lt)}enable(){this.div.style.pointerEvents="auto";const Lt=new Set;for(const fn of Kt(this,qt).values())fn.enableEditing(),fn.annotationElementId&&Lt.add(fn.annotationElementId);if(!Kt(this,Ct))return;const yn=Kt(this,Ct).getEditableAnnotations();for(const fn of yn){if(fn.hide(),Kt(this,un).isDeletedAnnotationElement(fn.data.id)||Lt.has(fn.data.id))continue;const $n=this.deserialize(fn);$n&&(this.addOrRebuild($n),$n.enableEditing())}}disable(){var yn;Jn(this,Nt,!0),this.div.style.pointerEvents="none";const Lt=new Set;for(const fn of Kt(this,qt).values()){if(fn.disableEditing(),!fn.annotationElementId||fn.serialize()!==null){Lt.add(fn.annotationElementId);continue}(yn=this.getEditableAnnotation(fn.annotationElementId))==null||yn.show(),fn.remove()}if(Kt(this,Ct)){const fn=Kt(this,Ct).getEditableAnnotations();for(const $n of fn){const{id:Ln}=$n.data;Lt.has(Ln)||Kt(this,un).isDeletedAnnotationElement(Ln)||$n.show()}}Wn(this,dn,jo).call(this),this.isEmpty&&(this.div.hidden=!0),Jn(this,Nt,!1)}getEditableAnnotation(Lt){var yn;return((yn=Kt(this,Ct))==null?void 0:yn.getEditableAnnotation(Lt))||null}setActiveEditor(Lt){Kt(this,un).getActive()!==Lt&&Kt(this,un).setActiveEditor(Lt)}enableClick(){this.div.addEventListener("pointerdown",Kt(this,Bt)),this.div.addEventListener("pointerup",Kt(this,Wt))}disableClick(){this.div.removeEventListener("pointerdown",Kt(this,Bt)),this.div.removeEventListener("pointerup",Kt(this,Wt))}attach(Lt){Kt(this,qt).set(Lt.id,Lt);const{annotationElementId:yn}=Lt;yn&&Kt(this,un).isDeletedAnnotationElement(yn)&&Kt(this,un).removeDeletedAnnotationElement(Lt)}detach(Lt){var yn;Kt(this,qt).delete(Lt.id),(yn=Kt(this,dt))==null||yn.removePointerInTextLayer(Lt.contentDiv),!Kt(this,Nt)&&Lt.annotationElementId&&Kt(this,un).addDeletedAnnotationElement(Lt)}remove(Lt){this.detach(Lt),Kt(this,un).removeEditor(Lt),Lt.div.contains(document.activeElement)&&setTimeout(()=>{Kt(this,un).focusMainContainer()},0),Lt.div.remove(),Lt.isAttachedToDOM=!1,Kt(this,kt)||this.addInkEditorIfNeeded(!1)}changeParent(Lt){var yn;Lt.parent!==this&&(Lt.annotationElementId&&(Kt(this,un).addDeletedAnnotationElement(Lt.annotationElementId),a.AnnotationEditor.deleteAnnotationElement(Lt),Lt.annotationElementId=null),this.attach(Lt),(yn=Lt.parent)==null||yn.detach(Lt),Lt.setParent(this),Lt.div&&Lt.isAttachedToDOM&&(Lt.div.remove(),this.div.append(Lt.div)))}add(Lt){if(this.changeParent(Lt),Kt(this,un).addEditor(Lt),this.attach(Lt),!Lt.isAttachedToDOM){const yn=Lt.render();this.div.append(yn),Lt.isAttachedToDOM=!0}Lt.fixAndSetPosition(),Lt.onceAdded(),Kt(this,un).addToAnnotationStorage(Lt)}moveEditorInDOM(Lt){var fn;if(!Lt.isAttachedToDOM)return;const{activeElement:yn}=document;Lt.div.contains(yn)&&(Lt._focusEventsAllowed=!1,setTimeout(()=>{Lt.div.contains(document.activeElement)?Lt._focusEventsAllowed=!0:(Lt.div.addEventListener("focusin",()=>{Lt._focusEventsAllowed=!0},{once:!0}),yn.focus())},0)),Lt._structTreeParentId=(fn=Kt(this,dt))==null?void 0:fn.moveElementInDOM(this.div,Lt.div,Lt.contentDiv,!0)}addOrRebuild(Lt){Lt.needsToBeRebuilt()?Lt.rebuild():this.add(Lt)}addUndoableEditor(Lt){const yn=()=>Lt._uiManager.rebuild(Lt),fn=()=>{Lt.remove()};this.addCommands({cmd:yn,undo:fn,mustExec:!1})}getNextId(){return Kt(this,un).getId()}pasteEditor(Lt,yn){Kt(this,un).updateToolbar(Lt),Kt(this,un).updateMode(Lt);const{offsetX:fn,offsetY:$n}=Wn(this,dn,Fo).call(this),Ln=this.getNextId(),jn=Wn(this,dn,Mo).call(this,{parent:this,id:Ln,x:fn,y:$n,uiManager:Kt(this,un),isCentered:!0,...yn});jn&&this.add(jn)}deserialize(Lt){switch(Lt.annotationType??Lt.annotationEditorType){case o.AnnotationEditorType.FREETEXT:return j.FreeTextEditor.deserialize(Lt,this,Kt(this,un));case o.AnnotationEditorType.INK:return _e.InkEditor.deserialize(Lt,this,Kt(this,un));case o.AnnotationEditorType.STAMP:return et.StampEditor.deserialize(Lt,this,Kt(this,un))}return null}addNewEditor(){Wn(this,dn,to).call(this,Wn(this,dn,Fo).call(this),!0)}setSelected(Lt){Kt(this,un).setSelected(Lt)}toggleSelected(Lt){Kt(this,un).toggleSelected(Lt)}isSelected(Lt){return Kt(this,un).isSelected(Lt)}unselect(Lt){Kt(this,un).unselect(Lt)}pointerup(Lt){const{isMac:yn}=o.FeatureTest.platform;if(!(Lt.button!==0||Lt.ctrlKey&&yn)&&Lt.target===this.div&&Kt(this,Ut)){if(Jn(this,Ut,!1),!Kt(this,vt)){Jn(this,vt,!0);return}if(Kt(this,un).getMode()===o.AnnotationEditorType.STAMP){Kt(this,un).unselectAll();return}Wn(this,dn,to).call(this,Lt,!1)}}pointerdown(Lt){if(Kt(this,Ut)){Jn(this,Ut,!1);return}const{isMac:yn}=o.FeatureTest.platform;if(Lt.button!==0||Lt.ctrlKey&&yn||Lt.target!==this.div)return;Jn(this,Ut,!0);const fn=Kt(this,un).getActive();Jn(this,vt,!fn||fn.isEmpty())}findNewParent(Lt,yn,fn){const $n=Kt(this,un).findParent(yn,fn);return $n===null||$n===this?!1:($n.changeParent(Lt),!0)}destroy(){var Lt,yn;((Lt=Kt(this,un).getActive())==null?void 0:Lt.parent)===this&&(Kt(this,un).commitOrRemove(),Kt(this,un).setActiveEditor(null));for(const fn of Kt(this,qt).values())(yn=Kt(this,dt))==null||yn.removePointerInTextLayer(fn.contentDiv),fn.setParent(null),fn.isAttachedToDOM=!1,fn.div.remove();this.div=null,Kt(this,qt).clear(),Kt(this,un).removeLayer(this)}render({viewport:Lt}){this.viewport=Lt,(0,tt.setLayerDimensions)(this.div,Lt);for(const yn of Kt(this,un).getEditors(this.pageIndex))this.add(yn);this.updateMode()}update({viewport:Lt}){Kt(this,un).commitOrRemove(),this.viewport=Lt,(0,tt.setLayerDimensions)(this.div,{rotation:Lt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:Lt,pageHeight:yn}=this.viewport.rawDims;return[Lt,yn]}};dt=new WeakMap,vt=new WeakMap,Ct=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,qt=new WeakMap,Ut=new WeakMap,kt=new WeakMap,Nt=new WeakMap,un=new WeakMap,dn=new WeakSet,Mo=function(Lt){switch(Kt(this,un).getMode()){case o.AnnotationEditorType.FREETEXT:return new j.FreeTextEditor(Lt);case o.AnnotationEditorType.INK:return new _e.InkEditor(Lt);case o.AnnotationEditorType.STAMP:return new et.StampEditor(Lt)}return null},to=function(Lt,yn){const fn=this.getNextId(),$n=Wn(this,dn,Mo).call(this,{parent:this,id:fn,x:Lt.offsetX,y:Lt.offsetY,uiManager:Kt(this,un),isCentered:yn});return $n&&this.add($n),$n},Fo=function(){const{x:Lt,y:yn,width:fn,height:$n}=this.div.getBoundingClientRect(),Ln=Math.max(0,Lt),jn=Math.max(0,yn),On=Math.min(window.innerWidth,Lt+fn),Vn=Math.min(window.innerHeight,yn+$n),Rn=(Ln+On)/2-Lt,Dn=(jn+Vn)/2-yn,[Fn,Tn]=this.viewport.rotation%180===0?[Rn,Dn]:[Dn,Rn];return{offsetX:Fn,offsetY:Tn}},jo=function(){Jn(this,kt,!0);for(const Lt of Kt(this,qt).values())Lt.isEmpty()&&Lt.remove();Jn(this,kt,!1)},zr(Dt,"_initialized",!1);let rt=Dt;e.AnnotationEditorLayer=rt},(s,e,i)=>{var et,rt,dt,vt,Ct,Wt,Bt,qt,Ut,kt,au,lu,cu,Os,$o,uu,Uo;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var o=i(1),a=i(5),j=i(4),_e=i(29);const Dt=class Dt extends j.AnnotationEditor{constructor(yn){super({...yn,name:"freeTextEditor"});Yn(this,kt);Yn(this,et,this.editorDivBlur.bind(this));Yn(this,rt,this.editorDivFocus.bind(this));Yn(this,dt,this.editorDivInput.bind(this));Yn(this,vt,this.editorDivKeydown.bind(this));Yn(this,Ct);Yn(this,Wt,"");Yn(this,Bt,`${this.id}-editor`);Yn(this,qt);Yn(this,Ut,null);Jn(this,Ct,yn.color||Dt._defaultColor||j.AnnotationEditor._defaultLineColor),Jn(this,qt,yn.fontSize||Dt._defaultFontSize)}static get _keyboardManager(){const yn=Dt.prototype,fn=jn=>jn.isEmpty(),$n=a.AnnotationEditorUIManager.TRANSLATE_SMALL,Ln=a.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new a.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],yn.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],yn.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],yn._translateEmpty,{args:[-$n,0],checker:fn}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],yn._translateEmpty,{args:[-Ln,0],checker:fn}],[["ArrowRight","mac+ArrowRight"],yn._translateEmpty,{args:[$n,0],checker:fn}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],yn._translateEmpty,{args:[Ln,0],checker:fn}],[["ArrowUp","mac+ArrowUp"],yn._translateEmpty,{args:[0,-$n],checker:fn}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],yn._translateEmpty,{args:[0,-Ln],checker:fn}],[["ArrowDown","mac+ArrowDown"],yn._translateEmpty,{args:[0,$n],checker:fn}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],yn._translateEmpty,{args:[0,Ln],checker:fn}]]))}static initialize(yn){j.AnnotationEditor.initialize(yn,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const fn=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(fn.getPropertyValue("--freetext-padding"))}static updateDefaultParams(yn,fn){switch(yn){case o.AnnotationEditorParamsType.FREETEXT_SIZE:Dt._defaultFontSize=fn;break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:Dt._defaultColor=fn;break}}updateParams(yn,fn){switch(yn){case o.AnnotationEditorParamsType.FREETEXT_SIZE:Wn(this,kt,au).call(this,fn);break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:Wn(this,kt,lu).call(this,fn);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,Dt._defaultFontSize],[o.AnnotationEditorParamsType.FREETEXT_COLOR,Dt._defaultColor||j.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,Kt(this,qt)],[o.AnnotationEditorParamsType.FREETEXT_COLOR,Kt(this,Ct)]]}_translateEmpty(yn,fn){this._uiManager.translateSelectedEditors(yn,fn,!0)}getInitialTranslation(){const yn=this.parentScale;return[-Dt._internalPadding*yn,-(Dt._internalPadding+Kt(this,qt))*yn]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(o.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",Kt(this,vt)),this.editorDiv.addEventListener("focus",Kt(this,rt)),this.editorDiv.addEventListener("blur",Kt(this,et)),this.editorDiv.addEventListener("input",Kt(this,dt)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Kt(this,Bt)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",Kt(this,vt)),this.editorDiv.removeEventListener("focus",Kt(this,rt)),this.editorDiv.removeEventListener("blur",Kt(this,et)),this.editorDiv.removeEventListener("input",Kt(this,dt)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(yn){this._focusEventsAllowed&&(super.focusin(yn),yn.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var yn;if(this.width){Wn(this,kt,Uo).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(yn=this._initialOptions)!=null&&yn.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const yn=Kt(this,Wt),fn=Jn(this,Wt,Wn(this,kt,cu).call(this).trimEnd());if(yn===fn)return;const $n=Ln=>{if(Jn(this,Wt,Ln),!Ln){this.remove();return}Wn(this,kt,$o).call(this),this._uiManager.rebuild(this),Wn(this,kt,Os).call(this)};this.addCommands({cmd:()=>{$n(fn)},undo:()=>{$n(yn)},mustExec:!1}),Wn(this,kt,Os).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(yn){this.enterInEditMode()}keydown(yn){yn.target===this.div&&yn.key==="Enter"&&(this.enterInEditMode(),yn.preventDefault())}editorDivKeydown(yn){Dt._keyboardManager.exec(this,yn)}editorDivFocus(yn){this.isEditing=!0}editorDivBlur(yn){this.isEditing=!1}editorDivInput(yn){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let yn,fn;this.width&&(yn=this.x,fn=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Kt(this,Bt)),this.enableEditing(),j.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Ln=>{var jn;return(jn=this.editorDiv)==null?void 0:jn.setAttribute("aria-label",Ln)}),j.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Ln=>{var jn;return(jn=this.editorDiv)==null?void 0:jn.setAttribute("default-content",Ln)}),this.editorDiv.contentEditable=!0;const{style:$n}=this.editorDiv;if($n.fontSize=`calc(${Kt(this,qt)}px * var(--scale-factor))`,$n.color=Kt(this,Ct),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Ln,jn]=this.parentDimensions;if(this.annotationElementId){const{position:On}=Kt(this,Ut);let[Vn,Rn]=this.getInitialTranslation();[Vn,Rn]=this.pageTranslationToScreen(Vn,Rn);const[Dn,Fn]=this.pageDimensions,[Tn,pn]=this.pageTranslation;let En,An;switch(this.rotation){case 0:En=yn+(On[0]-Tn)/Dn,An=fn+this.height-(On[1]-pn)/Fn;break;case 90:En=yn+(On[0]-Tn)/Dn,An=fn-(On[1]-pn)/Fn,[Vn,Rn]=[Rn,-Vn];break;case 180:En=yn-this.width+(On[0]-Tn)/Dn,An=fn-(On[1]-pn)/Fn,[Vn,Rn]=[-Vn,-Rn];break;case 270:En=yn+(On[0]-Tn-this.height*Fn)/Dn,An=fn+(On[1]-pn-this.width*Dn)/Fn,[Vn,Rn]=[-Rn,Vn];break}this.setAt(En*Ln,An*jn,Vn,Rn)}else this.setAt(yn*Ln,fn*jn,this.width*Ln,this.height*jn);Wn(this,kt,$o).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(yn,fn,$n){let Ln=null;if(yn instanceof _e.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:On,fontColor:Vn},rect:Rn,rotation:Dn,id:Fn},textContent:Tn,textPosition:pn,parent:{page:{pageNumber:En}}}=yn;if(!Tn||Tn.length===0)return null;Ln=yn={annotationType:o.AnnotationEditorType.FREETEXT,color:Array.from(Vn),fontSize:On,value:Tn.join(`
`),position:pn,pageIndex:En-1,rect:Rn,rotation:Dn,id:Fn,deleted:!1}}const jn=super.deserialize(yn,fn,$n);return Jn(jn,qt,yn.fontSize),Jn(jn,Ct,o.Util.makeHexColor(...yn.color)),Jn(jn,Wt,yn.value),jn.annotationElementId=yn.id||null,Jn(jn,Ut,Ln),jn}serialize(yn=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const fn=Dt._internalPadding*this.parentScale,$n=this.getRect(fn,fn),Ln=j.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:Kt(this,Ct)),jn={annotationType:o.AnnotationEditorType.FREETEXT,color:Ln,fontSize:Kt(this,qt),value:Kt(this,Wt),pageIndex:this.pageIndex,rect:$n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return yn?jn:this.annotationElementId&&!Wn(this,kt,uu).call(this,jn)?null:(jn.id=this.annotationElementId,jn)}};et=new WeakMap,rt=new WeakMap,dt=new WeakMap,vt=new WeakMap,Ct=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,qt=new WeakMap,Ut=new WeakMap,kt=new WeakSet,au=function(yn){const fn=Ln=>{this.editorDiv.style.fontSize=`calc(${Ln}px * var(--scale-factor))`,this.translate(0,-(Ln-Kt(this,qt))*this.parentScale),Jn(this,qt,Ln),Wn(this,kt,Os).call(this)},$n=Kt(this,qt);this.addCommands({cmd:()=>{fn(yn)},undo:()=>{fn($n)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},lu=function(yn){const fn=Kt(this,Ct);this.addCommands({cmd:()=>{Jn(this,Ct,this.editorDiv.style.color=yn)},undo:()=>{Jn(this,Ct,this.editorDiv.style.color=fn)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},cu=function(){const yn=this.editorDiv.getElementsByTagName("div");if(yn.length===0)return this.editorDiv.innerText;const fn=[];for(const $n of yn)fn.push($n.innerText.replace(/\r\n?|\n/,""));return fn.join(`
`)},Os=function(){const[yn,fn]=this.parentDimensions;let $n;if(this.isAttachedToDOM)$n=this.div.getBoundingClientRect();else{const{currentLayer:Ln,div:jn}=this,On=jn.style.display;jn.style.display="hidden",Ln.div.append(this.div),$n=jn.getBoundingClientRect(),jn.remove(),jn.style.display=On}this.rotation%180===this.parentRotation%180?(this.width=$n.width/yn,this.height=$n.height/fn):(this.width=$n.height/yn,this.height=$n.width/fn),this.fixAndSetPosition()},$o=function(){if(this.editorDiv.replaceChildren(),!!Kt(this,Wt))for(const yn of Kt(this,Wt).split(`
`)){const fn=document.createElement("div");fn.append(yn?document.createTextNode(yn):document.createElement("br")),this.editorDiv.append(fn)}},uu=function(yn){const{value:fn,fontSize:$n,color:Ln,rect:jn,pageIndex:On}=Kt(this,Ut);return yn.value!==fn||yn.fontSize!==$n||yn.rect.some((Vn,Rn)=>Math.abs(Vn-jn[Rn])>=1)||yn.color.some((Vn,Rn)=>Vn!==Ln[Rn])||yn.pageIndex!==On},Uo=function(yn=!1){if(!this.annotationElementId)return;if(Wn(this,kt,Os).call(this),!yn&&(this.width===0||this.height===0)){setTimeout(()=>Wn(this,kt,Uo).call(this,!0),0);return}const fn=Dt._internalPadding*this.parentScale;Kt(this,Ut).rect=this.getRect(fn,fn)},zr(Dt,"_freeTextDefaultContent",""),zr(Dt,"_internalPadding",0),zr(Dt,"_defaultColor",null),zr(Dt,"_defaultFontSize",10),zr(Dt,"_type","freetext");let tt=Dt;e.FreeTextEditor=tt},(s,e,i)=>{var An,wn,ds,hu,Gn,er,nr,ar,or,lr,zn,Hn,Pn,kn,Bn,Kn,sr,fr,ur,qn,gr,mr,du,no,Bo,zo,Rr,Or,jr,hr,Xn,Zn,vr,Wo,Lr,Nn,ir,_r,fu,Ho;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var o=i(1),a=i(6),j=i(3),_e=i(30),tt=i(31),et=i(32);const rt=1e3,dt=9,vt=new WeakSet;function Ct(Er){return{width:Er[2]-Er[0],height:Er[3]-Er[1]}}class Wt{static create(xn){switch(xn.data.annotationType){case o.AnnotationType.LINK:return new qt(xn);case o.AnnotationType.TEXT:return new Ut(xn);case o.AnnotationType.WIDGET:switch(xn.data.fieldType){case"Tx":return new Nt(xn);case"Btn":return xn.data.radioButton?new hn(xn):xn.data.checkBox?new dn(xn):new gn(xn);case"Ch":return new It(xn);case"Sig":return new un(xn)}return new kt(xn);case o.AnnotationType.POPUP:return new pt(xn);case o.AnnotationType.FREETEXT:return new mn(xn);case o.AnnotationType.LINE:return new Lt(xn);case o.AnnotationType.SQUARE:return new yn(xn);case o.AnnotationType.CIRCLE:return new fn(xn);case o.AnnotationType.POLYLINE:return new $n(xn);case o.AnnotationType.CARET:return new jn(xn);case o.AnnotationType.INK:return new On(xn);case o.AnnotationType.POLYGON:return new Ln(xn);case o.AnnotationType.HIGHLIGHT:return new Vn(xn);case o.AnnotationType.UNDERLINE:return new Rn(xn);case o.AnnotationType.SQUIGGLY:return new Dn(xn);case o.AnnotationType.STRIKEOUT:return new Fn(xn);case o.AnnotationType.STAMP:return new Tn(xn);case o.AnnotationType.FILEATTACHMENT:return new pn(xn);default:return new Bt(xn)}}}const bn=class bn{constructor(xn,{isRenderable:Sn=!1,ignoreBorder:Mn=!1,createQuadrilaterals:Qn=!1}={}){Yn(this,An,!1);this.isRenderable=Sn,this.data=xn.data,this.layer=xn.layer,this.linkService=xn.linkService,this.downloadManager=xn.downloadManager,this.imageResourcesPath=xn.imageResourcesPath,this.renderForms=xn.renderForms,this.svgFactory=xn.svgFactory,this.annotationStorage=xn.annotationStorage,this.enableScripting=xn.enableScripting,this.hasJSActions=xn.hasJSActions,this._fieldObjects=xn.fieldObjects,this.parent=xn.parent,Sn&&(this.container=this._createContainer(Mn)),Qn&&this._createQuadrilaterals()}static _hasPopupData({titleObj:xn,contentsObj:Sn,richText:Mn}){return!!(xn!=null&&xn.str||Sn!=null&&Sn.str||Mn!=null&&Mn.str)}get hasPopupData(){return bn._hasPopupData(this.data)}_createContainer(xn){const{data:Sn,parent:{page:Mn,viewport:Qn}}=this,rr=document.createElement("section");rr.setAttribute("data-annotation-id",Sn.id),this instanceof kt||(rr.tabIndex=rt),rr.style.zIndex=this.parent.zIndex++,this.data.popupRef&&rr.setAttribute("aria-haspopup","dialog"),Sn.noRotate&&rr.classList.add("norotate");const{pageWidth:cr,pageHeight:pr,pageX:br,pageY:Sr}=Qn.rawDims;if(!Sn.rect||this instanceof pt){const{rotation:kr}=Sn;return!Sn.hasOwnCanvas&&kr!==0&&this.setRotation(kr,rr),rr}const{width:yr,height:Nr}=Ct(Sn.rect),Ir=o.Util.normalizeRect([Sn.rect[0],Mn.view[3]-Sn.rect[1]+Mn.view[1],Sn.rect[2],Mn.view[3]-Sn.rect[3]+Mn.view[1]]);if(!xn&&Sn.borderStyle.width>0){rr.style.borderWidth=`${Sn.borderStyle.width}px`;const kr=Sn.borderStyle.horizontalCornerRadius,Vr=Sn.borderStyle.verticalCornerRadius;if(kr>0||Vr>0){const Ur=`calc(${kr}px * var(--scale-factor)) / calc(${Vr}px * var(--scale-factor))`;rr.style.borderRadius=Ur}else if(this instanceof hn){const Ur=`calc(${yr}px * var(--scale-factor)) / calc(${Nr}px * var(--scale-factor))`;rr.style.borderRadius=Ur}switch(Sn.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:rr.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:rr.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:rr.style.borderBottomStyle="solid";break}const $r=Sn.borderColor||null;$r?(Jn(this,An,!0),rr.style.borderColor=o.Util.makeHexColor($r[0]|0,$r[1]|0,$r[2]|0)):rr.style.borderWidth=0}rr.style.left=`${100*(Ir[0]-br)/cr}%`,rr.style.top=`${100*(Ir[1]-Sr)/pr}%`;const{rotation:wr}=Sn;return Sn.hasOwnCanvas||wr===0?(rr.style.width=`${100*yr/cr}%`,rr.style.height=`${100*Nr/pr}%`):this.setRotation(wr,rr),rr}setRotation(xn,Sn=this.container){if(!this.data.rect)return;const{pageWidth:Mn,pageHeight:Qn}=this.parent.viewport.rawDims,{width:rr,height:cr}=Ct(this.data.rect);let pr,br;xn%180===0?(pr=100*rr/Mn,br=100*cr/Qn):(pr=100*cr/Mn,br=100*rr/Qn),Sn.style.width=`${pr}%`,Sn.style.height=`${br}%`,Sn.setAttribute("data-main-rotation",(360-xn)%360)}get _commonActions(){const xn=(Sn,Mn,Qn)=>{const rr=Qn.detail[Sn],cr=rr[0],pr=rr.slice(1);Qn.target.style[Mn]=_e.ColorConverters[`${cr}_HTML`](pr),this.annotationStorage.setValue(this.data.id,{[Mn]:_e.ColorConverters[`${cr}_rgb`](pr)})};return(0,o.shadow)(this,"_commonActions",{display:Sn=>{const{display:Mn}=Sn.detail,Qn=Mn%2===1;this.container.style.visibility=Qn?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Qn,noPrint:Mn===1||Mn===2})},print:Sn=>{this.annotationStorage.setValue(this.data.id,{noPrint:!Sn.detail.print})},hidden:Sn=>{const{hidden:Mn}=Sn.detail;this.container.style.visibility=Mn?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Mn,noView:Mn})},focus:Sn=>{setTimeout(()=>Sn.target.focus({preventScroll:!1}),0)},userName:Sn=>{Sn.target.title=Sn.detail.userName},readonly:Sn=>{Sn.target.disabled=Sn.detail.readonly},required:Sn=>{this._setRequired(Sn.target,Sn.detail.required)},bgColor:Sn=>{xn("bgColor","backgroundColor",Sn)},fillColor:Sn=>{xn("fillColor","backgroundColor",Sn)},fgColor:Sn=>{xn("fgColor","color",Sn)},textColor:Sn=>{xn("textColor","color",Sn)},borderColor:Sn=>{xn("borderColor","borderColor",Sn)},strokeColor:Sn=>{xn("strokeColor","borderColor",Sn)},rotation:Sn=>{const Mn=Sn.detail.rotation;this.setRotation(Mn),this.annotationStorage.setValue(this.data.id,{rotation:Mn})}})}_dispatchEventFromSandbox(xn,Sn){const Mn=this._commonActions;for(const Qn of Object.keys(Sn.detail)){const rr=xn[Qn]||Mn[Qn];rr==null||rr(Sn)}}_setDefaultPropertiesFromJS(xn){if(!this.enableScripting)return;const Sn=this.annotationStorage.getRawValue(this.data.id);if(!Sn)return;const Mn=this._commonActions;for(const[Qn,rr]of Object.entries(Sn)){const cr=Mn[Qn];if(cr){const pr={detail:{[Qn]:rr},target:xn};cr(pr),delete Sn[Qn]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:xn}=this.data;if(!xn)return;const[Sn,Mn,Qn,rr]=this.data.rect;if(xn.length===1){const[,{x:Vr,y:$r},{x:Ur,y:Kr}]=xn[0];if(Qn===Vr&&rr===$r&&Sn===Ur&&Mn===Kr)return}const{style:cr}=this.container;let pr;if(Kt(this,An)){const{borderColor:Vr,borderWidth:$r}=cr;cr.borderWidth=0,pr=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Vr}" stroke-width="${$r}">`],this.container.classList.add("hasBorder")}const br=Qn-Sn,Sr=rr-Mn,{svgFactory:yr}=this,Nr=yr.createElement("svg");Nr.classList.add("quadrilateralsContainer"),Nr.setAttribute("width",0),Nr.setAttribute("height",0);const Ir=yr.createElement("defs");Nr.append(Ir);const wr=yr.createElement("clipPath"),kr=`clippath_${this.data.id}`;wr.setAttribute("id",kr),wr.setAttribute("clipPathUnits","objectBoundingBox"),Ir.append(wr);for(const[,{x:Vr,y:$r},{x:Ur,y:Kr}]of xn){const Hr=yr.createElement("rect"),Jr=(Ur-Sn)/br,es=(rr-$r)/Sr,ns=(Vr-Ur)/br,As=($r-Kr)/Sr;Hr.setAttribute("x",Jr),Hr.setAttribute("y",es),Hr.setAttribute("width",ns),Hr.setAttribute("height",As),wr.append(Hr),pr==null||pr.push(`<rect vector-effect="non-scaling-stroke" x="${Jr}" y="${es}" width="${ns}" height="${As}"/>`)}Kt(this,An)&&(pr.push("</g></svg>')"),cr.backgroundImage=pr.join("")),this.container.append(Nr),this.container.style.clipPath=`url(#${kr})`}_createPopup(){const{container:xn,data:Sn}=this;xn.setAttribute("aria-haspopup","dialog");const Mn=new pt({data:{color:Sn.color,titleObj:Sn.titleObj,modificationDate:Sn.modificationDate,contentsObj:Sn.contentsObj,richText:Sn.richText,parentRect:Sn.rect,borderStyle:0,id:`popup_${Sn.id}`,rotation:Sn.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Mn.render())}render(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(xn,Sn=null){const Mn=[];if(this._fieldObjects){const Qn=this._fieldObjects[xn];if(Qn)for(const{page:rr,id:cr,exportValues:pr}of Qn){if(rr===-1||cr===Sn)continue;const br=typeof pr=="string"?pr:null,Sr=document.querySelector(`[data-element-id="${cr}"]`);if(Sr&&!vt.has(Sr)){(0,o.warn)(`_getElementsByName - element not allowed: ${cr}`);continue}Mn.push({id:cr,exportValue:br,domElement:Sr})}return Mn}for(const Qn of document.getElementsByName(xn)){const{exportValue:rr}=Qn,cr=Qn.getAttribute("data-element-id");cr!==Sn&&vt.has(Qn)&&Mn.push({id:cr,exportValue:rr,domElement:Qn})}return Mn}show(){var xn;this.container&&(this.container.hidden=!1),(xn=this.popup)==null||xn.maybeShow()}hide(){var xn;this.container&&(this.container.hidden=!0),(xn=this.popup)==null||xn.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const xn=this.getElementsToTriggerPopup();if(Array.isArray(xn))for(const Sn of xn)Sn.classList.add("highlightArea");else xn.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:xn,data:{id:Sn}}=this;this.container.addEventListener("dblclick",()=>{var Mn;(Mn=this.linkService.eventBus)==null||Mn.dispatch("switchannotationeditormode",{source:this,mode:xn,editId:Sn})})}};An=new WeakMap;let Bt=bn;class qt extends Bt{constructor(Sn,Mn=null){super(Sn,{isRenderable:!0,ignoreBorder:!!(Mn!=null&&Mn.ignoreBorder),createQuadrilaterals:!0});Yn(this,wn);this.isTooltipOnly=Sn.data.isTooltipOnly}render(){const{data:Sn,linkService:Mn}=this,Qn=document.createElement("a");Qn.setAttribute("data-element-id",Sn.id);let rr=!1;return Sn.url?(Mn.addLinkAttributes(Qn,Sn.url,Sn.newWindow),rr=!0):Sn.action?(this._bindNamedAction(Qn,Sn.action),rr=!0):Sn.attachment?(this._bindAttachment(Qn,Sn.attachment),rr=!0):Sn.setOCGState?(Wn(this,wn,hu).call(this,Qn,Sn.setOCGState),rr=!0):Sn.dest?(this._bindLink(Qn,Sn.dest),rr=!0):(Sn.actions&&(Sn.actions.Action||Sn.actions["Mouse Up"]||Sn.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Qn,Sn),rr=!0),Sn.resetForm?(this._bindResetFormAction(Qn,Sn.resetForm),rr=!0):this.isTooltipOnly&&!rr&&(this._bindLink(Qn,""),rr=!0)),this.container.classList.add("linkAnnotation"),rr&&this.container.append(Qn),this.container}_bindLink(Sn,Mn){Sn.href=this.linkService.getDestinationHash(Mn),Sn.onclick=()=>(Mn&&this.linkService.goToDestination(Mn),!1),(Mn||Mn==="")&&Wn(this,wn,ds).call(this)}_bindNamedAction(Sn,Mn){Sn.href=this.linkService.getAnchorUrl(""),Sn.onclick=()=>(this.linkService.executeNamedAction(Mn),!1),Wn(this,wn,ds).call(this)}_bindAttachment(Sn,Mn){Sn.href=this.linkService.getAnchorUrl(""),Sn.onclick=()=>{var Qn;return(Qn=this.downloadManager)==null||Qn.openOrDownloadData(this.container,Mn.content,Mn.filename),!1},Wn(this,wn,ds).call(this)}_bindJSAction(Sn,Mn){Sn.href=this.linkService.getAnchorUrl("");const Qn=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const rr of Object.keys(Mn.actions)){const cr=Qn.get(rr);cr&&(Sn[cr]=()=>{var pr;return(pr=this.linkService.eventBus)==null||pr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Mn.id,name:rr}}),!1})}Sn.onclick||(Sn.onclick=()=>!1),Wn(this,wn,ds).call(this)}_bindResetFormAction(Sn,Mn){const Qn=Sn.onclick;if(Qn||(Sn.href=this.linkService.getAnchorUrl("")),Wn(this,wn,ds).call(this),!this._fieldObjects){(0,o.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Qn||(Sn.onclick=()=>!1);return}Sn.onclick=()=>{var Nr;Qn==null||Qn();const{fields:rr,refs:cr,include:pr}=Mn,br=[];if(rr.length!==0||cr.length!==0){const Ir=new Set(cr);for(const wr of rr){const kr=this._fieldObjects[wr]||[];for(const{id:Vr}of kr)Ir.add(Vr)}for(const wr of Object.values(this._fieldObjects))for(const kr of wr)Ir.has(kr.id)===pr&&br.push(kr)}else for(const Ir of Object.values(this._fieldObjects))br.push(...Ir);const Sr=this.annotationStorage,yr=[];for(const Ir of br){const{id:wr}=Ir;switch(yr.push(wr),Ir.type){case"text":{const Vr=Ir.defaultValue||"";Sr.setValue(wr,{value:Vr});break}case"checkbox":case"radiobutton":{const Vr=Ir.defaultValue===Ir.exportValues;Sr.setValue(wr,{value:Vr});break}case"combobox":case"listbox":{const Vr=Ir.defaultValue||"";Sr.setValue(wr,{value:Vr});break}default:continue}const kr=document.querySelector(`[data-element-id="${wr}"]`);if(kr){if(!vt.has(kr)){(0,o.warn)(`_bindResetFormAction - element not allowed: ${wr}`);continue}}else continue;kr.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Nr=this.linkService.eventBus)==null||Nr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:yr,name:"ResetForm"}})),!1}}}wn=new WeakSet,ds=function(){this.container.setAttribute("data-internal-link","")},hu=function(Sn,Mn){Sn.href=this.linkService.getAnchorUrl(""),Sn.onclick=()=>(this.linkService.executeSetOCGState(Mn),!1),Wn(this,wn,ds).call(this)};class Ut extends Bt{constructor(xn){super(xn,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const xn=document.createElement("img");return xn.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",xn.alt="[{{type}} Annotation]",xn.dataset.l10nId="text_annotation_type",xn.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(xn),this.container}}class kt extends Bt{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(xn){var Sn;this.data.hasOwnCanvas&&(((Sn=xn.previousSibling)==null?void 0:Sn.nodeName)==="CANVAS"&&(xn.previousSibling.hidden=!0),xn.hidden=!1)}_getKeyModifier(xn){const{isWin:Sn,isMac:Mn}=o.FeatureTest.platform;return Sn&&xn.ctrlKey||Mn&&xn.metaKey}_setEventListener(xn,Sn,Mn,Qn,rr){Mn.includes("mouse")?xn.addEventListener(Mn,cr=>{var pr;(pr=this.linkService.eventBus)==null||pr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Qn,value:rr(cr),shift:cr.shiftKey,modifier:this._getKeyModifier(cr)}})}):xn.addEventListener(Mn,cr=>{var pr;if(Mn==="blur"){if(!Sn.focused||!cr.relatedTarget)return;Sn.focused=!1}else if(Mn==="focus"){if(Sn.focused)return;Sn.focused=!0}rr&&((pr=this.linkService.eventBus)==null||pr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Qn,value:rr(cr)}}))})}_setEventListeners(xn,Sn,Mn,Qn){var rr,cr,pr;for(const[br,Sr]of Mn)(Sr==="Action"||(rr=this.data.actions)!=null&&rr[Sr])&&((Sr==="Focus"||Sr==="Blur")&&(Sn||(Sn={focused:!1})),this._setEventListener(xn,Sn,br,Sr,Qn),Sr==="Focus"&&!((cr=this.data.actions)!=null&&cr.Blur)?this._setEventListener(xn,Sn,"blur","Blur",null):Sr==="Blur"&&!((pr=this.data.actions)!=null&&pr.Focus)&&this._setEventListener(xn,Sn,"focus","Focus",null))}_setBackgroundColor(xn){const Sn=this.data.backgroundColor||null;xn.style.backgroundColor=Sn===null?"transparent":o.Util.makeHexColor(Sn[0],Sn[1],Sn[2])}_setTextStyle(xn){const Sn=["left","center","right"],{fontColor:Mn}=this.data.defaultAppearanceData,Qn=this.data.defaultAppearanceData.fontSize||dt,rr=xn.style;let cr;const pr=2,br=Sr=>Math.round(10*Sr)/10;if(this.data.multiLine){const Sr=Math.abs(this.data.rect[3]-this.data.rect[1]-pr),yr=Math.round(Sr/(o.LINE_FACTOR*Qn))||1,Nr=Sr/yr;cr=Math.min(Qn,br(Nr/o.LINE_FACTOR))}else{const Sr=Math.abs(this.data.rect[3]-this.data.rect[1]-pr);cr=Math.min(Qn,br(Sr/o.LINE_FACTOR))}rr.fontSize=`calc(${cr}px * var(--scale-factor))`,rr.color=o.Util.makeHexColor(Mn[0],Mn[1],Mn[2]),this.data.textAlignment!==null&&(rr.textAlign=Sn[this.data.textAlignment])}_setRequired(xn,Sn){Sn?xn.setAttribute("required",!0):xn.removeAttribute("required"),xn.setAttribute("aria-required",Sn)}}class Nt extends kt{constructor(xn){const Sn=xn.renderForms||!xn.data.hasAppearance&&!!xn.data.fieldValue;super(xn,{isRenderable:Sn})}setPropertyOnSiblings(xn,Sn,Mn,Qn){const rr=this.annotationStorage;for(const cr of this._getElementsByName(xn.name,xn.id))cr.domElement&&(cr.domElement[Sn]=Mn),rr.setValue(cr.id,{[Qn]:Mn})}render(){var Qn,rr;const xn=this.annotationStorage,Sn=this.data.id;this.container.classList.add("textWidgetAnnotation");let Mn=null;if(this.renderForms){const cr=xn.getValue(Sn,{value:this.data.fieldValue});let pr=cr.value||"";const br=xn.getValue(Sn,{charLimit:this.data.maxLen}).charLimit;br&&pr.length>br&&(pr=pr.slice(0,br));let Sr=cr.formattedValue||((Qn=this.data.textContent)==null?void 0:Qn.join(`
`))||null;Sr&&this.data.comb&&(Sr=Sr.replaceAll(/\s+/g,""));const yr={userValue:pr,formattedValue:Sr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Mn=document.createElement("textarea"),Mn.textContent=Sr??pr,this.data.doNotScroll&&(Mn.style.overflowY="hidden")):(Mn=document.createElement("input"),Mn.type="text",Mn.setAttribute("value",Sr??pr),this.data.doNotScroll&&(Mn.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Mn.hidden=!0),vt.add(Mn),Mn.setAttribute("data-element-id",Sn),Mn.disabled=this.data.readOnly,Mn.name=this.data.fieldName,Mn.tabIndex=rt,this._setRequired(Mn,this.data.required),br&&(Mn.maxLength=br),Mn.addEventListener("input",Ir=>{xn.setValue(Sn,{value:Ir.target.value}),this.setPropertyOnSiblings(Mn,"value",Ir.target.value,"value"),yr.formattedValue=null}),Mn.addEventListener("resetform",Ir=>{const wr=this.data.defaultFieldValue??"";Mn.value=yr.userValue=wr,yr.formattedValue=null});let Nr=Ir=>{const{formattedValue:wr}=yr;wr!=null&&(Ir.target.value=wr),Ir.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Mn.addEventListener("focus",wr=>{if(yr.focused)return;const{target:kr}=wr;yr.userValue&&(kr.value=yr.userValue),yr.lastCommittedValue=kr.value,yr.commitKey=1,yr.focused=!0}),Mn.addEventListener("updatefromsandbox",wr=>{this.showElementAndHideCanvas(wr.target);const kr={value(Vr){yr.userValue=Vr.detail.value??"",xn.setValue(Sn,{value:yr.userValue.toString()}),Vr.target.value=yr.userValue},formattedValue(Vr){const{formattedValue:$r}=Vr.detail;yr.formattedValue=$r,$r!=null&&Vr.target!==document.activeElement&&(Vr.target.value=$r),xn.setValue(Sn,{formattedValue:$r})},selRange(Vr){Vr.target.setSelectionRange(...Vr.detail.selRange)},charLimit:Vr=>{var Hr;const{charLimit:$r}=Vr.detail,{target:Ur}=Vr;if($r===0){Ur.removeAttribute("maxLength");return}Ur.setAttribute("maxLength",$r);let Kr=yr.userValue;!Kr||Kr.length<=$r||(Kr=Kr.slice(0,$r),Ur.value=yr.userValue=Kr,xn.setValue(Sn,{value:Kr}),(Hr=this.linkService.eventBus)==null||Hr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Sn,name:"Keystroke",value:Kr,willCommit:!0,commitKey:1,selStart:Ur.selectionStart,selEnd:Ur.selectionEnd}}))}};this._dispatchEventFromSandbox(kr,wr)}),Mn.addEventListener("keydown",wr=>{var $r;yr.commitKey=1;let kr=-1;if(wr.key==="Escape"?kr=0:wr.key==="Enter"&&!this.data.multiLine?kr=2:wr.key==="Tab"&&(yr.commitKey=3),kr===-1)return;const{value:Vr}=wr.target;yr.lastCommittedValue!==Vr&&(yr.lastCommittedValue=Vr,yr.userValue=Vr,($r=this.linkService.eventBus)==null||$r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Sn,name:"Keystroke",value:Vr,willCommit:!0,commitKey:kr,selStart:wr.target.selectionStart,selEnd:wr.target.selectionEnd}}))});const Ir=Nr;Nr=null,Mn.addEventListener("blur",wr=>{var Vr;if(!yr.focused||!wr.relatedTarget)return;yr.focused=!1;const{value:kr}=wr.target;yr.userValue=kr,yr.lastCommittedValue!==kr&&((Vr=this.linkService.eventBus)==null||Vr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Sn,name:"Keystroke",value:kr,willCommit:!0,commitKey:yr.commitKey,selStart:wr.target.selectionStart,selEnd:wr.target.selectionEnd}})),Ir(wr)}),(rr=this.data.actions)!=null&&rr.Keystroke&&Mn.addEventListener("beforeinput",wr=>{var es;yr.lastCommittedValue=null;const{data:kr,target:Vr}=wr,{value:$r,selectionStart:Ur,selectionEnd:Kr}=Vr;let Hr=Ur,Jr=Kr;switch(wr.inputType){case"deleteWordBackward":{const ns=$r.substring(0,Ur).match(/\w*[^\w]*$/);ns&&(Hr-=ns[0].length);break}case"deleteWordForward":{const ns=$r.substring(Ur).match(/^[^\w]*\w*/);ns&&(Jr+=ns[0].length);break}case"deleteContentBackward":Ur===Kr&&(Hr-=1);break;case"deleteContentForward":Ur===Kr&&(Jr+=1);break}wr.preventDefault(),(es=this.linkService.eventBus)==null||es.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Sn,name:"Keystroke",value:$r,change:kr||"",willCommit:!1,selStart:Hr,selEnd:Jr}})}),this._setEventListeners(Mn,yr,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wr=>wr.target.value)}if(Nr&&Mn.addEventListener("blur",Nr),this.data.comb){const wr=(this.data.rect[2]-this.data.rect[0])/br;Mn.classList.add("comb"),Mn.style.letterSpacing=`calc(${wr}px * var(--scale-factor) - 1ch)`}}else Mn=document.createElement("div"),Mn.textContent=this.data.fieldValue,Mn.style.verticalAlign="middle",Mn.style.display="table-cell";return this._setTextStyle(Mn),this._setBackgroundColor(Mn),this._setDefaultPropertiesFromJS(Mn),this.container.append(Mn),this.container}}class un extends kt{constructor(xn){super(xn,{isRenderable:!!xn.data.hasOwnCanvas})}}class dn extends kt{constructor(xn){super(xn,{isRenderable:xn.renderForms})}render(){const xn=this.annotationStorage,Sn=this.data,Mn=Sn.id;let Qn=xn.getValue(Mn,{value:Sn.exportValue===Sn.fieldValue}).value;typeof Qn=="string"&&(Qn=Qn!=="Off",xn.setValue(Mn,{value:Qn})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const rr=document.createElement("input");return vt.add(rr),rr.setAttribute("data-element-id",Mn),rr.disabled=Sn.readOnly,this._setRequired(rr,this.data.required),rr.type="checkbox",rr.name=Sn.fieldName,Qn&&rr.setAttribute("checked",!0),rr.setAttribute("exportValue",Sn.exportValue),rr.tabIndex=rt,rr.addEventListener("change",cr=>{const{name:pr,checked:br}=cr.target;for(const Sr of this._getElementsByName(pr,Mn)){const yr=br&&Sr.exportValue===Sn.exportValue;Sr.domElement&&(Sr.domElement.checked=yr),xn.setValue(Sr.id,{value:yr})}xn.setValue(Mn,{value:br})}),rr.addEventListener("resetform",cr=>{const pr=Sn.defaultFieldValue||"Off";cr.target.checked=pr===Sn.exportValue}),this.enableScripting&&this.hasJSActions&&(rr.addEventListener("updatefromsandbox",cr=>{const pr={value(br){br.target.checked=br.detail.value!=="Off",xn.setValue(Mn,{value:br.target.checked})}};this._dispatchEventFromSandbox(pr,cr)}),this._setEventListeners(rr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],cr=>cr.target.checked)),this._setBackgroundColor(rr),this._setDefaultPropertiesFromJS(rr),this.container.append(rr),this.container}}class hn extends kt{constructor(xn){super(xn,{isRenderable:xn.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const xn=this.annotationStorage,Sn=this.data,Mn=Sn.id;let Qn=xn.getValue(Mn,{value:Sn.fieldValue===Sn.buttonValue}).value;typeof Qn=="string"&&(Qn=Qn!==Sn.buttonValue,xn.setValue(Mn,{value:Qn}));const rr=document.createElement("input");if(vt.add(rr),rr.setAttribute("data-element-id",Mn),rr.disabled=Sn.readOnly,this._setRequired(rr,this.data.required),rr.type="radio",rr.name=Sn.fieldName,Qn&&rr.setAttribute("checked",!0),rr.tabIndex=rt,rr.addEventListener("change",cr=>{const{name:pr,checked:br}=cr.target;for(const Sr of this._getElementsByName(pr,Mn))xn.setValue(Sr.id,{value:!1});xn.setValue(Mn,{value:br})}),rr.addEventListener("resetform",cr=>{const pr=Sn.defaultFieldValue;cr.target.checked=pr!=null&&pr===Sn.buttonValue}),this.enableScripting&&this.hasJSActions){const cr=Sn.buttonValue;rr.addEventListener("updatefromsandbox",pr=>{const br={value:Sr=>{const yr=cr===Sr.detail.value;for(const Nr of this._getElementsByName(Sr.target.name)){const Ir=yr&&Nr.id===Mn;Nr.domElement&&(Nr.domElement.checked=Ir),xn.setValue(Nr.id,{value:Ir})}}};this._dispatchEventFromSandbox(br,pr)}),this._setEventListeners(rr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],pr=>pr.target.checked)}return this._setBackgroundColor(rr),this._setDefaultPropertiesFromJS(rr),this.container.append(rr),this.container}}class gn extends qt{constructor(xn){super(xn,{ignoreBorder:xn.data.hasAppearance})}render(){const xn=super.render();xn.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(xn.title=this.data.alternativeText);const Sn=xn.lastChild;return this.enableScripting&&this.hasJSActions&&Sn&&(this._setDefaultPropertiesFromJS(Sn),Sn.addEventListener("updatefromsandbox",Mn=>{this._dispatchEventFromSandbox({},Mn)})),xn}}class It extends kt{constructor(xn){super(xn,{isRenderable:xn.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const xn=this.annotationStorage,Sn=this.data.id,Mn=xn.getValue(Sn,{value:this.data.fieldValue}),Qn=document.createElement("select");vt.add(Qn),Qn.setAttribute("data-element-id",Sn),Qn.disabled=this.data.readOnly,this._setRequired(Qn,this.data.required),Qn.name=this.data.fieldName,Qn.tabIndex=rt;let rr=this.data.combo&&this.data.options.length>0;this.data.combo||(Qn.size=this.data.options.length,this.data.multiSelect&&(Qn.multiple=!0)),Qn.addEventListener("resetform",yr=>{const Nr=this.data.defaultFieldValue;for(const Ir of Qn.options)Ir.selected=Ir.value===Nr});for(const yr of this.data.options){const Nr=document.createElement("option");Nr.textContent=yr.displayValue,Nr.value=yr.exportValue,Mn.value.includes(yr.exportValue)&&(Nr.setAttribute("selected",!0),rr=!1),Qn.append(Nr)}let cr=null;if(rr){const yr=document.createElement("option");yr.value=" ",yr.setAttribute("hidden",!0),yr.setAttribute("selected",!0),Qn.prepend(yr),cr=()=>{yr.remove(),Qn.removeEventListener("input",cr),cr=null},Qn.addEventListener("input",cr)}const pr=yr=>{const Nr=yr?"value":"textContent",{options:Ir,multiple:wr}=Qn;return wr?Array.prototype.filter.call(Ir,kr=>kr.selected).map(kr=>kr[Nr]):Ir.selectedIndex===-1?null:Ir[Ir.selectedIndex][Nr]};let br=pr(!1);const Sr=yr=>{const Nr=yr.target.options;return Array.prototype.map.call(Nr,Ir=>({displayValue:Ir.textContent,exportValue:Ir.value}))};return this.enableScripting&&this.hasJSActions?(Qn.addEventListener("updatefromsandbox",yr=>{const Nr={value(Ir){cr==null||cr();const wr=Ir.detail.value,kr=new Set(Array.isArray(wr)?wr:[wr]);for(const Vr of Qn.options)Vr.selected=kr.has(Vr.value);xn.setValue(Sn,{value:pr(!0)}),br=pr(!1)},multipleSelection(Ir){Qn.multiple=!0},remove(Ir){const wr=Qn.options,kr=Ir.detail.remove;wr[kr].selected=!1,Qn.remove(kr),wr.length>0&&Array.prototype.findIndex.call(wr,$r=>$r.selected)===-1&&(wr[0].selected=!0),xn.setValue(Sn,{value:pr(!0),items:Sr(Ir)}),br=pr(!1)},clear(Ir){for(;Qn.length!==0;)Qn.remove(0);xn.setValue(Sn,{value:null,items:[]}),br=pr(!1)},insert(Ir){const{index:wr,displayValue:kr,exportValue:Vr}=Ir.detail.insert,$r=Qn.children[wr],Ur=document.createElement("option");Ur.textContent=kr,Ur.value=Vr,$r?$r.before(Ur):Qn.append(Ur),xn.setValue(Sn,{value:pr(!0),items:Sr(Ir)}),br=pr(!1)},items(Ir){const{items:wr}=Ir.detail;for(;Qn.length!==0;)Qn.remove(0);for(const kr of wr){const{displayValue:Vr,exportValue:$r}=kr,Ur=document.createElement("option");Ur.textContent=Vr,Ur.value=$r,Qn.append(Ur)}Qn.options.length>0&&(Qn.options[0].selected=!0),xn.setValue(Sn,{value:pr(!0),items:Sr(Ir)}),br=pr(!1)},indices(Ir){const wr=new Set(Ir.detail.indices);for(const kr of Ir.target.options)kr.selected=wr.has(kr.index);xn.setValue(Sn,{value:pr(!0)}),br=pr(!1)},editable(Ir){Ir.target.disabled=!Ir.detail.editable}};this._dispatchEventFromSandbox(Nr,yr)}),Qn.addEventListener("input",yr=>{var Ir;const Nr=pr(!0);xn.setValue(Sn,{value:Nr}),yr.preventDefault(),(Ir=this.linkService.eventBus)==null||Ir.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Sn,name:"Keystroke",value:br,changeEx:Nr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Qn,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],yr=>yr.target.value)):Qn.addEventListener("input",function(yr){xn.setValue(Sn,{value:pr(!0)})}),this.data.combo&&this._setTextStyle(Qn),this._setBackgroundColor(Qn),this._setDefaultPropertiesFromJS(Qn),this.container.append(Qn),this.container}}class pt extends Bt{constructor(xn){const{data:Sn,elements:Mn}=xn;super(xn,{isRenderable:Bt._hasPopupData(Sn)}),this.elements=Mn}render(){this.container.classList.add("popupAnnotation");const xn=new Dt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),Sn=[];for(const Mn of this.elements)Mn.popup=xn,Sn.push(Mn.data.id),Mn.addHighlightArea();return this.container.setAttribute("aria-controls",Sn.map(Mn=>`${o.AnnotationPrefix}${Mn}`).join(",")),this.container}}class Dt{constructor({container:xn,color:Sn,elements:Mn,titleObj:Qn,modificationDate:rr,contentsObj:cr,richText:pr,parent:br,rect:Sr,parentRect:yr,open:Nr}){Yn(this,mr);Yn(this,Gn,null);Yn(this,er,Wn(this,mr,du).bind(this));Yn(this,nr,Wn(this,mr,zo).bind(this));Yn(this,ar,Wn(this,mr,Bo).bind(this));Yn(this,or,Wn(this,mr,no).bind(this));Yn(this,lr,null);Yn(this,zn,null);Yn(this,Hn,null);Yn(this,Pn,null);Yn(this,kn,null);Yn(this,Bn,null);Yn(this,Kn,!1);Yn(this,sr,null);Yn(this,fr,null);Yn(this,ur,null);Yn(this,qn,null);Yn(this,gr,!1);var wr;Jn(this,zn,xn),Jn(this,qn,Qn),Jn(this,Hn,cr),Jn(this,ur,pr),Jn(this,kn,br),Jn(this,lr,Sn),Jn(this,fr,Sr),Jn(this,Bn,yr),Jn(this,Pn,Mn);const Ir=a.PDFDateString.toDateObject(rr);Ir&&Jn(this,Gn,br.l10n.get("annotation_date_string",{date:Ir.toLocaleDateString(),time:Ir.toLocaleTimeString()})),this.trigger=Mn.flatMap(kr=>kr.getElementsToTriggerPopup());for(const kr of this.trigger)kr.addEventListener("click",Kt(this,or)),kr.addEventListener("mouseenter",Kt(this,ar)),kr.addEventListener("mouseleave",Kt(this,nr)),kr.classList.add("popupTriggerArea");for(const kr of Mn)(wr=kr.container)==null||wr.addEventListener("keydown",Kt(this,er));Kt(this,zn).hidden=!0,Nr&&Wn(this,mr,no).call(this)}render(){if(Kt(this,sr))return;const{page:{view:xn},viewport:{rawDims:{pageWidth:Sn,pageHeight:Mn,pageX:Qn,pageY:rr}}}=Kt(this,kn),cr=Jn(this,sr,document.createElement("div"));if(cr.className="popup",Kt(this,lr)){const Hr=cr.style.outlineColor=o.Util.makeHexColor(...Kt(this,lr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?cr.style.backgroundColor=`color-mix(in srgb, ${Hr} 30%, white)`:cr.style.backgroundColor=o.Util.makeHexColor(...Kt(this,lr).map(es=>Math.floor(.7*(255-es)+es)))}const pr=document.createElement("span");pr.className="header";const br=document.createElement("h1");if(pr.append(br),{dir:br.dir,str:br.textContent}=Kt(this,qn),cr.append(pr),Kt(this,Gn)){const Hr=document.createElement("span");Hr.classList.add("popupDate"),Kt(this,Gn).then(Jr=>{Hr.textContent=Jr}),pr.append(Hr)}const Sr=Kt(this,Hn),yr=Kt(this,ur);if(yr!=null&&yr.str&&(!(Sr!=null&&Sr.str)||Sr.str===yr.str))et.XfaLayer.render({xfaHtml:yr.html,intent:"richText",div:cr}),cr.lastChild.classList.add("richText","popupContent");else{const Hr=this._formatContents(Sr);cr.append(Hr)}let Nr=!!Kt(this,Bn),Ir=Nr?Kt(this,Bn):Kt(this,fr);for(const Hr of Kt(this,Pn))if(!Ir||o.Util.intersect(Hr.data.rect,Ir)!==null){Ir=Hr.data.rect,Nr=!0;break}const wr=o.Util.normalizeRect([Ir[0],xn[3]-Ir[1]+xn[1],Ir[2],xn[3]-Ir[3]+xn[1]]),Vr=Nr?Ir[2]-Ir[0]+5:0,$r=wr[0]+Vr,Ur=wr[1],{style:Kr}=Kt(this,zn);Kr.left=`${100*($r-Qn)/Sn}%`,Kr.top=`${100*(Ur-rr)/Mn}%`,Kt(this,zn).append(cr)}_formatContents({str:xn,dir:Sn}){const Mn=document.createElement("p");Mn.classList.add("popupContent"),Mn.dir=Sn;const Qn=xn.split(/(?:\r\n?|\n)/);for(let rr=0,cr=Qn.length;rr<cr;++rr){const pr=Qn[rr];Mn.append(document.createTextNode(pr)),rr<cr-1&&Mn.append(document.createElement("br"))}return Mn}forceHide(){Jn(this,gr,this.isVisible),Kt(this,gr)&&(Kt(this,zn).hidden=!0)}maybeShow(){Kt(this,gr)&&(Jn(this,gr,!1),Kt(this,zn).hidden=!1)}get isVisible(){return Kt(this,zn).hidden===!1}}Gn=new WeakMap,er=new WeakMap,nr=new WeakMap,ar=new WeakMap,or=new WeakMap,lr=new WeakMap,zn=new WeakMap,Hn=new WeakMap,Pn=new WeakMap,kn=new WeakMap,Bn=new WeakMap,Kn=new WeakMap,sr=new WeakMap,fr=new WeakMap,ur=new WeakMap,qn=new WeakMap,gr=new WeakMap,mr=new WeakSet,du=function(xn){xn.altKey||xn.shiftKey||xn.ctrlKey||xn.metaKey||(xn.key==="Enter"||xn.key==="Escape"&&Kt(this,Kn))&&Wn(this,mr,no).call(this)},no=function(){Jn(this,Kn,!Kt(this,Kn)),Kt(this,Kn)?(Wn(this,mr,Bo).call(this),Kt(this,zn).addEventListener("click",Kt(this,or)),Kt(this,zn).addEventListener("keydown",Kt(this,er))):(Wn(this,mr,zo).call(this),Kt(this,zn).removeEventListener("click",Kt(this,or)),Kt(this,zn).removeEventListener("keydown",Kt(this,er)))},Bo=function(){Kt(this,sr)||this.render(),this.isVisible?Kt(this,Kn)&&Kt(this,zn).classList.add("focused"):(Kt(this,zn).hidden=!1,Kt(this,zn).style.zIndex=parseInt(Kt(this,zn).style.zIndex)+1e3)},zo=function(){Kt(this,zn).classList.remove("focused"),!(Kt(this,Kn)||!this.isVisible)&&(Kt(this,zn).hidden=!0,Kt(this,zn).style.zIndex=parseInt(Kt(this,zn).style.zIndex)-1e3)};class mn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0}),this.textContent=xn.data.textContent,this.textPosition=xn.data.textPosition,this.annotationEditorType=o.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const xn=document.createElement("div");xn.classList.add("annotationTextContent"),xn.setAttribute("role","comment");for(const Sn of this.textContent){const Mn=document.createElement("span");Mn.textContent=Sn,xn.append(Mn)}this.container.append(xn)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=mn;class Lt extends Bt{constructor(Sn){super(Sn,{isRenderable:!0,ignoreBorder:!0});Yn(this,Rr,null)}render(){this.container.classList.add("lineAnnotation");const Sn=this.data,{width:Mn,height:Qn}=Ct(Sn.rect),rr=this.svgFactory.create(Mn,Qn,!0),cr=Jn(this,Rr,this.svgFactory.createElement("svg:line"));return cr.setAttribute("x1",Sn.rect[2]-Sn.lineCoordinates[0]),cr.setAttribute("y1",Sn.rect[3]-Sn.lineCoordinates[1]),cr.setAttribute("x2",Sn.rect[2]-Sn.lineCoordinates[2]),cr.setAttribute("y2",Sn.rect[3]-Sn.lineCoordinates[3]),cr.setAttribute("stroke-width",Sn.borderStyle.width||1),cr.setAttribute("stroke","transparent"),cr.setAttribute("fill","transparent"),rr.append(cr),this.container.append(rr),!Sn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Kt(this,Rr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rr=new WeakMap;class yn extends Bt{constructor(Sn){super(Sn,{isRenderable:!0,ignoreBorder:!0});Yn(this,Or,null)}render(){this.container.classList.add("squareAnnotation");const Sn=this.data,{width:Mn,height:Qn}=Ct(Sn.rect),rr=this.svgFactory.create(Mn,Qn,!0),cr=Sn.borderStyle.width,pr=Jn(this,Or,this.svgFactory.createElement("svg:rect"));return pr.setAttribute("x",cr/2),pr.setAttribute("y",cr/2),pr.setAttribute("width",Mn-cr),pr.setAttribute("height",Qn-cr),pr.setAttribute("stroke-width",cr||1),pr.setAttribute("stroke","transparent"),pr.setAttribute("fill","transparent"),rr.append(pr),this.container.append(rr),!Sn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Kt(this,Or)}addHighlightArea(){this.container.classList.add("highlightArea")}}Or=new WeakMap;class fn extends Bt{constructor(Sn){super(Sn,{isRenderable:!0,ignoreBorder:!0});Yn(this,jr,null)}render(){this.container.classList.add("circleAnnotation");const Sn=this.data,{width:Mn,height:Qn}=Ct(Sn.rect),rr=this.svgFactory.create(Mn,Qn,!0),cr=Sn.borderStyle.width,pr=Jn(this,jr,this.svgFactory.createElement("svg:ellipse"));return pr.setAttribute("cx",Mn/2),pr.setAttribute("cy",Qn/2),pr.setAttribute("rx",Mn/2-cr/2),pr.setAttribute("ry",Qn/2-cr/2),pr.setAttribute("stroke-width",cr||1),pr.setAttribute("stroke","transparent"),pr.setAttribute("fill","transparent"),rr.append(pr),this.container.append(rr),!Sn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Kt(this,jr)}addHighlightArea(){this.container.classList.add("highlightArea")}}jr=new WeakMap;class $n extends Bt{constructor(Sn){super(Sn,{isRenderable:!0,ignoreBorder:!0});Yn(this,hr,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const Sn=this.data,{width:Mn,height:Qn}=Ct(Sn.rect),rr=this.svgFactory.create(Mn,Qn,!0);let cr=[];for(const br of Sn.vertices){const Sr=br.x-Sn.rect[0],yr=Sn.rect[3]-br.y;cr.push(Sr+","+yr)}cr=cr.join(" ");const pr=Jn(this,hr,this.svgFactory.createElement(this.svgElementName));return pr.setAttribute("points",cr),pr.setAttribute("stroke-width",Sn.borderStyle.width||1),pr.setAttribute("stroke","transparent"),pr.setAttribute("fill","transparent"),rr.append(pr),this.container.append(rr),!Sn.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Kt(this,hr)}addHighlightArea(){this.container.classList.add("highlightArea")}}hr=new WeakMap;class Ln extends $n{constructor(xn){super(xn),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class jn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class On extends Bt{constructor(Sn){super(Sn,{isRenderable:!0,ignoreBorder:!0});Yn(this,Xn,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=o.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const Sn=this.data,{width:Mn,height:Qn}=Ct(Sn.rect),rr=this.svgFactory.create(Mn,Qn,!0);for(const cr of Sn.inkLists){let pr=[];for(const Sr of cr){const yr=Sr.x-Sn.rect[0],Nr=Sn.rect[3]-Sr.y;pr.push(`${yr},${Nr}`)}pr=pr.join(" ");const br=this.svgFactory.createElement(this.svgElementName);Kt(this,Xn).push(br),br.setAttribute("points",pr),br.setAttribute("stroke-width",Sn.borderStyle.width||1),br.setAttribute("stroke","transparent"),br.setAttribute("fill","transparent"),!Sn.popupRef&&this.hasPopupData&&this._createPopup(),rr.append(br)}return this.container.append(rr),this.container}getElementsToTriggerPopup(){return Kt(this,Xn)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xn=new WeakMap,e.InkAnnotationElement=On;class Vn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Rn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Dn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Fn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Tn extends Bt{constructor(xn){super(xn,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=Tn;class pn extends Bt{constructor(Sn){var rr;super(Sn,{isRenderable:!0});Yn(this,vr);Yn(this,Zn,null);const{filename:Mn,content:Qn}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(Mn,!0),this.content=Qn,(rr=this.linkService.eventBus)==null||rr.dispatch("fileattachmentannotation",{source:this,filename:Mn,content:Qn})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:Sn,data:Mn}=this;let Qn;Mn.hasAppearance||Mn.fillAlpha===0?Qn=document.createElement("div"):(Qn=document.createElement("img"),Qn.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Mn.name)?"paperclip":"pushpin"}.svg`,Mn.fillAlpha&&Mn.fillAlpha<1&&(Qn.style=`filter: opacity(${Math.round(Mn.fillAlpha*100)}%);`)),Qn.addEventListener("dblclick",Wn(this,vr,Wo).bind(this)),Jn(this,Zn,Qn);const{isMac:rr}=o.FeatureTest.platform;return Sn.addEventListener("keydown",cr=>{cr.key==="Enter"&&(rr?cr.metaKey:cr.ctrlKey)&&Wn(this,vr,Wo).call(this)}),!Mn.popupRef&&this.hasPopupData?this._createPopup():Qn.classList.add("popupTriggerArea"),Sn.append(Qn),Sn}getElementsToTriggerPopup(){return Kt(this,Zn)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zn=new WeakMap,vr=new WeakSet,Wo=function(){var Sn;(Sn=this.downloadManager)==null||Sn.openOrDownloadData(this.container,this.content,this.filename)};class En{constructor({div:xn,accessibilityManager:Sn,annotationCanvasMap:Mn,l10n:Qn,page:rr,viewport:cr}){Yn(this,_r);Yn(this,Lr,null);Yn(this,Nn,null);Yn(this,ir,new Map);this.div=xn,Jn(this,Lr,Sn),Jn(this,Nn,Mn),this.l10n=Qn,this.page=rr,this.viewport=cr,this.zIndex=0,this.l10n||(this.l10n=tt.NullL10n)}async render(xn){const{annotations:Sn}=xn,Mn=this.div;(0,a.setLayerDimensions)(Mn,this.viewport);const Qn=new Map,rr={data:null,layer:Mn,linkService:xn.linkService,downloadManager:xn.downloadManager,imageResourcesPath:xn.imageResourcesPath||"",renderForms:xn.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:xn.annotationStorage||new j.AnnotationStorage,enableScripting:xn.enableScripting===!0,hasJSActions:xn.hasJSActions,fieldObjects:xn.fieldObjects,parent:this,elements:null};for(const cr of Sn){if(cr.noHTML)continue;const pr=cr.annotationType===o.AnnotationType.POPUP;if(pr){const yr=Qn.get(cr.id);if(!yr)continue;rr.elements=yr}else{const{width:yr,height:Nr}=Ct(cr.rect);if(yr<=0||Nr<=0)continue}rr.data=cr;const br=Wt.create(rr);if(!br.isRenderable)continue;if(!pr&&cr.popupRef){const yr=Qn.get(cr.popupRef);yr?yr.push(br):Qn.set(cr.popupRef,[br])}br.annotationEditorType>0&&Kt(this,ir).set(br.data.id,br);const Sr=br.render();cr.hidden&&(Sr.style.visibility="hidden"),Wn(this,_r,fu).call(this,Sr,cr.id)}Wn(this,_r,Ho).call(this),await this.l10n.translate(Mn)}update({viewport:xn}){const Sn=this.div;this.viewport=xn,(0,a.setLayerDimensions)(Sn,{rotation:xn.rotation}),Wn(this,_r,Ho).call(this),Sn.hidden=!1}getEditableAnnotations(){return Array.from(Kt(this,ir).values())}getEditableAnnotation(xn){return Kt(this,ir).get(xn)}}Lr=new WeakMap,Nn=new WeakMap,ir=new WeakMap,_r=new WeakSet,fu=function(xn,Sn){var Qn;const Mn=xn.firstChild||xn;Mn.id=`${o.AnnotationPrefix}${Sn}`,this.div.append(xn),(Qn=Kt(this,Lr))==null||Qn.moveElementInDOM(this.div,xn,Mn,!1)},Ho=function(){if(!Kt(this,Nn))return;const xn=this.div;for(const[Sn,Mn]of Kt(this,Nn)){const Qn=xn.querySelector(`[data-annotation-id="${Sn}"]`);if(!Qn)continue;const{firstChild:rr}=Qn;rr?rr.nodeName==="CANVAS"?rr.replaceWith(Mn):rr.before(Mn):Qn.append(Mn)}Kt(this,Nn).clear()},e.AnnotationLayer=En},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function i(j){return Math.floor(Math.max(0,Math.min(1,j))*255).toString(16).padStart(2,"0")}function o(j){return Math.max(0,Math.min(255,255*j))}class a{static CMYK_G([_e,tt,et,rt]){return["G",1-Math.min(1,.3*_e+.59*et+.11*tt+rt)]}static G_CMYK([_e]){return["CMYK",0,0,0,1-_e]}static G_RGB([_e]){return["RGB",_e,_e,_e]}static G_rgb([_e]){return _e=o(_e),[_e,_e,_e]}static G_HTML([_e]){const tt=i(_e);return`#${tt}${tt}${tt}`}static RGB_G([_e,tt,et]){return["G",.3*_e+.59*tt+.11*et]}static RGB_rgb(_e){return _e.map(o)}static RGB_HTML(_e){return`#${_e.map(i).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([_e,tt,et,rt]){return["RGB",1-Math.min(1,_e+rt),1-Math.min(1,et+rt),1-Math.min(1,tt+rt)]}static CMYK_rgb([_e,tt,et,rt]){return[o(1-Math.min(1,_e+rt)),o(1-Math.min(1,et+rt)),o(1-Math.min(1,tt+rt))]}static CMYK_HTML(_e){const tt=this.CMYK_RGB(_e).slice(1);return this.RGB_HTML(tt)}static RGB_CMYK([_e,tt,et]){const rt=1-_e,dt=1-tt,vt=1-et,Ct=Math.min(rt,dt,vt);return["CMYK",rt,dt,vt,Ct]}}e.ColorConverters=a},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=o;const i={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};i.print_progress_percent="{{progress}}%";function o(_e,tt){switch(_e){case"find_match_count":_e=`find_match_count[${tt.total===1?"one":"other"}]`;break;case"find_match_count_limit":_e=`find_match_count_limit[${tt.limit===1?"one":"other"}]`;break}return i[_e]||""}function a(_e,tt){return tt?_e.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(et,rt)=>rt in tt?tt[rt]:"{{"+rt+"}}"):_e}const j={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(_e,tt=null,et=o(_e,tt)){return a(et,tt)},async translate(_e){}};e.NullL10n=j},(s,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var o=i(25);class a{static setupStorage(_e,tt,et,rt,dt){const vt=rt.getValue(tt,{value:null});switch(et.name){case"textarea":if(vt.value!==null&&(_e.textContent=vt.value),dt==="print")break;_e.addEventListener("input",Ct=>{rt.setValue(tt,{value:Ct.target.value})});break;case"input":if(et.attributes.type==="radio"||et.attributes.type==="checkbox"){if(vt.value===et.attributes.xfaOn?_e.setAttribute("checked",!0):vt.value===et.attributes.xfaOff&&_e.removeAttribute("checked"),dt==="print")break;_e.addEventListener("change",Ct=>{rt.setValue(tt,{value:Ct.target.checked?Ct.target.getAttribute("xfaOn"):Ct.target.getAttribute("xfaOff")})})}else{if(vt.value!==null&&_e.setAttribute("value",vt.value),dt==="print")break;_e.addEventListener("input",Ct=>{rt.setValue(tt,{value:Ct.target.value})})}break;case"select":if(vt.value!==null){_e.setAttribute("value",vt.value);for(const Ct of et.children)Ct.attributes.value===vt.value?Ct.attributes.selected=!0:Ct.attributes.hasOwnProperty("selected")&&delete Ct.attributes.selected}_e.addEventListener("input",Ct=>{const Wt=Ct.target.options,Bt=Wt.selectedIndex===-1?"":Wt[Wt.selectedIndex].value;rt.setValue(tt,{value:Bt})});break}}static setAttributes({html:_e,element:tt,storage:et=null,intent:rt,linkService:dt}){const{attributes:vt}=tt,Ct=_e instanceof HTMLAnchorElement;vt.type==="radio"&&(vt.name=`${vt.name}-${rt}`);for(const[Wt,Bt]of Object.entries(vt))if(Bt!=null)switch(Wt){case"class":Bt.length&&_e.setAttribute(Wt,Bt.join(" "));break;case"dataId":break;case"id":_e.setAttribute("data-element-id",Bt);break;case"style":Object.assign(_e.style,Bt);break;case"textContent":_e.textContent=Bt;break;default:(!Ct||Wt!=="href"&&Wt!=="newWindow")&&_e.setAttribute(Wt,Bt)}Ct&&dt.addLinkAttributes(_e,vt.href,vt.newWindow),et&&vt.dataId&&this.setupStorage(_e,vt.dataId,tt,et)}static render(_e){var qt;const tt=_e.annotationStorage,et=_e.linkService,rt=_e.xfaHtml,dt=_e.intent||"display",vt=document.createElement(rt.name);rt.attributes&&this.setAttributes({html:vt,element:rt,intent:dt,linkService:et});const Ct=[[rt,-1,vt]],Wt=_e.div;if(Wt.append(vt),_e.viewport){const Ut=`matrix(${_e.viewport.transform.join(",")})`;Wt.style.transform=Ut}dt!=="richText"&&Wt.setAttribute("class","xfaLayer xfaFont");const Bt=[];for(;Ct.length>0;){const[Ut,kt,Nt]=Ct.at(-1);if(kt+1===Ut.children.length){Ct.pop();continue}const un=Ut.children[++Ct.at(-1)[1]];if(un===null)continue;const{name:dn}=un;if(dn==="#text"){const gn=document.createTextNode(un.value);Bt.push(gn),Nt.append(gn);continue}const hn=(qt=un==null?void 0:un.attributes)!=null&&qt.xmlns?document.createElementNS(un.attributes.xmlns,dn):document.createElement(dn);if(Nt.append(hn),un.attributes&&this.setAttributes({html:hn,element:un,storage:tt,intent:dt,linkService:et}),un.children&&un.children.length>0)Ct.push([un,-1,hn]);else if(un.value){const gn=document.createTextNode(un.value);o.XfaText.shouldBuildText(dn)&&Bt.push(gn),hn.append(gn)}}for(const Ut of Wt.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Ut.setAttribute("readOnly",!0);return{textDivs:Bt}}static update(_e){const tt=`matrix(${_e.viewport.transform.join(",")})`;_e.div.style.transform=tt,_e.div.hidden=!1}}e.XfaLayer=a},(s,e,i)=>{var rt,dt,vt,Ct,Wt,Bt,qt,Ut,kt,Nt,un,dn,hn,gn,It,pu,mu,gu,_u,qo,yu,Go,Eu,vu,Au,Tu,Ru,os,Ko,ro,so,Es,Xo,io,wn,Pu,Yo,Su,Iu,Qo,oo,vs;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var o=i(1),a=i(4),j=i(29),_e=i(6),tt=i(5);const lr=class lr extends a.AnnotationEditor{constructor(Pn){super({...Pn,name:"inkEditor"});Yn(this,It);Yn(this,rt,0);Yn(this,dt,0);Yn(this,vt,this.canvasPointermove.bind(this));Yn(this,Ct,this.canvasPointerleave.bind(this));Yn(this,Wt,this.canvasPointerup.bind(this));Yn(this,Bt,this.canvasPointerdown.bind(this));Yn(this,qt,new Path2D);Yn(this,Ut,!1);Yn(this,kt,!1);Yn(this,Nt,!1);Yn(this,un,null);Yn(this,dn,0);Yn(this,hn,0);Yn(this,gn,null);this.color=Pn.color||null,this.thickness=Pn.thickness||null,this.opacity=Pn.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Pn){a.AnnotationEditor.initialize(Pn,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Pn,kn){switch(Pn){case o.AnnotationEditorParamsType.INK_THICKNESS:lr._defaultThickness=kn;break;case o.AnnotationEditorParamsType.INK_COLOR:lr._defaultColor=kn;break;case o.AnnotationEditorParamsType.INK_OPACITY:lr._defaultOpacity=kn/100;break}}updateParams(Pn,kn){switch(Pn){case o.AnnotationEditorParamsType.INK_THICKNESS:Wn(this,It,pu).call(this,kn);break;case o.AnnotationEditorParamsType.INK_COLOR:Wn(this,It,mu).call(this,kn);break;case o.AnnotationEditorParamsType.INK_OPACITY:Wn(this,It,gu).call(this,kn);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,lr._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,lr._defaultColor||a.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(lr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||lr._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,this.color||lr._defaultColor||a.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??lr._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Wn(this,It,ro).call(this),Wn(this,It,so).call(this)),this.isAttachedToDOM||(this.parent.add(this),Wn(this,It,Es).call(this)),Wn(this,It,vs).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,Kt(this,un).disconnect(),Jn(this,un,null),super.remove())}setParent(Pn){!this.parent&&Pn?this._uiManager.removeShouldRescale(this):this.parent&&Pn===null&&this._uiManager.addShouldRescale(this),super.setParent(Pn)}onScaleChanging(){const[Pn,kn]=this.parentDimensions,Bn=this.width*Pn,Kn=this.height*kn;this.setDimensions(Bn,Kn)}enableEditMode(){Kt(this,Ut)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",Kt(this,Bt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",Kt(this,Bt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){Kt(this,Ut)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Jn(this,Ut,!0),this.div.classList.add("disabled"),Wn(this,It,vs).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Pn){this._focusEventsAllowed&&(super.focusin(Pn),this.enableEditMode())}canvasPointerdown(Pn){Pn.button!==0||!this.isInEditMode()||Kt(this,Ut)||(this.setInForeground(),Pn.preventDefault(),Pn.type!=="mouse"&&this.div.focus(),Wn(this,It,yu).call(this,Pn.offsetX,Pn.offsetY))}canvasPointermove(Pn){Pn.preventDefault(),Wn(this,It,Go).call(this,Pn.offsetX,Pn.offsetY)}canvasPointerup(Pn){Pn.preventDefault(),Wn(this,It,Ko).call(this,Pn)}canvasPointerleave(Pn){Wn(this,It,Ko).call(this,Pn)}get isResizable(){return!this.isEmpty()&&Kt(this,Ut)}render(){if(this.div)return this.div;let Pn,kn;this.width&&(Pn=this.x,kn=this.y),super.render(),a.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(ur=>{var qn;return(qn=this.div)==null?void 0:qn.setAttribute("aria-label",ur)});const[Bn,Kn,sr,fr]=Wn(this,It,_u).call(this);if(this.setAt(Bn,Kn,0,0),this.setDims(sr,fr),Wn(this,It,ro).call(this),this.width){const[ur,qn]=this.parentDimensions;this.setAspectRatio(this.width*ur,this.height*qn),this.setAt(Pn*ur,kn*qn,this.width*ur,this.height*qn),Jn(this,Nt,!0),Wn(this,It,Es).call(this),this.setDims(this.width*ur,this.height*qn),Wn(this,It,os).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Wn(this,It,so).call(this),this.div}setDimensions(Pn,kn){const Bn=Math.round(Pn),Kn=Math.round(kn);if(Kt(this,dn)===Bn&&Kt(this,hn)===Kn)return;Jn(this,dn,Bn),Jn(this,hn,Kn),this.canvas.style.visibility="hidden";const[sr,fr]=this.parentDimensions;this.width=Pn/sr,this.height=kn/fr,this.fixAndSetPosition(),Kt(this,Ut)&&Wn(this,It,Xo).call(this,Pn,kn),Wn(this,It,Es).call(this),Wn(this,It,os).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Pn,kn,Bn){var Rr,Or,jr;if(Pn instanceof j.InkAnnotationElement)return null;const Kn=super.deserialize(Pn,kn,Bn);Kn.thickness=Pn.thickness,Kn.color=o.Util.makeHexColor(...Pn.color),Kn.opacity=Pn.opacity;const[sr,fr]=Kn.pageDimensions,ur=Kn.width*sr,qn=Kn.height*fr,gr=Kn.parentScale,mr=Pn.thickness/2;Jn(Kn,Ut,!0),Jn(Kn,dn,Math.round(ur)),Jn(Kn,hn,Math.round(qn));const{paths:Dr,rect:Cr,rotation:Mr}=Pn;for(let{bezier:hr}of Dr){hr=Wn(Rr=lr,wn,Su).call(Rr,hr,Cr,Mr);const Xn=[];Kn.paths.push(Xn);let Zn=gr*(hr[0]-mr),vr=gr*(hr[1]-mr);for(let Lr=2,Nn=hr.length;Lr<Nn;Lr+=6){const ir=gr*(hr[Lr]-mr),_r=gr*(hr[Lr+1]-mr),Ar=gr*(hr[Lr+2]-mr),xr=gr*(hr[Lr+3]-mr),Er=gr*(hr[Lr+4]-mr),xn=gr*(hr[Lr+5]-mr);Xn.push([[Zn,vr],[ir,_r],[Ar,xr],[Er,xn]]),Zn=Er,vr=xn}const Fr=Wn(this,wn,Pu).call(this,Xn);Kn.bezierPath2D.push(Fr)}const Tr=Wn(Or=Kn,It,Qo).call(Or);return Jn(Kn,dt,Math.max(a.AnnotationEditor.MIN_SIZE,Tr[2]-Tr[0])),Jn(Kn,rt,Math.max(a.AnnotationEditor.MIN_SIZE,Tr[3]-Tr[1])),Wn(jr=Kn,It,Xo).call(jr,ur,qn),Kn}serialize(){if(this.isEmpty())return null;const Pn=this.getRect(0,0),kn=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:o.AnnotationEditorType.INK,color:kn,thickness:this.thickness,opacity:this.opacity,paths:Wn(this,It,Iu).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Pn),pageIndex:this.pageIndex,rect:Pn,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};rt=new WeakMap,dt=new WeakMap,vt=new WeakMap,Ct=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,qt=new WeakMap,Ut=new WeakMap,kt=new WeakMap,Nt=new WeakMap,un=new WeakMap,dn=new WeakMap,hn=new WeakMap,gn=new WeakMap,It=new WeakSet,pu=function(Pn){const kn=this.thickness;this.addCommands({cmd:()=>{this.thickness=Pn,Wn(this,It,vs).call(this)},undo:()=>{this.thickness=kn,Wn(this,It,vs).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},mu=function(Pn){const kn=this.color;this.addCommands({cmd:()=>{this.color=Pn,Wn(this,It,os).call(this)},undo:()=>{this.color=kn,Wn(this,It,os).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},gu=function(Pn){Pn/=100;const kn=this.opacity;this.addCommands({cmd:()=>{this.opacity=Pn,Wn(this,It,os).call(this)},undo:()=>{this.opacity=kn,Wn(this,It,os).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},_u=function(){const{parentRotation:Pn,parentDimensions:[kn,Bn]}=this;switch(Pn){case 90:return[0,Bn,Bn,kn];case 180:return[kn,Bn,kn,Bn];case 270:return[kn,0,Bn,kn];default:return[0,0,kn,Bn]}},qo=function(){const{ctx:Pn,color:kn,opacity:Bn,thickness:Kn,parentScale:sr,scaleFactor:fr}=this;Pn.lineWidth=Kn*sr/fr,Pn.lineCap="round",Pn.lineJoin="round",Pn.miterLimit=10,Pn.strokeStyle=`${kn}${(0,tt.opacityToHex)(Bn)}`},yu=function(Pn,kn){this.canvas.addEventListener("contextmenu",_e.noContextMenu),this.canvas.addEventListener("pointerleave",Kt(this,Ct)),this.canvas.addEventListener("pointermove",Kt(this,vt)),this.canvas.addEventListener("pointerup",Kt(this,Wt)),this.canvas.removeEventListener("pointerdown",Kt(this,Bt)),this.isEditing=!0,Kt(this,Nt)||(Jn(this,Nt,!0),Wn(this,It,Es).call(this),this.thickness||(this.thickness=lr._defaultThickness),this.color||(this.color=lr._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=lr._defaultOpacity)),this.currentPath.push([Pn,kn]),Jn(this,kt,!1),Wn(this,It,qo).call(this),Jn(this,gn,()=>{Wn(this,It,Au).call(this),Kt(this,gn)&&window.requestAnimationFrame(Kt(this,gn))}),window.requestAnimationFrame(Kt(this,gn))},Go=function(Pn,kn){const[Bn,Kn]=this.currentPath.at(-1);if(this.currentPath.length>1&&Pn===Bn&&kn===Kn)return;const sr=this.currentPath;let fr=Kt(this,qt);if(sr.push([Pn,kn]),Jn(this,kt,!0),sr.length<=2){fr.moveTo(...sr[0]),fr.lineTo(Pn,kn);return}sr.length===3&&(Jn(this,qt,fr=new Path2D),fr.moveTo(...sr[0])),Wn(this,It,Tu).call(this,fr,...sr.at(-3),...sr.at(-2),Pn,kn)},Eu=function(){if(this.currentPath.length===0)return;const Pn=this.currentPath.at(-1);Kt(this,qt).lineTo(...Pn)},vu=function(Pn,kn){Jn(this,gn,null),Pn=Math.min(Math.max(Pn,0),this.canvas.width),kn=Math.min(Math.max(kn,0),this.canvas.height),Wn(this,It,Go).call(this,Pn,kn),Wn(this,It,Eu).call(this);let Bn;if(this.currentPath.length!==1)Bn=Wn(this,It,Ru).call(this);else{const qn=[Pn,kn];Bn=[[qn,qn.slice(),qn.slice(),qn]]}const Kn=Kt(this,qt),sr=this.currentPath;this.currentPath=[],Jn(this,qt,new Path2D);const fr=()=>{this.allRawPaths.push(sr),this.paths.push(Bn),this.bezierPath2D.push(Kn),this.rebuild()},ur=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Wn(this,It,ro).call(this),Wn(this,It,so).call(this)),Wn(this,It,vs).call(this))};this.addCommands({cmd:fr,undo:ur,mustExec:!0})},Au=function(){if(!Kt(this,kt))return;Jn(this,kt,!1);const Pn=Math.ceil(this.thickness*this.parentScale),kn=this.currentPath.slice(-3),Bn=kn.map(fr=>fr[0]),Kn=kn.map(fr=>fr[1]);Math.min(...Bn)-Pn,Math.max(...Bn)+Pn,Math.min(...Kn)-Pn,Math.max(...Kn)+Pn;const{ctx:sr}=this;sr.save(),sr.clearRect(0,0,this.canvas.width,this.canvas.height);for(const fr of this.bezierPath2D)sr.stroke(fr);sr.stroke(Kt(this,qt)),sr.restore()},Tu=function(Pn,kn,Bn,Kn,sr,fr,ur){const qn=(kn+Kn)/2,gr=(Bn+sr)/2,mr=(Kn+fr)/2,Dr=(sr+ur)/2;Pn.bezierCurveTo(qn+2*(Kn-qn)/3,gr+2*(sr-gr)/3,mr+2*(Kn-mr)/3,Dr+2*(sr-Dr)/3,mr,Dr)},Ru=function(){const Pn=this.currentPath;if(Pn.length<=2)return[[Pn[0],Pn[0],Pn.at(-1),Pn.at(-1)]];const kn=[];let Bn,[Kn,sr]=Pn[0];for(Bn=1;Bn<Pn.length-2;Bn++){const[Cr,Mr]=Pn[Bn],[Tr,Rr]=Pn[Bn+1],Or=(Cr+Tr)/2,jr=(Mr+Rr)/2,hr=[Kn+2*(Cr-Kn)/3,sr+2*(Mr-sr)/3],Xn=[Or+2*(Cr-Or)/3,jr+2*(Mr-jr)/3];kn.push([[Kn,sr],hr,Xn,[Or,jr]]),[Kn,sr]=[Or,jr]}const[fr,ur]=Pn[Bn],[qn,gr]=Pn[Bn+1],mr=[Kn+2*(fr-Kn)/3,sr+2*(ur-sr)/3],Dr=[qn+2*(fr-qn)/3,gr+2*(ur-gr)/3];return kn.push([[Kn,sr],mr,Dr,[qn,gr]]),kn},os=function(){if(this.isEmpty()){Wn(this,It,io).call(this);return}Wn(this,It,qo).call(this);const{canvas:Pn,ctx:kn}=this;kn.setTransform(1,0,0,1,0,0),kn.clearRect(0,0,Pn.width,Pn.height),Wn(this,It,io).call(this);for(const Bn of this.bezierPath2D)kn.stroke(Bn)},Ko=function(Pn){this.canvas.removeEventListener("pointerleave",Kt(this,Ct)),this.canvas.removeEventListener("pointermove",Kt(this,vt)),this.canvas.removeEventListener("pointerup",Kt(this,Wt)),this.canvas.addEventListener("pointerdown",Kt(this,Bt)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",_e.noContextMenu)},10),Wn(this,It,vu).call(this,Pn.offsetX,Pn.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ro=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",a.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Pn=>{var kn;return(kn=this.canvas)==null?void 0:kn.setAttribute("aria-label",Pn)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},so=function(){Jn(this,un,new ResizeObserver(Pn=>{const kn=Pn[0].contentRect;kn.width&&kn.height&&this.setDimensions(kn.width,kn.height)})),Kt(this,un).observe(this.div)},Es=function(){if(!Kt(this,Nt))return;const[Pn,kn]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Pn),this.canvas.height=Math.ceil(this.height*kn),Wn(this,It,io).call(this)},Xo=function(Pn,kn){const Bn=Wn(this,It,oo).call(this),Kn=(Pn-Bn)/Kt(this,dt),sr=(kn-Bn)/Kt(this,rt);this.scaleFactor=Math.min(Kn,sr)},io=function(){const Pn=Wn(this,It,oo).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Pn,this.translationY*this.scaleFactor+Pn)},wn=new WeakSet,Pu=function(Pn){const kn=new Path2D;for(let Bn=0,Kn=Pn.length;Bn<Kn;Bn++){const[sr,fr,ur,qn]=Pn[Bn];Bn===0&&kn.moveTo(...sr),kn.bezierCurveTo(fr[0],fr[1],ur[0],ur[1],qn[0],qn[1])}return kn},Yo=function(Pn,kn,Bn){const[Kn,sr,fr,ur]=kn;switch(Bn){case 0:for(let qn=0,gr=Pn.length;qn<gr;qn+=2)Pn[qn]+=Kn,Pn[qn+1]=ur-Pn[qn+1];break;case 90:for(let qn=0,gr=Pn.length;qn<gr;qn+=2){const mr=Pn[qn];Pn[qn]=Pn[qn+1]+Kn,Pn[qn+1]=mr+sr}break;case 180:for(let qn=0,gr=Pn.length;qn<gr;qn+=2)Pn[qn]=fr-Pn[qn],Pn[qn+1]+=sr;break;case 270:for(let qn=0,gr=Pn.length;qn<gr;qn+=2){const mr=Pn[qn];Pn[qn]=fr-Pn[qn+1],Pn[qn+1]=ur-mr}break;default:throw new Error("Invalid rotation")}return Pn},Su=function(Pn,kn,Bn){const[Kn,sr,fr,ur]=kn;switch(Bn){case 0:for(let qn=0,gr=Pn.length;qn<gr;qn+=2)Pn[qn]-=Kn,Pn[qn+1]=ur-Pn[qn+1];break;case 90:for(let qn=0,gr=Pn.length;qn<gr;qn+=2){const mr=Pn[qn];Pn[qn]=Pn[qn+1]-sr,Pn[qn+1]=mr-Kn}break;case 180:for(let qn=0,gr=Pn.length;qn<gr;qn+=2)Pn[qn]=fr-Pn[qn],Pn[qn+1]-=sr;break;case 270:for(let qn=0,gr=Pn.length;qn<gr;qn+=2){const mr=Pn[qn];Pn[qn]=ur-Pn[qn+1],Pn[qn+1]=fr-mr}break;default:throw new Error("Invalid rotation")}return Pn},Iu=function(Pn,kn,Bn,Kn){var gr,mr;const sr=[],fr=this.thickness/2,ur=Pn*kn+fr,qn=Pn*Bn+fr;for(const Dr of this.paths){const Cr=[],Mr=[];for(let Tr=0,Rr=Dr.length;Tr<Rr;Tr++){const[Or,jr,hr,Xn]=Dr[Tr],Zn=Pn*Or[0]+ur,vr=Pn*Or[1]+qn,Fr=Pn*jr[0]+ur,Lr=Pn*jr[1]+qn,Nn=Pn*hr[0]+ur,ir=Pn*hr[1]+qn,_r=Pn*Xn[0]+ur,Ar=Pn*Xn[1]+qn;Tr===0&&(Cr.push(Zn,vr),Mr.push(Zn,vr)),Cr.push(Fr,Lr,Nn,ir,_r,Ar),Mr.push(Fr,Lr),Tr===Rr-1&&Mr.push(_r,Ar)}sr.push({bezier:Wn(gr=lr,wn,Yo).call(gr,Cr,Kn,this.rotation),points:Wn(mr=lr,wn,Yo).call(mr,Mr,Kn,this.rotation)})}return sr},Qo=function(){let Pn=1/0,kn=-1/0,Bn=1/0,Kn=-1/0;for(const sr of this.paths)for(const[fr,ur,qn,gr]of sr){const mr=o.Util.bezierBoundingBox(...fr,...ur,...qn,...gr);Pn=Math.min(Pn,mr[0]),Bn=Math.min(Bn,mr[1]),kn=Math.max(kn,mr[2]),Kn=Math.max(Kn,mr[3])}return[Pn,Bn,kn,Kn]},oo=function(){return Kt(this,Ut)?Math.ceil(this.thickness*this.parentScale):0},vs=function(Pn=!1){if(this.isEmpty())return;if(!Kt(this,Ut)){Wn(this,It,os).call(this);return}const kn=Wn(this,It,Qo).call(this),Bn=Wn(this,It,oo).call(this);Jn(this,dt,Math.max(a.AnnotationEditor.MIN_SIZE,kn[2]-kn[0])),Jn(this,rt,Math.max(a.AnnotationEditor.MIN_SIZE,kn[3]-kn[1]));const Kn=Math.ceil(Bn+Kt(this,dt)*this.scaleFactor),sr=Math.ceil(Bn+Kt(this,rt)*this.scaleFactor),[fr,ur]=this.parentDimensions;this.width=Kn/fr,this.height=sr/ur,this.setAspectRatio(Kn,sr);const qn=this.translationX,gr=this.translationY;this.translationX=-kn[0],this.translationY=-kn[1],Wn(this,It,Es).call(this),Wn(this,It,os).call(this),Jn(this,dn,Kn),Jn(this,hn,sr),this.setDims(Kn,sr);const mr=Pn?Bn/this.scaleFactor/2:0;this.translate(qn-this.translationX-mr,gr-this.translationY-mr)},Yn(lr,wn),zr(lr,"_defaultColor",null),zr(lr,"_defaultOpacity",1),zr(lr,"_defaultThickness",1),zr(lr,"_type","ink");let et=lr;e.InkEditor=et},(s,e,i)=>{var et,rt,dt,vt,Ct,Wt,Bt,qt,Ut,kt,Nt,Ls,Ms,ao,Jo,bu,wu,Zo,lo,xu;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var o=i(1),a=i(4),j=i(6),_e=i(29);const yn=class yn extends a.AnnotationEditor{constructor(Ln){super({...Ln,name:"stampEditor"});Yn(this,Nt);Yn(this,et,null);Yn(this,rt,null);Yn(this,dt,null);Yn(this,vt,null);Yn(this,Ct,null);Yn(this,Wt,null);Yn(this,Bt,null);Yn(this,qt,null);Yn(this,Ut,!1);Yn(this,kt,!1);Jn(this,vt,Ln.bitmapUrl),Jn(this,Ct,Ln.bitmapFile)}static initialize(Ln){a.AnnotationEditor.initialize(Ln)}static get supportedTypes(){const Ln=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,o.shadow)(this,"supportedTypes",Ln.map(jn=>`image/${jn}`))}static get supportedTypesStr(){return(0,o.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Ln){return this.supportedTypes.includes(Ln)}static paste(Ln,jn){jn.pasteEditor(o.AnnotationEditorType.STAMP,{bitmapFile:Ln.getAsFile()})}remove(){var Ln,jn;Kt(this,rt)&&(Jn(this,et,null),this._uiManager.imageManager.deleteId(Kt(this,rt)),(Ln=Kt(this,Wt))==null||Ln.remove(),Jn(this,Wt,null),(jn=Kt(this,Bt))==null||jn.disconnect(),Jn(this,Bt,null)),super.remove()}rebuild(){if(!this.parent){Kt(this,rt)&&Wn(this,Nt,ao).call(this);return}super.rebuild(),this.div!==null&&(Kt(this,rt)&&Wn(this,Nt,ao).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(Kt(this,dt)||Kt(this,et)||Kt(this,vt)||Kt(this,Ct))}get isResizable(){return!0}render(){if(this.div)return this.div;let Ln,jn;if(this.width&&(Ln=this.x,jn=this.y),super.render(),this.div.hidden=!0,Kt(this,et)?Wn(this,Nt,Jo).call(this):Wn(this,Nt,ao).call(this),this.width){const[On,Vn]=this.parentDimensions;this.setAt(Ln*On,jn*Vn,this.width*On,this.height*Vn)}return this.div}static deserialize(Ln,jn,On){if(Ln instanceof _e.StampAnnotationElement)return null;const Vn=super.deserialize(Ln,jn,On),{rect:Rn,bitmapUrl:Dn,bitmapId:Fn,isSvg:Tn,accessibilityData:pn}=Ln;Fn&&On.imageManager.isValidId(Fn)?Jn(Vn,rt,Fn):Jn(Vn,vt,Dn),Jn(Vn,Ut,Tn);const[En,An]=Vn.pageDimensions;return Vn.width=(Rn[2]-Rn[0])/En,Vn.height=(Rn[3]-Rn[1])/An,pn&&(Vn.altTextData=pn),Vn}serialize(Ln=!1,jn=null){if(this.isEmpty())return null;const On={annotationType:o.AnnotationEditorType.STAMP,bitmapId:Kt(this,rt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:Kt(this,Ut),structTreeParentId:this._structTreeParentId};if(Ln)return On.bitmapUrl=Wn(this,Nt,lo).call(this,!0),On.accessibilityData=this.altTextData,On;const{decorative:Vn,altText:Rn}=this.altTextData;if(!Vn&&Rn&&(On.accessibilityData={type:"Figure",alt:Rn}),jn===null)return On;jn.stamps||(jn.stamps=new Map);const Dn=Kt(this,Ut)?(On.rect[2]-On.rect[0])*(On.rect[3]-On.rect[1]):null;if(!jn.stamps.has(Kt(this,rt)))jn.stamps.set(Kt(this,rt),{area:Dn,serialized:On}),On.bitmap=Wn(this,Nt,lo).call(this,!1);else if(Kt(this,Ut)){const Fn=jn.stamps.get(Kt(this,rt));Dn>Fn.area&&(Fn.area=Dn,Fn.serialized.bitmap.close(),Fn.serialized.bitmap=Wn(this,Nt,lo).call(this,!1))}return On}};et=new WeakMap,rt=new WeakMap,dt=new WeakMap,vt=new WeakMap,Ct=new WeakMap,Wt=new WeakMap,Bt=new WeakMap,qt=new WeakMap,Ut=new WeakMap,kt=new WeakMap,Nt=new WeakSet,Ls=function(Ln,jn=!1){if(!Ln){this.remove();return}Jn(this,et,Ln.bitmap),jn||(Jn(this,rt,Ln.id),Jn(this,Ut,Ln.isSvg)),Wn(this,Nt,Jo).call(this)},Ms=function(){Jn(this,dt,null),this._uiManager.enableWaiting(!1),Kt(this,Wt)&&this.div.focus()},ao=function(){if(Kt(this,rt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(Kt(this,rt)).then(jn=>Wn(this,Nt,Ls).call(this,jn,!0)).finally(()=>Wn(this,Nt,Ms).call(this));return}if(Kt(this,vt)){const jn=Kt(this,vt);Jn(this,vt,null),this._uiManager.enableWaiting(!0),Jn(this,dt,this._uiManager.imageManager.getFromUrl(jn).then(On=>Wn(this,Nt,Ls).call(this,On)).finally(()=>Wn(this,Nt,Ms).call(this)));return}if(Kt(this,Ct)){const jn=Kt(this,Ct);Jn(this,Ct,null),this._uiManager.enableWaiting(!0),Jn(this,dt,this._uiManager.imageManager.getFromFile(jn).then(On=>Wn(this,Nt,Ls).call(this,On)).finally(()=>Wn(this,Nt,Ms).call(this)));return}const Ln=document.createElement("input");Ln.type="file",Ln.accept=yn.supportedTypesStr,Jn(this,dt,new Promise(jn=>{Ln.addEventListener("change",async()=>{if(!Ln.files||Ln.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const On=await this._uiManager.imageManager.getFromFile(Ln.files[0]);Wn(this,Nt,Ls).call(this,On)}jn()}),Ln.addEventListener("cancel",()=>{this.remove(),jn()})}).finally(()=>Wn(this,Nt,Ms).call(this))),Ln.click()},Jo=function(){const{div:Ln}=this;let{width:jn,height:On}=Kt(this,et);const[Vn,Rn]=this.pageDimensions,Dn=.75;if(this.width)jn=this.width*Vn,On=this.height*Rn;else if(jn>Dn*Vn||On>Dn*Rn){const En=Math.min(Dn*Vn/jn,Dn*Rn/On);jn*=En,On*=En}const[Fn,Tn]=this.parentDimensions;this.setDims(jn*Fn/Vn,On*Tn/Rn),this._uiManager.enableWaiting(!1);const pn=Jn(this,Wt,document.createElement("canvas"));Ln.append(pn),Ln.hidden=!1,Wn(this,Nt,Zo).call(this,jn,On),Wn(this,Nt,xu).call(this),Kt(this,kt)||(this.parent.addUndoableEditor(this),Jn(this,kt,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},bu=function(Ln,jn){var Dn;const[On,Vn]=this.parentDimensions;this.width=Ln/On,this.height=jn/Vn,this.setDims(Ln,jn),(Dn=this._initialOptions)!=null&&Dn.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,Kt(this,qt)!==null&&clearTimeout(Kt(this,qt)),Jn(this,qt,setTimeout(()=>{Jn(this,qt,null),Wn(this,Nt,Zo).call(this,Ln,jn)},200))},wu=function(Ln,jn){const{width:On,height:Vn}=Kt(this,et);let Rn=On,Dn=Vn,Fn=Kt(this,et);for(;Rn>2*Ln||Dn>2*jn;){const Tn=Rn,pn=Dn;Rn>2*Ln&&(Rn=Rn>=16384?Math.floor(Rn/2)-1:Math.ceil(Rn/2)),Dn>2*jn&&(Dn=Dn>=16384?Math.floor(Dn/2)-1:Math.ceil(Dn/2));const En=new OffscreenCanvas(Rn,Dn);En.getContext("2d").drawImage(Fn,0,0,Tn,pn,0,0,Rn,Dn),Fn=En.transferToImageBitmap()}return Fn},Zo=function(Ln,jn){Ln=Math.ceil(Ln),jn=Math.ceil(jn);const On=Kt(this,Wt);if(!On||On.width===Ln&&On.height===jn)return;On.width=Ln,On.height=jn;const Vn=Kt(this,Ut)?Kt(this,et):Wn(this,Nt,wu).call(this,Ln,jn),Rn=On.getContext("2d");Rn.filter=this._uiManager.hcmFilter,Rn.drawImage(Vn,0,0,Vn.width,Vn.height,0,0,Ln,jn)},lo=function(Ln){if(Ln){if(Kt(this,Ut)){const Vn=this._uiManager.imageManager.getSvgUrl(Kt(this,rt));if(Vn)return Vn}const jn=document.createElement("canvas");return{width:jn.width,height:jn.height}=Kt(this,et),jn.getContext("2d").drawImage(Kt(this,et),0,0),jn.toDataURL()}if(Kt(this,Ut)){const[jn,On]=this.pageDimensions,Vn=Math.round(this.width*jn*j.PixelsPerInch.PDF_TO_CSS_UNITS),Rn=Math.round(this.height*On*j.PixelsPerInch.PDF_TO_CSS_UNITS),Dn=new OffscreenCanvas(Vn,Rn);return Dn.getContext("2d").drawImage(Kt(this,et),0,0,Kt(this,et).width,Kt(this,et).height,0,0,Vn,Rn),Dn.transferToImageBitmap()}return structuredClone(Kt(this,et))},xu=function(){Jn(this,Bt,new ResizeObserver(Ln=>{const jn=Ln[0].contentRect;jn.width&&jn.height&&Wn(this,Nt,bu).call(this,jn.width,jn.height)})),Kt(this,Bt).observe(this.div)},zr(yn,"_type","stamp");let tt=yn;e.StampEditor=tt}],__webpack_module_cache__={};function __w_pdfjs_require__(s){var e=__webpack_module_cache__[s];if(e!==void 0)return e.exports;var i=__webpack_module_cache__[s]={exports:{}};return __webpack_modules__[s](i,i.exports,__w_pdfjs_require__),i.exports}var __webpack_exports__={};return(()=>{var s=__webpack_exports__;Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(s,"AnnotationEditorLayer",{enumerable:!0,get:function(){return j.AnnotationEditorLayer}}),Object.defineProperty(s,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(s,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(s,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return _e.AnnotationEditorUIManager}}),Object.defineProperty(s,"AnnotationLayer",{enumerable:!0,get:function(){return tt.AnnotationLayer}}),Object.defineProperty(s,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(s,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(s,"DOMSVGFactory",{enumerable:!0,get:function(){return o.DOMSVGFactory}}),Object.defineProperty(s,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(s,"GlobalWorkerOptions",{enumerable:!0,get:function(){return et.GlobalWorkerOptions}}),Object.defineProperty(s,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(s,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(s,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(s,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(s,"PDFDataRangeTransport",{enumerable:!0,get:function(){return i.PDFDataRangeTransport}}),Object.defineProperty(s,"PDFDateString",{enumerable:!0,get:function(){return o.PDFDateString}}),Object.defineProperty(s,"PDFWorker",{enumerable:!0,get:function(){return i.PDFWorker}}),Object.defineProperty(s,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(s,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(s,"PixelsPerInch",{enumerable:!0,get:function(){return o.PixelsPerInch}}),Object.defineProperty(s,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(s,"RenderingCancelledException",{enumerable:!0,get:function(){return o.RenderingCancelledException}}),Object.defineProperty(s,"SVGGraphics",{enumerable:!0,get:function(){return i.SVGGraphics}}),Object.defineProperty(s,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(s,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(s,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(s,"XfaLayer",{enumerable:!0,get:function(){return rt.XfaLayer}}),Object.defineProperty(s,"build",{enumerable:!0,get:function(){return i.build}}),Object.defineProperty(s,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(s,"getDocument",{enumerable:!0,get:function(){return i.getDocument}}),Object.defineProperty(s,"getFilenameFromUrl",{enumerable:!0,get:function(){return o.getFilenameFromUrl}}),Object.defineProperty(s,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return o.getPdfFilenameFromUrl}}),Object.defineProperty(s,"getXfaPageViewport",{enumerable:!0,get:function(){return o.getXfaPageViewport}}),Object.defineProperty(s,"isDataScheme",{enumerable:!0,get:function(){return o.isDataScheme}}),Object.defineProperty(s,"isPdfFile",{enumerable:!0,get:function(){return o.isPdfFile}}),Object.defineProperty(s,"loadScript",{enumerable:!0,get:function(){return o.loadScript}}),Object.defineProperty(s,"noContextMenu",{enumerable:!0,get:function(){return o.noContextMenu}}),Object.defineProperty(s,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(s,"renderTextLayer",{enumerable:!0,get:function(){return a.renderTextLayer}}),Object.defineProperty(s,"setLayerDimensions",{enumerable:!0,get:function(){return o.setLayerDimensions}}),Object.defineProperty(s,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(s,"updateTextLayer",{enumerable:!0,get:function(){return a.updateTextLayer}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return i.version}});var e=__w_pdfjs_require__(1),i=__w_pdfjs_require__(2),o=__w_pdfjs_require__(6),a=__w_pdfjs_require__(26),j=__w_pdfjs_require__(27),_e=__w_pdfjs_require__(5),tt=__w_pdfjs_require__(29),et=__w_pdfjs_require__(14),rt=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjs=pdf;var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function s(o,a,j,_e,tt,et){if(et!==ReactPropTypesSecret){var rt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw rt.name="Invariant Violation",rt}}s.isRequired=s;function e(){return s}var i={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:e,element:s,elementType:s,instanceOf:e,node:s,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return i.PropTypes=i,i};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);var __spreadArray=function(s,e,i){if(i||arguments.length===2)for(var o=0,a=e.length,j;o<a;o++)(j||!(o in e))&&(j||(j=Array.prototype.slice.call(e,0,o)),j[o]=e[o]);return s.concat(j||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(s,e){var i={};return allEvents.forEach(function(o){var a=s[o];a&&(e?i[o]=function(j){return a(j,e(o))}:i[o]=a)}),i}function makeCancellablePromise(s){var e=!1,i=new Promise(function(o,a){s.then(function(j){return!e&&o(j)}).catch(function(j){return!e&&a(j)})});return{promise:i,cancel:function(){e=!0}}}var prefix="Invariant failed";function invariant(s,e){if(!s)throw new Error(prefix)}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(s,e,i){for(i of s.keys())if(dequal(i,e))return i}function dequal(s,e){var i,o,a;if(s===e)return!0;if(s&&e&&(i=s.constructor)===e.constructor){if(i===Date)return s.getTime()===e.getTime();if(i===RegExp)return s.toString()===e.toString();if(i===Array){if((o=s.length)===e.length)for(;o--&&dequal(s[o],e[o]););return o===-1}if(i===Set){if(s.size!==e.size)return!1;for(o of s)if(a=o,a&&typeof a=="object"&&(a=find(e,a),!a)||!e.has(a))return!1;return!0}if(i===Map){if(s.size!==e.size)return!1;for(o of s)if(a=o[0],a&&typeof a=="object"&&(a=find(e,a),!a)||!dequal(o[1],e.get(a)))return!1;return!0}if(i===ArrayBuffer)s=new Uint8Array(s),e=new Uint8Array(e);else if(i===DataView){if((o=s.byteLength)===e.byteLength)for(;o--&&s.getInt8(o)===e.getInt8(o););return o===-1}if(ArrayBuffer.isView(s)){if((o=s.byteLength)===e.byteLength)for(;o--&&s[o]===e[o];);return o===-1}if(!i||typeof s=="object"){o=0;for(i in s)if(has.call(s,i)&&++o&&!has.call(e,i)||!(i in e)||!dequal(s[i],e[i]))return!1;return Object.keys(e).length===o}}return s!==s&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:s,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},s)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(i=>{invariant(this.pdfDocument),invariant(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(i):Array.isArray(e)?i(e):e.then(i)}).then(i=>{invariant(Array.isArray(i));const o=i[0];new Promise(a=>{invariant(this.pdfDocument),o instanceof Object?this.pdfDocument.getPageIndex(o).then(j=>{a(j)}).catch(()=>{invariant(!1)}):typeof o=="number"?a(o):invariant(!1)}).then(a=>{const j=a+1;invariant(this.pdfViewer),invariant(j>=1&&j<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:i,pageIndex:a,pageNumber:j})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const i=e-1;invariant(this.pdfViewer),invariant(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:i,pageNumber:e})}addLinkAttributes(e,i,o){e.href=i,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=o?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(s){return typeof s<"u"}function isProvided(s){return isDefined(s)&&s!==null}function isString(s){return typeof s=="string"}function isArrayBuffer(s){return s instanceof ArrayBuffer}function isBlob(s){return invariant(isBrowser),s instanceof Blob}function isDataURI(s){return isString(s)&&/^data:/.test(s)}function dataURItoByteString(s){invariant(isDataURI(s));const[e="",i=""]=s.split(",");return e.split(";").indexOf("base64")!==-1?atob(i):unescape(i)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(s){s&&s.cancel&&s.cancel()}function makePageCallback(s,e){return Object.defineProperty(s,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(s,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(s,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(s,"originalHeight",{get(){return this.view[3]},configurable:!0}),s}function isCancelException(s){return s.name==="RenderingCancelledException"}function loadFromFile(s){return new Promise((e,i)=>{const o=new FileReader;o.onload=()=>{if(!o.result)return i(new Error("Error while reading a file."));e(o.result)},o.onerror=a=>{if(!a.target)return i(new Error("Error while reading a file."));const{error:j}=a.target;if(!j)return i(new Error("Error while reading a file."));switch(j.code){case j.NOT_FOUND_ERR:return i(new Error("Error while reading a file: File not found."));case j.SECURITY_ERR:return i(new Error("Error while reading a file: Security error."));case j.ABORT_ERR:return i(new Error("Error while reading a file: Aborted."));default:return i(new Error("Error while reading a file."))}},o.readAsArrayBuffer(s)})}function reducer(s,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return s}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const s={};return allEvents.forEach(e=>{s[e]=PropTypes.func}),s})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function s(e,i,o){const{[i]:a,pageNumber:j,pdf:_e}=e;if(!isDefined(_e))return null;if(isDefined(a)){if(typeof a!="number")return new Error(`\`${i}\` of type \`${typeof a}\` supplied to \`${o}\`, expected \`number\`.`);if(a<0)return new Error(`Expected \`${i}\` to be greater or equal to 0.`);const{numPages:tt}=_e;if(a+1>tt)return new Error(`Expected \`${i}\` to be less or equal to ${tt-1}.`)}else if(!isDefined(j))return new Error(`\`${i}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${o}\`.`);return null},isPageNumber=function s(e,i,o){const{[i]:a,pageIndex:j,pdf:_e}=e;if(!isDefined(_e))return null;if(isDefined(a)){if(typeof a!="number")return new Error(`\`${i}\` of type \`${typeof a}\` supplied to \`${o}\`, expected \`number\`.`);if(a<1)return new Error(`Expected \`${i}\` to be greater or equal to 1.`);const{numPages:tt}=_e;if(a>tt)return new Error(`Expected \`${i}\` to be less or equal to ${tt}.`)}else if(!isDefined(j))return new Error(`\`${i}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${o}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(s,e,i,o){function a(j){return j instanceof i?j:new i(function(_e){_e(j)})}return new(i||(i=Promise))(function(j,_e){function tt(dt){try{rt(o.next(dt))}catch(vt){_e(vt)}}function et(dt){try{rt(o.throw(dt))}catch(vt){_e(vt)}}function rt(dt){dt.done?j(dt.value):a(dt.value).then(tt,et)}rt((o=o.apply(s,e||[])).next())})},__rest$1=function(s,e){var i={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&e.indexOf(o)<0&&(i[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(s);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(s,o[a])&&(i[o[a]]=s[o[a]]);return i};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(s,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const i=prompt("Enter the password to open this PDF file.");s(i);break}case PasswordResponses.INCORRECT_PASSWORD:{const i=prompt("Invalid password. Please try again.");s(i);break}}};function isParameterObject(s){return typeof s=="object"&&s!==null&&("data"in s||"range"in s||"url"in s)}const Document=reactExports.forwardRef(function s(e,i){var{children:o,className:a,error:j="Failed to load PDF file.",externalLinkRel:_e,externalLinkTarget:tt,file:et,inputRef:rt,imageResourcesPath:dt,loading:vt="Loading PDF",noData:Ct="No PDF file specified.",onItemClick:Wt,onLoadError:Bt,onLoadProgress:qt,onLoadSuccess:Ut,onPassword:kt=defaultOnPassword,onSourceError:Nt,onSourceSuccess:un,options:dn,renderMode:hn,rotate:gn}=e,It=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[pt,Dt]=useResolver(),{value:mn,error:Lt}=pt,[yn,fn]=useResolver(),{value:$n,error:Ln}=yn,jn=reactExports.useRef(new LinkService),On=reactExports.useRef([]),Vn=reactExports.useRef(),Rn=reactExports.useRef();reactExports.useEffect(()=>{et&&et!==Vn.current&&isParameterObject(et)&&(warning$1(!dequal(et,Vn.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),Vn.current=et)},[et]),reactExports.useEffect(()=>{dn&&dn!==Rn.current&&(warning$1(!dequal(dn,Rn.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),Rn.current=dn)},[dn]);const Dn=reactExports.useRef({scrollPageIntoView:zn=>{const{dest:Hn,pageNumber:Pn,pageIndex:kn=Pn-1}=zn;if(Wt){Wt({dest:Hn,pageIndex:kn,pageNumber:Pn});return}const Bn=On.current[kn];if(Bn){Bn.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${Pn} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(i,()=>({linkService:jn,pages:On,viewer:Dn}),[]);function Fn(){un&&un()}function Tn(){Lt&&(warning$1(!1,Lt.toString()),Nt&&Nt(Lt))}function pn(){Dt({type:"RESET"})}reactExports.useEffect(pn,[et,Dt]);const En=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!et)return null;if(typeof et=="string")return isDataURI(et)?{data:dataURItoByteString(et)}:(displayCORSWarning(),{url:et});if(et instanceof PDFDataRangeTransport)return{range:et};if(isArrayBuffer(et))return{data:et};if(isBrowser&&isBlob(et))return{data:yield loadFromFile(et)};if(invariant(typeof et=="object"),invariant(isParameterObject(et)),"url"in et&&typeof et.url=="string"){if(isDataURI(et.url)){const{url:zn}=et,Hn=__rest$1(et,["url"]),Pn=dataURItoByteString(zn);return Object.assign({data:Pn},Hn)}displayCORSWarning()}return et}),[et]);reactExports.useEffect(()=>{const zn=makeCancellablePromise(En());return zn.promise.then(Hn=>{Dt({type:"RESOLVE",value:Hn})}).catch(Hn=>{Dt({type:"REJECT",error:Hn})}),()=>{cancelRunningTask(zn)}},[En,Dt]),reactExports.useEffect(()=>{if(!(typeof mn>"u")){if(mn===!1){Tn();return}Fn()}},[mn]);function An(){$n&&(Ut&&Ut($n),On.current=new Array($n.numPages),jn.current.setDocument($n))}function bn(){Ln&&(warning$1(!1,Ln.toString()),Bt&&Bt(Ln))}function wn(){fn({type:"RESET"})}reactExports.useEffect(wn,[fn,mn]);function Cn(){if(!mn)return;const zn=Object.assign(Object.assign({},dn),{isEvalSupported:!1}),Hn=Object.assign(Object.assign({},mn),zn),Pn=pdfjs.getDocument(Hn);qt&&(Pn.onProgress=qt),kt&&(Pn.onPassword=kt);const kn=Pn;return kn.promise.then(Bn=>{fn({type:"RESOLVE",value:Bn})}).catch(Bn=>{kn.destroyed||fn({type:"REJECT",error:Bn})}),()=>{kn.destroy()}}reactExports.useEffect(Cn,[dn,fn,mn]),reactExports.useEffect(()=>{if(!(typeof $n>"u")){if($n===!1){bn();return}An()}},[$n]);function Un(){jn.current.setViewer(Dn.current),jn.current.setExternalLinkRel(_e),jn.current.setExternalLinkTarget(tt)}reactExports.useEffect(Un,[_e,tt]);function Gn(zn,Hn){On.current[zn]=Hn}function er(zn){delete On.current[zn]}const nr=reactExports.useMemo(()=>({imageResourcesPath:dt,linkService:jn.current,onItemClick:Wt,pdf:$n,registerPage:Gn,renderMode:hn,rotate:gn,unregisterPage:er}),[dt,Wt,$n,hn,gn]),ar=reactExports.useMemo(()=>makeEventProps(It,()=>$n),[It,$n]);function or(){return React.createElement(DocumentContext.Provider,{value:nr},o)}function lr(){return et?$n==null?React.createElement(Message,{type:"loading"},typeof vt=="function"?vt():vt):$n===!1?React.createElement(Message,{type:"error"},typeof j=="function"?j():j):or():React.createElement(Message,{type:"no-data"},typeof Ct=="function"?Ct():Ct)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",a),ref:rt,style:{"--scale-factor":"1"}},ar),lr())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];var i=s.filter(Boolean);if(i.length<=1){var o=i[0];return o||null}return function(j){i.forEach(function(_e){typeof _e=="function"?_e(j):_e&&(_e.current=j)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(s){return s in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(s){return"children"in s}function isStructTreeNodeWithOnlyContentChild(s){return isStructTreeNode(s)?s.children.length===1&&0 in s.children&&"id"in s.children[0]:!1}function getRoleAttributes(s){const e={};if(isStructTreeNode(s)){const{role:i}=s,o=i.match(HEADING_PATTERN);if(o)e.role="heading",e["aria-level"]=Number(o[1]);else if(isPdfRole(i)){const a=PDF_ROLE_TO_HTML_ROLE[i];a&&(e.role=a)}}return e}function getBaseAttributes(s){const e={};if(isStructTreeNode(s)){if(s.alt!==void 0&&(e["aria-label"]=s.alt),s.lang!==void 0&&(e.lang=s.lang),isStructTreeNodeWithOnlyContentChild(s)){const[i]=s.children;if(i){const o=getBaseAttributes(i);return Object.assign(Object.assign({},e),o)}}}else"id"in s&&(e["aria-owns"]=s.id);return e}function getAttributes(s){return s?Object.assign(Object.assign({},getRoleAttributes(s)),getBaseAttributes(s)):null}function StructTreeItem({className:s,node:e}){const i=reactExports.useMemo(()=>getAttributes(e),[e]),o=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((a,j)=>React.createElement(StructTreeItem,{key:j,node:a})),[e]);return React.createElement("span",Object.assign({className:s},i),o)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const s=usePageContext();invariant(s);const{onGetStructTreeError:e,onGetStructTreeSuccess:i}=s,[o,a]=useResolver(),{value:j,error:_e}=o,{customTextRenderer:tt,page:et}=s;function rt(){j&&i&&i(j)}function dt(){_e&&(warning$1(!1,_e.toString()),e&&e(_e))}function vt(){a({type:"RESET"})}reactExports.useEffect(vt,[a,et]);function Ct(){if(tt||!et)return;const Wt=makeCancellablePromise(et.getStructTree()),Bt=Wt;return Wt.promise.then(qt=>{a({type:"RESOLVE",value:qt})}).catch(qt=>{a({type:"REJECT",error:qt})}),()=>cancelRunningTask(Bt)}return reactExports.useEffect(Ct,[tt,et,a]),reactExports.useEffect(()=>{if(j!==void 0){if(j===!1){dt();return}rt()}},[j]),j?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:j}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(s){const e=usePageContext();invariant(e);const i=Object.assign(Object.assign({},e),s),{_className:o,canvasBackground:a,devicePixelRatio:j=getDevicePixelRatio(),onRenderError:_e,onRenderSuccess:tt,page:et,renderForms:rt,renderTextLayer:dt,rotate:vt,scale:Ct}=i,{canvasRef:Wt}=s;invariant(et);const Bt=reactExports.useRef(null);function qt(){et&&tt&&tt(makePageCallback(et,Ct))}function Ut(hn){isCancelException(hn)||(warning$1(!1,hn.toString()),_e&&_e(hn))}const kt=reactExports.useMemo(()=>et.getViewport({scale:Ct*j,rotation:vt}),[j,et,vt,Ct]),Nt=reactExports.useMemo(()=>et.getViewport({scale:Ct,rotation:vt}),[et,vt,Ct]);function un(){if(!et)return;et.cleanup();const{current:hn}=Bt;if(!hn)return;hn.width=kt.width,hn.height=kt.height,hn.style.width=`${Math.floor(Nt.width)}px`,hn.style.height=`${Math.floor(Nt.height)}px`,hn.style.visibility="hidden";const gn={annotationMode:rt?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:hn.getContext("2d",{alpha:!1}),viewport:kt};a&&(gn.background=a);const It=et.render(gn),pt=It;return It.promise.then(()=>{hn.style.visibility="",qt()}).catch(Ut),()=>cancelRunningTask(pt)}reactExports.useEffect(un,[a,Bt,j,et,rt,kt,Nt]);const dn=reactExports.useCallback(()=>{const{current:hn}=Bt;hn&&(hn.width=0,hn.height=0)},[Bt]);return reactExports.useEffect(()=>dn,[dn]),React.createElement("canvas",{className:`${o}__canvas`,dir:"ltr",ref:mergeRefs(Wt,Bt),style:{display:"block",userSelect:"none"}},dt?React.createElement(StructTree,null):null)}function PageSVG(){const s=usePageContext();invariant(s);const{_className:e,onRenderSuccess:i,onRenderError:o,page:a,rotate:j,scale:_e}=s;invariant(a);const[tt,et]=useResolver(),{value:rt,error:dt}=tt;function vt(){a&&i&&i(makePageCallback(a,_e))}function Ct(){dt&&(isCancelException(dt)||(warning$1(!1,dt.toString()),o&&o(dt)))}const Wt=reactExports.useMemo(()=>a.getViewport({scale:_e,rotation:j}),[a,j,_e]);function Bt(){et({type:"RESET"})}reactExports.useEffect(Bt,[a,et,Wt]);function qt(){if(!a)return;const un=makeCancellablePromise(a.getOperatorList());return un.promise.then(dn=>{new pdfjs.SVGGraphics(a.commonObjs,a.objs).getSVG(dn,Wt).then(gn=>{if(!(gn instanceof SVGElement))throw new Error("getSVG returned unexpected result.");et({type:"RESOLVE",value:gn})}).catch(gn=>{et({type:"REJECT",error:gn})})}).catch(dn=>{et({type:"REJECT",error:dn})}),()=>cancelRunningTask(un)}reactExports.useEffect(qt,[a,et,Wt]),reactExports.useEffect(()=>{if(rt!==void 0){if(rt===!1){Ct();return}vt()}},[rt]);function Ut(un){if(!un||!rt)return;un.firstElementChild||un.appendChild(rt);const{width:dn,height:hn}=Wt;rt.setAttribute("width",`${dn}`),rt.setAttribute("height",`${hn}`)}const{width:kt,height:Nt}=Wt;return React.createElement("div",{className:`${e}__svg`,ref:un=>Ut(un),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:kt,height:Nt,userSelect:"none"}})}function isTextItem(s){return"str"in s}function TextLayer(){const s=usePageContext();invariant(s);const{customTextRenderer:e,onGetTextError:i,onGetTextSuccess:o,onRenderTextLayerError:a,onRenderTextLayerSuccess:j,page:_e,pageIndex:tt,pageNumber:et,rotate:rt,scale:dt}=s;invariant(_e);const[vt,Ct]=useResolver(),{value:Wt,error:Bt}=vt,qt=reactExports.useRef(null),Ut=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function kt(){Wt&&o&&o(Wt)}function Nt(){Bt&&(warning$1(!1,Bt.toString()),i&&i(Bt))}function un(){Ct({type:"RESET"})}reactExports.useEffect(un,[_e,Ct]);function dn(){if(!_e)return;const Lt=makeCancellablePromise(_e.getTextContent()),yn=Lt;return Lt.promise.then(fn=>{Ct({type:"RESOLVE",value:fn})}).catch(fn=>{Ct({type:"REJECT",error:fn})}),()=>cancelRunningTask(yn)}reactExports.useEffect(dn,[_e,Ct]),reactExports.useEffect(()=>{if(Wt!==void 0){if(Wt===!1){Nt();return}kt()}},[Wt]);const hn=reactExports.useCallback(()=>{j&&j()},[j]),gn=reactExports.useCallback(Lt=>{warning$1(!1,Lt.toString()),a&&a(Lt)},[a]);function It(){const Lt=Ut.current;Lt&&Lt.classList.add("active")}function pt(){const Lt=Ut.current;Lt&&Lt.classList.remove("active")}const Dt=reactExports.useMemo(()=>_e.getViewport({scale:dt,rotation:rt}),[_e,rt,dt]);function mn(){if(!_e||!Wt)return;const{current:Lt}=qt;if(!Lt)return;Lt.innerHTML="";const yn=_e.streamTextContent({includeMarkedContent:!0}),fn={container:Lt,textContentSource:yn,viewport:Dt},$n=pdfjs.renderTextLayer(fn),Ln=$n;return $n.promise.then(()=>{const jn=document.createElement("div");jn.className="endOfContent",Lt.append(jn),Ut.current=jn;const On=Lt.querySelectorAll('[role="presentation"]');if(e){let Vn=0;Wt.items.forEach((Rn,Dn)=>{if(!isTextItem(Rn))return;const Fn=On[Vn];if(!Fn)return;const Tn=e(Object.assign({pageIndex:tt,pageNumber:et,itemIndex:Dn},Rn));Fn.innerHTML=Tn,Vn+=Rn.str&&Rn.hasEOL?2:1})}hn()}).catch(gn),()=>cancelRunningTask(Ln)}return reactExports.useLayoutEffect(mn,[e,gn,hn,_e,tt,et,Wt,Dt]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:pt,onMouseDown:It,ref:qt})}function AnnotationLayer(){const s=useDocumentContext(),e=usePageContext();invariant(e);const i=Object.assign(Object.assign({},s),e),{imageResourcesPath:o,linkService:a,onGetAnnotationsError:j,onGetAnnotationsSuccess:_e,onRenderAnnotationLayerError:tt,onRenderAnnotationLayerSuccess:et,page:rt,pdf:dt,renderForms:vt,rotate:Ct,scale:Wt=1}=i;invariant(dt),invariant(rt),invariant(a);const[Bt,qt]=useResolver(),{value:Ut,error:kt}=Bt,Nt=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function un(){Ut&&_e&&_e(Ut)}function dn(){kt&&(warning$1(!1,kt.toString()),j&&j(kt))}function hn(){qt({type:"RESET"})}reactExports.useEffect(hn,[qt,rt]);function gn(){if(!rt)return;const Lt=makeCancellablePromise(rt.getAnnotations()),yn=Lt;return Lt.promise.then(fn=>{qt({type:"RESOLVE",value:fn})}).catch(fn=>{qt({type:"REJECT",error:fn})}),()=>{cancelRunningTask(yn)}}reactExports.useEffect(gn,[qt,rt,vt]),reactExports.useEffect(()=>{if(Ut!==void 0){if(Ut===!1){dn();return}un()}},[Ut]);function It(){et&&et()}function pt(Lt){warning$1(!1,`${Lt}`),tt&&tt(Lt)}const Dt=reactExports.useMemo(()=>rt.getViewport({scale:Wt,rotation:Ct}),[rt,Ct,Wt]);function mn(){if(!dt||!rt||!a||!Ut)return;const{current:Lt}=Nt;if(!Lt)return;const yn=Dt.clone({dontFlip:!0}),fn={accessibilityManager:null,annotationCanvasMap:null,div:Lt,l10n:null,page:rt,viewport:yn},$n={annotations:Ut,annotationStorage:dt.annotationStorage,div:Lt,downloadManager:null,imageResourcesPath:o,linkService:a,page:rt,renderForms:vt,viewport:yn};Lt.innerHTML="";try{new pdfjs.AnnotationLayer(fn).render($n),It()}catch(Ln){pt(Ln)}return()=>{}}return reactExports.useEffect(mn,[Ut,o,a,rt,vt,Dt]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:Nt})}var __rest=function(s,e){var i={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&e.indexOf(o)<0&&(i[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(s);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(s,o[a])&&(i[o[a]]=s[o[a]]);return i};const defaultScale=1,Page=function s(e){const i=useDocumentContext(),o=Object.assign(Object.assign({},i),e),{_className:a="react-pdf__Page",_enableRegisterUnregisterPage:j=!0,canvasBackground:_e,canvasRef:tt,children:et,className:rt,customRenderer:dt,customTextRenderer:vt,devicePixelRatio:Ct,error:Wt="Failed to load the page.",height:Bt,inputRef:qt,loading:Ut="Loading page",noData:kt="No page specified.",onGetAnnotationsError:Nt,onGetAnnotationsSuccess:un,onGetStructTreeError:dn,onGetStructTreeSuccess:hn,onGetTextError:gn,onGetTextSuccess:It,onLoadError:pt,onLoadSuccess:Dt,onRenderAnnotationLayerError:mn,onRenderAnnotationLayerSuccess:Lt,onRenderError:yn,onRenderSuccess:fn,onRenderTextLayerError:$n,onRenderTextLayerSuccess:Ln,pageIndex:jn,pageNumber:On,pdf:Vn,registerPage:Rn,renderAnnotationLayer:Dn=!0,renderForms:Fn=!1,renderMode:Tn="canvas",renderTextLayer:pn=!0,rotate:En,scale:An=defaultScale,unregisterPage:bn,width:wn}=o,Cn=__rest(o,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Un,Gn]=useResolver(),{value:er,error:nr}=Un,ar=reactExports.useRef(null);invariant(Vn);const or=isProvided(On)?On-1:jn??null,lr=On??(isProvided(jn)?jn+1:null),zn=En??(er?er.rotate:null),Hn=reactExports.useMemo(()=>{if(!er)return null;let Rr=1;const Or=An??defaultScale;if(wn||Bt){const jr=er.getViewport({scale:1,rotation:zn});wn?Rr=wn/jr.width:Bt&&(Rr=Bt/jr.height)}return Or*Rr},[Bt,er,zn,An,wn]);function Pn(){return()=>{isProvided(or)&&j&&bn&&bn(or)}}reactExports.useEffect(Pn,[j,Vn,or,bn]);function kn(){if(Dt){if(!er||!Hn)return;Dt(makePageCallback(er,Hn))}if(j&&Rn){if(!isProvided(or)||!ar.current)return;Rn(or,ar.current)}}function Bn(){nr&&(warning$1(!1,nr.toString()),pt&&pt(nr))}function Kn(){Gn({type:"RESET"})}reactExports.useEffect(Kn,[Gn,Vn,or]);function sr(){if(!Vn||!lr)return;const Rr=makeCancellablePromise(Vn.getPage(lr)),Or=Rr;return Rr.promise.then(jr=>{Gn({type:"RESOLVE",value:jr})}).catch(jr=>{Gn({type:"REJECT",error:jr})}),()=>cancelRunningTask(Or)}reactExports.useEffect(sr,[Gn,Vn,or,lr,Rn]),reactExports.useEffect(()=>{if(er!==void 0){if(er===!1){Bn();return}kn()}},[er,Hn]);const fr=reactExports.useMemo(()=>er&&isProvided(or)&&lr&&isProvided(zn)&&isProvided(Hn)?{_className:a,canvasBackground:_e,customTextRenderer:vt,devicePixelRatio:Ct,onGetAnnotationsError:Nt,onGetAnnotationsSuccess:un,onGetStructTreeError:dn,onGetStructTreeSuccess:hn,onGetTextError:gn,onGetTextSuccess:It,onRenderAnnotationLayerError:mn,onRenderAnnotationLayerSuccess:Lt,onRenderError:yn,onRenderSuccess:fn,onRenderTextLayerError:$n,onRenderTextLayerSuccess:Ln,page:er,pageIndex:or,pageNumber:lr,renderForms:Fn,renderTextLayer:pn,rotate:zn,scale:Hn}:null,[a,_e,vt,Ct,Nt,un,dn,hn,gn,It,mn,Lt,yn,fn,$n,Ln,er,or,lr,Fn,pn,zn,Hn]),ur=reactExports.useMemo(()=>makeEventProps(Cn,()=>er&&(Hn?makePageCallback(er,Hn):void 0)),[Cn,er,Hn]),qn=`${or}@${Hn}/${zn}`,gr=`${or}/${zn}`;function mr(){switch(Tn){case"custom":return invariant(dt),React.createElement(dt,{key:`${qn}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${gr}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${qn}_canvas`,canvasRef:tt})}}function Dr(){return pn?React.createElement(TextLayer,{key:`${qn}_text`}):null}function Cr(){return Dn?React.createElement(AnnotationLayer,{key:`${qn}_annotations`}):null}function Mr(){return React.createElement(PageContext.Provider,{value:fr},mr(),Dr(),Cr(),et)}function Tr(){return lr?Vn===null||er===void 0||er===null?React.createElement(Message,{type:"loading"},typeof Ut=="function"?Ut():Ut):Vn===!1||er===!1?React.createElement(Message,{type:"error"},typeof Wt=="function"?Wt():Wt):Mr():React.createElement(Message,{type:"no-data"},typeof kt=="function"?kt():kt)}return React.createElement("div",Object.assign({className:clsx(a,rt),"data-page-number":lr,ref:mergeRefs(qt,ar),style:{"--scale-factor":`${Hn}`,backgroundColor:_e||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},ur),Tr())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;function PdfViewer({paper:s,onClose:e}){const[i,o]=reactExports.useState(null),[a,j]=reactExports.useState(1),[_e,tt]=reactExports.useState(!0);function et({numPages:Ct}){o(Ct),tt(!1)}function rt(Ct){console.error("Error loading PDF:",Ct),tt(!1)}const dt=()=>{j(Ct=>Math.max(Ct-1,1))},vt=()=>{j(Ct=>Math.min(Ct+1,i))};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-5xl h-[90vh] flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-navy text-white rounded-t-lg",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold",children:s.subject}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-200",children:[s.year," | Semester ",s.semester," | ",s.examType]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[i&&jsxRuntimeExports.jsxs("span",{className:"text-sm",children:["Page ",a," of ",i]}),jsxRuntimeExports.jsx("button",{onClick:e,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition duration-200",children:" Close"})]})]}),i&&i>1&&jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center p-2 bg-gray-100 border-b",children:[jsxRuntimeExports.jsx("button",{onClick:dt,disabled:a<=1,className:"px-4 py-2 bg-navy text-white rounded-l-lg hover:bg-navy-dark disabled:opacity-50 disabled:cursor-not-allowed transition duration-200",children:" Previous"}),jsxRuntimeExports.jsxs("span",{className:"px-4 py-2 bg-white border-t border-b",children:["Page ",a," / ",i]}),jsxRuntimeExports.jsx("button",{onClick:vt,disabled:a>=i,className:"px-4 py-2 bg-navy text-white rounded-r-lg hover:bg-navy-dark disabled:opacity-50 disabled:cursor-not-allowed transition duration-200",children:"Next "}),jsxRuntimeExports.jsx("a",{href:s.fileURL,download:!0,className:"ml-4 px-4 py-2 bg-teal text-white rounded-lg hover:bg-teal-dark transition duration-200",children:" Download"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto p-4 bg-gray-100 flex justify-center",children:[_e&&jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-navy mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Loading PDF..."})]})}),jsxRuntimeExports.jsx(Document,{file:s.fileURL,onLoadSuccess:et,onLoadError:rt,loading:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-navy mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Loading PDF..."})]})}),error:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsxs("div",{className:"text-center p-8",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:""}),jsxRuntimeExports.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Failed to load PDF"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-4",children:"The PDF file could not be loaded. Please try downloading it instead."}),jsxRuntimeExports.jsx("a",{href:s.fileURL,target:"_blank",rel:"noopener noreferrer",className:"inline-block px-6 py-2 bg-teal text-white rounded-lg hover:bg-teal-dark transition duration-200",children:"Open in New Tab"})]})}),children:jsxRuntimeExports.jsx(Page,{pageNumber:a,renderTextLayer:!1,renderAnnotationLayer:!1,className:"shadow-lg"})})]})]})})}function StudentDashboard(){const[s,e]=reactExports.useState(null),[i,o]=reactExports.useState({currentYear:"",currentSemester:"",targetYear:"",targetSemester:""}),[a,j]=reactExports.useState([]),[_e,tt]=reactExports.useState(!1),[et,rt]=reactExports.useState(null),dt=useNavigate();reactExports.useEffect(()=>{vt()},[]);const vt=async()=>{try{const Bt=auth.currentUser;if(!Bt){dt("/login?role=student");return}const qt=await getDoc(doc(db,"users",Bt.uid));if(qt.exists()){const Ut=qt.data();e(Ut),Ut.year&&Ut.semester&&o({currentYear:Ut.year.toString(),currentSemester:Ut.semester.toString(),targetYear:"",targetSemester:""})}}catch(Bt){console.error("Error fetching user data:",Bt),B$1.error("Error loading user data")}},Ct=Bt=>{o({...i,[Bt.target.name]:Bt.target.value})},Wt=async Bt=>{Bt.preventDefault(),tt(!0);try{const qt=i.targetYear||i.currentYear,Ut=i.targetSemester||i.currentSemester,kt=(s==null?void 0:s.branch)||"";if(!qt||!Ut){B$1.error("Please provide year and semester!"),tt(!1);return}let Nt;kt?Nt=query(collection(db,"papers"),where("branch","==",kt),where("year","==",parseInt(qt)),where("semester","==",parseInt(Ut))):Nt=query(collection(db,"papers"),where("year","==",parseInt(qt)),where("semester","==",parseInt(Ut)));const dn=(await getDocs(Nt)).docs.map(hn=>({id:hn.id,...hn.data()}));dn.sort((hn,gn)=>hn.subject.localeCompare(gn.subject)),j(dn),dn.length===0?B$1.info("No papers found for the selected criteria."):B$1.success(`Found ${dn.length} paper(s)!`)}catch(qt){console.error("Error searching papers:",qt),B$1.error("Error searching papers: "+qt.message)}finally{tt(!1)}};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("main",{className:"flex-1 p-6 bg-gray-50",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-navy mb-4",children:"Student Dashboard"}),s&&jsxRuntimeExports.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"PRN:"})," ",s.prn||"N/A"," |"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Name:"})," ",s.name||"N/A"," |"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Branch:"})," ",s.branch||"N/A"," |"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Year:"})," ",s.year||"N/A"," |"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Semester:"})," ",s.semester||"N/A"]})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-navy mb-4",children:"Search Question Papers"}),jsxRuntimeExports.jsxs("form",{onSubmit:Wt,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Year"}),jsxRuntimeExports.jsx("input",{name:"currentYear",type:"number",placeholder:"e.g., 2023",value:i.currentYear,onChange:Ct,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Semester"}),jsxRuntimeExports.jsx("input",{name:"currentSemester",type:"number",placeholder:"e.g., 6",min:"1",max:"8",value:i.currentSemester,onChange:Ct,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Year (Optional)"}),jsxRuntimeExports.jsx("input",{name:"targetYear",type:"number",placeholder:"e.g., 2022 (leave blank to use current)",value:i.targetYear,onChange:Ct,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Semester (Optional)"}),jsxRuntimeExports.jsx("input",{name:"targetSemester",type:"number",placeholder:"e.g., 5 (leave blank to use current)",min:"1",max:"8",value:i.targetSemester,onChange:Ct,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"})]})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:_e,className:"w-full bg-navy text-white px-6 py-3 rounded-lg font-semibold hover:bg-navy-dark transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:_e?"Searching...":"Search Papers"})]})]}),a.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-navy mb-4",children:["Search Results (",a.length," paper",a.length!==1?"s":"",")"]}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"min-w-full border border-gray-200",children:[jsxRuntimeExports.jsx("thead",{className:"bg-navy text-white",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Subject"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Year"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Semester"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Exam Type"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Uploaded Date"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:a.map(Bt=>jsxRuntimeExports.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[jsxRuntimeExports.jsx("td",{className:"px-4 py-3 font-medium",children:Bt.subject}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:Bt.year}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:Bt.semester}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 capitalize",children:Bt.examType}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:Bt.uploadedAt?new Date(Bt.uploadedAt.toMillis()).toLocaleDateString():"N/A"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>rt(Bt),className:"text-blue-600 hover:underline text-sm font-medium",children:"View"}),jsxRuntimeExports.jsx("a",{href:Bt.fileURL,target:"_blank",rel:"noopener noreferrer",download:!0,className:"text-green-600 hover:underline text-sm font-medium",children:"Download"})]})})]},Bt.id))})]})})]}),a.length===0&&!_e&&jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-12 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:""}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-lg",children:"Use the search form above to find question papers."})]})]})}),jsxRuntimeExports.jsx(Footer,{}),et&&jsxRuntimeExports.jsx(PdfViewer,{paper:et,onClose:()=>rt(null)})]})}function UploadForm(){const[s,e]=reactExports.useState(null),[i,o]=reactExports.useState({subject:"",branch:"",year:"",semester:"",examType:"",description:""}),[a,j]=reactExports.useState(0),[_e,tt]=reactExports.useState(!1),et=vt=>{o({...i,[vt.target.name]:vt.target.value})},rt=vt=>{const Ct=vt.target.files[0];if(Ct){if(Ct.type!=="application/pdf"){B$1.error("Please select a PDF file only.");return}if(Ct.size>25*1024*1024){B$1.error("File size must be less than 25MB.");return}e(Ct)}},dt=async vt=>{if(vt.preventDefault(),!s){B$1.error("Please select a PDF file!");return}const{subject:Ct,branch:Wt,year:Bt,semester:qt,examType:Ut}=i;if(!Ct||!Wt||!Bt||!qt||!Ut){B$1.error("All required fields must be filled.");return}tt(!0),j(0);try{const kt=auth.currentUser;if(!kt){B$1.error("You must be logged in to upload.");return}const Nt=await getDoc(doc(db,"users",kt.uid)),un=Nt.exists()?Nt.data().name:kt.email,dn=`question_papers/${Wt}/${Bt}/${qt}/${Ct}_${Date.now()}.pdf`,hn=ref(storage,dn),gn=uploadBytesResumable(hn,s);gn.on("state_changed",It=>{const pt=It.bytesTransferred/It.totalBytes*100;j(pt)},async It=>{console.error("Upload error:",It),B$1.error("Upload failed: "+It.message),tt(!1),j(0)},async()=>{try{const It=await getDownloadURL(gn.snapshot.ref);await addDoc(collection(db,"papers"),{subject:i.subject,branch:i.branch,year:parseInt(i.year),semester:parseInt(i.semester),examType:i.examType,description:i.description||"",fileURL:It,filePath:dn,uploadedAt:serverTimestamp(),uploadedBy:kt.uid,uploadedByName:un});try{await addDoc(collection(db,"auditLogs"),{actorUid:kt.uid,actorName:un,action:"upload",targetId:"",timestamp:serverTimestamp()})}catch(Dt){console.error("Audit log error:",Dt)}B$1.success("Paper uploaded successfully!"),e(null),o({subject:"",branch:"",year:"",semester:"",examType:"",description:""}),j(0);const pt=document.querySelector('input[type="file"]');pt&&(pt.value="")}catch(It){console.error("Error saving paper data:",It),B$1.error("Error saving paper data. File may have been uploaded.");try{await deleteObject(hn)}catch(pt){console.error("Error deleting file:",pt)}}finally{tt(!1)}})}catch(kt){console.error("Upload error:",kt),B$1.error("Upload failed: "+kt.message),tt(!1),j(0)}};return jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 max-w-2xl mx-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-navy mb-6",children:"Upload Question Paper"}),jsxRuntimeExports.jsxs("form",{onSubmit:dt,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Subject ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{name:"subject",placeholder:"e.g., Data Structures",value:i.subject,onChange:et,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Branch ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{name:"branch",placeholder:"e.g., Computer Engineering",value:i.branch,onChange:et,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Year ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{name:"year",type:"number",placeholder:"e.g., 2023",value:i.year,onChange:et,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Semester ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{name:"semester",type:"number",placeholder:"e.g., 6",value:i.semester,onChange:et,min:"1",max:"8",className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Exam Type ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsxs("select",{name:"examType",value:i.examType,onChange:et,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select Exam Type"}),jsxRuntimeExports.jsx("option",{value:"mid",children:"Midterm"}),jsxRuntimeExports.jsx("option",{value:"endsem",children:"End Semester"}),jsxRuntimeExports.jsx("option",{value:"practical",children:"Practical"})]})]}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),jsxRuntimeExports.jsx("textarea",{name:"description",placeholder:"Additional notes about this paper...",value:i.description,onChange:et,rows:"3",className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent"})]}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PDF File ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})," (Max 25MB)"]}),jsxRuntimeExports.jsx("input",{type:"file",accept:"application/pdf",onChange:rt,className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy focus:border-transparent",required:!0}),s&&jsxRuntimeExports.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",s.name," (",(s.size/1024/1024).toFixed(2)," MB)"]})]})]}),a>0&&jsxRuntimeExports.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:[jsxRuntimeExports.jsx("div",{className:"bg-teal h-2.5 rounded-full transition-all duration-300",style:{width:`${a}%`}}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Upload progress: ",a.toFixed(0),"%"]})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:_e||!s,className:"w-full bg-navy text-white px-6 py-3 rounded-lg font-semibold hover:bg-navy-dark transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:_e?"Uploading...":"Upload Paper"})]})]})}function ManagePapers(){const[s,e]=reactExports.useState([]),[i,o]=reactExports.useState(!0),[a,j]=reactExports.useState({branch:"",year:"",subject:"",semester:""}),[_e,tt]=reactExports.useState(null),[et,rt]=reactExports.useState({});reactExports.useEffect(()=>{dt()},[]);const dt=async()=>{try{o(!0);const Ut=(await getDocs(collection(db,"papers"))).docs.map(kt=>({id:kt.id,...kt.data()}));Ut.sort((kt,Nt)=>!kt.uploadedAt||!Nt.uploadedAt?0:Nt.uploadedAt.toMillis()-kt.uploadedAt.toMillis()),e(Ut)}catch(qt){console.error("Error fetching papers:",qt),B$1.error("Error loading papers")}finally{o(!1)}},vt=s.filter(qt=>(!a.branch||qt.branch.toLowerCase().includes(a.branch.toLowerCase()))&&(!a.year||qt.year.toString().includes(a.year))&&(!a.subject||qt.subject.toLowerCase().includes(a.subject.toLowerCase()))&&(!a.semester||qt.semester.toString().includes(a.semester))),Ct=async qt=>{if(window.confirm(`Are you sure you want to delete "${qt.subject}"? This action cannot be undone.`))try{if(await deleteDoc(doc(db,"papers",qt.id)),qt.filePath)try{const Ut=ref(storage,qt.filePath);await deleteObject(Ut)}catch(Ut){console.error("Error deleting file from storage:",Ut)}B$1.success("Paper deleted successfully!"),dt()}catch(Ut){console.error("Error deleting paper:",Ut),B$1.error("Error deleting paper: "+Ut.message)}},Wt=qt=>{tt(qt),rt({subject:qt.subject,branch:qt.branch,year:qt.year,semester:qt.semester,examType:qt.examType,description:qt.description||""})},Bt=async()=>{try{await updateDoc(doc(db,"papers",_e.id),{subject:et.subject,branch:et.branch,year:parseInt(et.year),semester:parseInt(et.semester),examType:et.examType,description:et.description}),B$1.success("Paper updated successfully!"),tt(null),dt()}catch(qt){console.error("Error updating paper:",qt),B$1.error("Error updating paper: "+qt.message)}};return i?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center p-8",children:jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-navy"})}):jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-navy",children:"Manage Uploaded Papers"}),jsxRuntimeExports.jsx("button",{onClick:dt,className:"bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition duration-200",children:"Refresh"})]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Filter by Branch",value:a.branch,onChange:qt=>j({...a,branch:qt.target.value}),className:"border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Filter by Year",value:a.year,onChange:qt=>j({...a,year:qt.target.value}),className:"border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Filter by Subject",value:a.subject,onChange:qt=>j({...a,subject:qt.target.value}),className:"border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Filter by Semester",value:a.semester,onChange:qt=>j({...a,semester:qt.target.value}),className:"border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy"})]}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[jsxRuntimeExports.jsx("thead",{className:"bg-navy text-white",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Subject"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Branch"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Year"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Semester"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Exam Type"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Uploaded By"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Upload Date"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:vt.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:s.length===0?"No papers found. Upload your first paper!":"No papers match the filters."})}):vt.map(qt=>jsxRuntimeExports.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:qt.subject}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:qt.branch}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:qt.year}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:qt.semester}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 capitalize",children:qt.examType}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:qt.uploadedByName||"Unknown"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:qt.uploadedAt?new Date(qt.uploadedAt.toMillis()).toLocaleDateString():"N/A"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx("a",{href:qt.fileURL,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:"View"}),jsxRuntimeExports.jsx("button",{onClick:()=>Wt(qt),className:"text-teal-600 hover:underline text-sm",children:"Edit"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ct(qt),className:"text-red-600 hover:underline text-sm",children:"Delete"})]})})]},qt.id))})]})}),_e&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-navy mb-4",children:"Edit Paper Details"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),jsxRuntimeExports.jsx("input",{type:"text",value:et.subject,onChange:qt=>rt({...et,subject:qt.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),jsxRuntimeExports.jsx("input",{type:"text",value:et.branch,onChange:qt=>rt({...et,branch:qt.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),jsxRuntimeExports.jsx("input",{type:"number",value:et.year,onChange:qt=>rt({...et,year:qt.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),jsxRuntimeExports.jsx("input",{type:"number",value:et.semester,onChange:qt=>rt({...et,semester:qt.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Type"}),jsxRuntimeExports.jsxs("select",{value:et.examType,onChange:qt=>rt({...et,examType:qt.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg",children:[jsxRuntimeExports.jsx("option",{value:"mid",children:"Midterm"}),jsxRuntimeExports.jsx("option",{value:"endsem",children:"End Semester"}),jsxRuntimeExports.jsx("option",{value:"practical",children:"Practical"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-4 mt-6",children:[jsxRuntimeExports.jsx("button",{onClick:Bt,className:"flex-1 bg-navy text-white px-4 py-2 rounded-lg hover:bg-navy-dark",children:"Save Changes"}),jsxRuntimeExports.jsx("button",{onClick:()=>tt(null),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LONG_TYPE="type.googleapis.com/google.protobuf.Int64Value",UNSIGNED_LONG_TYPE="type.googleapis.com/google.protobuf.UInt64Value";function mapValues(s,e){const i={};for(const o in s)s.hasOwnProperty(o)&&(i[o]=e(s[o]));return i}function encode(s){if(s==null)return null;if(s instanceof Number&&(s=s.valueOf()),typeof s=="number"&&isFinite(s)||s===!0||s===!1||Object.prototype.toString.call(s)==="[object String]")return s;if(s instanceof Date)return s.toISOString();if(Array.isArray(s))return s.map(e=>encode(e));if(typeof s=="function"||typeof s=="object")return mapValues(s,e=>encode(e));throw new Error("Data cannot be encoded in JSON: "+s)}function decode(s){if(s==null)return s;if(s["@type"])switch(s["@type"]){case LONG_TYPE:case UNSIGNED_LONG_TYPE:{const e=Number(s.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+s);return e}default:throw new Error("Data cannot be decoded from JSON: "+s)}return Array.isArray(s)?s.map(e=>decode(e)):typeof s=="function"||typeof s=="object"?mapValues(s,e=>decode(e)):s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FUNCTIONS_TYPE="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const errorCodeMap={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FunctionsError extends FirebaseError{constructor(e,i,o){super(`${FUNCTIONS_TYPE}/${e}`,i||""),this.details=o,Object.setPrototypeOf(this,FunctionsError.prototype)}}function codeForHTTPStatus(s){if(s>=200&&s<300)return"ok";switch(s){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function _errorForResponse(s,e){let i=codeForHTTPStatus(s),o=i,a;try{const j=e&&e.error;if(j){const _e=j.status;if(typeof _e=="string"){if(!errorCodeMap[_e])return new FunctionsError("internal","internal");i=errorCodeMap[_e],o=_e}const tt=j.message;typeof tt=="string"&&(o=tt),a=j.details,a!==void 0&&(a=decode(a))}}catch{}return i==="ok"?null:new FunctionsError(i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ContextProvider{constructor(e,i,o,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=i.getImmediate({optional:!0}),this.messaging=o.getImmediate({optional:!0}),this.auth||i.get().then(j=>this.auth=j,()=>{}),this.messaging||o.get().then(j=>this.messaging=j,()=>{}),this.appCheck||a==null||a.get().then(j=>this.appCheck=j,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const i=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return i.error?null:i.token}return null}async getContext(e){const i=await this.getAuthToken(),o=await this.getMessagingToken(),a=await this.getAppCheckToken(e);return{authToken:i,messagingToken:o,appCheckToken:a}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_REGION="us-central1",responseLineRE=/^data: (.*?)(?:\n|$)/;function failAfter(s){let e=null;return{promise:new Promise((i,o)=>{e=setTimeout(()=>{o(new FunctionsError("deadline-exceeded","deadline-exceeded"))},s)}),cancel:()=>{e&&clearTimeout(e)}}}class FunctionsService{constructor(e,i,o,a,j=DEFAULT_REGION,_e=(...tt)=>fetch(...tt)){this.app=e,this.fetchImpl=_e,this.emulatorOrigin=null,this.contextProvider=new ContextProvider(e,i,o,a),this.cancelAllRequests=new Promise(tt=>{this.deleteService=()=>Promise.resolve(tt())});try{const tt=new URL(j);this.customDomain=tt.origin+(tt.pathname==="/"?"":tt.pathname),this.region=DEFAULT_REGION}catch{this.customDomain=null,this.region=j}}_delete(){return this.deleteService()}_url(e){const i=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${i}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${i}.cloudfunctions.net/${e}`}}function connectFunctionsEmulator$1(s,e,i){const o=isCloudWorkstation(e);s.emulatorOrigin=`http${o?"s":""}://${e}:${i}`,o&&(pingServer(s.emulatorOrigin),updateEmulatorBanner("Functions",!0))}function httpsCallable$1(s,e,i){const o=a=>call(s,e,a,{});return o.stream=(a,j)=>stream(s,e,a,j),o}async function postJSON(s,e,i,o){i["Content-Type"]="application/json";let a;try{a=await o(s,{method:"POST",body:JSON.stringify(e),headers:i})}catch{return{status:0,json:null}}let j=null;try{j=await a.json()}catch{}return{status:a.status,json:j}}async function makeAuthHeaders(s,e){const i={},o=await s.contextProvider.getContext(e.limitedUseAppCheckTokens);return o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken),i}function call(s,e,i,o){const a=s._url(e);return callAtURL(s,a,i,o)}async function callAtURL(s,e,i,o){i=encode(i);const a={data:i},j=await makeAuthHeaders(s,o),_e=o.timeout||7e4,tt=failAfter(_e),et=await Promise.race([postJSON(e,a,j,s.fetchImpl),tt.promise,s.cancelAllRequests]);if(tt.cancel(),!et)throw new FunctionsError("cancelled","Firebase Functions instance was deleted.");const rt=_errorForResponse(et.status,et.json);if(rt)throw rt;if(!et.json)throw new FunctionsError("internal","Response is not valid JSON object.");let dt=et.json.data;if(typeof dt>"u"&&(dt=et.json.result),typeof dt>"u")throw new FunctionsError("internal","Response is missing data field.");return{data:decode(dt)}}function stream(s,e,i,o){const a=s._url(e);return streamAtURL(s,a,i,o||{})}async function streamAtURL(s,e,i,o){var a;i=encode(i);const j={data:i},_e=await makeAuthHeaders(s,o);_e["Content-Type"]="application/json",_e.Accept="text/event-stream";let tt;try{tt=await s.fetchImpl(e,{method:"POST",body:JSON.stringify(j),headers:_e,signal:o==null?void 0:o.signal})}catch(Wt){if(Wt instanceof Error&&Wt.name==="AbortError"){const qt=new FunctionsError("cancelled","Request was cancelled.");return{data:Promise.reject(qt),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(qt)}}}}}}const Bt=_errorForResponse(0,null);return{data:Promise.reject(Bt),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(Bt)}}}}}}let et,rt;const dt=new Promise((Wt,Bt)=>{et=Wt,rt=Bt});(a=o==null?void 0:o.signal)===null||a===void 0||a.addEventListener("abort",()=>{const Wt=new FunctionsError("cancelled","Request was cancelled.");rt(Wt)});const vt=tt.body.getReader(),Ct=createResponseStream(vt,et,rt,o==null?void 0:o.signal);return{stream:{[Symbol.asyncIterator](){const Wt=Ct.getReader();return{async next(){const{value:Bt,done:qt}=await Wt.read();return{value:Bt,done:qt}},async return(){return await Wt.cancel(),{done:!0,value:void 0}}}}},data:dt}}function createResponseStream(s,e,i,o){const a=(_e,tt)=>{const et=_e.match(responseLineRE);if(!et)return;const rt=et[1];try{const dt=JSON.parse(rt);if("result"in dt){e(decode(dt.result));return}if("message"in dt){tt.enqueue(decode(dt.message));return}if("error"in dt){const vt=_errorForResponse(0,dt);tt.error(vt),i(vt);return}}catch(dt){if(dt instanceof FunctionsError){tt.error(dt),i(dt);return}}},j=new TextDecoder;return new ReadableStream({start(_e){let tt="";return et();async function et(){if(o!=null&&o.aborted){const rt=new FunctionsError("cancelled","Request was cancelled");return _e.error(rt),i(rt),Promise.resolve()}try{const{value:rt,done:dt}=await s.read();if(dt){tt.trim()&&a(tt.trim(),_e),_e.close();return}if(o!=null&&o.aborted){const Ct=new FunctionsError("cancelled","Request was cancelled");_e.error(Ct),i(Ct),await s.cancel();return}tt+=j.decode(rt,{stream:!0});const vt=tt.split(`
`);tt=vt.pop()||"";for(const Ct of vt)Ct.trim()&&a(Ct.trim(),_e);return et()}catch(rt){const dt=rt instanceof FunctionsError?rt:_errorForResponse(0,null);_e.error(dt),i(dt)}}},cancel(){return s.cancel()}})}const name="@firebase/functions",version="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AUTH_INTERNAL_NAME="auth-internal",APP_CHECK_INTERNAL_NAME="app-check-internal",MESSAGING_INTERNAL_NAME="messaging-internal";function registerFunctions(s){const e=(i,{instanceIdentifier:o})=>{const a=i.getProvider("app").getImmediate(),j=i.getProvider(AUTH_INTERNAL_NAME),_e=i.getProvider(MESSAGING_INTERNAL_NAME),tt=i.getProvider(APP_CHECK_INTERNAL_NAME);return new FunctionsService(a,j,_e,tt,o)};_registerComponent(new Component(FUNCTIONS_TYPE,e,"PUBLIC").setMultipleInstances(!0)),registerVersion(name,version,s),registerVersion(name,version,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getFunctions(s=getApp(),e=DEFAULT_REGION){const o=_getProvider(getModularInstance(s),FUNCTIONS_TYPE).getImmediate({identifier:e}),a=getDefaultEmulatorHostnameAndPort("functions");return a&&connectFunctionsEmulator(o,...a),o}function connectFunctionsEmulator(s,e,i){connectFunctionsEmulator$1(getModularInstance(s),e,i)}function httpsCallable(s,e,i){return httpsCallable$1(getModularInstance(s),e)}registerFunctions();const EyeIcon=s=>jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",...s,children:[jsxRuntimeExports.jsx("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.18l.88-1.32.88-1.32A1.65 1.65 0 013.8 6.07l.88-1.32.88-1.32A1.65 1.65 0 017.6 2.07l.88-1.32.88-1.32A1.65 1.65 0 0110 0c1.29 0 2.51.56 3.346 1.48l.88 1.32.88 1.32a1.65 1.65 0 011.086 1.63l.88 1.32.88 1.32a1.65 1.65 0 010 1.18l-.88 1.32-.88 1.32a1.65 1.65 0 01-1.086 1.63l-.88 1.32-.88 1.32a1.65 1.65 0 01-1.214.73l-.88 1.32-.88 1.32A1.65 1.65 0 0110 20c-1.29 0-2.51-.56-3.346-1.48l-.88-1.32-.88-1.32a1.65 1.65 0 01-1.086-1.63l-.88-1.32-.88-1.32a1.65 1.65 0 010-1.18zM10 15a5 5 0 100-10 5 5 0 000 10z",clipRule:"evenodd"})]}),EyeSlashIcon=s=>jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",...s,children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M3.28 2.22a.75.75 0 00-1.06 1.06l14.5 14.5a.75.75 0 101.06-1.06l-1.72-1.72A8.969 8.969 0 0018.75 10c-1.524-4.572-5.592-7.778-9.75-7.778a9.01 9.01 0 00-2.34.36L3.28 2.22zM10 15a5 5 0 01-5-5c0-.99.284-1.92.78-2.678L7.33 8.87C7.126 9.22 7 9.605 7 10a3 3 0 003 3c.395 0 .78-.126 1.13-.33l1.547 1.547A4.982 4.982 0 0110 15z",clipRule:"evenodd"})});function ManageStudents(){const[s,e]=reactExports.useState([]),[i,o]=reactExports.useState(!0),[a,j]=reactExports.useState(!1),[_e,tt]=reactExports.useState(!1),[et,rt]=reactExports.useState({prn:"",name:"",email:"",password:"",branch:"",year:"",semester:"",active:!0}),[dt,vt]=reactExports.useState(!1);reactExports.useEffect(()=>{Ct()},[]);const Ct=async()=>{try{o(!0);const kt=(await getDocs(query(collection(db,"users"),where("role","==","student")))).docs.map(Nt=>({id:Nt.id,...Nt.data()}));kt.sort((Nt,un)=>(Nt.prn||"").localeCompare(un.prn||"")),e(kt)}catch(Ut){console.error("Error fetching students:",Ut),B$1.error("Error loading students")}finally{o(!1)}},Wt=async Ut=>{if(Ut.preventDefault(),!et.prn||!et.name||!et.email||!et.password){B$1.error("Please fill all required fields.");return}tt(!0);const kt=query(collection(db,"users"),where("prn","==",et.prn));if(!(await getDocs(kt)).empty){B$1.error("PRN already exists. Please use a different PRN."),tt(!1);return}const un=query(collection(db,"users"),where("email","==",et.email));if(!(await getDocs(un)).empty){B$1.error("Email already exists. Please use a different email."),tt(!1);return}try{const hn={email:et.email,password:et.password,prn:et.prn,name:et.name,branch:et.branch||"",year:et.year?parseInt(et.year):null,semester:et.semester?parseInt(et.semester):null},gn=getFunctions();(await httpsCallable(gn,"createNewStudent")(hn)).data.success?(B$1.success("Student created successfully!"),rt({prn:"",name:"",email:"",password:"",branch:"",year:"",semester:"",active:!0}),j(!1),vt(!1),Ct()):B$1.error("Failed to create student. Please try again.")}catch(hn){console.error("Error creating student:",hn),B$1.error("Failed to create student: "+hn.message)}finally{tt(!1)}},Bt=async Ut=>{try{await updateDoc(doc(db,"users",Ut.id),{active:!Ut.active}),B$1.success(`Student access ${Ut.active?"disabled":"enabled"}!`),Ct()}catch(kt){console.error("Error updating access:",kt),B$1.error("Error updating access: "+kt.message)}},qt=async Ut=>{if(window.confirm(`Are you sure you want to delete student "${Ut.name}" (${Ut.prn})? This will permanently delete their account.`))try{await deleteDoc(doc(db,"users",Ut.id)),B$1.success("Student deleted successfully!"),Ct()}catch(kt){console.error("Error deleting student:",kt),B$1.error("Error deleting student: "+kt.message)}};return i?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center p-8",children:jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-navy"})}):jsxRuntimeExports.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-navy",children:"Manage Students"}),jsxRuntimeExports.jsx("button",{onClick:()=>j(!a),className:"bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition duration-200",children:a?"Cancel":"+ Add New Student"})]}),a&&jsxRuntimeExports.jsxs("form",{onSubmit:Wt,className:"bg-gray-50 p-6 rounded-lg mb-6 space-y-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-navy mb-4",children:"Create New Student Account"}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PRN ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{type:"text",value:et.prn,onChange:Ut=>rt({...et,prn:Ut.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{type:"text",value:et.name,onChange:Ut=>rt({...et,name:Ut.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{type:"email",value:et.email,onChange:Ut=>rt({...et,email:Ut.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:dt?"text":"password",value:et.password,onChange:Ut=>rt({...et,password:Ut.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy pr-10",required:!0,minLength:"6"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 cursor-pointer",onClick:()=>vt(!dt),children:dt?jsxRuntimeExports.jsx(EyeSlashIcon,{className:"h-5 w-5 text-gray-400"}):jsxRuntimeExports.jsx(EyeIcon,{className:"h-5 w-5 text-gray-400"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),jsxRuntimeExports.jsx("input",{type:"text",value:et.branch,onChange:Ut=>rt({...et,branch:Ut.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy",placeholder:"e.g., Computer Engineering"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),jsxRuntimeExports.jsx("input",{type:"number",value:et.year,onChange:Ut=>rt({...et,year:Ut.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy",placeholder:"e.g., 3",min:"1",max:"4"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),jsxRuntimeExports.jsx("input",{type:"number",value:et.semester,onChange:Ut=>rt({...et,semester:Ut.g.target.value}),className:"w-full border border-gray-300 p-2 rounded-lg focus:ring-2 focus:ring-navy",placeholder:"e.g., 6",min:"1",max:"8"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsxs("label",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:et.active,onChange:Ut=>rt({...et,active:Ut.target.checked}),className:"w-4 h-4 text-navy focus:ring-navy"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active (Enable Access)"})]})})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:_e,className:"w-full bg-navy text-white px-4 py-2 rounded-lg hover:bg-navy-dark transition duration-200 disabled:bg-gray-400",children:_e?"Creating...":"Create Student Account"})]}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[jsxRuntimeExports.jsx("thead",{className:"bg-navy text-white",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"PRN"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Email"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Branch"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Year"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Semester"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left",children:"Actions"})]})}),jsxRuntimeExports.jsx("tbody",{children:s.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No students found. Add your first student!"})}):s.map(Ut=>jsxRuntimeExports.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[jsxRuntimeExports.jsx("td",{className:"px-4 py-3 font-medium",children:Ut.prn}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:Ut.name}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:Ut.email}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:Ut.branch||"N/A"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:Ut.year||"N/A"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:Ut.semester||"N/A"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded text-sm font-semibold ${Ut.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Ut.active?"Active":"Disabled"})}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Bt(Ut),className:`text-sm px-3 py-1 rounded ${Ut.active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:Ut.active?"Disable":"Enable"}),jsxRuntimeExports.jsx("button",{onClick:()=>qt(Ut),className:"text-red-600 hover:underline text-sm",children:"Delete"})]})})]},Ut.id))})]})})]})}function AdminDashboard(){const[s,e]=reactExports.useState("upload");return useNavigate(),jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("div",{className:"bg-navy text-white shadow-md",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center py-4",children:jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"})}),jsxRuntimeExports.jsxs("nav",{className:"flex space-x-1 pb-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>e("upload"),className:`px-4 py-2 rounded-t-lg transition duration-200 ${s==="upload"?"bg-white text-navy font-semibold":"hover:bg-navy-light"}`,children:"Upload Paper"}),jsxRuntimeExports.jsx("button",{onClick:()=>e("managePapers"),className:`px-4 py-2 rounded-t-lg transition duration-200 ${s==="managePapers"?"bg-white text-navy font-semibold":"hover:bg-navy-light"}`,children:"Manage Papers"}),jsxRuntimeExports.jsx("button",{onClick:()=>e("manageStudents"),className:`px-4 py-2 rounded-t-lg transition duration-200 ${s==="manageStudents"?"bg-white text-navy font-semibold":"hover:bg-navy-light"}`,children:"Manage Students"})]})]})}),jsxRuntimeExports.jsx("main",{className:"flex-1 p-6 bg-gray-50",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto",children:[s==="upload"&&jsxRuntimeExports.jsx(UploadForm,{}),s==="managePapers"&&jsxRuntimeExports.jsx(ManagePapers,{}),s==="manageStudents"&&jsxRuntimeExports.jsx(ManageStudents,{})]})}),jsxRuntimeExports.jsx(Footer,{})]})}function PrivateRoute({children:s,role:e}){const[i,o]=reactExports.useState(!0),[a,j]=reactExports.useState(!1),_e=useNavigate();return reactExports.useEffect(()=>{const tt=onAuthStateChanged(auth,async et=>{if(!et){_e("/login?role="+e),o(!1);return}try{const rt=await getDoc(doc(db,"users",et.uid));if(!rt.exists()){console.error("User document not found for UID:",et.uid),B$1.error("User data not found in database. Please contact support."),await auth.signOut(),_e("/login?role="+e),o(!1);return}const dt=rt.data();if(console.log("PrivateRoute - User data:",dt),dt.active===!1||dt.active===void 0){B$1.error("Your account has been disabled. Please contact the exam cell."),await auth.signOut(),_e("/"),o(!1);return}if(dt.role!==e){console.error(`Role mismatch: Expected ${e}, got ${dt.role}`),B$1.error(`Unauthorized access. You are logged in as ${dt.role}, but this section requires ${e}.`),_e("/"),o(!1);return}j(!0)}catch(rt){console.error("Error checking user role:",rt),B$1.error("Error verifying access: "+rt.message),_e("/login?role="+e)}finally{o(!1)}});return()=>tt()},[_e,e]),i?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center min-h-screen",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-navy mx-auto"}),jsxRuntimeExports.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):a?s:null}function App(){return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-50",children:[jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Home,{})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(Login,{})}),jsxRuntimeExports.jsx(Route,{path:"/student",element:jsxRuntimeExports.jsx(PrivateRoute,{role:"student",children:jsxRuntimeExports.jsx(StudentDashboard,{})})}),jsxRuntimeExports.jsx(Route,{path:"/admin",element:jsxRuntimeExports.jsx(PrivateRoute,{role:"admin",children:jsxRuntimeExports.jsx(AdminDashboard,{})})})]}),jsxRuntimeExports.jsx(Q$1,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})}));
